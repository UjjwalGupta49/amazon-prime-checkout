(function(h){var A=window.AmazonUIPageJS||window.P,w=A._namespace||A.attributeErrors,c=w?w("CheckoutWebappAssets",""):A;c.guardFatal?c.guardFatal(h)(c,window):c.execute(function(){h(c,window)})})(function(h,A,w){"use strict";h.when("A","jQuery","utils/createClass").register("components/Component",function(c,d,g){var f=g({$el:null,props:{},defaultProps:{},init:function(b){this.$el=d(b.$el);if(1<this.$el.length)throw Error("Component must be attached with only one DOM element");if(!this.$el.length)return this;
this.bindAll();this.props=d.extend({},this.defaultProps,b);this.onInit(this.props)},onInit:d.noop,find:function(b){return this.$el.find(b)},bindAll:function(){for(var b in this)"function"===typeof this[b]&&(this[b]=d.proxy(this[b],this))},data:function(){return this.$el.data.apply(this.$el,arguments)}});f.create=function(b){var a=this;return b.$el.length?c.map(b.$el,function(e){return new a(c.extend({},b,{$el:d(e)}))}):[]};f.extend=function(){function b(e){e=a.call(this,e);e.extend=b;e.create=f.create;
return e}var a=f.extend;return b}();return f});"use strict";h.when("jQuery","components/Component","weblab-helper").register("components/Checkbox",function(c,d,g){return d.extend({checkbox:null,$el:null,defaultProps:{onChange:c.noop},onInit:function(){if(g.isPyoClientSideInitiationEnabled()){if(!this.$el.length||!this.$el.is(":checkbox"))throw Error("[Checkbox] No checkbox input is found");this.$el.bind("change",this.handleChange)}else{if(!this.$el.hasClass("a-checkbox"))throw Error("[Checkbox] Checkbox component must instantiate with an `a-checkbox` element");
this.$input=this.find(":checkbox");if(!this.$input.length)throw Error("[Checkbox] No checkbox input is found");this.$input.bind("change",this.handleChange)}},handleChange:function(d){this.props.onChange(this.isChecked(),this,d)},isChecked:function(){return g.isPyoClientSideInitiationEnabled()?this.$el.is(":checked"):this.$input.is(":checked")},data:function(d,b){return this.$el.data(d,b)}})});"use strict";h.when("A","jQuery","components/Component","components/Checkbox","weblab-helper").register("components/PrimaryActionBlockerCheckbox",
function(c,d,g,f,b){function a(){var a=c.reduce(e,function(a,e){var d="";if(a.blocking)return a;b.isPyoClientSideInitiationEnabled()?(a=e.shouldBlock())&&(d=e.getBlockerMessage()):(a=!e.isChecked())&&(d=e.data("blocker-message"));return{blocking:a,message:d}},{blocking:null,message:""});c.equals(a,m)||(m=a,c.trigger(l.blockingStateChanged,a))}var e=[],m={blocking:null,message:""},l={blockingStateChanged:"checkbox:primaryActionBlocker:blockingStateChanged"};g=g.extend({onInit:function(d){b.isPyoClientSideInitiationEnabled()?
(this.checkbox=new f({$el:this.$el,onChange:a}),this.blockerMessage=d.blockerMessage,e.push(this)):(this.checkbox=new f({$el:this.$el,onChange:a}),e.push(this.checkbox));a()},shouldBlock:function(){return!this.$el.is(":checked")},getBlockerMessage:function(){return this.blockerMessage}});g.events=l;g.tryChangingBlockingState=a;g.getState=function(){return e.length?d.extend({},m):null};var n=b.isPyoClientSideInitiationEnabled()?"checkout:unload":"checkout:beforeReload";c.on(n,function(){e=[];m={blocking:null,
message:""}});return g});"use strict";h.register("configurations/keys",function(){var c={VIEW_TYPE:"VIEW_TYPE",CONTAINER_SELECTOR:"CONTAINER_SELECTOR",PURCHASE_ID_SELECTOR:"PURCHASE_ID_SELECTOR",validate:function(d){if("string"!==typeof d||!c[d])throw Error('The key "'+d+'" is not defined within "configurations/keys".');}};return c});"use strict";h.when("configurations/keys").register("configurations/newCheckoutExperienceConfig",function(c){var d={};d[c.VIEW_TYPE]="newCheckoutExperience";d[c.CONTAINER_SELECTOR]=
"#checkout-experience-container";d[c.PURCHASE_ID_SELECTOR]='input[name\x3d"purchaseId"]';return{getConfiguration:function(c){return c in d?d[c]:null}}});h.when("A").register("utils/createClass",function(c){function d(){}if(c.createClass)return c.createClass;var g=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;d.extend=function(c){var b=this.prototype,a=Object.create?Object.create(b):function(b){function a(){}a.prototype=b;return new a}(b),e;for(e in c)a[e]="function"===typeof c[e]&&"function"===typeof b[e]&&
g.test(c[e])?function(a,e){return function(){var d=this._super;this._super=b[a];var c=e.apply(this,arguments);this._super=d;return c}}(e,c[e]):c[e];c="function"===typeof a.init?a.hasOwnProperty("init")?a.init:function(){b.init.apply(this,arguments)}:function(){};c.prototype=a;a.constructor=c;c.extend=d.extend;return c};return function(c){return d.extend(c)}});"use strict";h.register("utils/eventConstants",function(){return{PAGE_CONTENTS_REPLACED:"checkout:pageContentsReplaced"}});"use strict";h.when("A",
"client-side-metrics","utils/eventConstants","utils/redirectionUtils","utils/urlConstants").register("utils/pageConductor",function(c,d,g,f,b){return{redirectToGurupa:function(a){f.redirectInCurrentTab(b.GURUPA_URL,a)},replaceDisplayContent:function(b,e){0<b.length&&(b.replaceWith(e),c.trigger(g.PAGE_CONTENTS_REPLACED))}}});"use strict";h.when("A","client-side-metrics").register("utils/redirectionUtils",function(c,d){function g(b,a,e,c){b&&0<b.length?(d.setCountValue("checkout:"+a+":startRedirection",
1),A.open(f(b,e),c?"_blank":"_self")):d.setCountValue("checkout:"+a+":emptyUrl",1)}function f(b,a){var e=Object.keys(a).map(function(b){return b+"\x3d"+a[b]});return 0<e.length?b+(-1<b.indexOf("?")?"\x26":"?")+e:b}return{redirectInCurrentTab:function(b,a,e){g(b,a,e||{},!1)},openInNewTab:function(b,a,e){g(b,a,e||{},!0)}}});"use strict";h.register("utils/smsMessageValidator",function(){var c=/^[\n\r !-Z[\]\\^_a-~¡£¤¥§¿ÄÅÆÇÉÑÓÖØÜßàäåæçèéìñòóöøùüĄąĆćĘęĞğİıŁłŃńŚśŞşŹ-żΓΔΘΛΞΠΣΦΨΩ€]*$/;return{isValid:function(d){return c.test(d)}}});
"use strict";h.register("utils/urlConstants",function(){return{GURUPA_URL:"/gp/buy/shared/handlers/dispatch.html",SHOPPING_PORTAL_ROUTED_WEBAPP_LOCATION_PURCHASES:"/checkout/p/"}});"use strict";h.when("utils/urlConstants").register("utils/urlUtils",function(c){function d(d,f){return c.SHOPPING_PORTAL_ROUTED_WEBAPP_LOCATION_PURCHASES+d+f}return{buildShoppingPortalRoutedWebappUrl:d,buildShoppingPortalRoutedWebappUrlWithParams:function(c,f,b){c=d(c,f);if(!b)return c;f=Object.keys(b).map(function(a){return a+
"\x3d"+b[a]});for(var a=0;a<f.length;a++)c=c+(-1<c.indexOf("?")?"\x26":"?")+f[a];return c}}});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor","widgets/ageVerification/ageVerificationCommon","client-side-metrics").register("widgets/ageVerification/removeLineItems",function(c,d,g,f,b,a){c.declarative("age-restriction-remove-restricted-items","click",function(e){a.increaseCount("checkout:ageverification:removeRestrictedItemsClick",1);e=e.data;var c=(new Date).getTime(),
g=f.setAjaxTransitionHeader({"x-amz-checkout-page":"agelimitation"});b.startPageTransition(e.loadingText);d.ajax({type:"POST",url:e.url+"\x26cachebuster\x3d"+c,data:d.param(e.param,!0),dataType:"text",headers:g,error:f.ajaxRedirect,success:f.ajaxUpdatePage})})});"use strict";h.when("A","jQuery").register("widgets/ageVerification/switchIdForm",function(c,d){c.declarative("age-verification-change-id-dropdown","change",function(c){c=".age-verification-id-"+c.$target.find(":selected").val().toLowerCase().replace(/_/g,
"-");var f=d("[name\x3d'age_verification_form']");f.find(".age-verification-id").addClass("aok-hidden");f.find(c).removeClass("aok-hidden")})});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor","widgets/ageVerification/ageVerificationCommon").register("widgets/ageVerification/ageVerification",function(c,d,g,f,b){function a(b){var a=!0;b.find(".a-button-error, .a-form-error").removeClass("a-button-error").removeClass("a-form-error").end().find(".calendar-dropdown select, .age-verification-id:visible select, :text:visible, [type\x3ddate]:visible, [type\x3dnumber]:visible").each(function(b,
e){b=d(e);b.val()||(a=!1,"INPUT"===b.prop("tagName")?b.addClass("a-form-error"):b.siblings(".a-button-dropdown").addClass("a-button-error"))});return a?!0:(b.find("#missing-fields-error-message").removeClass("aok-hidden"),!1)}function e(a){a=b.buildFormData(a);var e=f.setAjaxTransitionHeader({"x-amz-checkout-page":"agelimitation"});return d.ajax({type:"POST",url:"/gp/buy/agelimitation/handlers/dob-uploader.html",data:a,dataType:"text",headers:e,success:p,error:f.ajaxRedirect})}function m(a){var e=
a.data("profile");a=b.buildFormData(a);return d.ajax({type:"POST",url:"/ap/cvf/request/identity?sif_profile\x3d"+e,data:a,dataType:"json",success:l,error:f.ajaxRedirect})}function l(b,a){var e=d('[name\x3d"age_verification_form"]');a=e.find('input[name\x3d"ageLimitation"]').val();e=e.find('input[name\x3d"ivvDomain"]').val();b={claimToken:b.token,ageLimit:a,ivvDomain:e};a=f.setAjaxTransitionHeader({"x-amz-checkout-page":"agelimitation"});return d.ajax({type:"POST",url:"/gp/buy/agelimitation/handlers/decode.html",
data:b,dataType:"text",headers:a,success:n,error:f.ajaxRedirect})}function n(a,e,c){var g=a.trim(),n;-1!==g.indexOf("newRequestToken\x3d")&&(n=g.split("\x3d")[1]);n?(b.stopPageTransition(),a=d('[name\x3d"age_verification_form"]'),a.find("#id-error-message").removeClass("aok-hidden"),a.find('input[name\x3d"requestToken"]').val(n)):f.ajaxUpdatePage(a,e,c)}function p(a,e,c){var g=a.trim();null!==c&&null===c.getResponseHeader("x-amz-checkout-agelimitation-embu-write-failed")&&-1===g.indexOf("embuWriteFailed")?
f.ajaxUpdatePage(a,e,c):(b.stopPageTransition(),d('[name\x3d"age_verification_form"]').find("#upload-error-message").removeClass("aok-hidden"))}d(document.documentElement).delegate('[name\x3d"age_verification_form"]',"submit",function(c){c.preventDefault();c=d(c.target);c.find("#dob-error-message").addClass("aok-hidden");c.find("#id-error-message").addClass("aok-hidden");c.find("#missing-fields-error-message").addClass("aok-hidden");a(c)&&b.validateDateOfBirth()&&(b.startPageTransition(c.data("loadingtext")),
"true"===c.find('input[name\x3d"isDateOfBirthOnlyEnabled"]').val()?e(c):m(c))});return{validateDateOfBirth:b.validateDateOfBirth,validateForm:a,callCVF:m,submitDateOfBirthForm:e,decodeClaimToken:l,verifyServiceResult:n,verifyDateOfBirthUploadResult:p}});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor").register("widgets/ageVerification/ageVerificationCommon",function(c,d,g,f){function b(a){a=a.split(/\D/);return new Date(a[0],a[1]-1,a[2])}function a(a){var b=a.find('input[name\x3d"dob_input"]');
b.length?e(b,"dob-error-message"):(m(a.find('[name\x3d"month"]'),"dob-error-message"),m(a.find('[name\x3d"day"]'),"dob-error-message"),m(a.find('[name\x3d"year"]'),"dob-error-message"))}function e(a,b){var e=a.parent(".a-input-text-wrapper");(e.length?e:a).addClass("a-form-error");l(a,b)}function m(a,b){a=a.siblings("span.a-button-dropdown");a.addClass("a-button-error");l(a,b)}function l(a,b){a.attr("aria-invalid",!0);a.attr("aria-errormessage",b);d("#"+b).removeClass("aok-hidden")}return{validateDateOfBirth:function(){var e=
d('[name\x3d"age_verification_form"]'),c=e.find('input[name\x3d"dob_input"]');if(c.length)c=b(c.val());else{var g=e.find('[name\x3d"year"]').val(),f=e.find('[name\x3d"month"]').val(),m=e.find('[name\x3d"day"]').val(),c=b(g+"-"+f+"-"+m);if(c.getFullYear()!==Number(g)||c.getMonth()!==Number(f)-1||c.getDate()!==Number(m))return a(e),!1}g=e.find('input[name\x3d"ageLimitation"]').val();f=new Date;if(f.getFullYear()-c.getFullYear()>Number(g)||f.getFullYear()-c.getFullYear()===Number(g)&&0<=f.getMonth()-
c.getMonth()&&0<=f.getDate()-c.getDate())return!0;a(e);return!1},buildFormData:function(a){var b=a.serialize();if(!a.find('input[name\x3d"dob_input"]').length){var c=a.find('[name\x3d"year"]').val(),e=a.find('[name\x3d"month"]').val();a=a.find('[name\x3d"day"]').val();c=c+"-"+("0"+e).slice(-2)+"-"+("0"+a).slice(-2);b+="\x26dob_input\x3d"+c}return b},stopPageTransition:function(){if(f.isSPP()){var a=d("#agelimitation");a.removeClass("spp-panel.collapsed");a.addClass("spp-panel.expanded");var b=a.find(".panel-content");
a.find(".shrink-placeholder").hide();b.show();g.unblockAllActions()}else g.hide()},startPageTransition:function(a){if(f.isSPP()){g.blockAllActions();var b=d("#agelimitation");g.shrinkPanel(b,!0,a)}else g.show()},addSelectError:m,addInputError:e}});"use strict";h.when("A").register("widgets/ageVerification/formPreprocessor/formPreprocessor",function(){function c(c){return/\d/.test(c)}return{preprocessForm:function(d){var g=d.clone();0===d.find('[name\x3d"dob_input"]').length&&(g.find('[name\x3d"day"]').val(d.find('[name\x3d"day"]').val()),
g.find('[name\x3d"month"]').val(d.find('[name\x3d"month"]').val()),g.find('[name\x3d"year"]').val(d.find('[name\x3d"year"]').val()));d=g.find('[name\x3d"door-number"]');var f=d.val(),f=f.replace(/(?![A-Za-z0-9])[-¿]/g," ");f=c(f)?f.split(" ").filter(c).join(" "):f;f=f.replace(/\s\s+/g," ").trim();d.val(f);return g}}});"use strict";h.when("A","jQuery","client-side-metrics","configurations/keys","configurations/newCheckoutExperienceConfig","utils/redirectionUtils").register("widgets/deliveryAddress/newCheckoutExperience/deliveryAddress",
function(c,d,g,f,b,a){var e=b.getConfiguration(f.VIEW_TYPE);c.declarative("change-delivery-option-action","click",function(b){g.setCountValue("checkout:newCheckoutExperience:changeDelivery",1);a.redirectInCurrentTab(b.data.redirectionUrl,e)});c.declarative("add-delivery-instructions-action","click",function(b){g.setCountValue("checkout:newCheckoutExperience:addDeliveryInstruction",1);a.redirectInCurrentTab(b.data.redirectionUrl,e)})});"use strict";h.when("A","jQuery","weblab-helper","gift-utility",
"a-checkbox","page-transition-controller","a-truncate","a-popover-base","email-validation","gift-contact-picker","utils/smsMessageValidator").register("widgets/giftOptions/giftOptions",function(c,d,g,f,b,a,e,m,l,n,p){function q(a){this._domElement=a}function t(a){this._domElement=a}function ca(a){this._domElement=a;this.isInputValid=function(){return H()?J(this._domElement.val())||l(this._domElement.val()):l(this._domElement.val())};this.toggleValidationError=function(a){var b=H()?"#gcx-egift-warning-no-contact-details-":
"#egift-recipient-email-warning-";y(k.find(b+this.getLineItemIndex()),a);z(this._domElement,a,"")}}function da(a){this._domElement=a;this.isInputValid=function(){if(!H()||!J(this._domElement.val()))return!0;var a=fa(this._domElement.val());return a.isValid?!0:"gcx-egift-warning-not-valid-mobile-"!==a.warningKey};this.toggleValidationError=function(a){y(k.find("#gcx-egift-warning-not-valid-mobile-"+this.getLineItemIndex()),a);z(this._domElement,a,"-phone")}}function ea(a){this._domElement=a;this.isInputValid=
function(){if(!H()||!J(this._domElement.val()))return!0;var a=fa(this._domElement.val());return a.isValid?!0:"gcx-egift-warning-not-supported-mobile-"!==a.warningKey};this.toggleValidationError=function(a){y(k.find("#gcx-egift-warning-not-supported-mobile-"+this.getLineItemIndex()),a);z(this._domElement,a,"-region")}}function ga(a){this._domElement=a;this.isInputValid=function(){return U(this.getLineItemIndex()).senderNameIsOptional||d.trim(this._domElement.val())};this.toggleValidationError=function(a){y(k.find("#sender-name-empty-warning-"+
this.getLineItemIndex()),a);z(this._domElement,a,"-empty")}}function K(a){this._domElement=a;this.isInputValid=function(){return!f.valueContainsUrl(d.trim(this._domElement.val()))}}function ha(a){K.call(this,a);this.toggleValidationError=function(a){y(k.find("#sender-name-url-warning-"+this.getLineItemIndex()),a);z(this._domElement,a,"-url")}}function ia(a){K.call(this,a);this.toggleValidationError=function(a){y(k.find("#message-url-warning-"+this.getLineItemIndex()),a);z(this._domElement,a,"-url")}}
function ja(a){this._domElement=a;var b=this.getLineItemIndex();this.isInputValid=function(){var a=!1;if(p&&0<k.find('[id^\x3d"message-invalid-chars-warning-"]').length)var a=x(b).val(),D=B(b).val(),a=a+V(D),a=J(L(b).val())&&!p.isValid(a);return!a};this.toggleValidationError=function(a){y(k.find("#message-invalid-chars-warning-"+b),a);z(this._domElement,a,"-chars")}}function ka(a){this._domElement=a;this.isInputValid=function(){var a=this.getLineItemIndex(),b=U(a),D=x(a).val(),a=B(a).val(),D=D+V(a),
a=f.getLineCount(D,b.maxLineLength),c=D.length;if(b=a<=b.maxLines&&c<=b.maxChars)b=!(512<A.unescape(encodeURIComponent(D)).length);return b};this.toggleValidationError=function(a){var b=this.getLineItemIndex();y(k.find("#message-length-warning-"+b),a);z(this._domElement,a,"-length");z(k.find("#gift-message-sender-input-"+b),a,"-length");a=!a;k.find("#message-counter-"+b).find(".counter-text").toggleClass("a-color-error",!a)}}function la(a){this._domElement=a;this.isInputValid=function(){return l(this._domElement.val())};
this.toggleValidationError=function(a){var b=this.getLineItemIndex();y(k.find("#recipient-not-email-warning-"+b),a);z(this._domElement,a,"")}}function x(a){return k.find("#message-area-"+a)}function Q(a){return b("#gift-wrap-checkbox-"+a,k)}function C(a){return b("#digital-gift-message-checkbox-"+a,k)}function ma(a){return k.find("#digital-gift-message-input-wrapper-"+a)}function M(a){return k.find("#digital-gift-message-text-input-"+a)}function L(a){return k.find("#egift-recipient-text-input-"+a)}
function B(a){return k.find("#gift-message-sender-input-"+a)}function W(a){return b("#toggle-gift-item-checkbox-"+a,k)}function R(a){return k.find("#gift-wrap-selection-"+a)}function I(a){a.addClass("aok-hidden")}function E(a){a.removeClass("aok-hidden")}function y(a,b){b?E(a):I(a)}function F(a){a.prop("disabled",!0);a.removeClass("a-form-normal").addClass("a-form-disabled")}function G(a){a.prop("disabled",!1);a.removeClass("a-form-disabled").addClass("a-form-normal")}function na(a){I(a.find(".gift-options-summary-header"));
E(a.find(".gift-options-expanded-header"))}function U(a){return x(a).closest("[data-message-validation-options]").data("messageValidationOptions")}function J(a){return/^\+?[()\s.0-9-]*$/.test(a)&&9<a.length&&19>a.length}function fa(a){var b=String(a);if(!b)return{isValid:!1,warningKey:"gcx-egift-warning-not-valid-mobile-"};a="+"===b[0]?b:"+1"+b;if(11!==(a.match(/\d/g)||[]).length||!/^(\+[1-9][\s.-]?)?(\(\d{3}\)|\d{3})[\s.-]?\d{3}[\s.-]?\d{4}$/.test(b))return{isValid:!1,warningKey:"gcx-egift-warning-not-valid-mobile-"};
if("1"!==a[1])return{isValid:!1,warningKey:"gcx-egift-warning-not-supported-mobile-"};a=a.slice(2).replace(/[()\s-.]/g,"");return/(?:2(?:0[1-35-9]|1[02-9]|2[03-589]|3[149]|4[08]|5[1-46]|6[0279]|7[0269]|8[13])|3(?:0[1-57-9]|1[02-9]|2[01356]|3[0-24679]|4[167]|5[12]|6[014]|8[056])|4(?:0[124-9]|1[02-579]|2[3-5]|3[0245]|4[023578]|58|6[39]|7[0589]|8[04])|5(?:0[1-47-9]|1[0235-8]|20|3[0149]|4[01]|5[19]|6[1-47]|7[0-5]|8[056])|6(?:0[1-35-9]|1[024-9]|2[03689]|[34][016]|5[0179]|6[0-279]|78|8[0-29])|7(?:0[1-46-8]|1[2-9]|2[04-7]|3[1247]|4[037]|5[47]|6[02359]|7[0-59]|8[156])|8(?:0[1-6]|1[02-8]|2[08]|3[0-289]|4[03578]|5[046-9]|6[02-5]|7[028])|9(?:0[134689]|1[02-9]|2[0589]|3[0146-8]|4[01579]|5[12469]|7[0-389]|8[04-69]))[2-9]\d{6}$/.test(a)?
{isValid:!0,warningKey:w}:{isValid:!1,warningKey:"gcx-egift-warning-not-supported-mobile-"}}function H(){return document.getElementById("gcx-egift-warning-no-contact-details-0")}function oa(a,b,c){var e=k.find("#message-counter-"+a).find("."+b+"-counter");a=e.find(".count");b=e.find(".message");var d=Math.abs(c),e=e.data("messageData");c=0<c?"remaining":"over";var g=1===d?"single":"multiple";a.text(d);b.text(e[c][g])}function V(a){return a?"\n"+Array(pa+1).join("X")+a:""}function u(a,b){var c=!0;
Array.isArray(a)&&a.forEach(function(a){a.validate(b)||(c=!1)});return c}function ua(a){var b=[];Array.isArray(a)&&a.forEach(function(a){a.validate(!1)||b.push(a)});return b}function X(a){if(0<x(a).size()){var b=U(a),c=x(a).val(),e=B(a).val(),c=c+V(e),e=f.getLineCount(c,b.maxLineLength);oa(a,"lines",b.maxLines-e);oa(a,"chars",b.maxChars-c.length)}}function N(a){var b=k.find("#notification-preview-"+a);if(b){var c=x(a).val(),e=B(a).val(),d=L(a).val();a=k.find("#notification-preview-wrap-image-"+a);
H()&&J(d)?(I(a),c.length>r.maxGiftMessageLengthForSMS&&(c=c.substr(0,r.maxGiftMessageLengthForSMS)+"..."),e.length>r.maxSenderNameLengthForSMS&&(e=e.substr(0,r.maxSenderNameLengthForSMS)+"..."),c=r.sentByStringSMS.replace(r.placeholderChar,e)+"\n"+r.exampleURL+"\n"+c+"\n"+r.acceptByStringSMS.replace(r.placeholderChar,r.expireDateSMS)):(E(a),c=c+"\n"+qa.replace(r.placeholderChar,e)+"\n"+r.acceptByStringEmail.replace(r.placeholderChar,r.expireDateEmail));b.text(c)}}function z(a,b,c){a.toggleClass("gift-input-error"+
c,b)}function Y(a){var b=a.val();b!==d.trim(b)&&a.val(d.trim(b))}function ra(a,b){if(k&&0!==d("#item-"+b.itemId).length){var c=a.parent().find(".selected");sa(c);a=a.find(".gw-card");ta(a);k.find('input[name\x3d"wrap.'+b.itemId+'"]').val(b.wrapNo)}}function ta(a){a.addClass("selected");a.attr("aria-pressed","true")}function sa(a){a.removeClass("selected");a.attr("aria-pressed","false")}function va(){var a=document.querySelectorAll(".gw-card");0!==a.length&&(h.when("a-carousel-framework").execute(function(a){a.createAll();
a.initializeAll()}),A.NodeList&&!NodeList.prototype.forEach&&(a=Array.prototype.slice.call(a)),a.forEach(function(a){function b(){c.classList.remove("active");c.style.removeProperty("background-position")}a.addEventListener("keydown",function(a){if("keydown"===a.type){var b=a.which||a.keyCode;if(32===b||13===b)a.preventDefault(),b=a.target.dataset,ra(d(a.target).parents("li"),{itemId:b.itemId,wrapNo:b.wrapId})}});a=a.querySelector(".gw-card-header");var c=a.querySelector(".gw-hover-zoom");a.addEventListener("mousemove",
function(a){var b=a.currentTarget.offsetWidth,e=a.currentTarget.offsetHeight;c.classList.add("active");e=a.offsetY/e*100;c.style.setProperty("background-position","".concat(a.offsetX/b*100,"% ").concat(e,"%"))});a.addEventListener("pointerup",b);a.addEventListener("pointerleave",b);a.addEventListener("pointercancel",b)}))}function Z(a){var b=a.val(),c=b.replace(/[\u2018\u2019\u0060\u00B4]/g,"'").replace(/[\u201C\u201D]/g,'"');c!==b&&a.val(c)}function aa(){return document.getElementById("gcx-egift-warning-no-contact-details-0")}
var k,pa=5,qa="",r={localizedFromString:"",acceptByStringEmail:"",acceptByStringSMS:"",sentByStringSMS:"",exampleURL:"",expireDateEmail:"",expireDateSMS:"",maxGiftMessageLengthForSMS:168,maxSenderNameLengthForSMS:20,placeholderChar:"@"};q.prototype.getLineItemIndex=function(){var a=this._domElement.attr("id").split("-");if(2>a.length)throw Error("Expected DOM element id to be suffixed with -lineItemIndex");return a[a.length-1]};q.prototype.validate=function(a){a=this._domElement.prop("disabled")||
this.isInputValid();this.toggleValidationError(!a);return a};t.prototype=new q;t.prototype.validate=function(a){var b=this._domElement.prop("disabled")||this.isInputValid();a&&!b||this.toggleValidationError(!b);return b};ca.prototype=new t;da.prototype=new t;ea.prototype=new t;ga.prototype=new t;K.prototype=new q;ha.prototype=new K;ia.prototype=new K;ja.prototype=new q;ka.prototype=new q;la.prototype=new t;var v=[],S={},T={},O={},P={},ba=function(a){k=d(a||"#giftOptions-contains");v=[];k.find(".a-truncate").each(function(){e.get(this).update()});
k.find(".toggle-gift-checkbox").trigger("change");k.find(".gift-message-textarea textarea").trigger("change");k.find(".digital-gift-message-checkbox").trigger("change");(a=c.state("giftPageState"))&&a.localizedFromStringLength&&(pa=a.localizedFromStringLength);a&&a.notificationPreviewAcceptByStringSMS&&(r.acceptByStringEmail=a.notificationPreviewAcceptByStringEmail,r.acceptByStringSMS=a.notificationPreviewAcceptByStringSMS,r.sentByStringSMS=a.notificationPreviewSentByStringSMS,r.exampleURL=a.notificationPreviewExampleURL,
r.expireDateEmail=a.notificationPreviewExpireDateEmail,r.expireDateSMS=a.notificationPreviewExpireDateSMS,r.maxGiftMessageLengthForSMS=a.notificationPreviewMaxGiftMessageSMS,r.maxSenderNameLengthForSMS=a.notificationPreviewMaxSenderNameSMS,r.placeholderChar=a.placeholderChar,qa=a.localizedFromString);k.find(".recipient-contact-details-input").bind("paste",function(){var a=this;A.setTimeout(function(){d(a).parent().trigger("change")},0)});va();g.isEGiftOptionsActive()&&n.isEnabled()&&h.when("mash").execute(function(){E(k.find(".chewbacca-gift-options-contact-picker-button"))});
d(k.find(".recipient-contact-details-input")).each(function(){var a=d(this);a.is("input")||(a=a.find("input"));if(a.attr("id").match("^egift")){var b=new ca(a),c=new da(a),a=new ea(a);T[b.getLineItemIndex()]=[b,c,a];v.push(b);v.push(c);v.push(a)}else b=new la(a),c=b.getLineItemIndex(),O[c]=[b],v.push(b)});d(k.find(".sender-name-text-input")).each(function(){var a=d(this);a.is("input")||(a=a.find("input"));var b=new ga(a),a=new ha(a),c=a.getLineItemIndex();S[c]=[b,a];v.push(b);v.push(a)});d(k.find(".gift-message-textarea").find("textarea")).each(function(){var a=
d(this),b=new ia(a),c=new ka(a),a=new ja(a),e=c.getLineItemIndex();P[e]=[b,c,a];v.push(b);v.push(c);v.push(a)});k.find('.chewbacca-enabled-save-gift-options-button input[type\x3d"submit"]').bind("click touchend",function(a){u(v,!1)||(a.preventDefault(),a.stopImmediatePropagation())})};c.declarative("chewbacca-toggle-gift-item","change",function(a){a=a.data.lineItemIndex;if(W(a).isChecked()){G(x(a));var b=B(a);b&&G(b);0!==C(a).size()&&(C(a).enable(),C(a).isChecked()&&G(M(a)));0!==Q(a).size()&&Q(a).enable();
b=k.find('input[name\x3d"wrap.'+a+'"]');0!==b.size()&&b.prop("disabled",!1);0!==R(a).size()&&R(a).prop("disabled",!1);E(k.find("#gift-options-box-"+a))}else{F(x(a));(b=B(a))&&F(b);0!==C(a).size()&&(b=C(a),b.uncheck(),b.disable(),F(M(a)));0!==Q(a).size()&&(b=Q(a),b.uncheck(),b.disable());b=k.find('input[name\x3d"wrap.'+a+'"]');0!==b.size()&&(k.find("#gift-wrap-radio-"+a+"-none").click(),b.prop("disabled",!0));if(0!==R(a).size()){var c=k.find("#gift-wrap-carousel-"+a);if(0!==c.length){var e=c.find(".selected");
sa(e);e=c.find(".gw-none").parent();ta(e);k.find('input[name\x3d"wrap.'+a+'"]').val("");c=c.find(".a-carousel-restart");0<c.length&&c.click()}c=R(a);b.prop("disabled",!0);c.prop("disabled",!0)}I(k.find("#gift-options-box-"+a))}b=x(a);c=B(a);e=C(a);(g.isEGiftOptionsActive()&&0<L(a).size()?0:0<W(a).size()&&!W(a).isChecked())?(F(b),F(c),e.disable()):(G(b),G(c),e.enable());u(O[a],!1);u(S[a],!1);u(P[a],!1)});c.declarative("chewbacca-gift-message-textarea","change keyup click focus",function(a){if("textarea"===
a.targetTag&&k){a=a.data.lineItemIndex;if(aa()){var b=x(a);Z(b)}N(a);X(a);u(P[a],!0)}});c.declarative("chewbacca-sender-name-input","change blur focusout",function(a){a=a.data.lineItemIndex;if(aa()){var b=B(a);Z(b)}N(a);X(a);u(S[a],!1);u(P[a],!1)});c.declarative("chewbacca-sender-name-input","keyup",function(a){a=a.data.lineItemIndex;if(aa()){var b=B(a);Z(b)}N(a);X(a);u(S[a],!0);u(P[a],!0)});c.declarative("chewbacca-digital-gift-message-checkbox","change",function(a){a=a.data.lineItemIndex;0!==C(a).size()&&
C(a).isChecked()?(G(M(a)),G(ma(a))):(F(M(a)),F(ma(a)));u(O[a],!0)});c.declarative("chewbacca-recipient-contact-details","change blur focusout",function(a){a=a.data.lineItemIndex;Y(M(a));u(O[a],!1)});c.declarative("chewbacca-recipient-contact-details","keyup",function(a){u(O[a.data.lineItemIndex],!0)});g.isEGiftOptionsActive()&&c.declarative("chewbacca-egift-recipient-contact-details","change blur focusout",function(a){var b=a.data.lineItemIndex;"change"===a.type&&(Y(L(b)),N(b));u(T[b],!1)});g.isEGiftOptionsActive()&&
n.isEnabled()&&c.declarative("chewbacca-gift-options-contact-picker","click",function(a){var b=a.data.lineItemIndex;a=["emails"];H()&&a.push("phoneNumbers");n.selectContact({contactFields:a,onSuccess:function(a){var c=L(b);c.val(a.value);Y(c);N(b);u(T[b],!1)}})});c.declarative("chewbacca-egift-recipient-contact-details","keyup",function(a){u(T[a.data.lineItemIndex],!0)});c.declarative("chewbacca-gift-options-submit","submit",function(b){if(u(v,!1))a.showPageTransition();else{b.$event.preventDefault();
var c=[];ua(v).forEach(function(a){var b=a._domElement.closest(".a-expander-container"),e=b.find(".a-expander-section-header");b.find(".gift-options-expanded-header").hasClass("aok-hidden")&&!c.includes(a.getLineItemIndex())&&(e.click(),c.push(a.getLineItemIndex()))})}});c.declarative("chewbacca-gift-options-popover-submit","submit",function(a){a=a.$target.closest(".a-popover").data("a-popover-id");m.hide(a)});c.on("a:expander:chewbacca-gift-options-expander:toggle:collapse",function(a){a=a.expander.$expander;
var b=a.data("lineitemindex"),c;c=x(b).val();c=!c||10>=c.length?c||"":c.substring(0,10)+"...";var e=0<c.length,b=k.find('input[name\x3d"wrap.'+b+'"]:checked').val()||"";e||b?(E(a.find(".gift-options-summary-header")),I(a.find(".gift-options-expanded-header")),y(a.find(".gift-message-summary"),e),a.find(".gift-message-preview").text(c),I(a.find(".gift-wrap-summary")),E(a.find(".gift-wrap-summary-"+b.replace(/#/g,"\\#")))):na(a)});c.on("a:expander:chewbacca-gift-options-expander:toggle:expand",function(a){na(a.expander.$expander)});
c.on("checkout:reload:giftselect",function(){ba()});c.on("checkout:reload:spp-giftoptions",function(){ba()});h.when("giftOptionsPopoverData").execute(function(a){for(var b=0;b<a.lineItemCount;++b)(function(a){c.on("a:popover:show:changeGiftOptionsPopover"+a,function(){ba("#giftOptions-contains"+a)})})(b)});c.declarative("gift-wrap-selected","click",function(a){ra(a.$target.parents("li"),{itemId:a.data.itemId,wrapNo:a.data.wrapId})})});h.when("A").register("gift-contact-picker",function(c){function d(a){return a&&
0<=c.indexOfArray(l,a)}function g(b,c,e,d){b.permissions.requireForFeature({featureID:"eshipping",requestID:"eshipping_contacts_permission"}).onPermissionGranted(function(){a(b,c,e,d)}).onPermissionDenied(d)}function f(a,b){var e=[];c.each(b,function(b){c.each(a[b]||[],function(a){e.push(a.value)})});return e}function b(a){function b(){c.delay(function(){d.remove()},100)}if(c.capabilities.android){var e=c.$,d=e('\x3cscript id\x3d"stop-mash-reappear" type\x3d"application/x-amzn-empty" /\x3e');e(document.body).append(d);
c.delay(function(){a(b)})}else a(n)}function a(a,c,d,g){b(function(b){a.showContactPicker({fields:c,successCallback:function(m){b();m=f(m,c);0===m.length?g():1===m.length?d({value:m[0]}):e(a,m,d,g)},failCallback:function(){b();g()}})})}function e(a,b,c,e){a.showChooser({buttonTitles:b,successCallback:function(a){a<b.length&&0<=a?c({value:b[a]}):e()},failCallback:e})}function m(){return c.capabilities.isAmazonApp}var l="phoneNumbers emails ims photos categories urls".split(" "),n=function(){};return{selectContact:function(b){var e=
b.onSuccess,f=b.onError||n,l=c.filter(b.contactFields||[],d);m()&&e&&0!==l.length?h.now("mash").execute(function(b){b?b.permissions&&b.permissions.available?g(b,l,e,f):a(b,l,e,f):f()}):f()},isEnabled:m}});"use strict";h.when("A","jQuery","components/PrimaryActionBlockerCheckbox","weblab-helper","client-side-metrics").register("widgets/purchaseLevelMessages/blockingConfirmationMessages",function(c,d,g,f,b){function a(){f.isPyoClientSideInitiationEnabled()||g.create({$el:d('#purchase-level-messages [data-client-component\x3d"PrimaryActionBlockerCheckbox"]')})}
c.each(["checkout:reload:spc","checkout:reload:spclite","checkout:reload:spp-revieworder","checkout:reload:spp-collapsed"],function(b){c.on(b,a)})});h.when("A","jQuery","components/Component","components/PrimaryActionBlockerCheckbox","verification-checkbox-controller").register("widgets/pyoButton/PyoButton",function(c,d,g,f,b){return g.extend({onInit:function(){var a=f.getState();this.block(a);c.on(f.events.blockingStateChanged,this.block)},block:function(a){a&&b.updatePyo(a)}})});"use strict";h.when("A",
"jQuery","client-side-metrics").register("/widgets/pyoButton/newCheckoutExperience/pyoButton",function(c,d,g){c.declarative("checkout-place-your-order-action",["click"],function(c){g.setCountValue("checkout:newCheckoutExperience:clickPlaceYourOrderButton",1)})});"use strict";h.when("A","jQuery","widgets/subscribeAndSave/snsCommon").execute("widgets/subscribeAndSave/setSnSOptions",function(c,d,g){function f(b,a,c,f,l){var n=g.getSnSItemData(b);b={asin:n.asin,encodedLineItemId:n.lineItemId,encryptedMerchantId:n.encryptedMerchantId,
merchantSku:n.merchantSku,couponId:d("#sns-item-discount-"+b).data("couponId"),redeemCoupon:g.convertToPerlBoolean(f),optedIn:g.convertToPerlBoolean(a),customerSelectedRecurrencePeriod:c};g.updatePurchase([b],w,l)}c.declarative("sns-item-checkbox","change",function(b){var a=b.data.index,c=g.isCustomerOptedIn("#sns-item-checkbox-",a),d=g.getActiveSubscriptionRecurrencePeriod("#sns-recurrence-period-selector-",a);f(a,c,d,!0,b.data.callbackUrl)});c.on("a:accordion:sns-recurrence-period-accordion:select",
function(b){b=b.selectedRow.$row.data();var a=b.index,c=g.isCustomerOptedIn("#sns-item-checkbox-",a);c?f(a,c,b.recurrencePeriod,!1,b.callbackUrl):g.setActiveSubscriptionRecurrencePeriod("#sns-recurrence-period-selector-",b)})});"use strict";h.when("jQuery","page-transition-controller","page-conductor","client-side-metrics").register("widgets/subscribeAndSave/snsCommon",function(c,d,g,f){function b(a){a||(f.increaseCount("checkout:sns:updatePurchaseInvokedWithoutUrl",1),a="/gp/buy/spc/handlers/set-subscribe-and-save-options.html?ref_\x3dchk_spc_set_sns_options");
return a}return{convertToPerlBoolean:function(a){return a?1:0},getSnSItemData:function(a){return document.getElementById("sns-item-"+a).dataset},isCustomerOptedIn:function(a,b){return c(a+b).is(":checked")},updatePurchase:function(a,e,f){var l=g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});d.show();c.ajax({type:"POST",url:b(f),contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:{subscriptionParameters:JSON.stringify(a)},dataType:"text",cache:!1,async:!0,headers:l,success:function(a,
b,c){"function"===typeof e&&(e(),d.hide());g.ajaxUpdatePage(a,b,c)},error:function(a,b,c){g.ajaxRedirect(a,b,c)}})},setActiveSubscriptionRecurrencePeriod:function(a,b){c(a+b.index).text(b.recurrencePeriodText).data("activeRecurrencePeriod",b.recurrencePeriod)},getActiveSubscriptionRecurrencePeriod:function(a,b){return c(a+b).data("activeRecurrencePeriod")}}});"use strict";h.when("A","page-spinner-controller").execute(function(c,d){c.declarative("ingress-internal-launch-opt-out","click",function(c){c=
function(a,b,c,d){a=[a+"\x3d"+b];c&&(b=new Date,b.setTime(b.getTime()+864E5*c),a.push("expires\x3d"+b.toGMTString()));a.push("path\x3d/");d&&a.push("domain\x3d"+d);document.cookie=a.join("; ")};var f=function(){var a=/:\/\/([^:/]+)/.exec(A.location.href)[1].split("."),b=a.length-2;"co"!==a[b]&&"com"!==a[b]||b--;for(var c=[];b<a.length;b++)c.push(a[b]);return c.join(".")}(),b=function(a){return(a=(new RegExp(a+"\x3d([^;]+)")).exec(document.cookie))?a[1]:""}("checkout-dyn-config").split("\x26");b[b.length]=
"escapeingress:1";c("checkout-dyn-config","",-1,f);c("checkout-dyn-config",b.join("\x26"),365,f);d.show();location.reload()})});"use strict";h.when("A","jQuery","widgets/installmentsModal/state","installments-service").register("widgets/installmentsModal",function(c,d,g,f){c.on("a:popover:dismiss:installmentsModal",function(b){f.sendReftag("installments_bundle_modal_cancelled_asin_"+g.asin+"_bundle_asin_"+g.bundleAsin)});c.on("a:popover:hide:installmentsModal",function(b){g.$target.prop("checked",
!g.isChecked)});c.declarative("installments-confirm","click",function(b){f.sendReftag("installments_bundle_modal_confirm_removal_asin_"+g.asin+"_bundle_asin_"+g.bundleAsin);f.call(g.itemId,g.programId,g.handlerData);b.$target.closest(".a-popover").find(".a-icon-close").click()});c.declarative("installments-cancel","click",function(b){f.sendReftag("installments_bundle_modal_cancelled_asin_"+g.asin+"_bundle_asin_"+g.bundleAsin);b.$target.closest(".a-popover").find(".a-icon-close").click()})});"use strict";
h.register("widgets/installmentsModal/state",function(){return{asin:"",bundleAsin:"",itemId:"",program:"",handler:null,$target:"",isChecked:""}});"use strict";h.when("A","page-transition-controller","page-conductor","utils/createClass","ready").register("retail-installments-contract-base-controller",function(c,d,g,f){var b=c.$;return f({config:null,ricPageWrapper:null,hasConsentedToAtLeastOneRic:!1,hasMultipleRics:!1,FROM_CURRENT_CONFIG:"current",FROM_DEFAULT_CONFIG:"default",REFTAG_URL:"/hctp/log/refMarker?ref_\x3d",
REFTAG_MOBILE_BACK:"back",REFTAG_MOBILE_CANCEL:"cancel",REFTAG_ESIGN_Y:"esign_y",REFTAG_ESIGN_N:"esign_n",REFTAG_ESIGN_LINK:"esign_link",REFTAG_ESIGN_PDF:"esign_pdf",REFTAG_RIC_CHANGE:"ric_change",REFTAG_RIC_CHANGE_OPEN:"ric_change_open",REFTAG_RIC_CHANGE_OPEN_SECONDARY:"ric_change_open_secondary",REFTAG_RIC_Y:"ric_y",REFTAG_RIC_N:"ric_n",REFTAG_RIC_LINK:"ric_link",REFTAG_RIC_REMOVE:"ric_remove",REFTAG_RIC_CONSENT:"ric_consent",init:function(){this.config=b.extend(c.state("ricPageState"),c.state("ricCustomerInfoState"));
this.hasMultipleRics=2<this.config.ricWidgetViews.length;this.getElements();this.bindEvents()},bindEvents:function(){b("body").delegate(".customerInfoUpdateBtn","click",b.proxy(this.handleCustomerInfoUpdate,this));b("body").delegate(".useBillingInfo","click",b.proxy(function(a){a.preventDefault();this.resetCustomerInfoUpdateForm(this.FROM_DEFAULT_CONFIG)},this))},declineAll:function(){var a="";b.each(this.config.installmentsAgreementsList,function(b,c){a+=btoa(c.lineItemId)+","});var c={token:this.ricPageWrapper.find('input[name\x3d"csrfToken"]').val(),
unsetLineItemIds:a.slice(0,-1)};this.doSubmit(c)},doReftag:function(a){a&&b.get(this.REFTAG_URL+this.REFTAG_BASE_PREFIX+a)},doSubmit:function(a){d.show();var c=b("#gurupaRicCSRFToken").val();a.gurupaRicCSRFToken=c;b.ajax({type:"POST",url:this.config.gurupaRicSubmitUrl,data:a,async:!0,cache:!1,headers:g.setAjaxTransitionHeader(),success:function(a){g.redirect(a)},error:function(a){g.redirect(a)}})},getRicByLineItemId:function(a){var c=null;a=a.replace(/(\.|#)/g,"");b.each(this.config.installmentsAgreementsList,
function(b,d){(b=d.lineItemId===a)||(b=d.lineItemId,b=-1!==b.indexOf(a,b.length-a.length));if(b)return c=d,!1});return c},handleCustomerInfoUpdate:function(a){a.preventDefault();var c=b(a.currentTarget).closest("form");a=c.serializeArray();var d=!1;b.each(a,b.proxy(function(a,f){if(""===b.trim(f.value)&&"customerPhoneNumber"!==f.name)return c.find('input[name\x3d"'+f.name+'"]').addClass("a-form-error"),c.find("#"+f.name+"Alert").removeClass("aok-hidden"),d=!0,!1;a=b("\x3cdiv\x3e").text(f.value).html();
this.config[f.name]=a},this));d||(b("body").find(".ricCustomerName").html(this.config.customerName),b("body").find(".ricCustomerPhone").html(this.config.customerPhoneNumber),b("body").find(".ricCustomerAddress").html(this.config.customerAddress),this.closeCustomerInfoUpdateView(),this.handleCustomerInfoUpdateFormClose(),this.doReftag(this.REFTAG_RIC_CHANGE))},handleFormAlertToggle:function(a){a=b(a.currentTarget);var c=a.closest("form");a.hasClass("a-form-error")&&(a.removeClass("a-form-error"),c.find("#"+
a.attr("name")+"Alert").addClass("aok-hidden"))},prepareCustomerAgreementsAndSubmit:function(){var a="";b.each(this.config.installmentsAgreementsList,function(c,e){a+=btoa(e.lineItemId)+":";b.each(e.customerAgreementsList,function(b,c){a+=c?"1":"0";a+=","});a=a.slice(0,-1);a+="~"});var c={token:this.ricPageWrapper.find('input[name\x3d"csrfToken"]').val(),customerAddress:this.config.customerAddress,customerName:this.config.customerName,customerPhoneNumber:this.config.customerPhoneNumber,eSignConsentAgreement:this.config.eSignConsentAgreement?
"1":"0",installmentsAgreementsList:a.slice(0,-1)};this.doReftag(this.REFTAG_RIC_CONSENT);this.doSubmit(c)},resetCustomerInfoUpdateForm:function(a){var e=c.state("ricCustomerInfoState"),d=b(".customerInfoUpdateForm");d.find(".updateInfoBrief").each(function(a,c){b(c).addClass("aok-hidden")});var f="",f=this.hasMultipleRics?this.hasConsentedToAtLeastOneRic?".multipleHasConsent":".multiplePendingConsent":this.hasConsentedToAtLeastOneRic?".singleHasConsent":".singlePendingConsent";b(f).removeClass("aok-hidden");
d.find(".a-alert-inline").each(function(a,c){b(c).addClass("aok-hidden")});d.find("input").each(function(a,c){b(c).removeClass("a-form-error")});a=a===this.FROM_DEFAULT_CONFIG?e:this.config;d.find('input[name\x3d"customerAddress"]').val(a.customerAddress);d.find('input[name\x3d"customerName"]').val(a.customerName);d.find('input[name\x3d"customerPhoneNumber"]').val(a.customerPhoneNumber)},validateInstallmentsAgreements:function(){var a=!0;b.each(this.config.installmentsAgreementsList,b.proxy(function(b,
c){if(!this.validateCustomerAgreements(c))return a=!1},this));return a&&this.config.eSignConsentAgreement},validateCustomerAgreements:function(a){var c=!0;b.each(a.customerAgreementsList,function(a,b){if(!b)return c=!1});return c}})});"use strict";h.when("A","a-modal","a-popover-base","retail-installments-contract-base-controller","ready").register("retail-installments-contract-controller",function(c,d,g,f){var b=c.$;return f.extend({continueButton:null,continueButtonWithToolTip:null,REFTAG_BASE_PREFIX:"co_lti_",
init:function(){this._super()},getElements:function(){this.ricPageWrapper=b(".ricPageWrapper");this.continueButton=this.ricPageWrapper.find(".primary-action-button");this.continueButtonWithToolTip=this.ricPageWrapper.find(".primary-action-button-tooltip")},bindEvents:function(){b(".eSignConsentCheckbox input").attr("checked",!1);this.ricPageWrapper.delegate(".eSignConsentCheckbox input","change",b.proxy(function(a){b(a.currentTarget).is(":checked")?this.handleEConsentYes():this.handleEConsentNo()},
this));this.ricPageWrapper.delegate(".mpaConsentCheckbox input","change",b.proxy(this.handleMonthlyPaymentsConsentToggle,this));this.ricPageWrapper.delegate(".mpaDecline input","click",b.proxy(this.declineAll,this));this.ricPageWrapper.delegate(".primary-action-button input","click",b.proxy(this.handleContinueButtonClick,this));b(".eSignConsentCheckbox .esignModal").click(b.proxy(function(){this.doReftag(this.REFTAG_ESIGN_LINK)},this));b("body").delegate(".a-popover-modal .downloadPdf a","click",
b.proxy(function(){this.doReftag(this.REFTAG_ESIGN_PDF)},this));b(".ricWrapper .customerInfoUpdateLink").click(b.proxy(function(){this.doReftag(this.REFTAG_RIC_CHANGE_OPEN)},this));b("body").delegate(".a-popover-modal .customerInfoUpdateLink","click",b.proxy(function(){this.doReftag(this.REFTAG_RIC_CHANGE_OPEN_SECONDARY)},this));b(".mpaConsentCheckbox a").click(b.proxy(function(){this.doReftag(this.REFTAG_RIC_LINK)},this));b("body").delegate("input.ricInput","focus",b.proxy(this.handleFormAlertToggle,
this));b("body").delegate(".closeModalButton","click",b.proxy(this.closeAllModals,this));c.on("a:popover:beforeShow:customerInfoInputModal",b.proxy(function(){this.resetCustomerInfoUpdateForm(this.FROM_CURRENT_CONFIG)},this));this._super()},declineAll:function(){this.doReftag(this.REFTAG_RIC_REMOVE);this._super()},handleCustomerInfoUpdateFormClose:function(){this.toggleContinueButtons(!1);b.each(this.config.installmentsAgreementsList,function(a,c){b.each(c.customerAgreementsList,function(a){c.customerAgreementsList[a]=
!1})});c.delay(b.proxy(function(){this.ricPageWrapper.find(".mpaConsentCheckbox input").each(function(){b(this).attr("checked",!1)})},this),500)},handleContinueButtonClick:function(){var a=this.validateInstallmentsAgreements();!0===this.config.eSignConsentAgreement&&a&&((a=g.get("mpaContinuePopover"))&&a.hide(),this.prepareCustomerAgreementsAndSubmit())},handleEConsentNo:function(){this.doReftag(this.REFTAG_ESIGN_N);this.config.eSignConsentAgreement=!1;this.ricPageWrapper.find(".mpaConsentWrapperShroud").show();
this.ricPageWrapper.find(".mpaConsentCheckbox input").each(function(){var a=b(this);a.prop("checked",!1);a.attr("disabled",!0)});b.each(this.config.installmentsAgreementsList,function(a,c){b.each(c.customerAgreementsList,function(a){c.customerAgreementsList[a]=!1})});this.toggleContinueButtons(!1)},handleEConsentYes:function(){this.doReftag(this.REFTAG_ESIGN_Y);this.config.eSignConsentAgreement=!0;this.ricPageWrapper.find(".mpaConsentCheckbox input").removeAttr("disabled");this.ricPageWrapper.find(".mpaConsentWrapperShroud").hide()},
handleMonthlyPaymentsConsentToggle:function(a){var c=b(a.currentTarget),d=(a=c.is(":checked"))?this.REFTAG_RIC_Y:this.REFTAG_RIC_N,c=c.closest(".mpaConsentWrapper").attr("id").split("_"),f=this.getRicByLineItemId(c[0]);this.doReftag(d);f.customerAgreementsList[c[1]]=a;this.hasConsentedToAtLeastOneRic=this.hasConsentedToAtLeastOneAgreement();a=this.validateInstallmentsAgreements();this.toggleContinueButtons(a)},hasConsentedToAtLeastOneAgreement:function(){var a=null;b.each(this.config.installmentsAgreementsList,
function(c,d){b.each(d.customerAgreementsList,function(b,c){if(c)return a=!0,!1});if(null!==a)return!1});return null!==a},toggleContinueButtons:function(a){a?(this.continueButtonWithToolTip.addClass("aok-hidden"),this.continueButton.removeClass("aok-hidden")):(this.continueButtonWithToolTip.hasClass("aok-hidden")&&this.continueButtonWithToolTip.removeClass("aok-hidden"),this.continueButton.hasClass("aok-hidden")||this.continueButton.addClass("aok-hidden"));c.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")},
closeCustomerInfoUpdateView:function(){this.closeAllModals()},closeAllModals:function(){b(".a-popover-modal .a-button-close").each(function(){b(this).click()})}})});"use strict";h.when("A","jQuery","client-side-metrics","a-modal","page-spinner-controller","configurations/keys","configurations/newCheckoutExperienceConfig","utils/pageConductor").register("widgets/itemBlocks/newCheckoutExperience/itemBlocks",function(c,d,g,f,b,a,e,m){function l(a){d(a).closest(q).length?(b.hide(),m.replaceDisplayContent(d(q),
a)):h()}function h(){g.setCountValue("checkout:newCheckoutExperience:updateQuantity:failed",1);m.redirectToGurupa(p)}var p=e.getConfiguration(a.VIEW_TYPE),q=e.getConfiguration(a.CONTAINER_SELECTOR);c.declarative("item-block-change-quantity","click",function(a){var c=a.data;f.get(d("#"+c.modalName)).hide();a.$event.preventDefault();c.isSelected||(g.setCountValue("checkout:newCheckoutExperience:updateQuantity:attempted",1),b.show(),d.ajax({type:"POST",url:c.url,data:{lineItemId:c.lineItemId,quantity:c.quantity},
dataType:"html",success:l,error:h}))})});"use strict";h.when("A","jQuery","client-side-metrics","page-spinner-controller","configurations/keys","configurations/newCheckoutExperienceConfig","utils/pageConductor").register("widgets/itemBlocks/newCheckoutExperience/shipOptions",function(c,d,g,f,b,a,e){function m(a){d(a).closest(p).length?(f.hide(),e.replaceDisplayContent(d(p),a)):h()}function h(){g.setCountValue("checkout:newCheckoutExperience:selectShipOption:failed",1);e.redirectToGurupa(n)}var n=
a.getConfiguration(b.VIEW_TYPE),p=a.getConfiguration(b.CONTAINER_SELECTOR);c.declarative("checkout-select-ship-option-radio","click",function(a){var b=a.data;a.$event.preventDefault();b.isSelected||(g.setCountValue("checkout:newCheckoutExperience:selectShipOption:attempted",1),f.show(),d.ajax({type:"POST",url:b.setActionUrl,data:b.postData,dataType:"html",success:m,error:h}))})});"use strict";h.when("A","utils/eventConstants","ready").register("widgets/itemBlocks/newCheckoutExperience/fastTrackCountdown",
function(c,d){function g(){f();var c=p("#checkout-item-block-panel");0!==c.length&&(c=c.find(".checkout-fast-track-text"),0!==c.length&&(b(),c.each(function(){var b=p(this),c=b.attr("id"),d=b.attr("data-expiration-time");c!==w&&d!==w&&(d=parseInt(d,10),isNaN(d)||(b.find(".checkout-fast-track-available").show(),a(b,c,d)))})))}function f(){for(var a in t)clearTimeout(t[a]);t={}}function b(){q.days={plural:p("#checkout-fast-track-days").html(),singular:p("#checkout-fast-track-day").html()};q.hours={plural:p("#checkout-fast-track-hours").html(),
singular:p("#checkout-fast-track-hour").html()};q.minutes={plural:p("#checkout-fast-track-minutes").html(),singular:p("#checkout-fast-track-minute").html()};q.seconds={plural:p("#checkout-fast-track-seconds").html(),singular:p("#checkout-fast-track-second").html()};q.and=p("#checkout-fast-track-and").html()}function a(b,d,f){var g=Math.round(c.now()/1E3),g=f-g;if(0>=g)b.find(".checkout-fast-track-available").hide(),b.find(".checkout-fast-track-expired").show(),delete t[d];else{var h=g,m=Math.floor(h/
86400),h=h-86400*m,l=Math.floor(h/3600),h=h-3600*l,p=Math.floor(h/60),h=h-60*p,q=e(m,l,p,h);b.find('span[data-countdown\x3d"fastTrackCountdown"]').html(q);g=n(g,m,l,p,h);t[d]=setTimeout(function(){a(b,d,f)},g)}}function e(a,b,c,d){return 0<a?2<=a?h(a,"days"):m(a,"days",b,"hours"):0<b?m(b,"hours",c,"minutes"):0<c?5<=c?h(c,"minutes"):m(c,"minutes",d,"seconds"):h(d,"seconds")}function m(a,b,c,d){a=h(a,b);0<c&&(a+=" ",0<q.and.length&&(a+=q.and+" "),a+=h(c,d));return a}function h(a,b){return a.toString()+
" "+(1<a?q[b].plural:q[b].singular)}function n(a,b,c,d,e){var f=1;0<b?f=2<=b?f+(a-86400*b):f+(60*d+e):0<c?f+=e:0<d&&5<=d&&(f+=e);return 1E3*f}var p=c.$,q={},t={};c.on(d.PAGE_CONTENTS_REPLACED,g);g();return{setTimeUnitStrings:b,getFastTrackCountdownDisplayText:e,getDelayForCountdownChangeInMilliseconds:n}});"use strict";h.when("A","jQuery","client-side-metrics","configurations/keys","configurations/newCheckoutExperienceConfig","utils/redirectionUtils").register("widgets/paymentMethods/newCheckoutExperience/paymentMethods",
function(c,d,g,f,b,a){var e=b.getConfiguration(f.VIEW_TYPE);c.declarative("change-payment-action","click",function(b){g.setCountValue("checkout:newCheckoutExperience:changePaymentMethod",1);a.redirectInCurrentTab(b.data.redirectionUrl,e)});c.declarative("use-gift-voucher-promo-action","click",function(b){g.setCountValue("checkout:newCheckoutExperience:useGiftVoucherPromo",1);a.redirectInCurrentTab(b.data.redirectionUrl,e)})});"use strict";h.when("A","ready").register("widgets/pointsRedemption/pointsRedemption",
function(){});"use strict";h.when("A","jQuery","page-transition-controller","page-conductor","client-side-metrics","ajax-utility","load").register("widgets/pointsRedemption/pointsRedemptionCommon",function(c,d,g,f,b,a){function e(a){a.addClass("aok-hidden")}function h(a){a.removeClass("aok-hidden")}function l(a){return a.find(".offscreen-points-redemption-error")}function n(){return d("#partial-redemption-points-input").val()}function p(a,b){q();h(a);"mobile"===b&&t("error");b=a.find(".visible-points-redemption-error").text();
l(a).text(b)}function q(a){var b=d("#input-points-exceeds-redeemable-error");e(b);l(b).empty();b=d("#input-points-invalid-error");e(b);l(b).empty();"mobile"===a&&t("normal")}function t(a){var b=d("#partial-redemption-points-input").parent(".a-input-text-wrapper");b&&0<b.length&&("error"===a?b.addClass("a-form-error"):"normal"===a&&b.removeClass("a-form-error"))}function w(a){a.beforeRequest();d.ajax({type:"POST",url:a.url,headers:a.headers,async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",data:d.param(a.data,!0),success:a.onSuccess,error:a.onFailure})}return{hideAllErrors:q,hideFormElement:e,showFormElement:h,getOffscreenErrorMessage:l,isInputPointsValid:function(a,c){var e=n();if(!c.test(e))return b.increaseCount("checkout:pointsRedemption:"+a+":inputPointsInvalidError",1),p(d("#input-points-invalid-error"),a),!1;if(Number(e)>Number(d("#redeemable-points-amount").val()))return b.increaseCount("checkout:pointsRedemption:"+a+":inputPointsExceedsRedeemableError",1),p(d("#input-points-exceeds-redeemable-error"),
a),!1;q(a);return!0},getPartialRedemptionInputValue:n,inputPointsOnInput:function(){q("desktop");e(d("#input-points-apply-success"));h(d("#submit-points-for-redemption"))},emitWidgetLoadMetric:function(a){b.increaseCount("checkout:pointsRedemption:"+a+":spcWidgetLoad",1)},onSubmitClick:function(c,e){c={url:d("#redemption-option-update-handler-url").val(),headers:{"x-amz-checkout-page":"spc"},data:{jpPointsCustomerRequestedAmount:c,jpPointsPaymentInstrumentId:d("#points-instrument-id").val(),jpPointsTargetCurrencyCode:d("#currency-code").val(),
jpPointsAvailablePoints:d("#redeemable-points-amount").val(),isClientTimeBased:d("input[name\x3duseCtb]").val(),hasWorkingJavascript:1},beforeRequest:function(){g.show()},onSuccess:function(c,d,g){b.increaseCount("checkout:pointsRedemption:"+e+":purchaseDocUpdateSuccess",1);b.increaseCount("checkout:pointsRedemption:"+e+":redirectOnSuccess",1);f.redirect(a.jsonify(c))},onFailure:function(a,c,d){b.increaseCount("checkout:pointsRedemption:"+e+":purchaseDocUpdateFailure",1);f.ajaxRedirect(a,c,d)}};w(c)}}});
"use strict";h.when("A","jQuery","a-modal","client-side-metrics").register("widgets/productInformation/quicklookEventHandler",function(c,d,g,f){c.declarative("a-modal","click",function(b){if(b.$target.hasClass("cpx-quicklook-open-link")){f.increaseCount("checkout:quicklook:universal:modalLinkClick",1);b=b.data;if(!b)throw f.increaseCount("checkout:quicklook:universal:eventDataUndefined",1),Error("[Modal] Event data is undefined");b=b.lineItemIndex;if(!b)throw f.increaseCount("checkout:quicklook:universal:lineItemIndexMissing",
1),Error("[Modal] LineItemIndex is missing from event data");c.loadImageManually(d("#quicklook-modal-manual-image-"+b))}})});"use strict";h.when("A","page-transition-controller","page-conductor","client-side-metrics").register("checkout-vas-notification-preferences",function(c,d,g,f){function b(){l(".notification-preferences-widget :checkbox").change(a)}function a(){this.checked?f.increaseCount(n.CHECKBOX.SELECTED,1):f.increaseCount(n.CHECKBOX.DESELECTED,1);e(l(this),this.checked)}function e(a,b){var c=
g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),e=h(a,b);l.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/notification-preferences.html",headers:c,async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",data:l.param(e,!0),beforeSend:function(){d.show()},success:function(a,b,c){f.increaseCount(n.PURCHASE_UPDATE.SUCCESS);d.hide()},error:function(c,e,g){f.increaseCount(n.PURCHASE_UPDATE.FAIL);f.logError(g,"notification preference AJAX update call failed",
"checkout-vas-notification-preferences","ERROR");a.prop("checked",!b);d.hide()}})}function h(a,b){var c={};c[a.closest(".a-checkbox").attr("data-name")]=b?1:0;a.closest(".notification-preferences-widget").find("input:hidden").each(function(){var a=l(this);c[a.attr("data-name")]=a.val()});return c}var l=c.$,n={CHECKBOX:{SELECTED:"checkout:np:checkbox:selected",DESELECTED:"checkout:np:checkbox:deselected"},PURCHASE_UPDATE:{SUCCESS:"checkout:np:purchaseUpdate:success",FAIL:"checkout:np:purchaseUpdate:fail"}};
c.each(["checkout:reload:spc","checkout:reload:spp-revieworder"],function(a){c.off(a,b);c.on(a,b)})});"use strict";h.when("A","jQuery","a-checkbox","client-side-metrics","widgets/invoiceAddress/invoiceAddressSelectCommon").register("widgets/invoiceAddress/invoiceAddressSelect",function(c,d,g,f,b){var a;d(document.documentElement).delegate('[name\x3d"select_invoice_address"]',"submit",function(c){f.increaseCount("checkout:selectinvoiceaddress:desktop:formsubmit",1);b.handleSelectInvoiceAddressFormSubmit(a)});
c.declarative("select_address_in_list","click",function(c){f.increaseCount("checkout:selectinvoiceaddress:desktop:addressselected",1);a=b.getEncryptedTaxId(c.data)})});h.when("A","jQuery","a-checkbox","client-side-metrics","ready").register("widgets/invoiceAddress/invoiceAddressSelectCommon",function(c,d,g,f){return{handleSelectInvoiceAddressFormSubmit:function(b){var a=d('[name\x3d"select_invoice_address"]'),c=g("#purchaseLevelSetInvoiceAddress").isChecked();f.increaseCount("checkout:selectinvoiceaddress:purchaselevel",
"true"===c?1:0);if(null!==c||""!==c||"undefined"!==c)c=d("\x3cinput\x3e").attr("type","hidden").attr("name","isPurchaseLevelSetInvoiceAddressSelected").val(c),a.append(c);null!==b||""!==b||"undefined"!==b?(b=d("\x3cinput\x3e").attr("type","hidden").attr("name","encryptedTaxId").val(b),a.append(b)):f.increaseCount("checkout:selectinvoiceaddress:taxidnotfound",1)},getEncryptedTaxId:function(b){var a=c.state("selectInvoiceAddressParams");if(a===w)return f.increaseCount("checkout:selectinvoiceaddress:getEncryptedTaxId:emptyinvoiceaddressparams",
1),"";a=a.taxRegistrations;b=b.stateOrRegion;if(null!==b&&""!==b&&"undefined"!==b)return b=a[b.toUpperCase()],b===w?(f.increaseCount("checkout:selectinvoiceaddress:getEncryptedTaxId:taxidnotfoundforstate",1),""):b;f.increaseCount("checkout:selectinvoiceaddress:getEncryptedTaxId:statenotfound",1);return""}}});"use strict";h.when("A","jQuery","page-transition-controller","ajax-utility","page-conductor","page-detector","client-side-metrics").register("widgets/financialOfferCheckbox/financingCheckboxCommon",
function(c,d,g,f,b,a,e){return{clickFinancingCheckbox:function(a){a.preventDefault();b.isSPP()?(g.blockAllActions(),g.showTransitionInContainer(d("#payment"))):g.show();a={"x-amz-checkout-page":"spc"};var c={paymentMethodId:d("#payment-method-id").val(),paymentMethodType:d("#payment-method-type").val(),rewardAccountId:d("#reward-account-id").val(),rewardAccountAmount:d("#reward-account-amount").val(),rewardAccountRate:d("#reward-account-rate").val(),useGCBalance:d("#use-gc-balance").val(),financialOfferId:d("#financial-offer-id").val(),
returnFullHTML:1,returnjson:1,hasWorkingJavascript:1,isClientTimeBased:d("input[name\x3duseCtb]").val()};a=b.setAjaxTransitionHeader(a);d.ajax({type:"POST",url:"/gp/buy/payselect/handlers/continue.html",data:d.param(c,!0),dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:a,success:function(a,c,d){e.increaseCount("checkout:financingCheckbox:purchaseDocUpdateSuccess",1);d.getResponseHeader("x-amz-checkout-page")?b.ajaxUpdatePage(a,c,d):(a=f.jsonify(a),
b.redirect(a))},error:function(a,c,d){e.increaseCount("checkout:financingCheckbox:purchaseDocUpdateFailure",1);b.ajaxRedirect(a,c,d)}})}}});"use strict";h.when("A","jQuery","client-side-metrics","widgets/financialOfferCheckbox/financingCheckboxCommon").execute("widgets/financialOfferCheckbox/financingCheckbox",function(c,d,g,f){c.declarative("click-financing-checkbox","click",function(b){var a=b.data.click;a&&null!==a&&(g.increaseCount("checkout:spp-payment:clickFinancingCheckbox",1),f.clickFinancingCheckbox(b.$event))})});
"use strict";h.when("A","jQuery","page-transition-controller","page-conductor","client-side-metrics").register("widgets/devicePreregistration/devicePreregistration",function(c,d,g,f,b){function a(a,c,h){g.show();d.ajax({type:"POST",url:"/gp/buy/devices/preregistration/handlers/set-item-preregistration.html",data:{csrfToken:a,lineItemId:c,isChecked:h},dataType:"text",async:!0,cache:!1,headers:f.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,c,d){b.increaseCount("checkout:devicePreregistration:ajaxSuccess",
1);f.ajaxUpdatePage(a,c,d,{pushNewFrame:"false"})},error:function(a,c,d){b.increaseCount("checkout:devicePreregistration:ajaxError",1);f.ajaxRedirect(a,c,d)}})}c.declarative("mako-rcx-prereg-declarative","change",function(c){var f=d("[name\x3dcsrfToken]").val(),g=null==c.data?w:c.data.lineItemId;(c=c.$target.is(":checked"))?b.increaseCount("checkout:devicePreregistration:checked",1):b.increaseCount("checkout:devicePreregistration:unchecked",1);a(f,g,c)})});"use strict";h.when("A","jQuery","client-side-metrics",
"ready").register("widgets/devicePreregistration/reftagHelper",function(c,d,g){function f(a){a&&d.get("/hctp/log/refMarker?ref_\x3d"+a)}function b(){Object.keys(a).forEach(function(b){b="PREREGISTRATION_"+b+"_C_PC_"+a[b];g.increaseCount("checkout:device:preregistration:registerState:success",1);f(b)})}var a={};return{registerState:function(c,h,l,n){null!=c&&null!=h&&null!=l&&null!=n?(h="E_"+(h?"CHECKED":"UNCHECKED"),l&&(h="D_"+(n?"GIFTED":"OTHER")),l=h,a[c]!==l&&(a[c]=l,f("PREREGISTRATION_"+c+"_C_"+
a[c])),d('input[name\x3d"placeYourOrder1"]').unbind("click",b).bind("click",b),g.increaseCount("checkout:device:preregistration:registerState:success",1)):g.increaseCount("checkout:device:preregistration:registerState:failed",1)}}});h.when("A","client-side-metrics").execute("updp-fallback-auto-click",function(c,d){function g(){var f=c.$("#prime-updp-fallback-button");f.length&&c.delay(function(){d.increaseCount("checkout:updp:fallback:clickedContinue",1);f.click()},100)}c.on("load",g);c.on("checkout:afterReload",
g)});"use strict";h.when("A","jQuery").register("widgets/customizationDetails/customizationDetails",function(c,d){c.declarative("additional-customization-details-action","click",function(c){c.$currentTarget.closest(".sc-customization-details-list").find(".sc-customization-details-additional").removeClass("aok-hidden");c.$currentTarget.closest(".sc-customization-details-see-more").hide();c.$event.preventDefault()})})});