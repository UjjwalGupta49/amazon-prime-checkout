(function(f){var q=window.AmazonUIPageJS||window.P,l=q._namespace||q.attributeErrors,k=l?l("CalendarWidgetCommonAssets",""):q;k.guardFatal?k.guardFatal(f)(k,window):k.execute(function(){f(k,window)})})(function(f,q,l){function k(b,d){if(!(b instanceof d))throw new TypeError("Cannot call a class as a function");}function k(b,d){if(!(b instanceof d))throw new TypeError("Cannot call a class as a function");}function k(b,d){if(!(b instanceof d))throw new TypeError("Cannot call a class as a function");
}function k(b,d){if(!(b instanceof d))throw new TypeError("Cannot call a class as a function");}f.when("A").register("buttonUtil",function(b){return{setStatus:function(d,a,c){var e=d.find(a);d=[null,"normal","selected","disabled","error","inactive"];a=0>b.indexOfArray(d,c);var h="radio"===e.attr("role");if(a)return f.error(c+" is not a valid status"),!1;b.each(d,function(a){e.removeClass("a-button-"+a)});e.children(".a-button-inner").children("button,input").prop("disabled","disabled"===c);e.attr("aria-checked",
function(a,b){return h?"selected"===c:b});null!==c&&e.addClass("a-button-"+c);return this}}});"use strict";f.when("A","buttonUtil","ready").register("CalendarWidgetActions",function(b,d){var a=b.$,c=function(b,c,d,e){b.find(".dynamic-toggle").each(function(){var b=a(this),g=b.data("property"),c=b.data("value");e.currentSelection[g]&&(g=d.currentSelection[g],g!==l&&g===c?b.removeClass("aok-hidden"):b.addClass("aok-hidden"))})},e=function(b,c,d){b.find(".dynamic-class").each(function(){var b=a(this),
g=b.data("property"),e=b.data("value");if(d.currentSelection[g]){var g=c.currentSelection[g],h=b.data("selected"),p=b.data("unselected");g!==l&&g===e?(b.removeClass(p),b.addClass(h)):(b.removeClass(h),b.addClass(p))}})},h=function(b,c){c.hasOwnProperty("dateId")&&b.find(".a-declarative").each(function(){var b=a(this).find(".a-button-toggle");b&&!b.hasClass("a-button-disabled")&&(b=a(this).data("date-selected"),b!==l&&b.dateId===c.dateId?d.setStatus(a(this),".calendar-widget-date","selected"):d.setStatus(a(this),
".calendar-widget-date","normal"))})},r=function(b,c){c.hasOwnProperty("slotId")&&b.find(".a-declarative").each(function(){var b=a(this).find(".a-button-toggle");b&&!b.hasClass("a-button-disabled")&&(b=a(this).data("slot-selected"),b!==l&&b.slotId===c.slotId?d.setStatus(a(this),".calendar-slot","selected"):d.setStatus(a(this),".calendar-slot","normal"))})},f=function(b,a,c){for(var d=0;d<b.length;d++)if(b[d][a]===c)return b[d];return l},k=function(b,a){var c=b.dateId;if(!c)return null;a=f(a,"id",
c).slots;return(b=b.slotId)?f(a,"id",b):null},p=function(a,c,d){(d=k(c,d))&&null!==d&&b.trigger("calendar_widget_slot_selected",{widgetId:a,slotId:d.id,dateId:c.dateId,timeRange:d.timeRange,metadata:d.metadata})},u=function(a,c){b.trigger("calendar_widget_date_selected",{widgetId:a,dateId:c})},w=function(c){var d={};b.each(a('script[type\x3d"a-state"]'),function(e,h){a(e).data("a-state").key===c&&(d=b.parseJSON(a(e).html()))});b.state(c,d);return d},v=function(a,c){return(a=(a=c||b.state(a))&&a.currentSelection?
a.currentSelection.slotId:null)&&null!==a?!0:!1},x=function(){var g=a(this),m=g.attr("id"),t=w(m);v(m,t)&&p(m,t.currentSelection,t.dates);"1"===a("meta[name\x3dRCX_CHECKOUT_SD_GOLDEN_CX_DESKTOP_SPC]").attr("content")?b.state.bind(m,function(b,a){a.currentSelection&&(a.currentSelection.dateId&&(c(g,m,b,a),e(g,b,a),d.setStatus(g,".calendar-slot","normal"),h(g,b.currentSelection),u(m,b.currentSelection.dateId)),a.currentSelection.slotId&&b.currentSelection.slotId&&(p(b.id,b.currentSelection,b.dates),
r(g,b.currentSelection)),a.currentSelection.currentDatePage&&c(g,m,b,a))}):b.state.bind(m,function(b,a){a.currentSelection&&(a.currentSelection.dateId?(c(g,m,b,a),e(g,b,a),d.setStatus(g,".calendar-slot","normal"),u(m,b.currentSelection.dateId)):a.currentSelection.slotId&&b.currentSelection.slotId?(p(b.id,b.currentSelection,b.dates),r(g,b.currentSelection)):a.currentSelection.currentDatePage&&c(g,m,b,a))})};b.declarative("date-selected","click",function(a){var c=a.data;a=c.dateId;var c=c.widgetId,
d=b.state(c);d.currentSelection.dateId=a;d.currentSelection.slotId=null;b.state(c,d)});b.declarative("slot-selected","click",function(a){var c=a.data;a=c.slotId;var d=c.dateId,c=c.widgetId,e=b.state(c);e.currentSelection.widgetId=c;e.currentSelection.dateId=d;e.currentSelection.slotId=a;b.state(c,e)});b.declarative("previous-page","click",function(a){a=a.data.widgetId;var c=b.state(a),d=c.currentSelection.currentDatePage;0!==d&&(c.currentSelection.currentDatePage=d-1,b.state(a,c))});b.declarative("next-page",
"click",function(a){a=a.data.widgetId;var c=b.state(a),d=c.currentSelection.currentDatePage;d!==c.config.lastPage&&(c.currentSelection.currentDatePage=d+1,b.state(a,c))});return{enableWidgetActions:function(b){a("#"+b).each(x)},isSlotSelected:v,getSelectedSlot:function(a){a=b.state(a);if(!a||null===a)return null;var c=a.currentSelection;return c&&null!==c?k(c,a.dates):null},getFirstSlotForDate:function(a,c){c=b.state(c);if(!c||null===c)return null;a=f(c.dates,"id",a);if(!a||null===a)return null;a=
a.slots;var d;a!==l&&0<a.length&&(d=a[0]);return d},getSlotById:function(a,c){c=b.state(c);if(!c||null===c)return null;c=c.dates.reduce(function(a,b){return a.concat(b.slots?b.slots:[])},[]);return 0===c.length?null:(a=f(c,"id",a))?a:null}}});"use strict";f.when("A","CalendarWidgetActions").register("CalendarWidget",function(b,d){return{createWidget:function(a,c,d,h){b.$.ajax({url:a,type:"POST",dataType:"html",contentType:"application/json",data:JSON.stringify(c),success:function(a){d({payload:a})},
error:function(a){h(a)}})},enableWidgetActions:d.enableWidgetActions,isSlotSelected:d.isSlotSelected,getSelectedSlot:d.getSelectedSlot,getFirstSlotForDate:d.getFirstSlotForDate,getSlotById:d.getSlotById}});"use strict";f.when("A","buttonUtil","SlotContainerWidgetConstants","ready").register("SlotContainerWidgetActions",function(b,d,a){var c=b.$,e=function(a,b){if(a=a.id)a:{for(var c=0;c<b.length;c++)if(b[c].id===a){b=b[c];break a}b=l}else b=null;return b},h=function(a,c,d){d=e(c,d);c&&null!==c&&b.trigger("slot-container-slot-selected",
{widgetId:a,slotId:d.id,pageType:c.pageType,callCaseForSDOverride:c.callCaseForSDOverride,metadata:d.metadata})},r=function(a){var d={};b.each(c('script[type\x3d"a-state"]'),function(e,h){c(e).data("a-state").key===a&&(d=b.parseJSON(c(e).html()))});if(d.selectedSlot&&d.selectedSlot.id){var e=c("#"+d.selectedSlot.id).find("[data-action]").data("slotContainerSlotSelected");d.selectedSlot.pageType=e.pageType;d.selectedSlot.callCaseForSDOverride=e.callCaseForSDOverride;d.selectedSlot.widgetId=l}b.state(a)&&
"replace"in b.state&&b.$.isFunction(b.state.replace)?b.state.replace(a,d):b.state(a,d);return d},f=function(a,c){return(a=(a=c||b.state(a))&&a.selectedSlot?a.selectedSlot.id:null)&&null!==a?!0:!1},k=function(){var d=c(this).attr("id"),e=r(d);e&&e.selectedSlot&&e.selectedSlot.pageType===a.SHIP_OPTION_SELECT_PAGE&&f(d,e)&&h(d,e.selectedSlot,e.slots);e=b.state(d+a.STATE_BIND_STATUS);e&&e.isStateBinded||(b.state(d+a.STATE_BIND_STATUS,{isStateBinded:!0}),b.state.bind(d,function(a,b){a.slots&&a.selectedSlot&&
h(a.selectedSlot.widgetId,a.selectedSlot,a.slots)}))};b.declarative("slot-container-slot-selected","click",function(a){var c=a.data;a=c.widgetId;var d=c.slotId,e=c.pageType,c=c.callCaseForSDOverride,h=b.state(a);h.selectedSlot.widgetId=a;h.selectedSlot.id=d;h.selectedSlot.pageType=e;h.selectedSlot.callCaseForSDOverride=c;b.state(a,h)});b.declarative("open-expander","click",function(b){var d=c("#"+b.data.widgetId);b=d.find("."+a.EXPANDER_HEADER_CLASS);d=d.find("."+a.HIDDEN_CLASS+"."+a.DYNAMIC_CLASS);
b.addClass(a.HIDDEN_CLASS);d.each(function(){c(this).removeClass(a.HIDDEN_CLASS)})});b.on("scheduled-delivery-mdw:select-slot",function(b){b=c("#"+b);d.setStatus(b,"."+a.SLOT_CLASS,"selected")});b.on("scheduled-delivery-mdw:deselect-slot",function(b){b=c("#"+b);d.setStatus(b,"."+a.SLOT_CLASS,"normal")});return{enableWidgetActions:function(a){c("#"+a).each(k)},isSlotSelected:f,getSelectedSlot:function(a){a=b.state(a);if(!a||null===a)return null;var c=a.selectedSlot;return c&&null!==c?e(c,a.slots):
null}}});"use strict";f.when("A","SlotContainerWidgetActions").register("SlotContainerWidget",function(b,d){return{createWidget:function(a,c,d,h){b.$.ajax({url:a,type:"POST",dataType:"html",contentType:"application/json",data:JSON.stringify(c),success:function(a){d({payload:a})},error:function(a){h(a)},timeout:11E3})},enableWidgetActions:d.enableWidgetActions,isSlotSelected:d.isSlotSelected,getSelectedSlot:d.getSelectedSlot}});"use strict";f.when("A").register("SlotContainerWidgetConstants",function(){return{HIDDEN_CLASS:"aok-hidden",
DYNAMIC_CLASS:"dynamic-class",EXPANDER_HEADER_CLASS:"slot-container-expander-heading",SLOT_CLASS:"slot-container-slot",STATE_BIND_STATUS:"-bind-status",SHIP_OPTION_SELECT_PAGE:"SOSP"}});"use strict";var y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"===typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},n=function(){function b(b,a){for(var c=0;c<a.length;c++){var e=a[c];e.enumerable=e.enumerable||
!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(b,e.key,e)}}return function(d,a,c){a&&b(d.prototype,a);c&&b(d,c);return d}}();f.when("A").register("DeliveryWindowPreferenceModel",function(b){return function(){function b(a,c,e,h){k(this,b);this._marketplaceId=a;this._customerId=c;this._addressId=e;this.deliveryWindows=h}n(b,[{key:"removeDeliveryWindows",value:function(){this._deliveryWindows=[];return this}},{key:"isSamePreferredDeliveryWindow",value:function(a){if(!this.preferredDeliveryWindow||
!a)return!1;var b=this.preferredDeliveryWindow;return b.startTime===a.startTime&&b.endTime===a.endTime}},{key:"toJSON",value:function(){return{marketplaceId:this.marketplaceId,customerId:this.customerId,addressId:this.addressId,deliveryWindows:this.deliveryWindows}}},{key:"toJSONString",value:function(){return JSON.stringify(this.toJSON())}},{key:"marketplaceId",get:function(){return this._marketplaceId}},{key:"customerId",get:function(){return this._customerId}},{key:"addressId",get:function(){return this._addressId}},
{key:"deliveryWindows",get:function(){return this._deliveryWindows},set:function(a){a&&a.length?(a=Array.isArray(a)?a:[a],a.every(b._verifyDeliveryWindow)?this._deliveryWindows=a.map(function(a){return{startTime:a.startTime,endTime:a.endTime}}):this.removeDeliveryWindows()):this.removeDeliveryWindows()}},{key:"preferredDeliveryWindow",get:function(){return Array.isArray(this._deliveryWindows)&&this._deliveryWindows[0]?this._deliveryWindows[0]:null}}],[{key:"fromJSON",value:function(a){"object"!==
("undefined"===typeof a?"undefined":y(a))&&(a=JSON.parse(a));return new b(a.marketplaceId,a.customerId,a.addressId,a.deliveryWindows)}},{key:"_verifyDeliveryWindow",value:function(a){return a.hasOwnProperty("startTime")&&a.hasOwnProperty("endTime")}}]);return b}()});"use strict";n=function(){function b(b,a){for(var c=0;c<a.length;c++){var e=a[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(b,e.key,e)}}return function(d,a,c){a&&b(d.prototype,a);
c&&b(d,c);return d}}();f.when("A","DeliveryWindowPreferenceModel").register("DeliveryWindowPreferenceService",function(b,d){var a=b.$;return function(){function c(){k(this,c)}n(c,null,[{key:"getDWPPageState",value:function(a){return b.state(a).deliveryWindowPreferenceData}},{key:"saveDWPPrefToPageState",value:function(a,c){var f=b.state(a);f&&f.deliveryWindowPreferenceData&&f.deliveryWindowPreferenceData.pref&&(c instanceof d&&(c=c.toJSON()),f.deliveryWindowPreferenceData.pref=c,b.state.replace(a,
f))}},{key:"getDWP",value:function(a){return(a=c.getDWPPageState(a))&&a.pref?d.fromJSON(a.pref):null}},{key:"saveDWP",value:function(b,c,f,k){c instanceof d||k(Error('Input is not of type "DeliveryWindowPreferenceModel"'));a.ajax({url:b,type:"POST",contentType:"application/json",data:c.toJSONString(),success:function(a){f({status:a,dwp:c})},error:function(a){k(a)}})}}]);return c}()});"use strict";n=function(){function b(b,a){for(var c=0;c<a.length;c++){var e=a[c];e.enumerable=e.enumerable||!1;e.configurable=
!0;"value"in e&&(e.writable=!0);Object.defineProperty(b,e.key,e)}}return function(d,a,c){a&&b(d.prototype,a);c&&b(d,c);return d}}();f.when("A").register("DeliveryWindowPreferenceView",function(b){var d=b.$;return function(){function a(b){k(this,a);this._calendarWidgetSelector=b;this._$calendarWidget=d(this._calendarWidgetSelector);this._$container=this._$calendarWidget.find(".sd-dwp-checkbox");this._$checkbox=this._$container.find("input[type\x3d'checkbox']");this._$label=this._$container.find(".sd-dwp-label");
this._$timeLabel=this._$container.find(".sd-dwp-dw-time-label");this._$bottomSheetTimeLabel=this._$container.find(".sd-dwp-details-timelabel")}n(a,[{key:"show",value:function(){this._$container.removeClass("aok-hidden");return this}},{key:"hide",value:function(){this._$container.addClass("aok-hidden");return this}},{key:"setEnabled",value:function(a){a?(this._$container.css("cursor","pointer"),this._$checkbox.removeAttr("disabled")):(this._$container.css("cursor","not-allowed"),this._$checkbox.attr("disabled",
"disabled"));return this}},{key:"isCheckboxChecked",value:function(){return this._$checkbox.is(":checked")}},{key:"setCheckboxState",value:function(a){a?this._$checkbox.attr("checked",!0):this._$checkbox.removeAttr("checked");return this}},{key:"setTimeLabel",value:function(a){this._$timeLabel.text(a);return this}},{key:"setBottomSheetTimeLabel",value:function(a){this._$bottomSheetTimeLabel.text(a);return this}},{key:"$container",get:function(){return this._$container}},{key:"$checkbox",get:function(){return this._$checkbox}},
{key:"$label",get:function(){return this._$label}},{key:"$timeLabel",get:function(){return this._$timeLabel}},{key:"$bottomSheetTimeLabel",get:function(){return this._$bottomSheetTimeLabel}}]);return a}()});"use strict";n=function(){function b(b,a){for(var c=0;c<a.length;c++){var e=a[c];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(b,e.key,e)}}return function(d,a,c){a&&b(d.prototype,a);c&&b(d,c);return d}}();f.when("A","DeliveryWindowPreferenceModel",
"DeliveryWindowPreferenceView","page-detector").register("DeliveryWindowPreferenceWidget",function(b,d,a,c){return function(){function e(a,b,c){k(this,e);this._calendarWidgetId=a;this._calendarWidgetIndex=b;this._dwpWidgetId=""+a+"-dwp";this._dwp=d.fromJSON(c);this._addressId=this._dwp.addressId;this._view=this._currentDW=null;this._bindEventsFunc=this._bindEvents.bind(this);this.initialize()}n(e,[{key:"initialize",value:function(){this._view=new a("#"+this._calendarWidgetId);if(!c.isMobile()&&c.isSpc()){var d=
"a:popover:show:scheduled-delivery-popover-name-"+this._calendarWidgetIndex;b.off(d,this._bindEventsFunc);b.on(d,this._bindEventsFunc)}else this._bindEventsFunc()}},{key:"_bindEvents",value:function(){var a=this;this._view.$checkbox.bind("click",function(b){return a._handleCheckbox(b)})}},{key:"_handleCheckbox",value:function(a){a=d.fromJSON(this._dwp.toJSON());if(this.isCheckboxChecked()){var c=this._currentDW;a.deliveryWindows=[{startTime:c.startTime,endTime:c.endTime}]}else a.deliveryWindows=[];
b.trigger("sd-dwp-preference-changed",{calendarWidgetId:this._calendarWidgetId,dwpWidgetId:this._dwpWidgetId,dwp:a,currentDW:this._currentDW})}},{key:"updateCurrentDeliveryWindow",value:function(a){(this._currentDW=a)?this.setCheckboxState(this._dwp.isSamePreferredDeliveryWindow(a)).setTimeLabel(e.deliveryWindowString(a)).show():this.setCheckboxState(!1).hide()}},{key:"show",value:function(){this._view.show();return this}},{key:"hide",value:function(){this._view.hide();return this}},{key:"setEnabled",
value:function(a){this._view.setEnabled(a);return this}},{key:"isCheckboxChecked",value:function(){return this._view.isCheckboxChecked()}},{key:"setCheckboxState",value:function(a){this._view.setCheckboxState(a);return this}},{key:"setTimeLabel",value:function(a){this._view.setTimeLabel(a);return this}},{key:"setBottomSheetTimeLabel",value:function(a){this._view.setBottomSheetTimeLabel(a);return this}},{key:"calendarWidgetId",get:function(){return this._calendarWidgetId}},{key:"calendarWidgetIndex",
get:function(){return this._calendarWidgetIndex}},{key:"dwpWidgetId",get:function(){return this._dwpWidgetId}},{key:"addressId",get:function(){return this._addressId}},{key:"dwp",get:function(){return this._dwp},set:function(a){a instanceof d&&(this._dwp=a)}},{key:"currentDW",get:function(){return this._currentDW}}],[{key:"deliveryWindowString",value:function(a){return(a.startTimeDisplay||a.startTime)+" "+a.separator+" "+(a.endTimeDisplay||a.endTime)}},{key:"blankTimeLabel",value:function(){return"--"}}]);
return e}()})});
/* ******** */
(function(a){var g=window.AmazonUIPageJS||window.P,h=g._namespace||g.attributeErrors,b=h?h("ServicesWidgetCommonAssets",""):g;b.guardFatal?b.guardFatal(a)(b,window):b.execute(function(){a(b,window)})})(function(a,g,h){a.when("A").register("ServicesWidgetConstants",function(){return{AJAX_CALL_URL:"/scheduleddelivery/widgets/services"}});"use strict";a.when("A","ready").register("ServicesWidgetActions",function(b){b.declarative("service-selected","change",function(e){var d="undefined"!==typeof e.$target.attr("checked"),
f=e.data;e=JSON.parse(f.metadata);var f=f.id,c=b.state(f);c||(c=[]);var k=e.service;if(d)a:{for(d=0;d<c.length;d++)if(c[d].serviceSymbol===k.serviceSymbol)break a;c.push(k)}else for(var d=c,c=[],a=0;a<d.length;a++)d[a].serviceSymbol!==k.serviceSymbol&&c.push(d[a]);b.state(f,c);b.trigger("services_widget_service_selected",{calendarWidgetId:e.calendarWidgetId,selectedServices:c,widgetIndex:e.widgetIndex,trimmedOrderId:e.trimmedOrderId,isAfn:e.isAfn})})});"use strict";a.when("A","ServicesWidgetConstants").register("ServicesWidget",
function(b,a){return{createWidget:function(d,f,c){b.$.ajax({url:a.AJAX_CALL_URL,type:"POST",dataType:"html",contentType:"application/json",data:JSON.stringify(d),success:function(a){f({payload:a})},error:function(a){c(a)}})}}})});
/* ******** */
(function(k){var v=window.AmazonUIPageJS||window.P,q=v._namespace||v.attributeErrors,g=q?q("ScheduledDeliveryDataTransformerJs",""):v;g.guardFatal?g.guardFatal(k)(g,window):g.execute(function(){k(g,window)})})(function(k,v,q){k.when("A","ready").register("SDTransformerConstants",function(){return{TRANSFORMER_OUTPUT_CACHE_KEY:"goldenTransformerOutputKey",SLOT_LIST_CACHE_KEY:"goldenCacheKey",RAP_SERVICE_URL:"/gp/product/features/scheduled-delivery/sd-get-slots-coral.html",NO_SERVICES_KEY:"",SD_RESERVATION_ID_FIELD_TYPE_DELIMITER:";",
SD_RESERVATION_ID_LIST_ITEM_DELIMITER:",",SD_RESERVATION_ID_CURRENCY_DELIMITER:"^",SD_RESERVATION_ID_COMPLEX_SERVICE_DELIMITER:"^",SD_RESERVATION_ID_BASIC_SERVICE_DELIMITER:"",SERVICE_IDS_TO_FILTER_FROM_DISPLAY:["AgeVerification:True","Saturday:true","TestService:Basic","Evening:true"],AJAX_FAILURE:"ajaxCallFailure",VALIDATION_FAILURE:"validationException",DATA_TRANSFORMATION_FAILURE:"dataTransformationException",UDS_ENABLED_MARKETPLACES:"ATVPDKIKX0DER A1F83G8C2ARO7P A1VC38T7YXB528 A2EUQ1WTGCTBG2 A1PA6795UKMFR9 A13V1IB3VIYZZH APJ6JRA9NG5V4 A3HOBANJMCMD83 A1RKKUPIHCS9HS AJZF8LZ1EJVJN".split(" ")}});
"use strict";k.when("A","SDTransformerConstants","ready").register("GoldenCxDataTransformerUtil",function(g,c){function d(b){return b===this.element}return{validateMandatoryFields:function(b,a){return b.map(function(b){return[b,a[b]!==q]}).reduce(function(a,b){var c=b[0];b[1]||a.push(Error(c+" is invalid"));return a},[])},arrayContainsAll:function(b,a){return a&&0!==a.length?a.every(function(a){return b.includes(a)}):!0},addElementToArray:function(b,a){a&&-1===b.findIndex(d,{element:a})&&b.push(a)},
generateFailurePayload:function(b,a){return{type:b,data:a}}}});"use strict";k.when("A","RapServiceCall","GoldenCxDataTransformerUtil","SDTransformerConstants","GoldenCxDataTransformer","ready").register("GoldenCxRapServiceIntegration",function(g,c,d,b,a){var h="marketplace shipoption address lineItems widgetIndex client calendarWidgetId servicesWidgetId trimmedOrderId isAfn".split(" "),r="itemID merchantID merchantSKU inventoryAuthorityID offerListingID fulfillmentManagerID totalQuantity".split(" ");
return{getWidgetInputParameters:function(a,f,w){var m;a:{var e=d.validateMandatoryFields(h,a);if(0<e.length)m=e;else{for(m in a.lineItems)if(e=d.validateMandatoryFields(r,a.lineItems[m]),0<e.length){m=e;break a}m=[]}}if(0<m.length)return a=d.generateFailurePayload(b.VALIDATION_FAILURE,m),w(a);c.getSlots(a,f,w)},getCachedCalendarWidgetInputParameters:function(c,f,w){(c=a.getCalendarWidgetInputParametersFromCache(c))?f(c):(f=d.generateFailurePayload(b.DATA_TRANSFORMATION_FAILURE,"Unable to retrieve widget input parameters"),
w(f))}}});"use strict";k.when("A","SDTransformerConstants","SDTransformerSlotQualityUtil","SDTransformerDefaultSlotUtil","SDTransformerRapSlotsMergeUtil","ready").register("GoldenCxDataTransformer",function(g,c,d,b,a){function h(c,f,w,h){c=a.getFilteredSlotsGroupedByTime(c,f,h.udsServiceCodes);var e=d.getSlotQuality(c.hasMultipleSlotsForADay),z=c.slots,g=[],x,k="1"===r("meta[name\x3dRCX_CHECKOUT_SD_GOLDEN_CX_DESKTOP_SPC]").attr("content"),D;for(D in z){var t=a.getMergedSlotsInformation(z[D],f,w),
l;l=t;var u=h,n=e,p=l.timeRange,B=l.legacyTimeWindows,E=l.priceInformation,y={srsIds:l.srsSlotIdentifiers,reservationId:l.reservationId,reservationType:"RAP",carriers:l.carriers,shortTimezone:l.shortTimezone,longTimezone:l.longTimezone,startTimeLocalTimezone:p.startTime,startTimeUTC:B.s,endTimeLocalTimezone:p.endTime,endTimeUTC:B.e,fss:l.fss},C=w?w.shipmentDates:q;C&&(y.minShipDate=C.startTime,y.maxShipDate=C.endTime);u.isAfn||(y.cutoffTimeUTC=B.c,y.cutOffTimeLocalTimezone=l.minCutoffTime);l={startTime:p.startTime,
endTime:p.endTime,price:E.price,priceCurrency:E.priceCurrency,metadata:JSON.stringify({version:"1.0",widgetIndex:u.widgetIndex,trimmedOrderId:u.trimmedOrderId,slotQuality:n,slotQualityDetail:"CUSTOMER_NOMINATED",slot:y})};x=k?b.getDefaultSlotInformationWithSelectedSlot(x,l,t.longTimezone,h.selectedSlot):b.getDefaultSlotInformation(x,l,t.longTimezone);g.push(l)}var v;x&&x.slot&&(x.slot.isDefault=!0,v=x.timezone);return{services:c.services,goldenCxSlots:g,timezone:v}}var r=g.$;return{transform:function(b,
f){var d={},m=b.rapSlotIntersections;if(!m||null===m||0===m.length)return d;var e=h(m,f.selectedServiceList,b.shippingProperties,f),m={widgetId:f.calendarWidgetId,client:f.client,timezone:e.timezone,marketplaceId:f.marketplace,customerId:f.customerId,isPrimeCustomer:f.isPrimeCustomer,isAfn:f.isAfn,addressId:f.addressId,sessionId:f.sessionId,slots:e.goldenCxSlots,isSlotPreviouslySelected:f.isSlotPreviouslySelected};d.calendarInput=m;d.widgetIndex=f.widgetIndex;e=a.getServicesToDisplay(e.services,f.marketplace,
f.udsServiceCodes);if(0<e.length){for(var z=[],A=0;A<e.length;A++){var x=e[A],r=x.charge.perUnitCharge,x={serviceSymbol:x.serviceSymbol,price:r.Value,priceCurrency:r.Unit,metadata:JSON.stringify({version:"1.0",widgetIndex:f.widgetIndex,trimmedOrderId:f.trimmedOrderId,isAfn:f.isAfn,calendarWidgetId:f.calendarWidgetId,servicesWidgetId:f.servicesWidgetId,service:x})};z.push(x)}d.servicesInput={widgetId:f.servicesWidgetId,client:f.client,isSelectable:!0,marketplaceId:f.marketplace,customerId:f.customerId,
sessionId:f.sessionId,services:z}}f=c.TRANSFORMER_OUTPUT_CACHE_KEY.concat(f.calendarWidgetId);g.state(f,{rapResponse:b,calendarWidgetInputParameters:m});return d},transformRaplessSlots:function(a,b){if(a&&a.availableSlots&&0<a.availableSlots.length){for(var c=[],d=0;d<a.availableSlots.length;d++){var e=a.availableSlots[d],h=e.totalItemCharge+"^"+e.totalShipmentCharge+"^"+e.currencyCode,h=e.reservationIds.join()+";"+e.carrierNames.join()+";"+h+";",h={srsIds:e.reservationIds,reservationId:h,reservationType:"RAP",
carriers:e.carrierNames,shortTimezone:a.deliveryTimeZoneShort,longTimezone:a.deliveryTimeZone,startTimeLocalTimezone:e.slotStartTime,startTimeUTC:e.slotStartTimeUTC,endTimeLocalTimezone:e.slotEndTime,endTimeUTC:e.slotEndTimeUTC,fss:e.fulfillmentServiceSubclass};b.isAfn?(h.minShipDate=e.promiseMinShipmentDate,h.maxShipDate=e.promiseMaxShipmentDate):(h.cutOffTimeLocalTimezone=e.cutoffTime,h.cutoffTimeUTC=e.cutoffTimeUTC);e={startTime:Number(e.slotStartTime),endTime:Number(e.slotEndTime),price:Number(e.deliveryPrice),
priceCurrency:e.currencyCode,metadata:JSON.stringify({version:"1.0",widgetIndex:b.widgetIndex,trimmedOrderId:b.trimmedOrderId,slotQuality:e.slotQuality,slotQualityDetail:e.slotQualityDetail,slot:h})};c.push(e)}if(0<c.length)a:{if((e=b.selectedSlot)&&e.start&&e.end)for(d=parseInt(e.start),h=parseInt(e.end),e=0;e<c.length;e++){var g=c[e];if(g.startTime===d&&g.endTime===h){c[e].isDefault=!0;break a}}for(e=d=0;e<c.length;e++)c[e].startTime<c[d].startTime?d=e:c[e].startTime===c[d].startTime&&c[e].endTime<
c[d].endTime&&(d=e);c[d].isDefault=!0}return{calendarInput:{widgetId:b.calendarWidgetId,client:b.client,timezone:a.deliveryTimeZone,marketplaceId:b.marketplace,customerId:b.customerId,isPrimeCustomer:b.isPrimeCustomer,isAfn:b.isAfn,sessionId:b.sessionId,addressId:b.addressId,slots:c,isSlotPreviouslySelected:b.isSlotPreviouslySelected},widgetIndex:b.widgetIndex}}},getCalendarWidgetInputParametersFromCache:function(a){var b=c.TRANSFORMER_OUTPUT_CACHE_KEY.concat(a.calendarWidgetId);if(b=g.state(b)){var d=
b.rapResponse;a=h(d.rapSlotIntersections,a.selectedServices,d.shippingProperties,a);b=b.calendarWidgetInputParameters;b.slots=a.goldenCxSlots;return{calendarInput:b}}}}});"use strict";k.when("A","SDTransformerConstants","GoldenCxDataTransformerUtil","GoldenCxDataTransformer","ready").register("RapServiceCall",function(g,c,d,b){return{getSlots:function(a,h,r){var k={marketplace:a.marketplace,shipoption:a.shipoption,address:a.address,lineItems:a.lineItems};a.path&&"Rapless"===a.path&&(k.path="Rapless");
var f={widgetIndex:a.widgetIndex,calendarWidgetId:a.calendarWidgetId,servicesWidgetId:a.servicesWidgetId,trimmedOrderId:a.trimmedOrderId,client:a.client,marketplace:a.marketplace,selectedServiceList:a.selectedServiceList,sessionId:a.sessionId!==q?a.sessionId:null,customerId:a.customerId!==q?a.customerId:null,isPrimeCustomer:!!a.isPrimeCustomer,addressId:a.address!==q?a.address:null,isAfn:1===a.isAfn?!0:!1,udsServiceCodes:a.udsServiceCodes,selectedSlot:a.selectedSlot!==q?a.selectedSlot:null,isSlotPreviouslySelected:a.isSlotPreviouslySelected};
g.ajax(c.RAP_SERVICE_URL,{method:"post",dataType:"json",contentType:"application/x-www-form-urlencoded;charset\x3dUTF-8",params:{ajaxCallParams:JSON.stringify(k)},success:function(a){a=a.path&&"Rapless"===a.path?b.transformRaplessSlots(a,f):b.transform(a,f);h(a)},error:function(){var a=d.generateFailurePayload(c.AJAX_FAILURE,k);r(a)},timeout:5E3,traditional:!0})}}});"use strict";k.when("A","SDTransformerConstants","SDTransformerServiceSymbolUtil","ready").register("SDReservationIdUtil",function(g,
c,d){return{calculateReservationId:function(b,a,h,g,k,f){Array.isArray(b)&&(b=b.join(c.SD_RESERVATION_ID_LIST_ITEM_DELIMITER));Array.isArray(a)&&(a=a.join(c.SD_RESERVATION_ID_LIST_ITEM_DELIMITER));b=b+c.SD_RESERVATION_ID_FIELD_TYPE_DELIMITER+a+c.SD_RESERVATION_ID_FIELD_TYPE_DELIMITER+h+c.SD_RESERVATION_ID_CURRENCY_DELIMITER+g+c.SD_RESERVATION_ID_CURRENCY_DELIMITER+k+c.SD_RESERVATION_ID_FIELD_TYPE_DELIMITER;if(f){if(Array.isArray(f)){a=[];h=[];g="";for(var q in f)k=f[q],d.isBasicService(k)?a.push(k):
h.push(k);0<a.length&&(g=a.join(c.SD_RESERVATION_ID_BASIC_SERVICE_DELIMITER));0<a.length&&0<h.length&&(g+=c.SD_RESERVATION_ID_COMPLEX_SERVICE_DELIMITER);0<h.length&&(g+=h.join(c.SD_RESERVATION_ID_COMPLEX_SERVICE_DELIMITER));f=g}b+=f}return b}}});"use strict";k.when("A","ready").register("SDTransformerDefaultSlotUtil",function(g){return{getDefaultSlotInformation:function(c,d,b){var a=c&&null!==c?c.slot:null;return!a||null===a||d.price<a.price||c.slot.price===d.price&&(d.startTime<a.startTime||d.startTime===
a.startTime&&d.endTime<a.endTime)?{slot:d,timezone:b}:c},getDefaultSlotInformationWithSelectedSlot:function(c,d,b,a){var h=c&&null!==c?c.slot:null;return a&&null!==a&&d.startTime.toString()===a.start&&d.endTime.toString()===a.end&&b===a.tz||!h||null===h||d.price<h.price||c.slot.price===d.price&&(d.startTime<h.startTime||d.startTime===h.startTime&&d.endTime<h.endTime)?{slot:d,timezone:b}:c}}});"use strict";k.when("A","ready").register("SDTransformerSlotQualityUtil",function(g){return{getSlotQuality:function(c){return c?
"TIME":"DAY"}}});"use strict";k.when("A","ready").register("SDTransformerServiceSymbolUtil",function(g){var c={"Assembly:Basic":"A:B","Assembly:Complex":"A:C","Assembly:Moderate":"A:M","Assembly:Specialized":"A:S","Installation:BuiltInBasic":"I:B","Installation:BuiltInComplex":"I:C","Installation:BuiltInElectronics":"I:I","Installation:BuiltInModerate":"I:M","Installation:StandAloneBasic":"I:A","Installation:StandAloneElectronics":"I:E","Evening:true":"E","Haulaway:true":"H","Installation:true":"I",
"Recycling:true":"R","Unpack:true":"U","Saturday:true":"S","Delivery:RoomOfChoice":"D:R","Delivery:InsideEntryway":"D:E"},d=["E","H","I","R","S"];return{getServiceSymbol:function(b){return c[b]},isBasicService:function(b){return 0<=d.indexOf(b)}}});"use strict";k.when("A","ready").register("SDTransformerFssUtil",function(g){var c=["FAST_TRACK_SAME_DAY","FAST_TRACK_FUTURE_DAY","NOT_FAST_TRACK"];return{calculateFss:function(d,b){var a;d&&b&&(b=b.map(function(a){a=c.indexOf(d[a]);return-1===a?Infinity:
a}),b=Math.min.apply(Math,b),a=Infinity===b?q:c[b]);return a}}});"use strict";k.when("A","SDTransformerServiceSymbolUtil","SDTransformerConstants","SDTransformerFssUtil","SDReservationIdUtil","GoldenCxDataTransformerUtil","SDTransformerPolyfill","ready").register("SDTransformerRapSlotsMergeUtil",function(g,c,d,b,a,h){function k(a){return a.serviceId===this.serviceId}var v=function(a){var b=c.getServiceSymbol(a.serviceId);return a.serviceSymbol=b},f=function(a){a=new Date(1E3*a);return a.getMonth()+
"-"+a.getDate()},w=function(a,b){-1===a.findIndex(k,{serviceId:b.serviceId})&&a.push(b)},m=function(a){return a.map(function(a){return a.slotID})};return{getFilteredSlotsGroupedByTime:function(a,b,c){var g={},k=!1,m=[],t=[],l=[];b?l=b.map(function(a){return a.serviceSymbol}):c&&(l=c);for(b=0;b<a.length;b++){c=a[b];for(var u=[],n=c.services,p=[],q=0;q<n.length;q++){var r=n[q],y=v(r);d.SERVICE_IDS_TO_FILTER_FROM_DISPLAY.includes(r.serviceId)?h.addElementToArray(u,y):(w(t,n[q]),h.addElementToArray(p,
y))}c.invisibleServices=u;h.arrayContainsAll(p,l)&&(u=c.timeRange,n=u.startTime+"-"+u.endTime,(p=g[n])?p.push(c):(g[n]=[c],k||(c=f(u.startTime),k=m[c]&&!0===m[c]?!0:!1,m[c]=!0)))}return{slots:g,hasMultipleSlotsForADay:k,services:t}},getMergedSlotsInformation:function(c,d,g){for(var f=c[0],k=f.carriers,r=f.srsSlotIdentifiers,t=f,l=f,u=1;u<c.length;u++){var n=c[u],k=k.concat(n.carriers),r=r.concat(n.srsSlotIdentifiers);t.minCutoffTime>=n.minCutoffTime||(t=n);l.charge.perShipmentCharge.Value>=n.charge.perShipmentCharge.Value||
(l=n)}c=t.minCutoffTime;u=t.legacyTimeWindows;g=b.calculateFss(g?g.carrierFastTrackMap:q,k);var r=m(r),p=l.charge,l={};l.price=p.perUnitCharge.Value+p.perShipmentCharge.Value;l.priceCurrency=p.perUnitCharge.Unit;var n=p.perUnitCharge.Value,p=p.perShipmentCharge.Value,w=[],w=w.concat(t.invisibleServices);if(d)for(t=0;t<d.length;t++){var v=d[t];h.addElementToArray(w,v.serviceSymbol);v=v.charge;n+=v.perUnitCharge.Value;p+=v.perShipmentCharge.Value}n=+n.toFixed(2);p=+p.toFixed(2);d=a.calculateReservationId(r,
k,n,p,l.priceCurrency,w);return{srsSlotIdentifiers:r,minCutoffTime:c,legacyTimeWindows:u,reservationId:d,timeRange:f.timeRange,shortTimezone:f.shortFormTz,longTimezone:f.timeZone,carriers:k,priceInformation:l,fss:g}},getServicesToDisplay:function(a,b,c){return c===q?(d.UDS_ENABLED_MARKETPLACES.includes(b)&&(a=[]),a):[]}}});"use strict";k.when("A","ready").register("SDTransformerPolyfill",function(){Array.prototype.map||(Array.prototype.map=function(g){var c,d,b;if(null==this)throw new TypeError("this is null or not defined");
var a=Object(this),h=a.length>>>0;if("function"!==typeof g)throw new TypeError(g+" is not a function");1<arguments.length&&(c=arguments[1]);d=Array(h);for(b=0;b<h;){var k;b in a&&(k=a[b],k=g.call(c,k,b,a),d[b]=k);b++}return d});Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(g,c){if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),b=d.length>>>0;if("function"!==typeof g)throw new TypeError("predicate must be a function");
for(var a=0;a<b;){if(g.call(c,d[a],a,d))return a;a++}return-1},configurable:!0,writable:!0});Array.prototype.reduce||Object.defineProperty(Array.prototype,"reduce",{value:function(g){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!==typeof g)throw new TypeError(g+" is not a function");var c=Object(this),d=c.length>>>0,b=0,a;if(2<=arguments.length)a=arguments[1];else{for(;b<d&&!(b in c);)b++;if(b>=d)throw new TypeError("Reduce of empty array with no initial value");
a=c[b++]}for(;b<d;)b in c&&(a=g(a,c[b],b,c)),b++;return a}});Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(g,c){if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),b=d.length>>>0;if(0===b)return!1;c|=0;for(c=Math.max(0<=c?c:b-Math.abs(c),0);c<b;){var a=d[c],h=g;if(a===h||"number"===typeof a&&"number"===typeof h&&isNaN(a)&&isNaN(h))return!0;c++}return!1}})})});
/* ******** */
(function(q){var v=window.AmazonUIPageJS||window.P,C=v._namespace||v.attributeErrors,z=C?C("ScheduledDeliveryCheckoutAssets",""):v;z.guardFatal?z.guardFatal(q)(z,window):z.execute(function(){q(z,window)})})(function(q,v,C){function z(e,h){if(!(e instanceof h))throw new TypeError("Cannot call a class as a function");}function z(e,h){if(!(e instanceof h))throw new TypeError("Cannot call a class as a function");}q.when("A").register("SDWidgetsConstants",function(){return{CALENDAR_AJAX_CALL_URL:"/scheduleddelivery/widgets/calendar",
DELIVERY_WINDOW_PREFERENCE_AJAX_CALL_URL:"/scheduleddelivery/widgets/calendar/deliverywindowpreference",SD_NOT_AVAILABLE_ID_PREFIX:"#sd-not-available-",SD_NOTE_ID_PREFIX:"#sd-widget-note-",SD_CHANGE_LINK_ID_PREFIX:"#sd-widget-change-link-",SD_CALENDAR_WIDGET_PREFIX:"sd-calendar-widget-",SD_WIDGETS_PREFIX:"sd-widgets-",SD_WIDGETS_SPINNER_PREFIX:"#sd-widget-spinner-",SD_WIDGETS_POPOVER_NAME_PREFIX:"scheduled-delivery-popover-name-",UPSELL_MESSAGE_PREFIX_COLON:": ",UPSELL_MESSAGE_PREFIX_HYPHEN:"- ",
UPSELL_MESSAGE_PREFIX_DASH:"— ",SD_UPSELL_MESSAGE_PREFIX:"sd-upsell-messaging-",UPSELL_MESSAGE_CLASS:".upsell-messaging",SD_UDS_ERROR_MESSAGE:"UDS service code missing from hard coded map",SD_MDW_WIDGET_ROOT_CLASS:".sd-mdw-widget-root",SD_MDW_SLOT_CONTAINER_WIDGET_PREFIX:"sd-slot-container-widget-",SD_CALENDAR_WIDGET_RENDER_ERROR_METRIC:"GoldenCXCalendarRenderErrorCount",SD_CALENDAR_WIDGET_RENDER_SUCCESS_METRIC:"GoldenCXCalendarRenderSuccessCount",SD_SERVICE_WIDGET_RENDER_ERROR_METRIC:"GoldenCXServicesRenderErrorCount",
SD_WIDGET_HAS_GVDGO_SLOTS_METRIC:"GoldenCXWidgetHasGvdgoSlots",SD_WIDGET_LOAD_ERROR_METRIC:"GoldenCXWidgetLoadErrorCount",SD_WIDGET_LOAD_INFORMATION_METRIC:"GoldenCXWidgetLoadInformation",SD_WIDGET_NO_GVDGO_SLOTS_METRIC:"GoldenCXWidgetNoGvdgoSlots",SD_WIDGET_NO_SLOTS_METRIC:"GoldenCXWidgetNoSlots",SD_WIDGET_NO_SHIPOPTION_LEVEL_PRICE_METRIC:"GoldenCXWidgetNoShipoptionLevelPrice",SD_WIDGET_NO_SLOT_LEVEL_PRICE_METRIC:"GoldenCXWidgetNoSlotLevelPrice",SD_WIDGET_RAPLESS_ASYNC_METRIC:"GoldenCXWidgetRaplessAsync",
SD_WIDGET_SHADOW_BOTH_SLOTS_EXIST_METRIC:"GoldenCXWidgetShadowBothSlotsExist",SD_WIDGET_SHADOW_BOTH_SLOTS_NOT_EXIST_METRIC:"GoldenCXWidgetShadowBothSlotsNotExist",SD_WIDGET_SHADOW_COMPARISON_METRIC:"GoldenCXWidgetShadowComparison",SD_WIDGET_SHADOW_ONLY_HAS_GVDGO_SLOTS_METRIC:"GoldenCXWidgetShadowOnlyHasGvdgoSlots",SD_WIDGET_SHADOW_ONLY_HAS_RAP_SLOTS_METRIC:"GoldenCXWidgetShadowOnlyHasRapSlots",SD_WIDGET_SHADOW_RAP_TEN_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowRapTenPlusSlotsMore",SD_WIDGET_SHADOW_RAP_FIVE_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowRapFivePlusSlotsMore",
SD_WIDGET_SHADOW_RAP_ONE_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowRapOnePlusSlotsMore",SD_WIDGET_SHADOW_RAP_ONE_SLOT_MORE_METRIC:"GoldenCXWidgetShadowRapOneSlotMore",SD_WIDGET_SHADOW_GVDGO_TEN_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowGvdgoTenPlusSlotsMore",SD_WIDGET_SHADOW_GVDGO_FIVE_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowGvdgoFivePlusSlotsMore",SD_WIDGET_SHADOW_GVDGO_ONE_PLUS_SLOTS_MORE_METRIC:"GoldenCXWidgetShadowGvdgoOnePlusSlotsMore",SD_WIDGET_SHADOW_GVDGO_ONE_SLOT_MORE_METRIC:"GoldenCXWidgetShadowGvdgoOneSlotMore",
SD_WIDGET_SHADOW_SLOTS_FADD_PRICE_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsFaddPriceMismatch",SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatch",SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_START_LATE_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatchGvdgoStartLate",SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_START_EARLY_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatchGvdgoStartEarly",SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_END_LATE_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatchGvdgoEndLate",
SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_END_EARLY_METRIC:"GoldenCXWidgetShadowSlotsFaddTimeMismatchGvdgoEndEarly",SD_WIDGET_SHADOW_SLOTS_LENGTH_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsLengthMismatch",SD_WIDGET_SHADOW_SLOTS_PRICE_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsPriceMismatch",SD_WIDGET_SHADOW_SLOTS_TIME_MISMATCH_METRIC:"GoldenCXWidgetShadowSlotsTimeMismatch",SD_CALENDAR_WIDGET_SLOT_CHANGE_TRIGGER_ERROR_METRIC:"GoldenCXSlotChangeNotificationErrorCount",SD_CALENDAR_WIDGET_NO_VAS_SHIP_GROUP_ID:"GoldenCXCalendarNoVASGroupIdErrorCount",
SD_MDW_UPDATE_SDI_COUNT_METRIC:"MDWUpdateSDICallCount",SD_SHADOW_DUP_ERROR_METRIC:"GoldenCXDupShadowErrorCount",SD_SHADOW_REGISTER_METRIC:"GoldenCXShadowWidgetRegCount",SD_SHADOW_LOAD_METRIC:"GoldenCXShadowLoadCount",CONTINUE_BUTTON_OWNER:"SD",SD_SLOT_CONTAINER_WIDGET_RENDER_SUCCESS_METRIC:"MdwSlotWidgetRenderSuccessCount",SD_SLOT_CONTAINER_WIDGET_RENDER_ERROR_METRIC:"MdwSlotWidgetRenderErrorCount",SD_MDW_DISABLE_SHIP_OPTION_METRIC:"MdwShipOptionDisableCount",SD_SLOT_CONTAINER_WIDGET_NO_SLOTS_METRIC:"MdwSlotWidgetNoSlotsCount",
SLOT_CONTAINER_AJAX_CALL_URL:"/scheduleddelivery/widgets/slotcontainer",AOK_HIDDEN:"aok-hidden",SHIP_OPTION_SELECT_PAGE:"SOSP",SINGLE_PAGE_CHECKOUT:"SPC",SLOT_CONTAINER_WIDGET_ROOT_PREFIX:"sd_widgets_",DWP_WIDGET_NAME:"DeliveryWindowPreference",DWP_LOADED_METRIC:"DeliveryWindowPreferenceLoaded",DWP_LOAD_ERROR:"DeliveryWindowPreferenceLoadError",DWP_PAGE_STATE_NOT_FOUND:"DeliveryWindowPreferencePageStateNotFound",DWP_PDW_SLOT_NOT_FOUND:"DeliveryWindowPreferencePDWSlotNotFound",DWP_SAVE_PREFERENCE_METRIC:"DeliveryWindowPreferenceSavePreference",
DWP_SAVE_PREFERENCE_ERROR:"DeliveryWindowPreferenceSavePreferenceError",DWP_CUSTOMER_INTERACTED_METRIC:"DeliveryWindowPreferenceCustomerInteracted",DWP_CUSTOMER_OPT_IN_METRIC:"DeliveryWindowPreferenceCustomerOptIn",DWP_CUSTOMER_OPT_OUT_METRIC:"DeliveryWindowPreferenceCustomerOptOut",DWP_CUSTOMER_OPT_OUT_OF_PREFERRED_TIME_METRIC:"DeliveryWindowPreferenceCustomerOptOutOfPreferredTime"}});"use strict";q.when("A").register("SDGoldenCXTransformer",function(e){return{transform:function(e){return{calendar:{widgetId:e.widgetIndex,
timezone:"America/Los_Angeles",marketplaceId:"A1VC38T7YXB528",sessionId:"123",customerId:"Agatha",client:"SOSP",slots:[{startTime:1551362400,endTime:1551373200,isFree:!0,isDefault:!0},{startTime:1551373200,endTime:1551384E3,isFree:!1,price:12.99,priceCurrency:"GBP"},{startTime:1551373200,endTime:1551384E3,isFree:!1,price:12.99,priceCurrency:"GBP"},{startTime:1551448800,endTime:1551459600,isFree:!1,price:10.99,priceCurrency:"GBP"},{startTime:1551621600,endTime:1551632400,isFree:!1,price:10.99,priceCurrency:"GBP"}]},
services:{widgetId:e.widgetIndex,marketplaceId:"ATVPDKIKX0DER",sessionId:"session",customerId:"customer",client:"SOSP",isSelectable:!0,services:[{serviceSymbol:"R",price:12.99,priceCurrency:"USD",isDefault:!1,isFree:!1},{serviceSymbol:"D:E",price:10.99,priceCurrency:"USD",isDefault:!0,isFree:!1},{serviceSymbol:"D:R",isDefault:!0,isFree:!0,metadata:"abc to send bla"}]},dwp:{marketplaceId:"A1VC38T7YXB528",customerId:"customer123",addressId:"address123",deliveryWindows:[{startTime:"08:00",endTime:"12:00"},
{startTime:"14:00",endTime:"16:00"}]}}}}});"use strict";q.register("sdLogger",function(){return{logMetric:function(e,h){var f;"undefined"!==typeof v.ue&&"undefined"!==typeof e&&"undefined"!==typeof v.ue.count&&(f=v.ue.count(e)||0,v.ue.count(e,f+(h||1)))},logException:function(e,h){var f={logLevel:"ERROR",attribution:2<arguments.length&&arguments[2]!==C?arguments[2]:"scheduled_delivery_golden_cx_widget",message:h};"undefined"!==typeof v.ueLogError&&v.ueLogError(e,f)}}});"use strict";q.when("A","page-detector",
"SDWidgetsConstants","ready").register("SDShipOptionHandler",function(e,h,f){function m(a){var l=b(a.currentTarget);a=l.find("input[type\x3d'radio']");l=k(l);a=a.attr("name");e.trigger("scheduled-delivery-mdw:ship-option-changed",{current:l,previous:n[a]});n[a]=l}function k(a){a=a.find(f.SD_MDW_WIDGET_ROOT_CLASS);return 0<a.length?a.attr("id"):null}function c(a){a=b("#"+a).find("[id^\x3d"+f.SD_MDW_SLOT_CONTAINER_WIDGET_PREFIX+"]");if(!a&&!a.attr("id"))return null;a=a.attr("id");return(a=e.state(a))&&
a.selectedSlot&&a.selectedSlot.id?a.selectedSlot.id:null}function d(){return"1"===b("meta[name\x3dRCX_CHECKOUT_SD_GOLDEN_CX_DESKTOP_SPC]").attr("content")}var b=e.$,n={},u=function(){n={};h.isMobile()?b("div.selectable-box input[type\x3d'radio']:checked").each(function(){var a=b(this),l=a.closest("div.selectable-box");(l=k(l))&&(n[a.attr("name")]=l)}):b("div.fake-label input[type\x3d'radio']:checked").each(function(){var a=b(this),l=a.closest("div.fake-label");(l=k(l))&&(n[a.attr("name")]=l)})};e.on("checkout:reload:shipoptionselect",
u);e.on("checkout:reload:spp-revieworder",u);h.isSosp()&&u();var t=!1;b(document).delegate(".ship-option.is-scheduled-delivery","mousedown",function(a){d()&&(t=b(a.currentTarget).find("input[type\x3d'radio']").is(":checked"))});b(document).delegate(".ship-option.is-scheduled-delivery","click",function(a){if(h.isSpc()){var l=b(a.target);if(!l.closest("a").hasClass("slot-container-expander-heading")){a=b(a.currentTarget);var c=a.find("input[type\x3d'radio']");if(!(d()&&l.closest("a").hasClass("sd-ship-option-selection-change")||
c.attr("disabled"))){c.is(":checked")||c.attr("checked",!0);if(d()){if(t)return;c.closest(".shipping-speed").addClass("selected");var f;a:{if((f=a.find(".a-declarative"))&&(f=f.data("a-modal"))&&f.data&&(f=f.data,f.hasOwnProperty("widgetIndex"))){f=f.widgetIndex;break a}f=null}if(f){e.trigger("scheduled-delivery-ship-option-selected",c,f);return}}l.closest("li").hasClass("slot-container-slot-item")||(l=k(a))&&e.trigger("slot-selected-update-sdi",l)}}}});b(document).delegate("div.fake-label","click",
function(a){h.isSosp()&&!h.isMobile()&&m(a)});b(document).delegate("div.selectable-box","click",function(a){h.isSosp()&&h.isMobile()&&m(a)});e.on("scheduled-delivery-mdw:ship-option-changed",function(a){var b=a.current;a=a.previous;b&&b!==a&&e.trigger("scheduled-delivery-mdw:ship-option-selected",b);a&&b!==a&&e.trigger("scheduled-delivery-mdw:ship-option-deselected",a)});e.on("scheduled-delivery-mdw:ship-option-selected",function(a){(a=c(a))&&e.trigger("scheduled-delivery-mdw:select-slot",a)});e.on("scheduled-delivery-mdw:ship-option-deselected",
function(a){(a=c(a))&&e.trigger("scheduled-delivery-mdw:deselect-slot",a)});return{disableShipOption:function(a,l){var c;a=b("#"+a);if(0!==a.length){if(h.isSpc())a=a.closest(".shipping-speed");else if(h.isSosp())a=h.isMobile()?a.closest("div.selectable-box.scheduled-delivery.a-box"):a.closest("div.fake-label.a-box");else return;c=a.find("input[type\x3d'radio']");c.attr("disabled",!0);c.is(":checked")&&l&&(l=b("input[name\x3d"+c.attr("name")+"]:radio:not(:disabled):first"),l.prop("checked",!0),l.trigger("change"));
a.addClass("sd-ship-option-disabled");d()&&(l=a.find(".sd-ship-option-selection-change"),0!==l.length&&l.hide())}},disableMdwShipOption:function(a){a=b("#"+a);if(0!==a.length){if(h.isSpc())a=a.closest(".shipping-speed");else if(h.isSosp())a=h.isMobile()?a.closest("div.selectable-box.a-box"):a.closest("div.fake-label.a-box");else return;var c=a.find("input[type\x3d'radio']");c.attr("disabled",!0);c.is(":checked")&&(c=b("input[name\x3d"+c.attr("name")+"]:radio:not(:disabled):first"),c.prop("checked",
!0),c.trigger("change"));a.addClass("sd-ship-option-disabled")}}}});"use strict";q.when("A","page-detector","button-blocker","client-side-metrics").register("SDButtonBlockerController",function(e,h,f,m){function k(a,l){b[a]!==C&&b[a].state!==l&&(b[a].state=l,c())}function c(){var a;d.each(b,function(b,c){a=c.owner;if(c.state===t.DISABLE_CONTINUE)return f.show(a,u),n||(m.increaseCount("removeauijs12"),d(".continue-button-blocker").css("display","inline-block")),!1;f.hide(a)})}var d=e.$,b={},n=v.P&&
v.P.AUI_BUILD_DATE,u="Please choose a time for your order",t={ENABLE_CONTINUE:"enableContinue",DISABLE_CONTINUE:"disableContinue"};e.on("checkout:beforeReload",function(){b={}});return{disableContinue:function(a,l){b[l]===C&&(b[l]!==C||(b[l]={state:t.ENABLE_CONTINUE,owner:a,toolTipMessage:u}),c());k(l,t.DISABLE_CONTINUE)},enableContinue:function(a){b[a]!==C&&k(a,t.ENABLE_CONTINUE)},setTooltipMessage:function(a){a&&(u=a)}}});"use strict";q.when("A").register("SDUpsellMessagePrefixConfig",function(e){return{prefixType:"COLON"}});
"use strict";q.when("A","CalendarWidget","SDWidgetsConstants","SDButtonBlockerController","sdLogger","SDShadowWidgetsHub","SDUpsellMessagePrefixConfig","DWPConfig","DWPWidgetsManager","page-detector","a-popover-base","ready").register("SDCalendarWidget",function(e,h,f,m,k,c,d,b,n,u,t){function a(a){e.on("active-shipment-changed",function(){r(a)});v.history&&g(v).bind("popstate",function(){r(a)});e.on("Shipping::ShipSpeed::Change",function(b){b.shipSpeedType&&"scheduledDelivery"===b.shipSpeedType?
r(a):m.enableContinue(a)})}function l(a,b){var c=b.slot;b&&(g("[name\x3dSD-OrderID-"+a+"]").val(b.trimmedOrderId),g("[name\x3dSD-SlotQuality-"+a+"]").val(b.slotQuality),g("[name\x3dSD-SlotQualityDetail-"+a+"]").val(b.slotQualityDetail));c&&(g("[name\x3dSD-SlotID-"+a+"]").val(c.srsIds),g("[name\x3dSD-ResID-"+a+"]").val(c.reservationId),g("[name\x3dSD-ResType-"+a+"]").val(c.reservationType),g("[name\x3dSD-Carriers-"+a+"]").val(c.carriers),g("[name\x3dSD-StartTime-"+a+"]").val(c.startTimeUTC),g("[name\x3dSD-EndTime-"+
a+"]").val(c.endTimeUTC),g("[name\x3dSD-CutoffTime-"+a+"]").val(c.cutOffTimeLocalTimezone),g("[name\x3dSD-Cutoff-"+a+"]").val(c.cutOffTimeUTC),g("[name\x3dSD-WindowTZ-"+a+"]").val(c.shortTimezone),g("[name\x3dSD-CutoffTZ-"+a+"]").val(c.shortTimezone),g("[name\x3dSD-SlotLongTZ-"+a+"]").val(c.longTimezone),g("[name\x3dD_MinShipDtUTC-"+a+"]").val(c.minShipDate),g("[name\x3dD_MaxShipDtUTC-"+a+"]").val(c.maxShipDate),g("[name\x3dSD-SlotStartLTZ-"+a+"]").val(c.startTimeLocalTimezone),g("[name\x3dSD-SlotEndLTZ-"+
a+"]").val(c.endTimeLocalTimezone),g("[name\x3dSD-Date-"+a+"]").val(c.startTimeLocalTimezone),g("[name\x3dSD-PromiseLFSS-"+a+"]").val(c.fss))}function G(a){if(a&&a.hasOwnProperty("popover")&&(p=a.popover,p.data&&p.data.widgetIndex)){a=f.SD_CALENDAR_WIDGET_PREFIX+p.data.widgetIndex;m.disableContinue(f.CONTINUE_BUTTON_OWNER,a);var b=M[a];if(b&&null!==b){var c={};c.widgetId=a;c.dateId=null;c.slotId=null;c.currentDatePage=0;var g=e.state(a);g.currentSelection=c;e.state(a,g);g.currentSelection=b;e.state(a,
g)}}}function O(a){a&&a.hasOwnProperty("popover")&&p&&(p.data||p.data.widgetIndex)&&m.enableContinue(f.SD_CALENDAR_WIDGET_PREFIX+p.data.widgetIndex)}function I(a){a=e.state(a);return a&&null!==a?(a=a.currentSelection)&&null!==a?a:null:null}function A(a){var b=g("#"+a).find('script[type\x3d"a-state"]');a=e.state(a);b.html(JSON.stringify(a))}var g=e.$,M={},x,p,r=function(a){g("#"+a).is(":visible")?h.isSlotSelected(a)?m.enableContinue(a):m.disableContinue(f.CONTINUE_BUTTON_OWNER,a):m.enableContinue(a)},
q=function(a,b){(a=h.getSelectedSlot(a))&&null!==a&&(a=a.fullDateLabel)&&null!==a&&""!==a&&(u.isSpc()?g("."+f.SD_UPSELL_MESSAGE_PREFIX+b).html(a):(b=g("#"+f.SD_WIDGETS_PREFIX+b).parent())&&null!==b&&(b=b.find(".upsell-messaging"))&&null!==b&&("HYPHEN"===d.prefixType?b.html(f.UPSELL_MESSAGE_PREFIX_HYPHEN+a):"DASH"===d.prefixType?b.html(f.UPSELL_MESSAGE_PREFIX_DASH+a):b.html(f.UPSELL_MESSAGE_PREFIX_COLON+a)))};e.on("calendar_widget_date_selected",function(a){r(a.widgetId);u.isSpc()&&g(".sd-calendar-save-and-continue").addClass("a-button-disabled")});
e.on("calendar_widget_slot_selected",function(a){if(u.isSpc())x=a,g(".sd-calendar-save-and-continue").removeClass("a-button-disabled");else{var b=a.metadata;if(b){var b=JSON.parse(b),e=b.widgetIndex;if(c.enabled()&&c.isShadowWidget(e)){var f=c.getMainWidgetInfo(e);f&&f.widgetIndex&&l(f.widgetIndex,b)}else l(e,b)}q(a.widgetId,e);r(a.widgetId)}});e.declarative("scheduled-delivery-modal-calendar-save","click",function(a){if(!a.$currentTarget.find(".sd-calendar-save-and-continue").hasClass("a-button-disabled")){var b=
x.metadata;a=x.widgetId;var f,d;if(b)if(b=JSON.parse(b),d=b.widgetIndex,f=g("#sd-option-td-"+d).closest(".shipping-speed").find("input[type\x3d'radio']"),c.enabled()&&c.isShadowWidget(d)){var n=c.getMainWidgetInfo(d);n&&n.widgetIndex&&l(n.widgetIndex,b)}else l(d,b);A(a);M[a]=I(a);p&&t.hide(p.id);e.trigger("scheduled-delivery-ship-option-selected",f,d)}});e.on("scheduled-delivery-ship-option-selected",function(a,b){b=f.SD_WIDGETS_PREFIX+b;var c={};g("#"+b+" input[type\x3dhidden]").each(function(){var a=
g(this),b=a.attr("key"),a=a.attr("value");b&&(c[b]=a)});v.spcpage.scheduledDeliverySetSOCallbackWithTarget(a,c,b)});return{createWidget:function(c,d,t){h.createWidget(f.CALENDAR_AJAX_CALL_URL,d,function(t){var p=d.widgetId;g(f.SD_WIDGETS_SPINNER_PREFIX+c).addClass("aok-hidden");g("#"+p).replaceWith(t.payload);g("#"+p).addClass("hide-if-not-selected");h.enableWidgetActions(p);if(u.isSpc()){m.disableContinue(f.CONTINUE_BUTTON_OWNER,p);M[p]=I(p);t=h.getSelectedSlot(p);l(c,JSON.parse(t.metadata));A(p);
t="a:popover:show:"+f.SD_WIDGETS_POPOVER_NAME_PREFIX+c;var x="a:popover:hide:"+f.SD_WIDGETS_POPOVER_NAME_PREFIX+c;e.off(t,G);e.off(x,O);e.on(t,G);e.on(x,O)}r(p);a(p);q(p,c);b.enabled&&n.registerDeliveryWindowPreferenceWidget(p,c);k.logMetric(f.SD_CALENDAR_WIDGET_RENDER_SUCCESS_METRIC,1)},function(a){k.logException(a,"Got an error while trying to create Calendar Widget");k.logMetric(f.SD_CALENDAR_WIDGET_RENDER_ERROR_METRIC,1);t(a)})},hide:function(a){g("#"+a).hide();b.enabled&&n.disable(a)}}});"use strict";
q.when("A","CalendarWidget","shipspeed-helper","SDWidgetsConstants","sdLogger","ready").register("SDSlotChangeVASNotifier",function(e,h,f,m,k){function c(b){try{var c;var h=d("#"+m.SD_WIDGETS_PREFIX+b.widgetIndex).parent();if(h&&null!==h){var t=h.find('[data-speed-type\x3d"scheduled-delivery"]');c=t&&0<t.length?t[0]:void 0}else c=void 0;if(c){var a,l,G;l=(c.getAttribute("name")||"").match(/\d+/gi);null!==l&&0<l.length&&(G=l[0]);a=G;if(!a)k.logMetric(m.SD_CALENDAR_WIDGET_NO_VAS_SHIP_GROUP_ID,1);else if(!d.isEmptyObject(b)){var O,
I=f.getShipSpeedDataByGroupId(a),A={slotQuality:b.slotQuality},g=b.slot,M;if(null!==g){A.slotStartTimeEpoch=g.startTimeLocalTimezone;A.slotEndTimeEpoch=g.endTimeLocalTimezone;A.timeZone=g.longTimezone;var x=g.srsIds;M=x&&0<x.length?x[0]+"_SELECT":void 0}O=d.extend({},{eventId:M,selectedSlotDetails:A},I);e.trigger("Shipping::ScheduledDelivery::Change",O)}}}catch(p){k.logException(p,"Got an error when trying to trigger an sd slot change notification event"),k.logMetric(m.SD_CALENDAR_WIDGET_SLOT_CHANGE_TRIGGER_ERROR_METRIC,
1)}}var d=e.$;e.on("calendar_widget_date_selected",function(b){if(b=h.getFirstSlotForDate(b.dateId,b.widgetId))b=JSON.parse(b.metadata),c(b)});e.on("calendar_widget_slot_selected",function(b){if(b=b.metadata)b=JSON.parse(b),c(b)})});"use strict";q.when("A","SlotContainerWidget","SDWidgetsConstants","SDButtonBlockerController","SDShipOptionHandler","sdLogger","ready").register("SDSlotContainerWidget",function(e,h,f,m,k,c){function d(c){e.on("active-shipment-changed",function(){n(c)});v.history&&b(v).bind("popstate",
function(){n(c)});e.on("Shipping::ShipSpeed::Change",function(a){a.shipSpeedType&&"scheduledDelivery"===a.shipSpeedType?n(c):m.enableContinue(c)})}var b=e.$,n=function(b){h.isSlotSelected(b)?m.enableContinue(b):m.disableContinue(f.CONTINUE_BUTTON_OWNER,b)},u=function(c,a){b(f.SD_NOT_AVAILABLE_ID_PREFIX+c).removeClass(f.AOK_HIDDEN);b(f.SD_WIDGETS_SPINNER_PREFIX+c).addClass(f.AOK_HIDDEN);b("#"+a).hide();m.enableContinue(a);k.disableMdwShipOption(f.SLOT_CONTAINER_WIDGET_ROOT_PREFIX+c)};e.on("slot-container-slot-selected",
function(c){var a=c.metadata;if(a){var l=c.pageType,d=a.widgetId;if(a=a.slot){b("[name\x3dSDV1-ResID-"+d+"]").val(a.reservationId);b("[name\x3dSDV1-startDeliveryTime-"+d+"]").val(a.startTimeUTC);b("[name\x3dSDV1-endDeliveryTime-"+d+"]").val(a.endTimeUTC);var n=b("[name\x3dSDV1-isMdwLatencyClawbackEnabled-"+d+"]");n&&"1"===n.val()&&(b("[name\x3dSDV1-carrierSet-"+d+"]").val(a.carrierSet),b("[name\x3dSDV1-promiseFulfillmentServiceSubclass-"+d+"]").val(a.promiseFulfillmentServiceSubclass),b("[name\x3dSDV1-promiseMaxShipmentDate-"+
d+"]").val(a.promiseMaxShipmentDate),b("[name\x3dSDV1-promiseMinShipmentDate-"+d+"]").val(a.promiseMinShipmentDate))}l===f.SINGLE_PAGE_CHECKOUT&&e.trigger("slot-container-slot-selected-on-spc",c)}});return{createWidget:function(e,a,l){var G=function(a){b(f.SD_WIDGETS_SPINNER_PREFIX+e).addClass(f.AOK_HIDDEN);b("#"+l).replaceWith(a.payload);h.enableWidgetActions(l);n(l);d(l);c.logMetric(f.SD_SLOT_CONTAINER_WIDGET_RENDER_SUCCESS_METRIC,1)},k=function(d){if(a&&a.selectedSlotUpsellMessage){var g=a.selectedSlotUpsellMessage;
b(f.SD_WIDGETS_SPINNER_PREFIX+e).addClass(f.AOK_HIDDEN);var n=b("#"+l);n.addClass(f.AOK_HIDDEN);n.closest(f.SD_MDW_WIDGET_ROOT_CLASS).parent().find(f.UPSELL_MESSAGE_CLASS).html(g);m.enableContinue(l)}else u(e,l),c.logMetric(f.SD_MDW_DISABLE_SHIP_OPTION_METRIC,1);c.logException(d,"Got an error while trying to create slot container widget");c.logMetric(f.SD_SLOT_CONTAINER_WIDGET_RENDER_ERROR_METRIC,1)},I=a&&a.scheduleSlots&&a.scheduleSlots.availableSlots;I&&0<I.length?h.createWidget(f.SLOT_CONTAINER_AJAX_CALL_URL,
a,G,k):(u(e,l),c.logMetric(f.SD_SLOT_CONTAINER_WIDGET_NO_SLOTS_METRIC,1))}}});"use strict";q.when("A","CalendarWidget","SDWidgetsConstants","SDUpsellMessagePrefixConfig","page-detector").register("SDCalendarUtils",function(e,h,f,m,k){function c(c,d){if(k.isSpc())return b("."+f.SD_UPSELL_MESSAGE_PREFIX+d);if(c=b("#"+f.SD_WIDGETS_PREFIX+d).parent())return c.find(".upsell-messaging")}function d(b,d,e){var a=3<arguments.length&&arguments[3]!==C?arguments[3]:!1,l=c(b,d);if(l&&l.length)if(k.isSpc())l.html(e);
else{var h="";a||(h="HYPHEN"===m.prefixType?f.UPSELL_MESSAGE_PREFIX_HYPHEN:"DASH"===m.prefixType?f.UPSELL_MESSAGE_PREFIX_DASH:f.UPSELL_MESSAGE_PREFIX_COLON);l.html(h+e)}}var b=e.$;return{updateUpsellMessage:d,appendUpsellMessage:function(b,e,f){var a=c(b,e);a&&a.length&&d(b,e,a.html()+"\x3cbr /\x3e"+f,!0)}}});"use strict";q.when("A").register("DWPConfig",function(e){return{enabled:!1}});"use strict";var J=function(){function e(e,f){for(var m=0;m<f.length;m++){var k=f[m];k.enumerable=k.enumerable||
!1;k.configurable=!0;"value"in k&&(k.writable=!0);Object.defineProperty(e,k.key,k)}}return function(h,f,m){f&&e(h.prototype,f);m&&e(h,m);return h}}();q.when("A","DeliveryWindowPreferenceWidget","DeliveryWindowPreferenceService","DeliveryWindowPreferenceModel","DeliveryWindowPreferenceView","CalendarWidget","SDCalendarUtils","SDWidgetsConstants","sdLogger","DWPInteractionLogger").register("DWPWidgetsManager",function(e,h,f,m,k,c,d,b,n,u){return new (function(){function k(){z(this,k);this._dwpWidgetRegistry=
{};this._addressIdToWidgetIds={};this._eventsEnabled=!1;this._dwpLogger=new u}J(k,[{key:"registerDeliveryWindowPreferenceWidget",value:function(a,l){this.disable(a);var d=this._initializeAndRegisterWidget(a,l);if(d){var e=c.getSelectedSlot(a),e=k._formatTimeRange(e);d.updateCurrentDeliveryWindow(e);this._dwpLogger.registerAddressId(d.addressId);d.dwp.preferredDeliveryWindow&&(this._dwpLogger.logInteraction(d.addressId,u.Interactions().hadPreferenceInitially),d.setBottomSheetTimeLabel(h.deliveryWindowString(e)));
this._showAdditionalMessagesOnLoad(a,l);d.show();this._eventsEnabled||(this._bindEvents(),this._eventsEnabled=!0);n.logMetric(b.DWP_LOADED_METRIC,1)}else n.logMetric(b.DWP_LOAD_ERROR,1)}},{key:"disable",value:function(a){var b=this.getDWPWidget(a);b&&b.hide();delete this._dwpWidgetRegistry[a];for(var c in this._addressIdToWidgetIds)this._addressIdToWidgetIds[c]=this._addressIdToWidgetIds[c].filter(function(b){return b!==a})}},{key:"getDWPWidget",value:function(a){return this._dwpWidgetRegistry[a]}},
{key:"getWidgetsForAddress",value:function(a){var b=this;a=this._addressIdToWidgetIds[a];return Array.isArray(a)?a.map(function(a){return b.getDWPWidget(a)}):[]}},{key:"_initializeAndRegisterWidget",value:function(a,c){var d=f.getDWP(a);if(!d)return n.logMetric(b.DWP_PAGE_STATE_NOT_FOUND,1),null;c=new h(a,c,d);this._dwpWidgetRegistry[a]=c;d=d.addressId;Array.isArray(this._addressIdToWidgetIds[d])||(this._addressIdToWidgetIds[d]=[]);this._addressIdToWidgetIds[d].push(a);return c}},{key:"_showAdditionalMessagesOnLoad",
value:function(a,c){var e=f.getDWPPageState(a);e.additionalMessage&&(d.appendUpsellMessage(a,c,e.additionalMessage),n.logMetric(b.DWP_PDW_SLOT_NOT_FOUND,1))}},{key:"_bindEvents",value:function(){var a=this;e.on("calendar_widget_date_selected",function(b){return a._handleDateSelectionChange(b)});e.on("calendar_widget_slot_selected",function(b){return a._handleSlotSelectionChange(b)});e.on("sd-dwp-preference-changed",function(b){return a._handlePreferenceChangedNotification(b)})}},{key:"_handleDateSelectionChange",
value:function(a){var d=a.widgetId,f=a.dateId;if(d&&f){var h=this.getDWPWidget(d),m=h.dwp.preferredDeliveryWindow;h&&m&&(h=k._findCalendarSlot(d,m,f),h||(h=c.getFirstSlotForDate(a.dateId,d),n.logMetric(b.DWP_PDW_SLOT_NOT_FOUND,1)),e.trigger("a:declarative:slot-selected:click",{data:{widgetId:d,dateId:f,slotId:h.id}}))}}},{key:"_handleSlotSelectionChange",value:function(a){var b=a.widgetId,d=a.slotId;b&&d&&(a=this.getDWPWidget(b),b=c.getSlotById(d,b)||c.getSelectedSlot(b),a&&b&&(b=k._formatTimeRange(b),
a.dwp.preferredDeliveryWindow&&(d=a.dwp.isSamePreferredDeliveryWindow(b)?u.Interactions().optBackIntoPreferredTime:u.Interactions().optOutOfPreferredTime,this._dwpLogger.logInteraction(a.addressId,d),this._dwpLogger.logInteraction(a.addressId,u.Interactions().customerInteracted)),a.updateCurrentDeliveryWindow(b)))}},{key:"_handlePreferenceChangedNotification",value:function(a){var c=this,d=a.dwp,e=d.addressId,k=a.currentDW,A=this.getWidgetsForAddress(e);A.forEach(function(a){return a.setEnabled(!1)});
f.saveDWP(b.DELIVERY_WINDOW_PREFERENCE_AJAX_CALL_URL,d,function(a){var d=a.dwp,m=void 0;d.preferredDeliveryWindow?(m=!0,c._dwpLogger.logInteraction(e,u.Interactions().optIn)):(m=!1,c._dwpLogger.logInteraction(e,u.Interactions().optOut));c._dwpLogger.logInteraction(e,u.Interactions().customerInteracted);A.forEach(function(a){a.dwp=d;f.saveDWPPrefToPageState(a.calendarWidgetId,d);m?a.setBottomSheetTimeLabel(h.deliveryWindowString(k)):a.setBottomSheetTimeLabel(h.blankTimeLabel());a.setCheckboxState(a.dwp.isSamePreferredDeliveryWindow(a.currentDW));
a.setEnabled(!0)});n.logMetric(b.DWP_SAVE_PREFERENCE_METRIC,1)},function(a){A.forEach(function(a){return a.setEnabled(!0)});n.logMetric(b.DWP_SAVE_PREFERENCE_ERROR,1);n.logException(a,"AJAX call to saving PDW failed",b.DWP_WIDGET_NAME)})}}],[{key:"_formatTimeRange",value:function(a){var b=JSON.parse(a.metadata).slot,c=parseInt(b.startTimeUTC),b=parseInt(b.endTimeUTC),c=new Date(1E3*c),b=new Date(1E3*b),c=c.getUTCHours().toString().padStart(2,"0")+":"+c.getUTCMinutes().toString().padStart(2,"0"),b=
b.getUTCHours().toString().padStart(2,"0")+":"+b.getUTCMinutes().toString().padStart(2,"0");return{startTime:c,endTime:b,startTimeDisplay:a.timeRange.startTime,endTimeDisplay:a.timeRange.endTime,separator:a.timeRange.separator}}},{key:"_findCalendarSlot",value:function(a,b,c){var d=b.startTime,f=b.endTime;a=e.state(a).dates.filter(function(a){return a.id===c})[0];return a?(a=a.slots.filter(function(a){a=k._formatTimeRange(a);return a.startTime===d&&a.endTime===f})[0])?a:null:null}}]);return k}())});
"use strict";J=function(){function e(e,f){for(var m=0;m<f.length;m++){var k=f[m];k.enumerable=k.enumerable||!1;k.configurable=!0;"value"in k&&(k.writable=!0);Object.defineProperty(e,k.key,k)}}return function(h,f,m){f&&e(h.prototype,f);m&&e(h,m);return h}}();q.when("A","page-detector","SDWidgetsConstants","sdLogger").register("DWPInteractionLogger",function(e,h,f,m){return function(){function k(){z(this,k);this._interactionHistoryByAddressId={}}J(k,null,[{key:"Interactions",value:function(){return{hadPreferenceInitially:"hadPreferenceInitially",
customerInteracted:f.DWP_CUSTOMER_INTERACTED_METRIC,optIn:f.DWP_CUSTOMER_OPT_IN_METRIC,optOut:f.DWP_CUSTOMER_OPT_OUT_METRIC,optOutOfPreferredTime:f.DWP_CUSTOMER_OPT_OUT_OF_PREFERRED_TIME_METRIC,optBackIntoPreferredTime:"optBackIntoPreferredTime"}}}]);J(k,[{key:"registerAddressId",value:function(c){this._interactionHistoryByAddressId[c]||(this._interactionHistoryByAddressId[c]=[]);this._bindEvents()}},{key:"logInteraction",value:function(c,d){this._interactionHistoryByAddressId[c]&&this._interactionHistoryByAddressId[c].push(d)}},
{key:"getInteractionsForAddressId",value:function(c){return this._interactionHistoryByAddressId[c]||[]}},{key:"clearLogs",value:function(){this._interactionHistoryByAddressId={}}},{key:"calculateInteractionsToLog",value:function(c){var d=k.Interactions(),b=this.getInteractionsForAddressId(c),e=0,f=0,h=0,a=0;b.forEach(function(b){switch(b){case d.hadPreferenceInitially:e++;break;case d.customerInteracted:f++;break;case d.optIn:h++;break;case d.optOut:a++}});c=0<h-a;var l=0<a-h,b=!l&&!(c||b.lastIndexOf(d.optOutOfPreferredTime)<
b.lastIndexOf(d.optIn))&&b.lastIndexOf(d.optOutOfPreferredTime)>b.lastIndexOf(d.optBackIntoPreferredTime),m={};if(!(0<e)||c||l||b)m[d.customerInteracted]=0<f?1:0;c&&(m[d.optIn]=1);l&&(m[d.optOut]=1);b&&(m[d.optOutOfPreferredTime]=1);return m}},{key:"logMetricsToCSM",value:function(){for(var c in this._interactionHistoryByAddressId){var d=this.calculateInteractionsToLog(c),b;for(b in d)m.logMetric(b,d[b])}this.clearLogs()}},{key:"_bindEvents",value:function(){var c=this,d=void 0;h.isMobile()&&h.isSosp()?
d=e.$(".continue-button.sosp-continue-button"):!h.isMobile()&&h.isSpc()&&(d=e.$("#placeYourOrder"));d&&d.bind("click",function(b){return c.logMetricsToCSM(b)})}}]);return k}()});"use strict";q.when("A","ServicesWidget","SDWidgetsConstants","sdLogger","ready").register("SDServicesWidget",function(e,h,f,m){var k=e.$;return{createWidget:function(c){h.createWidget(c,function(d){var b=c.widgetId;k("#"+b).replaceWith(d.payload);k("#"+b).addClass("hide-if-not-selected")},function(c){m.logException(c,"Got an error while trying to create Service Widget");
m.logMetric(f.SD_SERVICE_WIDGET_RENDER_ERROR_METRIC,1)})},hide:function(c){k("#"+c).hide()}}});"use strict";q.when("A").register("SDShadowConfig",function(e){return{enabled:!1}});"use strict";q.when("A","SDWidgetsConstants","sdLogger").register("SDShadowInputTransformer",function(e,h,f){var m=[function(c,d,b){b.widgetIndex=c;b.calendarInput&&(b.calendarInput.widgetId=d.calendarWidgetId);b.servicesInput&&(b.servicesInput.widgetId=d.servicesWidgetId);return b},function(c,d,b){b.calendarInput&&b.calendarInput.slots&&
0<b.calendarInput.slots.length&&e.each(b.calendarInput.slots,function(b){if(b.metadata){var d=JSON.parse(b.metadata);d.widgetIndex=c;b.metadata=JSON.stringify(d)}});return b},function(c,d,b){b.servicesInput&&b.servicesInput.services&&0<b.servicesInput.services.length&&e.each(b.servicesInput.services,function(b){if(b.metadata){var e=JSON.parse(b.metadata);e.widgetIndex=c;e.calendarWidgetId=d.calendarWidgetId;e.servicesWidgetId=d.servicesWidgetId;b.metadata=JSON.stringify(e)}});return b}],k={A1VC38T7YXB528:[function(c,
d,b){b.calendarInput&&b.calendarInput.slots&&0<b.calendarInput.slots.length&&e.each(b.calendarInput.slots,function(b){b.price=0});return b}]};return{transform:function(c,d,b){var f=e.$.extend(!0,{},b);e.each(m,function(b){f=b(c,d,f)});b=d.marketplace;b in k&&e.each(k[b],function(b){f=b(c,d,f)});return f}}});"use strict";q.when("A","SDWidgetsConstants","sdLogger","SDShadowInputTransformer","SDShadowConfig").register("SDShadowWidgetsHub",function(e,h,f,m,k){var c={},d={};e.on("sd_widget_input_loaded",
function(b,d){e.each(c,function(c,f){c.mainWidgetIndex===b&&e.trigger("sd_shadow_widget_input_loaded",f,d)})});e.on("sd_shadow_widget_input_loaded",function(b,e){var k=c[b];if(k&&b in d){var t=d[b];t&&(b=m.transform(b,k,e),t(b),f.logMetric(h.SD_SHADOW_LOAD_METRIC,1))}});return{enabled:function(){return k.enabled},registerShadowWidget:function(b,e,k){b in c||(c[b]=e,d[b]=k,f.logMetric(h.SD_SHADOW_REGISTER_METRIC,1))},isShadowWidget:function(b){return b in c},getShadowWidgetInfo:function(b){var d=null;
e.each(c,function(c,e){d||c.mainWidgetIndex===b&&(d={widgetIndex:e,calendarWidgetId:c.calendarWidgetId,servicesWidgetId:c.servicesWidgetId})});return d},getMainWidgetInfo:function(b){if(!(b in c))return null;b=c[b];return{widgetIndex:b.mainWidgetIndex,calendarWidgetId:b.mainCalendarWidgetId,servicesWidgetId:b.mainServicesWidgetId}},processShadowCalendarInput:function(b,d){return b in c?m.transform(b,c[b],d):d}}});"use strict";q.when("A","GoldenCxRapServiceIntegration","SDCalendarWidget","SDServicesWidget",
"SDShipOptionHandler","SDWidgetsConstants","sdLogger","SDButtonBlockerController","SDShadowWidgetsHub","page-detector","ready").register("ScheduledDeliveryWidgets",function(e,h,f,m,k,c,d,b,n,u){function t(){return"1"===l("meta[name\x3dRCX_CHECKOUT_SD_GOLDEN_CX_DESKTOP_SPC]").attr("content")}function a(a,b){if(b&&b.start&&b.end){var c=parseInt(b.start),d=parseInt(b.end);for(b=0;b<a.length;b++){var e=a[b];if(e.startTime===c&&e.endTime===d)return a[b].isDefault=!0,a}}for(b=c=0;b<a.length;b++)a[b].startTime<
a[c].startTime?c=b:a[b].startTime===a[c].startTime&&a[b].endTime<a[c].endTime&&(c=b);a[c].isDefault=!0;return a}var l=e.$,q=function A(a,d,e){l(c.SD_NOT_AVAILABLE_ID_PREFIX+a).removeClass("aok-hidden");l(c.SD_NOTE_ID_PREFIX+a).addClass("aok-hidden");l(c.SD_CHANGE_LINK_ID_PREFIX+a).addClass("aok-hidden");l(c.SD_WIDGETS_SPINNER_PREFIX+a).addClass("aok-hidden");m.hide(e);f.hide(d);b.enableContinue(d);k.disableShipOption(c.SD_WIDGETS_PREFIX+a,!0);n.enabled()&&!n.isShadowWidget(a)&&(a=n.getShadowWidgetInfo(a))&&
A(a.widgetIndex,a.calendarWidgetId,a.servicesWidgetId)},v=function(a){f.createWidget(a.widgetIndex,a.calendarInput,function(b){q(a.widgetIndex,a.calendarWidgetId,a.servicesWidgetId)})};e.on("sd_load_information",function(f,g,k,x){d.logMetric(c.SD_WIDGET_LOAD_INFORMATION_METRIC,1);var p,r,z,J,L;b.setTooltipMessage(g.tooltipMessage);g.isSelected&&1===g.isSelected&&b.disableContinue(c.CONTINUE_BUTTON_OWNER,k);var H=function(a){d.logException(JSON.stringify(a),"Got an error while trying to load SD widgets");
d.logMetric(c.SD_WIDGET_LOAD_ERROR_METRIC,1);a.type&&d.logMetric(a.type,1);q(f,k,x)},U=function(){function a(b,c){var d=JSON.parse(c.metadata).slot.reservationId.split(";"),e;3<=d.length&&(e=d[2]);b[""+c.startTime+c.endTime]=e}function b(a,c){a=a.split("^");c=c.split("^");return 3===a.length&&3===c.length&&parseFloat(a[0])===parseFloat(c[0])&&parseFloat(a[1])===parseFloat(c[1])&&a[2]===c[2]?1:0}d.logMetric(c.SD_WIDGET_SHADOW_COMPARISON_METRIC,1);var e=0;r&&r.calendarInput&&r.calendarInput.slots&&
0!==r.calendarInput.slots.length&&(e=1);var f=0;p&&p.calendarInput&&p.calendarInput.slots&&0!==p.calendarInput.slots.length&&(f=1);if(f||e)if(f&&!e)d.logMetric(c.SD_WIDGET_SHADOW_ONLY_HAS_GVDGO_SLOTS_METRIC,1);else if(!f&&e)d.logMetric(c.SD_WIDGET_SHADOW_ONLY_HAS_RAP_SLOTS_METRIC,1);else{d.logMetric(c.SD_WIDGET_SHADOW_BOTH_SLOTS_EXIST_METRIC,1);var e={},f={},g=""+r.calendarInput.slots[0].startTime+r.calendarInput.slots[0].endTime,h=""+p.calendarInput.slots[0].startTime+p.calendarInput.slots[0].endTime;
if("HB"===z)for(var k=0;k<r.calendarInput.slots.length;k++)a(e,r.calendarInput.slots[k]);else if("SP"===z)for(var l=r.calendarInput.slots[0].startTime+691200,k=0;k<r.calendarInput.slots.length;k++)r.calendarInput.slots[k].startTime<l&&a(e,r.calendarInput.slots[k]);for(k=0;k<p.calendarInput.slots.length;k++)a(f,p.calendarInput.slots[k]);g!==h&&d.logMetric(c.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_METRIC,1);b(e[g],f[h])||d.logMetric(c.SD_WIDGET_SHADOW_SLOTS_FADD_PRICE_MISMATCH_METRIC,1);r.calendarInput.slots[0].startTime<
p.calendarInput.slots[0].startTime?d.logMetric(c.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_START_LATE_METRIC,p.calendarInput.slots[0].startTime-r.calendarInput.slots[0].startTime):r.calendarInput.slots[0].startTime>p.calendarInput.slots[0].startTime&&d.logMetric(c.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_START_EARLY_METRIC,r.calendarInput.slots[0].startTime-p.calendarInput.slots[0].startTime);r.calendarInput.slots[0].endTime<p.calendarInput.slots[0].endTime?d.logMetric(c.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_END_LATE_METRIC,
p.calendarInput.slots[0].endTime-r.calendarInput.slots[0].endTime):r.calendarInput.slots[0].endTime>p.calendarInput.slots[0].endTime&&d.logMetric(c.SD_WIDGET_SHADOW_SLOTS_FADD_TIME_MISMATCH_GVDGO_END_EARLY_METRIC,r.calendarInput.slots[0].endTime-p.calendarInput.slots[0].endTime);g=Object.keys(e).length;h=Object.keys(f).length;g!==h&&(d.logMetric(c.SD_WIDGET_SHADOW_SLOTS_LENGTH_MISMATCH_METRIC,1),10<g-h?d.logMetric(c.SD_WIDGET_SHADOW_RAP_TEN_PLUS_SLOTS_MORE_METRIC,1):5<g-h?d.logMetric(c.SD_WIDGET_SHADOW_RAP_FIVE_PLUS_SLOTS_MORE_METRIC,
1):1<g-h?d.logMetric(c.SD_WIDGET_SHADOW_RAP_ONE_PLUS_SLOTS_MORE_METRIC,1):1===g-h?d.logMetric(c.SD_WIDGET_SHADOW_RAP_ONE_SLOT_MORE_METRIC,1):10<h-g?d.logMetric(c.SD_WIDGET_SHADOW_GVDGO_TEN_PLUS_SLOTS_MORE_METRIC,1):5<h-g?d.logMetric(c.SD_WIDGET_SHADOW_GVDGO_FIVE_PLUS_SLOTS_MORE_METRIC,1):1<h-g?d.logMetric(c.SD_WIDGET_SHADOW_GVDGO_ONE_PLUS_SLOTS_MORE_METRIC,1):1===h-g&&d.logMetric(c.SD_WIDGET_SHADOW_GVDGO_ONE_SLOT_MORE_METRIC,1));for(var m in e)f.hasOwnProperty(m)?b(e[m],f[m])||d.logMetric(c.SD_WIDGET_SHADOW_SLOTS_PRICE_MISMATCH_METRIC,
1):d.logMetric(c.SD_WIDGET_SHADOW_SLOTS_TIME_MISMATCH_METRIC,1)}else d.logMetric(c.SD_WIDGET_SHADOW_BOTH_SLOTS_NOT_EXIST_METRIC,1)},S=function(a){p=a;U()},E=function(a){r=a;L.path="Rapless";h.getWidgetInputParameters(L,S,H)},T=g.shadowMode,P=function(a){if(a&&a.calendarInput&&a.calendarInput.slots&&0!==a.calendarInput.slots.length){if(v(a),a.servicesInput?m.createWidget(a.servicesInput):m.hide(x),n.enabled()&&!T){var b=l.extend(!0,{},a);e.trigger("sd_widget_input_loaded",f,b)}}else d.logMetric(c.SD_WIDGET_NO_SLOTS_METRIC,
1),q(f,k,x);J&&(r=a,L.path="Rapless",h.getWidgetInputParameters(L,S,H))};l(c.SD_CHANGE_LINK_ID_PREFIX+f).click(function(a){a.preventDefault()});if(n.enabled()&&T)g.calendarWidgetId=k,g.servicesWidgetId=x,n.registerShadowWidget(f,g,P);else{if(g.udsServiceCodes){if(-1===g.udsServiceCodes){H({type:c.SD_UDS_ERROR_MESSAGE,data:g.marketplace});b.disableContinue(c.CONTINUE_BUTTON_OWNER,k);return}for(var y=document.getElementsByName("order_"+g.trimmedOrderId+"_ShippingSpeed"),D=0;D<y.length;D++){var B=y[D];
"hidden"===B.type&&B.remove()}}y=[];for(D=0;D<g.items.length;D++){var B=g.items[D],N={itemID:D,merchantID:B.merchantid,merchantSKU:B.merchantsku,inventoryAuthorityID:B.asin,offerListingID:B.offerlistingid,fulfillmentManagerID:B.fulfillmentnetworkid,totalQuantity:B.quantity};g.isSdRaplessAsyncEnabled&&(N.lineItemId=B.lineItemId);y.push(N)}y={marketplace:g.marketplace,shipoption:g.shipoption,address:g.address,widgetIndex:f,client:"SOSP",trimmedOrderId:g.trimmedOrderId,servicesWidgetId:x,calendarWidgetId:k,
sessionId:g.sessionId,customerId:g.customerId,isPrimeCustomer:!!g.isPrimeCustomer,isSlotPreviouslySelected:!!g.selectedSlot,isAfn:g.isAfn,udsServiceCodes:g.udsServiceCodes,lineItems:y};t()&&(y.client=u.isSosp()?"SOSP":"SPC",y.selectedSlot=g.selectedSlot);if(g.isSdRaplessAsyncEnabled&&"LAUNCH"===g.isSdRaplessAsyncEnabled)d.logMetric(c.SD_WIDGET_RAPLESS_ASYNC_METRIC,1),y.path="Rapless",h.getWidgetInputParameters(y,P,H);else if(g.isSdRaplessAsyncEnabled&&"SHADOW"===g.isSdRaplessAsyncEnabled&&!g.isSdWithoutRAPFeatureEnabled)g.sdRaplessAsyncUseCase&&
(z=g.sdRaplessAsyncUseCase),L=JSON.parse(JSON.stringify(y)),J=1,h.getWidgetInputParameters(y,P,H);else if(g.isSdWithoutRAPFeatureEnabled)if(g.isSdRaplessAsyncEnabled&&"SHADOW"===g.isSdRaplessAsyncEnabled&&(g.sdRaplessAsyncUseCase&&(z=g.sdRaplessAsyncUseCase),L=JSON.parse(JSON.stringify(y)),h.getWidgetInputParameters(y,E,H)),"undefined"===typeof g.sdGoldenCXWidgetsParametersWithoutRAP.deliveryTimeZone||null===g.sdGoldenCXWidgetsParametersWithoutRAP.deliveryTimeZone||"undefined"===typeof g.sdGoldenCXWidgetsParametersWithoutRAP.availableSlots||
0===g.sdGoldenCXWidgetsParametersWithoutRAP.availableSlots.length)d.logMetric(c.SD_WIDGET_NO_GVDGO_SLOTS_METRIC,1),q(f,k,x);else{d.logMetric(c.SD_WIDGET_HAS_GVDGO_SLOTS_METRIC,1);var Q;g.sdGoldenCXWidgetsParametersWithoutRAP.shipOptionLevelPrice&&g.sdGoldenCXWidgetsParametersWithoutRAP.shipOptionLevelPrice.CurrencyCode?Q=g.sdGoldenCXWidgetsParametersWithoutRAP.shipOptionLevelPrice:d.logMetric(c.SD_WIDGET_NO_SHIPOPTION_LEVEL_PRICE_METRIC,1);D=0;E=[];B=g.sdGoldenCXWidgetsParametersWithoutRAP.deliveryTimeZone;
for(N=0;N<g.sdGoldenCXWidgetsParametersWithoutRAP.availableSlots.length;N++){var w=g.sdGoldenCXWidgetsParametersWithoutRAP.availableSlots[N],K={reservationId:w.reservationIds.join().concat(";;"),reservationType:"CASE",longTimezone:B,startTimeLocalTimezone:Number(w.slotStartTime),endTimeLocalTimezone:Number(w.slotEndTime)},F=C,R=C;w.totalItemCharge&&w.totalShipmentCharge&&w.deliveryPrice&&w.totalItemCharge.CurrencyAmount&&w.totalShipmentCharge.CurrencyAmount&&w.deliveryPrice.CurrencyAmount&&w.deliveryPrice.CurrencyCode?
(F=w.totalItemCharge.CurrencyAmount.concat("^").concat(w.totalShipmentCharge.CurrencyAmount).concat("^").concat(w.deliveryPrice.CurrencyCode),K.reservationId=K.reservationId.concat(F).concat(";"),F=Number(w.deliveryPrice.CurrencyAmount),R=w.deliveryPrice.CurrencyCode):(Q?(F="0".concat("^").concat("0").concat("^").concat(Q.CurrencyCode),K.reservationId=K.reservationId.concat(F).concat(";"),F=0,R=Q.CurrencyCode):K.reservationId=K.reservationId.concat(";"),D=1);w={startTime:Number(w.slotStartTime),endTime:Number(w.slotEndTime),
metadata:JSON.stringify({version:"1.0",widgetIndex:f,trimmedOrderId:g.trimmedOrderId,slot:K})};"undefined"!==typeof F&&R&&(w.price=F,w.priceCurrency=R);E.push(w)}D&&d.logMetric(c.SD_WIDGET_NO_SLOT_LEVEL_PRICE_METRIC,1);0<E.length&&(E[0].isDefault=!0);g={widgetId:k,client:"SOSP",timezone:B,marketplaceId:g.marketplace,customerId:g.customerId,isPrimeCustomer:!!g.isPrimeCustomer,sessionId:g.sessionId,addressId:g.address,isSlotPreviouslySelected:!!g.selectedSlot,isAfn:g.isAfn,slots:E};t()&&(E[0].isDefault=
!1,g.slots=a(E,y.selectedSlot),g.client=u.isSosp()?"SOSP":"SPC");P({calendarInput:g,widgetIndex:f})}else h.getWidgetInputParameters(y,P,H)}});e.on("services_widget_service_selected",function(a){var b=n.isShadowWidget(a.widgetIndex),c={calendarWidgetId:a.calendarWidgetId,selectedServices:a.selectedServices,widgetIndex:a.widgetIndex,trimmedOrderId:a.trimmedOrderId,isAfn:a.isAfn};if(n.enabled()&&b){var d=n.getMainWidgetInfo(c.widgetIndex);d&&(c.widgetIndex=d.widgetIndex,c.calendarWidgetId=d.calendarWidgetId)}h.getCachedCalendarWidgetInputParameters(c,
function(c){n.enabled()&&b?v(n.processShadowCalendarInput(a.widgetIndex,c)):v(c)},function(b){q(a.widgetIndex,a.calendarWidgetId,a.servicesWidgetId)})});e.on("checkout:reload:shipoptionselect",function(){})});"use strict";q.when("A","SDSlotContainerWidget","SDWidgetsConstants","sdLogger","ready").register("ScheduledDeliveryMdwWidgets",function(e,h,f,m){var k=e.$;e.on("sd-load-mdw-widget",function(c,d,b){h.createWidget(c,d,b)});e.on("slot-container-slot-selected-on-spc",function(c){c=k("#"+c.widgetId).closest(f.SD_MDW_WIDGET_ROOT_CLASS);
0<c.length&&(c=c.attr("id"),e.trigger("slot-selected-update-sdi",c));return null});e.on("slot-selected-update-sdi",function(c){var d={};k("#"+c+" input[type\x3dhidden]").each(function(){var b=k(this),c=b.attr("key"),b=b.attr("value");c&&(d[c]=b)});var b=k("#"+c).closest(".shipping-speed").find("input[type\x3d'radio']");v.spcpage.scheduledDeliveryMdwSetSOCallback(b,d,c);m.logMetric(f.SD_MDW_UPDATE_SDI_COUNT_METRIC,1)})})});
/* ******** */
