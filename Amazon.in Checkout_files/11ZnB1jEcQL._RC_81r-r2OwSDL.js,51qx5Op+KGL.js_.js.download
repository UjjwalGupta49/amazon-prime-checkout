(function(c){var g=window.AmazonUIPageJS||window.P,h=g._namespace||g.attributeErrors,a=h?h("WidgetStreamer",""):g;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,g,h){c.when("jQuery","widget-streamer-action-ws-append","widget-streamer-action-ws-prepend","widget-streamer-action-ws-update","widget-streamer-action-ws-event").register("widget-streamer-actions",function(a,d,e,b,f){var c={"ws-append":d,"ws-prepend":e,"ws-update":b,"ws-event":f},k={execute:a.noop};
return{create:function(f){var b,e,d;b=k;if(a.isArray(f)&&f.length&&f[0]){b=f[0];e=c[b];d="widget-streamer-action-"+b;if("function"!==typeof e)throw Error("Action: "+b+" is not supported. Register component "+d+" to handle this action");b=e(f)}return b}}});"use strict";c.register("widget-streamer-jquery-action",function(){return function(a,d,e){var b,f;if(!a||3>a.length)throw Error("Can not create update action, insufficient data in chunk: "+JSON.stringify(a));b=a[1];f=a[2];return{execute:function(a){var c=
a._$target.find(b).add(a._$target.filter(b));a._isTargetUpdated?e(c,f):d(c.get(0),f)}}}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-update",function(a){return function(d){return a(d,function(a,b){a.innerHTML=b},function(a,b){a.html(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-append",function(a){return function(d){return a(d,function(a,b){a.innerHTML+=b},function(a,b){a.append(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-prepend",
function(a){return function(d){return a(d,function(a,b){a.innerHTML=b+a.innerHTML},function(a,b){a.prepend(b)})}});c.register("widget-streamer-action-ws-event",function(){return function(a){var d=a[1],c;try{c=JSON.parse(a[2])}catch(b){c=null}return{execute:function(a){a._emitEvent(d,c)}}}});"use strict";c.register("widget-streamer-utils",function(){return{isStreamingAjax:function(a){if(a&&"function"===typeof a.getResponseHeader)a=a.getResponseHeader("Content-Type");else if(a&&a.http&&"function"===
typeof a.http.getResponseHeader)a=a.http.getResponseHeader("Content-Type");else throw Error("Unable to retrive headers for the given xhr object: "+a);return"application/json-amazonui-streaming"===a}}});"use strict";c.when("A","jQuery","widget-streamer-actions").register("widget-streamer",function(a,c,e){function b(a){a=a||{};this._$originalTarget=a.$target;this._$target=a.$target.clone();this._actions=[];this._isExecutable="undefined"===typeof a.immediateExecution||a.immediateExecution;this._onUpdate=
a.onUpdate||c.noop;this._hasExecutionStarted=!1;this._events=a.events||{};this._isTargetUpdated=!1;this._updateTriggerEvent=a.updateTriggerEvent;this.chunkHandler=c.proxy(this.chunkHandler,this)}b.prototype.chunkHandler=function(a){a=e.create(a);this._actions.push(a);this.executeActions()};b.prototype.enableExecution=function(){this._isExecutable=!0;this.executeActions()};b.prototype.executeActions=function(){var a;if(this._isExecutable&&this._actions.length)for(this._hasExecutionStarted||(this._hasExecutionStarted=
!0,this._updateTriggerEvent||this._updateTarget()),a=this._actions.shift();a;)a.execute(this),a=this._actions.shift()};b.prototype._emitEvent=function(a,b){var e=(this._events||{})[a]||c.noop;a===this._updateTriggerEvent&&this._updateTarget(b);e.call(this,b)};b.prototype._updateTarget=function(){this._onUpdate.apply(this,arguments);this._$originalTarget.html(this._$target.html());this._$target=this._$originalTarget;this._isTargetUpdated=!0};return function(a){return new b(a)}})});
/* ******** */
(function(q){var p=window.AmazonUIPageJS||window.P,F=p._namespace||p.attributeErrors,pa=F?F("CheckoutCommonAsset",""):p;pa.guardFatal?pa.guardFatal(q)(pa,window):pa.execute(function(){q(pa,window)})})(function(q,p,F){q.register("polyfill-indexof",function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,l){if(null==this)throw new TypeError('"this" is null or not defined');var g=Object(this),c=g.length>>>0;if(0===c)return-1;l=+l||0;Infinity===Math.abs(l)&&(l=0);if(l>=c)return-1;for(l=
Math.max(0<=l?l:c-Math.abs(l),0);l<c;){if(l in g&&g[l]===a)return l;l++}return-1})});"use strict";q.register("polyfill-filter",function(){Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var l=Object(this),g=l.length>>>0;if("function"!==typeof a)throw new TypeError;for(var c=[],d=2<=arguments.length?arguments[1]:void 0,f=0;f<g;f++)if(f in l){var k=l[f];a.call(d,k,f,l)&&c.push(k)}return c})});"use strict";q.register("polyfill-json-stringify",
function(){"object"!==typeof JSON&&(JSON={});(function(){function a(a){return 10>a?"0"+a:a}function l(){return this.valueOf()}function g(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=v[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,h){var d,e,n=b,f,k=h[a];k&&"object"===typeof k&&"function"===typeof k.toJSON&&(k=k.toJSON(a));"function"===typeof u&&(k=u.call(h,a,k));switch(typeof k){case "string":return g(k);case "number":return isFinite(k)?
String(k):"null";case "boolean":case "null":return String(k);case "object":if(!k)return"null";b+=m;f=[];if("[object Array]"===Object.prototype.toString.apply(k)){e=k.length;for(a=0;a<e;a+=1)f[a]=c(a,k)||"null";h=0===f.length?"[]":b?"[\n"+b+f.join(",\n"+b)+"\n"+n+"]":"["+f.join(",")+"]";b=n;return h}if(u&&"object"===typeof u)for(e=u.length,a=0;a<e;a+=1)"string"===typeof u[a]&&(d=u[a],(h=c(d,k))&&f.push(g(d)+(b?": ":":")+h));else for(d in k)Object.prototype.hasOwnProperty.call(k,d)&&(h=c(d,k))&&f.push(g(d)+
(b?": ":":")+h);h=0===f.length?"{}":b?"{\n"+b+f.join(",\n"+b)+"\n"+n+"}":"{"+f.join(",")+"}";b=n;return h}}var d=/^[\],:{}\s]*$/,f=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,k=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,h=/(?:^|:|,)(?:\s*\[)+/g,e=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=l,Number.prototype.toJSON=l,String.prototype.toJSON=l);var b,m,v,u;"function"!==typeof JSON.stringify&&(v={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=
function(a,h,d){var e;m=b="";if("number"===typeof d)for(e=0;e<d;e+=1)m+=" ";else"string"===typeof d&&(m=d);if((u=h)&&"function"!==typeof h&&("object"!==typeof h||"number"!==typeof h.length))throw Error("JSON.stringify");return c("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function c(a,h){var d,e,n=a[h];if(n&&"object"===typeof n)for(d in n)Object.prototype.hasOwnProperty.call(n,d)&&(e=c(n,d),e!==F?n[d]=e:delete n[d]);return b.call(a,h,n)}a=String(a);n.lastIndex=0;n.test(a)&&
(a=a.replace(n,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(d.test(a.replace(f,"@").replace(k,"]").replace(h,"")))return a=eval("("+a+")"),"function"===typeof b?c({"":a},""):a;throw new SyntaxError("JSON.parse");})})()});"use strict";q.when("A","jQuery","client-side-metrics","weblab-helper","polyfill-filter","polyfill-json-stringify").register("ajax-wrapper",function(a,l,g,c){function d(a,b){function c(a,b){for(var h=0;h<a._options.length;h++){var d=a._options[h];
if(d=b.call(a,d,"object"===typeof d?d.name:d))return d}}this._options=a instanceof d&&b&&b.length?a._options.concat(b):a instanceof d?a._options:a&&a.length?a:[];this.filter=function(a){var b={};c(this,function(c,d){d in a&&(b[d]=a[d])});return b};this.getOption=function(a){return c(this,function(b,c){if(c===a)return b})};return this}function f(a){this._options=a.allowedOptions;this._messageForViolation=a.messageForViolation;this._messageForViolationWithValue=a.messageForViolationWithValue;this._optionName=
a.optionName;this._valueName=a.valueName;this.validate=function(a){for(var b in a)if(a.hasOwnProperty(b)){var c=this._options.getOption(b);if(!c)throw c=this._messageForViolation.replace(this._optionName,b),Error(c);if("object"===typeof c&&!c.validate(a[b]))throw c=this._messageForViolationWithValue.replace(this._optionName,b),c=c.replace(this._valueName,a[b]),Error(c);}};return this}function k(a){try{E.validate(a)}catch(b){console.error(b)}var c=r.filter(a),c=l.extend(c,h(a));return l.ajax(c)}function h(a){if(a.params){if(a.data&&
a.params)throw Error("The option data can not be present with the emulated params option. Merge both and use just one.");return{data:a.params}}}function e(d){try{G.validate(d)}catch(h){console.error(h)}var e={url:F,options:t.filter(d)},f=new l.Deferred;e.url=d.url;if(d.data){if(d.data&&d.params)throw Error("Unsupported options. 'params' and 'data' options are both specified. Remove one of them.");if("object"===typeof d.data)e.options.params=d.data;else if("string"===typeof d.data)c.isSetParamsFormatAsStirngWeblabOn()?
"GET"===d.type?e.url+="?"+d.data:(e.options.params=d.data,e.options.paramsFormat="string"):e.url+="?"+d.data;else throw Error("Unsupported type provided in the 'data' attribute of an AJAX call");}if(d.type){if(d.type&&d.method)throw Error("Unsupported options. 'type' and 'method' options are both specified. Remove one of them.");e.options.method=d.type}if("crossDomain"in d){if("crossDomain"in d&&"withCredentials"in d)throw Error("Unsupported options. 'crossDomain' and 'withCredentials' options are both specified. Remove one of them.");
e.options.withCredentials=d.crossDomain}e=b(e,d,f);e=n(e,d,f);e=v(e,d,f);e=m(e,d,f);e=u(e,d,f);d.beforeSend&&d.beforeSend(e.options);e=z(e,d,f);d=a.ajax(e.url,e.options);return d=f.promise(d)}function n(a,b,c){var d=a.options.success;a.options.success=function(a,b,e){d&&d(a,b,e);c.resolve(a,b,e)};var e=a.options.error;a.options.error=function(a,b,d){e&&e(a,b,d);c.reject(a,b,d)};var h=a.options.abort;a.options.abort=function(a){h&&h(a);c.reject(a,"abort")};return a}function b(a,b){if(!b.complete)return a;
var c=a.options.success;a.options.success=function(a,d,e){c&&c(a,d,e);b.complete(e,"success")};var d=a.options.error;a.options.error=function(a,c,e){d&&d(a,c,e);b.complete(a,"error")};var e=a.options.abort;a.options.abort=function(a){e&&e(a);b.complete(a,"abort")};return a}function m(a,b){var c=a.options.success;a.options.success=function(a,d,e){c&&("text"===b.dataType&&"object"===typeof a&&(a=JSON.stringify(a)),c(a,d,e))};return a}function v(a,b){if(!b.useXMLHttp)return a;var c=a.options.success;
a.options.success=function(a,b,d){d&&(d=d.http);c(a,b,d)};var d=a.options.error;a.options.error=function(a,b,c){a&&(a=a.http);d(a,b,c)};var e=a.options.abort;a.options.abort=function(a){a&&(a=a.http);e(a)};return a}function u(a,b){var d=a.options.success;a.options.success=function(a,b,c){c&&304===c.http.status?d(a,"notmodified",c):d(a,"success",c)};var c=a.options.error;a.options.error=function(a,b,e){a&&a.http.readyState<B.DONE?c(a,"timeout",e):a&&200<=a.http.status&&300>a.http.status&&a.http.readyState===
B.DONE?d(a.http.responseText,"success",a):a&&0==a.http.status?c(a,"abort",e):c(a,"error",e)};return a}function z(a,b){var c=a.options.success;a.options.success=function(a,b,d){w(d,"success");c(a,b,d)};var d=a.options.error;a.options.error=function(a,b,c){w(a,"error");d(a,b,c)};return a}function w(a,b){a?(g.increaseCount("AUI:Ajax:"+b+":xhr:defined"),a.http?g.increaseCount("AUI:Ajax:"+b+":xhr:http:defined"):a.http===F?g.increaseCount("AUI:Ajax:"+b+":xhr:http:undefined"):null===a.http&&g.increaseCount("AUI:Ajax:"+
b+":xhr:http:null")):a===F?g.increaseCount("AUI:Ajax:"+b+":xhr:undefined"):null===a&&g.increaseCount("AUI:Ajax:"+b+":xhr:null")}var B={UNSET:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},r=new d("accepts async beforeSend cache complete contents contentType context converters crossDomain data dataFilter dataType error global headers ifModified isLocal jsonp jsonpCallback method mimeType password processData scriptCharset statusCode success timeout traditional type url username xhr xhrFields".split(" ")),
t=new d("abort accepts cache chunk contentType error headers indicator method params success timeout withCredentials".split(" ")),H=new d(t,[{name:"async",validate:function(a){return a}},"useXMLHttp","beforeSend","complete","crossDomain","dataType","data","type","url"]),y=new d(r,["params"]),G=new f({allowedOptions:H,messageForViolation:"The option %O is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",
optionName:"%O",valueName:"%V"}),E=new f({allowedOptions:y,messageForViolation:"The option %O is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",optionName:"%O",valueName:"%V"}),I=l("meta[name\x3ddefaultAJAX]").attr("content");"jQuery"!==I&&"AUI"!==I&&(I="jQuery");return{default:function(a){try{G.validate(a),E.validate(a)}catch(b){console.error(b)}if("jQuery"===
I)k(a);else if("AUI"===I)e(a);else throw Error("Unknown AJAX method: "+I);},jQuery:k,aui:e,READY_STATE:B}});"use strict";q.when("jQuery").register("weblab-helper",function(a){return{isAJAXWeblabOn:function(){return"1"===a("meta[name\x3dPAGE_CONDUCTOR_AUI_AJAX]").attr("content")},isAjaxStreamingEnabled:function(){return"1"===a("meta[name\x3dENABLE_AJAX_STREAMING]").attr("content")},isNavCFWeblabOn:function(){return"1"===a("meta[name\x3dEMIT_NAV_CF]").attr("content")},isRemoveOrderSummaryPrimaryActionBtnTextWeblabOff:function(){return"1"!==
a("#is-remove-os-pabt").val()},isSetParamsFormatAsStirngWeblabOn:function(){return"1"===a("meta[name\x3dSET_PARAMS_FORMAT_AS_STRING]").attr("content")},disablePrefetchForScheduledDeliveryWeblabOn:function(){return"1"===a("meta[name\x3dDISABLE_PREFETCH_FOR_SCHEDULED_DELIVERY]").attr("content")},isRemoveAddressFormOnDeleteAddressWeblabOn:function(){return"1"===a("meta[name\x3dREMOVE_ADDRESS_FORM_ON_DELETE_ADDRESS]").attr("content")},isSOSPExclusiveJSHandlerWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_EXCLUSIVE_JS]").attr("content")},
sospPartialAvailabilityWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_PARTIAL_UNAVAILABILITY]").attr("content")},refactorExtractURL:function(){return"1"===a("meta[name\x3dREFACTOR_EXTRACT_URL]").attr("content")},showGiftTextAreaOnWarning:function(){return"1"===a("meta[name\x3dSHOW_GIFT_TEXT_AREA_ON_WARNING]").attr("content")},isInterceptionAddressFormWidthFixEnabled:function(){return"1"===a("meta[name\x3dFIX_FIELD_WIDTH_IN_CHECKOUT_INTERCEPTION_FIX_ENABLED]").attr("content")},removesGiftOptionOnRush:function(){return"1"===
a("meta[name\x3dREMOVE_GIFT_OPTION_RUSH]").attr("content")},isSPCMobileDisplayMoreShipOptionsEnabled:function(){return"1"===a("meta[name\x3dSPC_MOBILE_DISPLAY_MORE_SHIP_OPTIONS]").attr("content")},isMCBMultiTenderWeblabEnabled:function(){return"1"===a("meta[name\x3dMCB_MULTI_TENDER_ENABLED]").attr("content")},isCreateAddressLinkForTaxAddressFormWeblabOn:function(){return"1"===a("meta[name\x3dCREATE_ADDRESS_IN_TAX_COLLECTION_ENABLED]").attr("content")},isMfaPSD2DeviceDescriptionCollectionEnabled:function(){return"1"===
a("meta[name\x3dMFA_PSD2_DEVICE_DESCRIPTION_COLLECTION_ENABLED]").attr("content")},isSospCalendarFixEnabled:function(){return"1"===a("meta[name\x3dSOSP_CALENDAR_FIX]").attr("content")},isUpdateMobileNumberEnabled:function(){return"1"===a("meta[name\x3dUPDATE_MOBILE_NUMBER]").attr("content")},isGILCreditCardEnabled:function(){return"1"===a("meta[name\x3dGIL_CREDIT_CARD_PAYMENT_METHOD]").attr("content")},isPyoClientSideInitiationEnabled:function(){return"1"===a("meta[name\x3dPYO_CLIENT_SIDE_INITIATION]").attr("content")},
isTFXCurrencyToggleOnTabletFixed:function(){return"1"===a("meta[name\x3dTFX_CURRENCY_TOGGLE_ON_TABLET_FIXED]").attr("content")},isTFXGuaranteedExchangeFeeEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TFX_GUARANTEED_EXCHANGE_FEE]").attr("content")},isFreshMobileNoScrollOnRefreshEnabled:function(){return"1"===a("meta[name\x3dF3_CHECKOUT_MOBILE_NO_SCROLL_TO_TOP]").attr("content")},isCSMErrorLoggingEnabled:function(){return"1"===a("meta[name\x3dENABLE_CSM_ERROR_LOGGING]").attr("content")},
isLogAFFNFallbackEnabled:function(){return"1"===a("meta[name\x3dENABLE_AF_FN_FALLBACK]").attr("content")},isExecutionIdInQueryStringEnabled:function(){return"1"===a("meta[name\x3dADD_EXECUTION_ID_TO_QUERY_STRING]").attr("content")},isDigitalAsinIndexingFixedOnSOSPEnabled:function(){return"1"===a("meta[name\x3dDIGITAL_ASIN_INDEXING_FIXED_ON_SOSP]").attr("content")},isCvfOldAmazonUiFixesEnabled:function(){return"1"===a("meta[name\x3dCVF_OLD_AUI_FIXES]").attr("content")},isHeadersCleaned:function(){return"1"===
a("meta[name\x3dCLEAN_UP_HEADERS]").attr("content")},isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled:function(){return"1"===a("#is-item-assoc-delete-confirmation-popover-for-wireless-plans").val()},isSsdMdwEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SSD_MDW]").attr("content")},isSDGoldenCXSPCDesktopEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SD_GOLDEN_CX_DESKTOP_SPC]").attr("content")},isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled:function(){return"1"===
a("meta[name\x3dRCX_CHECKOUT_SD_NOT_DIGITAL]").attr("content")},isMobileBundleDeleteFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_MOBILE_BUNDLE_DELETE]").attr("content")},isEGiftOptionsActive:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_EGIFT_OPTIONS_MOBILE]").attr("content")},isPipelineDispatchSendHeaderEnabled:function(){return"1"===a("meta[name\x3dSEND_HEADER_FOR_PIPELINE_REQUEST]").attr("content")},isIngressEnabled:function(){return"1"===a("meta[name\x3dINGRESS_ENABLED]").attr("content")},
isISPUMasterEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_ISPU_MASTER]").attr("content")},isRushISPUMasterEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_RENDER_RUSH_ISPU_MASTER]").attr("content")},isProgressiveOrderReviewCardAnchorEnabled:function(){return 1===a("#progressive-order-review-card-anchor").length},isTaxExemptionMessagingFixed:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TAX_EXEMPTION_MSGING]").attr("content")},isCachingOfPSPPanelOnTrueSPCDisabled:function(){return"1"===
a("meta[name\x3dRCX_CHECKOUT_SUPPRESS_TRUESPC_PSP_PANEL_CACHING]").attr("content")},isTSPCGoldBoxTimerFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_TSPC_GOLD_BOX_COUNTER_FIX]").attr("content")},isDisableGoldBoxTimerFixForFastTrackEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_DISABLE_GOLD_BOX_TIMER_FIX_FOR_FASTTRACK]").attr("content")},isProgressiveOrderReviewScrollingFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_PROGRESSIVE_SCROLLING_FIX]").attr("content")},
isFreshComingledPurchaseEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_FRESH_COMMINGLED_PURCHASE_ENABLED]").attr("content")}}});"use strict";q.when("A","client-side-metrics").register("weekend-availability-expander-helper",function(a,l){function g(a){return(a=k[a])?f("#weekend-availability-expander-header-text-"+a).text():f("#weekend-availability-default").text()}function c(){return 1==f("input[name\x3d'isBusinessDefaultWeekendDeliveryEnabled']").attr("value")?!0:!1}function d(a,c){return a&&
c?"BOTH":a?"SAT":c?"SUN":"NONE"}var f=a.$,k={BOTH:"both",SAT:"sat",SUN:"sun",NONE:"none"};return{isBusinessDefaultWeekendDeliveryViewActive:c,logExpanderState:function(a,c,d,b){l.increaseCount("checkout:delivery-preferences:"+a+":expander:"+c+":"+(d&&b?"neverExpanded":b?"collapsed":"expanded"),1)},stateToCheckboxes:function(a){var d=!1,n=!1;if(c()){if("BOTH"===a||"SAT"===a)d=!0;if("BOTH"===a||"SUN"===a)n=!0}else{if("BOTH"===a||"OTH"===a||"SAT"===a)d=!0;if("BOTH"===a||"OTH"===a||"SUN"===a)n=!0}return{isSaturdayChecked:d,
isSundayChecked:n}},updateAllOptOutMessages:function(a){1==f("input[name\x3d'isSundayDeliveryPreferenceSuppressed']").attr("value")?a.isSaturdayChecked?f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(f(".weekend-availability-opt-out-message").text(f("#weekend-availability-opt-out-sat-text").text()),f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):a.isSaturdayChecked||a.isSundayChecked?a.isSaturdayChecked?a.isSundayChecked?f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",
!0):(f(".weekend-availability-opt-out-message").text(f("#weekend-availability-opt-out-sun-text").text()),f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(f(".weekend-availability-opt-out-message").text(f("#weekend-availability-opt-out-sat-text").text()),f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(f(".weekend-availability-opt-out-message").text(f("#weekend-availability-opt-out-both-text").text()),f(".weekend-availability-opt-out-box").toggleClass("aok-hidden",
!1))},updateAllTitles:function(a){a=d(a.isSaturdayChecked,a.isSundayChecked);f(".sat-sun-expander-heading-text").text(g(a))},updateAllWeekendAvailabilityStates:function(a){a=d(a.isSaturdayChecked,a.isSundayChecked);f("input[name\x3d'BusinessHours']").attr("value",a)}}});"use strict";q.when("A","loading-spinner-controller","page-transition-controller","page-conductor","checkout-general-utils","address-utilities","page-detector-current-page","client-side-metrics","weblab-helper").register("address-popovers",
function(a,l,g,c,d,f,k,h,e){function n(a){(e.isHeadersCleaned()?a.popoverValid:a.getResponseHeader("x-amz-checkout-popover-valid"))||c.redirect({conductoraction:{url:"/gp/cart/view.html",type:"redirect"}})}function b(b,m,g){d.protectAgainstDoubleAction("show-add-address-popover",200)||(I=b.popover,!E('input[name\x3d"preloadAddressPopover"]').length||m.is(":empty")?(m.empty(),m.css("min-height",397),I.updatePosition(!0),l.showSpinner(m,!1,I),b=(new Date).getTime(),g=k.getCurrentPage(),h.increaseCount("checkout:address-popover-pagetype:".curPage,
1),g="itemselect"===g||"spp-itemselect"===g?1:0,e.isHeadersCleaned()?E.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+b,data:{isBilling:P,isMultiAddress:g},dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,c){n(a);m.css("min-height",0);t(m,a.popoverContent)},error:c.ajaxRedirect}):E.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+b,data:{isBilling:P,isMultiAddress:g},
async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,c){n(c);m.css("min-height",0);t(m,a)},error:c.ajaxRedirect})):(f.customizeFormFromIdentity(m),f.countrySpecificPopoverOptimizationCheck(E("html")),g&&a.trigger("identity-assets")))}function m(a,b){if(!d.protectAgainstDoubleAction("add-new-address",200)){h.resetMetrics();var m=!1;E(".identity-protect-from-errant").each(function(){var a=E(this),a=a.is("input")?a:a.find("input:first");-1!==a.val().search(/(\d[ -]?){13}/)&&
(m=!0)});if(m){var f=E(".address-form-security-error:first");f.length?alert(f.text()):alert("Please check that the address you have entered is correct.")}else{b.$event.preventDefault();l.showSpinner(a,!1,I);var g=E("#domestic-address-popover-form, #international-address-popover-form, #address-popover-suggestions-form").filter(":visible"),f=g.serialize(),k=(new Date).getTime();b=b.$currentTarget.find('input[type\x3d"submit"]').attr("name");"useSelectedAddress"===b?f+="\x26fromSuggestionPage\x3d1":
"fromAddressEditToContinue"===b&&(f+="\x26fromAddressEditToContinue\x3d1");E("#addAddressOnly").length&&(f+="\x26addOnly\x3d1");P&&(f+="\x26isBilling\x3d1");var r="/gp/buy/addressselect/handlers/popover/new.html";if(I){if("domestic-address-popover-form"===g.attr("id")&&(g.find(".enterAddressFormField").blur(),g="#"+a.attr("id")+" div[id^\x3donblur-character-validation-error-]",0<E(g).size())){l.hideSpinner(a);return}r+="/ref\x3dchk_addr_editPopoverSubmit";c.isSPP()&&(I.lock(11),setTimeout(function(){I.unlock(12)},
2E3))}var u=null!==p&&p!==F&&null!==W&&W!==F;"useSelectedAddress"===b&&!P&&u&&(f+="\x26fromSTMAPopover\x3d1");E("#international-address-popover-form").filter(":visible").length&&(f+="\x26showSecondaryForm\x3d1");y()&&D?v(a,k,f):e.isHeadersCleaned()?E.ajax({type:"POST",url:r+"?cachebuster\x3d"+k,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:f,dataType:"json",async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,d,e){c.isSPP()&&I.unlock(12);n(b);b.newPopoverType?z(b,d,b):
b.reloadPopover?t(a,b.popoverContent):u?w(b):B("added",b.popoverContent)}}):E.ajax({type:"POST",url:r+"?cachebuster\x3d"+k,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:f,async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,d,e){c.isSPP()&&I.unlock(12);n(e);e.getResponseHeader("x-amz-checkout-open-new-popover")?z(b,d,e):e.getResponseHeader("x-amz-checkout-reload-popover")?t(a,b):u?w(e):B("added",e)}})}}}function v(a,b,h){var m=D.getNewTaxAddressPopoverURL();e.isHeadersCleaned()?
E.ajax({type:"POST",url:m+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:h,dataType:"json",async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,e,h){c.isSPP()&&I.unlock(12);n(b);b.reloadPopover?t(a,b.popoverContent):b.newAddressId&&(E(".a-button-close").trigger("click"),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),D.submitTaxAddressFormWithNewAddressId(b.newAddressId))}}):E.ajax({type:"POST",url:m+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",
data:h,async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,e,h){c.isSPP()&&I.unlock(12);n(h);h.getResponseHeader("x-amz-checkout-reload-popover")?t(a,b):h.getResponseHeader("x-amz-checkout-new-address-id")&&(E(".a-button-close").trigger("click"),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),b=h.getResponseHeader("x-amz-checkout-new-address-id"),D.submitTaxAddressFormWithNewAddressId(b))}})}function u(a){if(!d.protectAgainstDoubleAction("show-edit-address-popover",200)){var b=
E("#address-suggestions-popover");a.$event.preventDefault();l.showSpinner(b,!1,I);a=E("#address-popover-suggestions-form");var h=a.serialize();a.find('input[type\x3d"radio"]').each(function(){var a=E(this);a.attr("checked")&&(h+="\x26edit_"+a.val()+"\x3d1")});P&&(h+="\x26isBilling\x3d1");I&&c.isSPP()&&(I.lock(11),setTimeout(function(){I.unlock(12)},2E3));a=(new Date).getTime();e.isHeadersCleaned()?E.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:h,
dataType:"json",async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,d){c.isSPP()&&I.unlock(12);n(a);z(a,b,a)}}):E.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:h,async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,d){c.isSPP()&&I.unlock(12);n(d);z(a,b,d)}})}}function z(b,d,c){E('input[name\x3d"preloadAddressPopover"]').remove();e.isHeadersCleaned()?(d=c.newPopoverType,"suggestions"===d?(E("#address-suggestions-popover").empty().append(c.popoverContent),
E("#address-suggestions-popover-link").trigger("click")):"edit"===d&&(d=E("#edit-address-popover"),d.empty().append(c.popoverContent),E("#edit-address-popover-link").trigger("click"),t(d,c.popoverContent))):(d=c.getResponseHeader("x-amz-checkout-open-new-popover"),"suggestions"===d?(E("#address-suggestions-popover").empty().append(b),E("#address-suggestions-popover-link").trigger("click")):"edit"===d&&(d=E("#edit-address-popover"),d.empty().append(b),E("#edit-address-popover-link").trigger("click"),
t(d,b)));a.trigger("identity-assets")}function w(a){a=e.isHeadersCleaned()?a.newAddressId:a.getResponseHeader("x-amz-checkout-new-address-id");var b=(new Date).getTime();E.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+b,data:{action:"update-address",lineitems:p,quantities:W,addresses:a+".home..",returnHTML:0},async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,d){B("applied",d)}})}function B(b,e){var h=(new Date).getTime();E('input[name\x3d"shipToAddress"]').length?
(b=function(){c.isSPP()?(g.blockAllActions(),g.shrinkPanel(E(".spp-panel.expanded"),!0)):g.show()},c.isNonBlockingAnimationEnabled()?a.delay(b,0):b(),b=k.getCurrentPage(),c.loadPage(b,"",F,{refTag:"chk_addr_editPopoverSubmit"},F,e)):(e=c.setAjaxTransitionHeader(),E.ajax({type:"POST",headers:e,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+h,data:{useCase:"multiAddress",showAddressAdded:b,page:"itemselect"},dataType:"text",async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,
b,e){c.ajaxUpdatePage(a,b,e);E(".a-button-close").trigger("click");d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}))}function r(a){a=E("#"+a);a.length&&a.empty()}function t(b,d){b.html(d);f.customizeFormFromIdentity(b);I.updatePosition(!0);a.trigger("identity-assets");f.countrySpecificPopoverOptimizationCheck(E("html"))}function H(a){a=a.$currentTarget.closest(".lineitem");p=a.find('input[name^\x3d"lineItemEntityID."]').val();W=a.find('input[name^\x3d"quantity."]').val();a=E("#add-address-popover-link");
a.length?a.trigger("click"):E("#add-new-address-popover").trigger("click")}function y(){return e.isCreateAddressLinkForTaxAddressFormWeblabOn()&&0<E("#isTaxAddress").length}function G(){P=E("#isBilling").length?1:0;if(e.isInterceptionAddressFormWidthFixEnabled()){var a=E(".enter-address-form");f.customizeFormFromIdentity(a)}}var E=a.$,I,p,W,P=0,D=null;if(!E("html").hasClass("a-ie6"))return a.on("a:popover:show:add-address",function(a){r("edit-address-popover");r("add-billing-address-popover");P=0;
b(a,E("#add-address-popover"),!1)}),a.on("a:popover:show:add-billing-address",function(a){r("edit-address-popover");r("add-address-popover");b(a,E("#add-billing-address-popover"),!0)}),a.on("a:popover:show:address-suggestions",function(a){I=a.popover}),a.on("a:expander:delivery-expander:toggle:expand",function(a){a=E(".a-expander-content");f.fixOverflow(a)}),a.declarative("close-delete-popover",["click","touchend"],function(a){q.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&
b.hide()})}),a.declarative("rm-address-action",["click","touchend"],function(a){q.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&b.hide()});e.isRemoveAddressFormOnDeleteAddressWeblabOn()&&(r("edit-address-popover"),r("add-address-popover"),r("add-billing-address-popover"));q.when("page-conductor").execute(function(b){b.continueClicked(null,a.$target)})}),a.declarative("select-billing-address-action",["click","touchend"],function(a){q.when("a-popover-base").execute(function(a){a.get("select-billing-address").hide()});
q.when("page-conductor").execute(function(b){b.continueClicked(null,a.$target)})}),E(document).delegate("a.prevent-default-marker","click",function(a){a.preventDefault()}),a.declarative("select-billing-address-in-popover",["click","touchend"],function(a){q.when("a-popover-base").execute(function(a){(a=a.get("select-billing-address"))&&a.hide()})}),a.declarative("trigger-popover-from-link",["click","touchend"],function(a){d.protectAgainstDoubleAction("trigger-popover-from-link",200)||(W=p=null,E("#add-address-popover-link").trigger("click"))}),
a.declarative("add-address-popover-submit",["click","touchend"],function(a){m(E("#add-address-popover"),a)}),a.declarative("add-billing-address-popover-submit",["click","touchend"],function(a){m(E("#add-billing-address-popover"),a)}),a.declarative("edit-address-popover-submit",["click","touchend"],function(a){m(E("#edit-address-popover"),a)}),a.declarative("address-suggestions-submit",["click","touchend"],function(a){m(E("#address-suggestions-popover"),a)}),a.declarative("delete-address-popover-submit",
["click","touchend"],function(a){a=E("#delete-address-button");0<a.length&&a.click()}),a.declarative("edit-address-suggestions",["click","touchend"],u),a.declarative("add-address-popover-edit",["click","touchend"],function(a){if(!d.protectAgainstDoubleAction("add-address-popover-edit",200)){a.$event.preventDefault();var b=E("#add-address-popover");l.showSpinner(b,!1,I);a=E("#address-popover-suggestions-form").serialize()+"\x26"+a.$currentTarget.find('input[type\x3d"submit"]').attr("name")+"\x3d1";
var h=(new Date).getTime();e.isHeadersCleaned()?E.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+h,data:a,dataType:"json",async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,d,c){n(a);t(b,a.popoverContent)}}):E.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+h,data:a,async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,d,c){n(c);t(b,a)}})}}),a.declarative("add-address-popover-toggle",["click","touchend"],
function(a){d.protectAgainstDoubleAction("add-address-popover-toggle",200)||(a.$event.preventDefault(),a=a.$currentTarget.closest(".enter-address-form"),f.toggleAddressForm(a,a.siblings(".enter-address-form")))}),a.declarative("select-radio-option",["click","touchend"],function(a){a=a.$currentTarget.find(".radio-option");a.find('input[type\x3d"radio"]').attr("checked","checked");a.closest(".radio-option-list").find(".radio-option").removeClass("radio-option-selected");a.addClass("radio-option-selected")}),
a.declarative("trigger-address-popover",["click","touchend"],function(a){d.protectAgainstDoubleAction("trigger-address-popover",200)||E("#add-address-popover-link").trigger("click")}),a.on("checkout:reload:spp-shipaddress",G),a.on("checkout:reload:spp-billing-address",G),a.on("checkout:reload:itemselect",G),a.on("checkout:reload:spp-itemselect",G),{actionTriggerPopoverFromDropdown:H,actionRegisterTaxAddressController:function(a){y()&&!D&&a&&(D=a)}}});"use strict";q.when("A").register("address-book-controller",
function(a){function l(){g("div.address-book").unbind("recalculate-address-height").bind("recalculate-address-height",function(){var a,d=g(),f=0,k=g("div.address-book .js-same-height"),h=k.length;k.css({height:"auto"}).each(function(e){var n=g(this);a=a||n.offset().top;a!==n.offset().top&&(d.height(f),d=g(),f=0,a=n.offset().top);var b=n.height();d=d.add(n);b>f&&(f=b);e===h-1&&0<f&&d.height(f)})}).trigger("recalculate-address-height");g(p).unbind("resize.checkout-as").bind("resize.checkout-as",function(){g("div.address-book").trigger("recalculate-address-height")})}
var g=a.$;a.on("checkout:reload:spp-shipaddress",l);a.on("checkout:reload:shipaddressselect",l);a.on("checkout:reload:billingaddressselect",l);a.on("checkout:reload:spp-billing-address",l)});"use strict";q.when("A","client-side-metrics","weblab-helper").register("address-utilities",function(a,l,g){function c(a){a.find("input").each(function(){var a=h(this),b=a.outerWidth(!0),d=a.parent().outerWidth(!0);b>d&&a.attr("size")&&(document.getElementById(a.attr("id")).removeAttribute("size"),a.width("100%"))})}
function d(a){if(h('input[name\x3d"useLiveAUI"]').length)q.when("p-detect").execute(function(b){b.capabilities.inputPlaceholder&&a.find(".field-description").each(function(){var a=h(this),b=a.text(),d=a.closest(".a-col-right").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");d.attr("maxlength")<b.length&&d.attr("size",b.length);d.attr("placeholder",a.text())})}),a.find("input").each(function(){h(this).outerWidth()}),a.find("input[type\x3d'text'], select").each(function(){var a=
h(this).closest(".full-width-config"),b=h(this);0===a.find(".a-popover-trigger").length&&(g.isInterceptionAddressFormWidthFixEnabled()?b.addClass("addressform-textfield-width"):b.width("96%"))});else{q.when("p-detect").execute(function(b){b.capabilities.inputPlaceholder?a.find(".field-description").each(function(){var a=h(this),b=a.text(),d=a.closest(".a-column").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");d.attr("maxlength")<b.length&&d.attr("size",b.length);
d.attr("placeholder",a.text())}):a.find(".field-description").each(function(){var a=h(this);a.find("br").remove();a.show()})});a.find(".popover-field-label").each(function(){var a=h(this);a.find("b").each(function(){var a=h(this);a.text(h.trim(a.text()))});a.find("font").each(function(){var a=h(this);"-2"===a.attr("size")&&a.remove()})});var d=h(".enter-address-form");c(d);var b=0,d=a.find(".one-new-address-form-field").first();d.length&&d.find(".a-column").each(function(){b+=h(this).outerWidth()});
a.width(0<b?b:"")}}function f(d){function c(){w=h.val();(B=k[w])&&f.find(".learn-more a").text(B.popOverLinkText)}var b=p.P&&p.P.AUI_BUILD_DATE,h=d.find("#enterAddressCountryCode"),f=d.find(".country-specific-form-input"),g,k;b?(g=f.find("input"),k=d.find(".country-specific-config").data("popovercountryconfig")):(l.increaseCount("removeauijs2"),g=f.find("#"+f.data("inputid")),k=f.find(".country-specific-config").data("popovercountryconfig"));if(h.length&&f.length&&g.length&&k){var w=h.val(),B=k[w];
h.unbind("change.countryChangeConfigUpdate").bind("change.countryChangeConfigUpdate",c);c();var r=b?"show":"beforeShow";a.on("a:popover:"+r+":checkout-"+f.data("inputid")+"Name",function(a){"beforeShow"===r&&l.increaseCount("removeauijs3");B&&(a.popover.$popover.find(".a-popover-header h4").html(B.popOverTitle),a.popover.$popover.find(".a-popover-inner").html(B.popOverText),a.popover.updatePosition())})}}function k(a){function d(){var a=c.val();(a=k[a])?(a=(a=a.label)||"",g.attr("placeholder",h("\x3cdiv /\x3e").html(a).text().replace(":",
"")),f.show()):f.hide()}var b=p.P&&p.P.AUI_BUILD_DATE,c=a.find("#enterAddressCountryCode"),f=a.find(".country-specific-form-input-mobile"),g,k;b?(g=f.find("input"),k=a.find(".country-specific-config").data("labelcountryconfig")):(l.increaseCount("removeauijs3"),g=f.find("#"+f.data("inputid")),k=f.find(".country-specific-config").data("labelcountryconfig"));c.length&&f.length&&g.length&&k&&(c.unbind("change.countryChangeLabelUpdate").bind("change.countryChangeLabelUpdate",function(){f.hasClass("initial-edit-value")?
f.removeClass("initial-edit-value"):g.val("");d()}),d())}var h=a.$;q.when("a-checkbox").execute(function(d){a.declarative("delivery-preferences-weekend-availability-checkbox-triggered","click",function(a){if("undefined"!==typeof a.$target){var b=a.$target.val();a.$target.is(":checked")&&("NONE"===b?(d("#delivery-preferences-weekend-availability-sat").uncheck(),d("#delivery-preferences-weekend-availability-sun").uncheck()):"SAT"!==b&&"SUN"!==b||d("#delivery-preferences-weekend-availability-none").uncheck())}})});
a.declarative("wdp-redesign-addresstype-radio-clicked","click",function(a){var d=a.$target.context.id;a=h(".com-businesshours-text");var b=h("#delivery-preferences-weekend-availability-sat").is(":checked"),c=h("#delivery-preferences-weekend-availability-sun").is(":checked");"devyPrefs_AddressType_COM"===d?(l.increaseCount("WDPTotalCOMClick"),h(".wdp-res").removeClass("a-color-base-background").addClass("a-color-alternate-background"),h(".wdp-com").removeClass("a-color-alternate-background").addClass("a-color-base-background"),
h(".wdp-BusinessHours").removeClass("aok-hidden")):"devyPrefs_AddressType_RES"===d?(l.increaseCount("WDPTotalRESClick"),h(".wdp-com").removeClass("a-color-base-background").addClass("a-color-alternate-background"),h(".wdp-res").removeClass("a-color-alternate-background").addClass("a-color-base-background"),h(".wdp-BusinessHours").addClass("aok-hidden")):"delivery-preferences-weekend-availability-sat"===d?(l.increaseCount("WDPTotalSATClick"),d=b?c?"BOTH":"SAT":c?"SUN":"OTH",a.addClass("aok-hidden"),
h(".com-businesshours-"+d).removeClass("aok-hidden")):"delivery-preferences-weekend-availability-sun"===d&&(l.increaseCount("WDPTotalSUNClick"),d=c?b?"BOTH":"SUN":b?"SAT":"OTH",a.addClass("aok-hidden"),h(".com-businesshours-"+d).removeClass("aok-hidden"))});return{toggleAddressForm:function(a,f){a.hide();f.find("div.a-alert-error:not(.js-originally-shown-imb)").hide();a.find("input[type\x3d'text'], select, input[type\x3d'radio']:checked, input[type\x3d'hidden']").each(function(){var a=h(this),d=a.attr("name")||
a.data("copyto")||a.attr("id");if(!a.is(":disabled")&&!a.find(":selected").is(".js-not-a-value")){var c=f.find("input[name\x3d'"+d+"']");"enterAddressLandmark"===d&&(c=f.find("input[name\x3d'Landmark']"));"Landmark"!==d||c.length||(c=f.find("input[name\x3d'enterAddressLandmark']"));1<c.length&&a.is("input[type\x3d'radio']")?c.filter("[value\x3d'"+a.val()+"']").attr("checked",!0):c.is("select")?c.find("option[value\x3d'"+a.val()+"']").attr("selected",!0):a.is("input[type\x3d'hidden']")||c.is("input[type\x3d'hidden']")||
c.val(a.val())}});f.show();c(f);d(f)},customizeFormFromIdentity:d,fixOverflow:c,countrySpecificLabelOptimizationCheck:function(a){var d=a.find(".enter-address-form");1===d.data("taxidOpt")?setTimeout(function(){k(d)},100):k(d)},countrySpecificPopoverOptimizationCheck:function(a){var d=a.find(".enter-address-form");1===d.data("taxidOpt")?setTimeout(function(){f(d)},100):f(d)}}});"use strict";q.when("A","page-conductor","page-transition-controller","client-side-metrics","page-detector-current-page",
"checkout-general-utils").register("address-form-helper",function(a,l,g,c,d,f){function k(a,b,d){m(".a-button-close").trigger("click");m('\x3cinput name\x3d"addressID"/\x3e').val(a).appendTo(d);m('\x3cinput name\x3d"purchaseId"/\x3e').val(b).appendTo(d);l.continueClicked(null,d)}function h(a,d){d||(d=m("#address-ui-checkout-form"));n(d);var c=(new Date).getTime();m.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+c,data:{action:"update-address",lineitems:v,quantities:u,
addresses:a,returnHTML:0},async:!0,cache:!1,error:function(){b(d);l.ajaxRedirect},success:function(a,b,c){e("applied",d)}})}function e(a,d){var c=(new Date).getTime(),e=l.setAjaxTransitionHeader();m.ajax({type:"POST",headers:e,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+c,data:{useCase:"multiAddress",showAddressAdded:a,page:"itemselect"},dataType:"text",async:!0,cache:!1,error:function(){b(d);l.ajaxRedirect},success:function(a,c,e){b(d);l.ajaxUpdatePage(a,c,e);m(".a-button-close").trigger("click");
f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function n(a){l.isSPP()?(g.blockAllActions(),g.showTransitionInContainer(a)):g.show()}function b(a){l.isSPP()?(g.unblockAllActions(),m(a).find("div.section-overwrap").remove()):g.hide()}var m=a.$,v,u;a.on("a:popover:afterUpdatePosition:edit-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:edit-address",b.popover)});a.on("a:popover:afterUpdatePosition:add-address",function(b){b.popover&&
b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});a.on("a:popover:visible:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});a.declarative("itemselect-update-address",["change"],function(a){a=a.$currentTarget.closest(".lineitem");v=a.find('input[name^\x3d"lineItemEntityID."]').val();u=a.find('input[name^\x3d"quantity."]').val()});return{setDestination:function(a,b){a||(c.increaseCount("checkout:addressForm:setDestination:noRequest",
1),a={});var e=a.addressId;e||c.increaseCount("checkout:addressForm:setDestination:noAddressId",1);var f=a.purchaseId||m("input[name\x3d'purchaseId']").val();f||c.increaseCount("checkout:addressForm:setDestination:noPurchaseId",1);a=a.ref||"ox_shipaddress_add_new_addr";var n=d.getCurrentPage();if("itemselect"===n||"spp-itemselect"===n)return h(e,b);m('[name\x3d"isBilling"]')&&1==m('[name\x3d"isBilling"]').val()?(a="ox_billing_continue",(b=m("input[name\x3d'paymentInstrumentId']").val())||c.increaseCount("checkout:addressForm:setDestination:noPaymentInstrumentId",
1),(n=m("input[name\x3d'paymentMethodCode']").val())||c.increaseCount("checkout:addressForm:setDestination:noPaymentMethodCode",1),a=m("\x3cform/\x3e").attr("action","/gp/buy/billingaddressselect/handlers/continue.html/ref\x3d"+a),m('\x3cinput name\x3d"paymentInstrumentId"/\x3e').val(b).appendTo(a),m('\x3cinput name\x3d"paymentMethodCode"/\x3e').val(n).appendTo(a),m('\x3cinput name\x3d"action" value\x3d"select-billing"/\x3e').appendTo(a),m('\x3cinput name\x3d"isAUIWSAddressCreationWorkflow" value\x3d"1"/\x3e').appendTo(a)):
(a=m("\x3cform/\x3e").attr("action","/gp/buy/addressselect/handlers/continue.html/ref\x3d"+a),m('\x3cinput name\x3d"action" value\x3d"select-shipping"/\x3e').appendTo(a));k(e,f,a)},onPageTransitionStart:n,onPageTransitionComplete:b}});"use strict";q.when("A","client-side-metrics","weblab-helper").register("action-logger",function(a,l){var g=a.$;a.declarative("ue-count",["click","touchend"],function(a){l.increaseCount(a.data.countFlag,a.data.countValue)});return{logUsedPrefetch:function(a,d,f,k){k||
(l.increaseCount("Checkout:action-log:MissingRefMarker"),k="");g.ajax({type:"GET",url:"/gp/buy/shared/handlers/log-used-prefetch.html"+k,data:"pageType\x3d"+a+"\x26subPageType\x3d"+d+"\x26relatedRequestId\x3d"+f,dataType:"text",cache:!1})}}});"use strict";q.when("A","weblab-helper").register("ajax-utility",function(a,l){return{jsonify:function(g){var c;if(c=l.isAJAXWeblabOn()){c=g instanceof Function;var d=g instanceof Array,f=g instanceof String;c=g instanceof Object&&!d&&!c&&!f}if(c)return g;try{g=
a.$.parseJSON(g)}catch(k){g=null}return g}}});"use strict";q.when("A","page-conductor","client-side-metrics","weblab-helper").register("button-blocker",function(a,l,g,c){function d(a,b,d,c){l.isSPP()?b.closest("span.a-declarative").data("blockerText",d):b.find("input.a-button-text").data("blockerText",d);f(c);m?(a.addClass("aok-hidden"),b.removeClass("aok-hidden"),k("#hasTVNavigation").length&&q.when("a-tv").execute(function(b){b.remove(a)})):(g.increaseCount("removeauijs10"),a.hide(),b.show(),b.hasClass("aok-hidden")&&
b.removeClass("aok-hidden"))}function f(a){var b=k(".continue-button-blocker-text");b.length&&(a?(b.html(a),b.removeClass("aok-hidden")):(b.addClass("aok-hidden"),b.empty()))}var k=a.$,h={},e=[],n,b,m=p.P&&p.P.AUI_BUILD_DATE,v=!1;c=c.isPyoClientSideInitiationEnabled()?"checkout:unload":"checkout:beforeReload";a.on(c,function(){e=[];h={};n=""});return{show:function(a,b,c){if(!v){var f=k(".continue-button");if(f.length)if(b){var m=k(".continue-button-blocker");if(m.length){c=c||"";var t=h[a]!==F&&h[a].tooltipText!==
b,l=h[a]!==F&&h[a].buttonInlineText!==c;if(0===e.length||!h[a]||t||l)d(f,m,b,c),n=a;h[a]===F&&e.push(a);h[a]={tooltipText:b,buttonInlineText:c}}}else p.console&&p.console.error&&console.error("showBlockerOnContinue should not be called with an empty tooltip."),g.increaseCount("Checkout:ButtonBlocker:EmptyTooltip")}},hide:function(a){if(!v){if(h[a]!==F){delete h[a];var b=k.inArray(a,e);e.splice(b,1)}var c=k(".continue-button");c.length&&(b=k(".continue-button-blocker"),b.length&&(0===e.length?(f(),
m?(b.addClass("aok-hidden"),c.removeClass("aok-hidden"),k("#hasTVNavigation").length&&q.when("a-tv").execute(function(a){a.add(c)})):(g.increaseCount("removeauijs11"),b.hide(),c.show(),c.hasClass("aok-hidden")&&c.removeClass("aok-hidden"))):n===a&&(n=e[0],d(c,b,h[n].tooltipText,h[n].buttonInlineText))))}},lock:function(){v=!0},unlock:function(){v=!1},getButtonBlocker:function(){b||(b=k(".continue-button-blocker"));return b}}});"use strict";q.when("A","button-blocker","client-side-metrics").register("button-blocker-controller",
function(a,l,g){function c(a,b){k[a]!==F&&k[a].state!==b&&(k[a].state=b,d())}function d(){var a=!0,b;f.each(k,function(d,c){b=c.owner;if(c.state===e.DISABLE_CONTINUE)return a=!1,l.show(b,c.toolTipMessage,c.buttonInlineMessage),h||(g.increaseCount("removeauijs12"),f(".continue-button-blocker").css("display","inline-block")),!1});a&&l.hide(b)}var f=a.$,k={},h=p.P&&p.P.AUI_BUILD_DATE,e={ENABLE_CONTINUE:"enableContinue",DISABLE_CONTINUE:"disableContinue"};a.on("checkout:beforeReload",function(){k={}});
return{disableContinue:function(a,b,h,f){f=f||"";k[b]===F&&(h?(k[b]!==F||(k[b]={state:e.ENABLE_CONTINUE,owner:a,toolTipMessage:h,buttonInlineMessage:f}),d()):p.console&&p.console.error&&console.error("_registerElement should not be called with an empty tooltip."));c(b,e.DISABLE_CONTINUE)},enableContinue:function(a){k[a]!==F&&c(a,e.ENABLE_CONTINUE)}}});"use strict";q.when("jQuery").register("cache-page-data-controller",function(a){var l={};return{clearCache:function(){l={}},setCachedPageData:function(g,
c,d,f,k){var h=[],e=!0;a(".cacheable-spp-panel").each(function(){var b=a(this),d;d=!b||b.find(".is-scheduled-delivery").length?!1:!0;if(!d)return e=!1;b.find(".expand-panel-button").removeClass("a-button-focus");h.push({id:b.attr("id"),content:b[0].outerHTML})});if(e){var n={panels:h};a(".cacheable-spp-section").each(function(){var b=a(this);n[b.attr("id")]=b[0].outerHTML});l[g+"-"+c]={curPageData:n,state:p.history?history.state:d,page:g,title:document.title||f,url:p.location.href||k}}},getCachedPageData:function(a,
c){return l[a+"-"+c]}}});"use strict";q.when("A").register("checkout-general-utils",function(a){function l(a,f,k,h){var e=c.getAssocParamValuesFromUrl(a);!k&&h?delete e[f]:e[f]=k;f=0<=a.indexOf("?")?a.substring(0,a.indexOf("?")):a;f=f+"?"+g.param(e,1);(a=c.getFragmentFromUrl(a))&&(f+="#"+a);return f}var g=a.$,c={moveToNextInput:function(a){a=a.nextAll(":visible").find("input").get(0);a!==[]&&a.focus()},hide:function(a){a.hide()},show:function(a){p.P&&p.P.AUI_BUILD_DATE&&a.hasClass("aok-hidden")&&
a.removeClass("aok-hidden");a.show()},getAssocParamValuesFromUrl:function(a){var c={};if("string"!==typeof a||-1===a.indexOf("?"))return c;a=a.slice(a.indexOf("?")+1);if(!a)return c;-1!=a.indexOf("#")&&(a=a.substring(a,a.indexOf("#")));a=a.split("\x26");for(var g=0;g<a.length;g++){var h=a[g].split("\x3d");c[h[0]]=h[1]}return c},addQueryStringParameter:function(a,c,g){return l(a,c,g,!1)},addQueryStringParameterOrDeleteIfEmpty:function(a,c,g){return l(a,c,g,!0)},getQueryStringParameter:function(a,f){a=
c.getAssocParamValuesFromUrl(a);return f in a?a[f]:F},getFragmentFromUrl:function(a){var c=a.indexOf("#");return-1==c?F:a.substring(c+1)},extractURLParts:function(a){if(!a||"string"!==typeof a)return{};a=/(.*html)(\/ref[^?\n]*)?[?]?(.*)/g.exec(a);var c={};a&&(a[1]&&(c.normalizedUrl=a[1]),a[2]&&(c.refMarker=a[2]),a[3]&&(c.query=a[3]));return c},redirectWithJavascript:function(a){p.location=c.addQueryStringParameter(a,"hasWorkingJavascript","1")},bindActionEnterKeyOnButton:function(a){a.keyup(function(a){13===
a.which&&g(a.target).trigger("click")})},toggleExpanderContent:function(a){a=a.$target.closest(".a-box");a.hasClass("a-single")?a.removeClass("a-single").addClass("a-first"):a.addClass("a-single").removeClass("a-first")},validateNumber:function(a,c,k){g.trim(a);return/^\d+$/.test(a)&&a>=c&&a<=k}};c.protectAgainstDoubleAction=function(){var a={};return function(c,g){if(!c)return p.console&&p.console.error&&console.error("Function is not used properly, use a unique owner to identify the caller."),!1;
if(a.hasOwnProperty(c))return!0;a[c]=1;setTimeout(function(){delete a[c]},g||100);return!1}}();c.logErrorOnLevel=function(a,c){(p.ueLogError||g.noop)({message:a,logLevel:c});if(p.console){var k={FATAL:p.console.error,"default":p.console.warn};c=k[c]||k["default"]}else c=g.noop;c.call(p,a)};c.logError=function(a){c.logErrorOnLevel(a,"FATAL")};c.updateCartByMash=function(a){q.when("safe-mash").execute(function(c){null!==a&&a!==F&&"1"===g("#updateCartByMash").attr("content")&&c&&c.cart&&c.cart.didUpdate&&
c.cart.didUpdate({newCartQuantity:a})})};c.getPosition=function(a,c,g){for(var h=0,e=a.length,n=0;n<e;n++)if(a.charAt(n)===c&&(h++,h===g))return n;return-1};c.limitInputToNumbers=function(a){var c=a.$event.keyCode;-1!==g.inArray(c,[46,8,9,37,39])||-1!==g.inArray(c,[65,67,86])&&!0===a.ctrlKey||(a.$event.shiftKey||(48>c||57<c)&&(96>c||105<c))&&a.$event.preventDefault()};c.nukeDropdowns=function(a){q.when("a-popover-base").execute(function(c){g.each(g(a),function(){c.remove(this.name)})})};a.on("checkout:reload",
function(){g('input[name\x3d"useLiveAUI"]').length||a.defer(function(){g(".a-declarative, .a-button").filter("[data-action]").unbind("keypress.checkout-page").bind("keypress.checkout-page",function(a){13===a.which&&g(this).trigger("click")})})});a.on("checkout:beforeLoadPage",function(){g("div.a-popover").find(".a-declarative:first:[data-action\x3dcustom-popover-close|a-popover-close]").click()});return c});"use strict";q.when("A","weblab-helper").register("client-side-metrics",function(a,l){var g=
a.$,c=null,d=null,f=0,k;a=function(){};var h=p.uet||a,e=p.uex||a,n=!1,b=!1,m=function(a){p.ue&&p.ue.t&&(p.uet(a,c),r("checkout:client-side-metrics:uet:marker:"+a,1,1),null===c&&null===d&&p.ue.isl&&(r("checkout:client-side-metrics:mark:at",1,1),p.uex("at")));"af"===a?n=!0:"fn"===a&&(b=!0)},v=function(a){p.ue&&p.uex&&(p.uex(a,c),r("checkout:client-side-metrics:uex:marker:"+a,1,1))},u=function(a){p.ue&&p.ues&&p.ues("id",c,a)},z=function(){p.ue&&p.ues&&p.ues("ctb",c,"1")},w=function(){p.ue&&p.ues&&(p.ues("t0",
c,(new Date).getTime()),m("ue"),m("bb"))},B=function(a){a?d="ctbajax"+f++:c="ajax"+f++},r=function(a,b,c){"undefined"!==typeof p.ue&&"undefined"!==typeof p.ue.count&&(b=b?b:1,c?p.ue.count(a,(p.ue.count(a)||0)+1):p.ue.count(a,b))},t=function(a){if(a&&a.length){var b=c;c=d;u(a);c=b}},H=function(){k===F&&(k=0<g("#transitionLogging").length);return k},y=function(a,b,c,d){p.ueLogError&&p.ueLogError(a,{message:b,attribution:c,logLevel:d})};return{getscope:function(){return c},getasyncscope:function(){return d},
setmarker:m,sendue:v,setrid:u,setctb:z,resetue:w,createscope:B,setscope:function(a){c=a},increaseCount:r,resetMetrics:function(){c=d;z();w()},setAsyncRequestId:t,sendUEPageLoadStats:function(){!l.isCSMErrorLoggingEnabled()||n&&b||y({message:"Logged ld without both af and fn logged first af:"+n+" fn:"+b},"","checkout-client-side-metrics","WARN");l.isLogAFFNFallbackEnabled()&&(!0===n&&r("checkout:client-side-metrics:page-load-stats:earlyaf",1),r("checkout:client-side-metrics:page-load-stats:af",1),
m("af"));l.isLogAFFNFallbackEnabled()&&(!0===b&&r("checkout:client-side-metrics:page-load-stats:earlyfn",1),r("checkout:client-side-metrics:page-load-stats:fn",1),m("fn"));v("ld");B(1);b=n=!1},isTransitionLoggingEnabled:H,logPageTransition:function(a,b,c,d){if(H()){var e=(new Date).getTime();g.ajax({type:"POST",url:"/gp/buy/shared/handlers/log-page-transition.html?cachebuster\x3d"+e,data:{fromPage:a,toPage:b},async:!0,cache:!1,timeout:1E3,success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-requestid");
t(e);c&&c.call(this,a,b,d)},complete:function(a,b){d&&d.call(this,a,b)}})}},logError:y,startWidgetTiming:function(a){h("bb",a,{wb:1})},finishWidgetTiming:function(a){e("ld",a,{wb:1})},setMarkerForWidget:function(a,b){h(a,b,{wb:1})},emitNexusMetrics:function(a,b,c){"undefined"!==typeof p.ue&&"undefined"!==typeof p.ue.event&&p.ue.event(a,b,c)}}});"use strict";q.register("currency-formatter",function(){function a(l,g){isNaN(g)||(l=Number(l).toFixed(g));l=l.toString();g=0<=l.lastIndexOf(".")?l.lastIndexOf("."):
l.length;return 3>=g?l:a(l.substring(0,g-3),0)+","+l.substring(g-3)}return{getNumberWithSeparators:a}});"use strict";q.when("A","client-side-metrics","page-conductor","page-detector").register("delivery-preferences-csm-helper",function(a,l,g,c){function d(a){var d=g.isSPP()?"spp":"mpp",f="desktop";c.isMobile()?f="mobile":c.isTablet()&&(f="tablet");l.increaseCount("checkout:delivery-preferences:"+f+":"+d+":"+a,1)}function f(a){return 0===a.length?"NoValueSet":a}var k=a.$;return{recordCSM:d,recordCSMWithCurrentFieldValues:function(a,
c,g){c=k("input[name\x3d"+c+"]:checked");c.length&&(c=c.val(),d(a+":preference:"+f(c)));g=k("input[name\x3d"+g+"]");g.length&&d(a+":set-as-default:"+(g.is(":checked")?"yes":"no"))},recordCSMForEligiblePages:function(a){a=a||"";d(a+"eligible-page-displayed");var c=k("input[name\x3ddelivery-preferences-preference-set]");c.length&&d(a+"summary-displayed:preference:"+f(c.val()))}}});"use strict";q.when("page-detector-current-page","A").register("error-feature-detection",function(a,l){function g(a){p.errorFeatureDetection&&
p.errorFeatureDetection.safelyLogError?p.errorFeatureDetection.safelyLogError(a):(p.ueLogError&&p.ueLogError(a),p.console&&p.console.error&&console.error(a))}try{l.on("page-detector:page-changed",function(){var c=a.getCurrentPage();if(c&&"spc"===c)try{p.errorFeatureDetection&&p.errorFeatureDetection.enableErrorHandling&&p.errorFeatureDetection.enableErrorHandling()}catch(d){g(d)}else try{p.errorFeatureDetection&&p.errorFeatureDetection.disableErrorHandling&&p.errorFeatureDetection.disableErrorHandling()}catch(d){g(d)}})}catch(c){g(c)}return{registerFeature:function(a,
d){try{p.errorFeatureDetection&&p.errorFeatureDetection.registerFeature&&p.errorFeatureDetection.registerFeature(a,d)}catch(f){g(f)}},markFeatureAvailable:function(a){try{p.errorFeatureDetection&&p.errorFeatureDetection.markFeatureAvailable&&p.errorFeatureDetection.markFeatureAvailable(a)}catch(d){g(d)}},markFeatureUnavailable:function(a){try{p.errorFeatureDetection&&p.errorFeatureDetection.markFeatureUnavailable&&p.errorFeatureDetection.markFeatureUnavailable(a)}catch(d){g(d)}}}});q.when("error-feature-detection").execute(function(a){a.registerFeature("continue-action",
0);a.markFeatureAvailable("javascript-detection");a.markFeatureAvailable("continue-action")});"use strict";q.when("A","loading-spinner-controller","ajax-utility","currency-formatter","page-conductor","page-transition-controller").register("inline-points-register-controller",function(a,l,g,c,d,f){function k(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,
String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))}function h(a){var b=u.$popover.find(".rewards-registration");l.hideSpinner(b);b.children("div").hide();b=b.find(".rewards-registration-error");a&&a.error?(a=b.find("[data-error\x3d'"+a.error+"']"),a.length?a.show():b.find("[data-error\x3d'rewards_SystemUnavailable']").show()):b.find("[data-error\x3d'rewards_SystemUnavailable']").show();b.fadeIn(300)}function e(a){u=a.popover;var b=u.$popover.find(".rewards-registration");
l.showSpinner(b,!1,u);a=b.data("issuer-id");var c=b.data("program-id"),d=b.data("cc-issuer"),e=b.data("cc-brand"),b=b.data("parent-payment-method-id"),f="/gp/buy/payselect/handlers/get-rewards-configuration.html?cachebuster\x3d"+(new Date).getTime();v.ajax({type:"POST",url:f,data:"programid\x3d"+c+"\x26partner\x3d"+a+"\x26ccpaymentinstrumentid\x3d"+b+"\x26issuer\x3d"+d+"\x26brand\x3d"+e+"\x26hasWorkingJavascript\x3d1",dataType:"text",async:!0,cache:!1,dataFilter:function(a){return g.jsonify(a)},success:function(a,
b,c){b=u.$popover.find(".rewards-registration");l.hideSpinner(b);c=a.fields||{};for(var d in c)if(c.hasOwnProperty(d)){var e=c[d],h=b.find("[data-field\x3d'"+e.type+"']");e.value&&h.filter("input").attr("value",e.value);h.parents(".rewardsfield").show()}a.termshtml&&b.find(".rewardstermstext").html(k(a.termshtml));a.billingzip&&b.find("[data-field\x3dBILLING_POSTAL_CODE]").attr("value",a.billingzip);if(a.displaydata){d=b.find("[data-field]");for(var f in a.displaydata)a.displaydata.hasOwnProperty(f)&&
d.filter("[data-field\x3d"+f+"]").html(a.displaydata[f])}a.marketinglink&&b.find("[data-field\x3d'rewards_marketing_link']").html(a.marketinglink);b.find("#rewards-registration-image").show();b.find(".rewards-registration-main").fadeIn(300);u.updatePosition(!0)},error:function(a){h(a)}})}function n(){if(u){var a=u.$popover.find(".rewards-registration");l.hideSpinner(a);a.find(".rewards-registration-success").hide();a=a.find(".rewards-registration-error");a.hide();a.find("h4").hide();z&&(f.show(),
d.isSPP()?d.reloadPage():v("div.pay").length?d.loadPage("payselect","payselect"):v("div.spc").length&&d.loadPage("spc","spc"))}}function b(a){return a.is("input")?a:a.find("input")}function m(){if(u){var a=u.$popover.find(".rewards-registration");a.find(".rewards-registration-main").hide();a.find("#rewards-registration-image").hide();l.showSpinner(a,!1,u);var d=(new Date).getTime(),e="programid\x3d"+encodeURIComponent(a.data("programId")),e=e+("\x26paymentinstrumentid\x3d"+encodeURIComponent(a.data("parent-payment-method-id"))+
"\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26cachebuster\x3d"+d),f=a.find("[data-field]");f.each(function(){var a=v(this).attr("data-field");if("CVV2"===a)e+="\x26registerRewardsCreditCardVerificationNumber\x3d"+encodeURIComponent(v(this).val());else if(v(this).data("entryindex")){if(1===v(this).data("entryindex")){var c=f.filter("[data-field\x3d"+a+"]").sort(function(a,b){return Number(v(a).data("entryindex"))-Number(v(b).data("entryindex"))});e+="\x26"+a+"\x3d";c.each(function(){e+=encodeURIComponent(v(this).val())})}}else"TERMS_AND_CONDITIONS"===
a?b(v(this)).is(":checked")&&(e+="\x26"+a+"\x3dtrue"):e+="\x26"+a+"\x3d"+encodeURIComponent(v(this).val())});d="ox_pay_page_swp_reg_popover_submit";a.data("programId")&&(d+="_"+a.data("programId"));a="/gp/buy/payselect/handlers/register-rewards-account.html/ref\x3d"+d+"?cachebuster\x3d"+(new Date).getTime();v.ajax({type:"POST",url:a,data:e,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return g.jsonify(a)},success:function(a,b,d){a?a&&0===a.success?h(a):u&&(b=u.$popover.find(".rewards-registration-success"),
b.find(".customername").text(a.customername),a.dollarbalancedisplay&&a.pointsbalance&&(b.find("[data-field\x3d'rewardsamount']").html(a.dollarbalancedisplay),b.find("[data-field\x3d'pointsamount']").html(c.getNumberWithSeparators(a.pointsbalance,a.rewardsdecimalplaces)),b.find(".rewardsuccessbalance").show()),a.showwarnmessage&&b.find(".warnmessage").show(),z=!0,b.fadeIn(300),l.hideSpinner(u.$popover.find(".rewards-registration"))):h()},error:function(a){h(a)}})}}var v=a.$,u,z=!1;a.on("a:popover:show:rewards-registration",
e);a.on("a:popover:hide:rewards-registration",n);a.declarative("close-rewards",["click"],function(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")});a.declarative("rewards-signup",["click"],function(a){a.$event.preventDefault();m(a)});a.declarative("toggle-reward-signup-button","change",function(a){a=a.$target;var b=u.$popover.find(".rewards-registration");a&&a.is(":checked")?(b.find("#reward-signup-button").removeClass("aok-hidden"),b.find("#disabled-reward-signup-button").addClass("aok-hidden")):
(b.find("#reward-signup-button").addClass("aok-hidden"),b.find("#disabled-reward-signup-button").removeClass("aok-hidden"))});a.on("a:popover:beforeShow:cvv2helpcontent",function(a){a.popover.$popover.find(".a-popover-inner").html(v(".cvv2helpcontent").text());a.popover.updatePosition()});return{displayRewardsRegister:e,hideRewardsRegister:n}});"use strict";q.when("A","error-feature-detection","safe-mash","ready").register("shared-kitchensink",function(a,l,g){var c=a.$;a.on("checkout:reload",function(){(c("body.a-touch").length||
c("div.a-touch:first").length)&&c("html").addClass("a-touch");c("form").each(function(){var a=c(this).find('input[name\x3d"hasWorkingJavascript"]');a&&0<a.length?a.val("1"):c(this).append('\x3cinput type\x3d"hidden" name\x3d"hasWorkingJavascript" value\x3d"1" /\x3e')});g&&(c("div.checkout-tablet a[target\x3d'AmazonHelp']").each(function(){var a=c(this).attr("href"),a=a+(0<=a.indexOf("?")?"\x26app-nav-type\x3dmodal":"?app-nav-type\x3dmodal"),a=a.replace("#","");c(this).attr("href",a);c(this).removeAttr("data-action");
c(this).removeAttr("data-help-popup");c(this).removeAttr("onclick")}),c("div.checkout.mobile a[target\x3d'AmazonHelp']").each(function(){var a=c(this).attr("href"),a=a.replace("#","");c(this).attr("href",a);c(this).removeAttr("data-help-popup");c(this).removeAttr("onclick");c(this).addClass("a-declarative help-popup");c(this).attr("data-action","help-popup")}));if(0<c("div.checkout-tablet").length)for(var a=document.getElementsByTagName("a"),f=0;f<a.length;f++)a[f].href||(a[f].href="#")});c(document).bind("jsdetection",
function(){l.markFeatureAvailable("javascript-detection")})});q.when("A","safe-mash","ready").execute(function(a,l){var g=a.$;a.declarative("mash-navigate",["click"],function(a){a=a.$currentTarget.attr("href");l&&l.navigate?l.navigate({url:a}):p.location.href=a});a.declarative("expander-scroll-there",["click"],function(a){if("false"!==a.$currentTarget.closest(".a-expander-container").find(".a-expander-content").attr("aria-expanded")){var d=g(p),f=g(document),k=a.$currentTarget.offset().top,h=0,e=
0,n=function(){p.setTimeout(function(){d.scrollTop(k);h===f.height()?e++:(e=0,h=f.height());10>e&&n()},10)};n()}})});p.amz_js_PopWin=function(a,l,g){(a=p.open(a,l,g))&&a.focus&&a.focus();return!1};var pa=!1;p.confirmPurchase_onSubmit||(p.confirmPurchase_onSubmit=function(){return pa?!1:pa=!0});"use strict";q.when("A","error-feature-detection","loading-spinner-spp-controller","loading-spinner-aui-controller").register("loading-spinner-controller",function(a,l,g,c){function d(){return k("#checkout-spinner").length}
function f(a){if(h&&e){var b,c,d;m&&z?(a=m.getContent(),b=a.innerHeight(),c=a.innerWidth()):(b=a.height(),c=a.width());d=a.offset();a=e.width();var f=e.height();if(n)d="1"===k("input[name\x3dfromAnywhere]").val()?k(document).height():k(p).height(),h.width(k(document).width()).height(d).css("left","0px").css("z-index",2E3),e.css("left",c/2-a/2+"px").css("top",b/2-f/2+"px").css("z-index",4E3).show();else{var g=k(p),l=z?g.scrollLeft():0;h.css("position","fixed").width(c).height(b).css("z-index",3E3).css("left",
d.left-l).css("top",d.top-g.scrollTop());v?e.css("position","fixed").css("left",d.left-l+(c/2-a/2)+"px").css("top",d.top-g.scrollTop()+(b/2-f/2)+"px").css("z-index",4E3).show():e.css("left",c/2-a/4+"px").css("top",b/2-f/4+"px").css("z-index",4E3).show()}}}var k=a.$,h,e,n,b,m,v=!1,u=!1,z=!1,w=!1;a.on("a:popover:positionUpdated",function(a){if(z&&m&&m.name===a.popover.name&&h&&e){var b=m.getContent();a=b.innerHeight();var c=b.innerWidth(),b=b.offset(),d=k(p);h.width(c).height(a).css("left",b.left-d.scrollLeft()).css("top",
b.top-d.scrollTop());e.css("left",b.left-d.scrollLeft()+(c/2-e.width()/2)+"px").css("top",b.top-d.scrollTop()+(a/2-e.height()/2)+"px")}});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",c=k("#first-pipeline-load-page-spinner-img");c.length&&(a=k.trim(c.attr("src")));1>k("#loading-spinner-blocker-doc").length&&(a=k(['\x3cdiv class\x3d"template loading-spinner" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-inner"\x3e',
'\x3cimg id\x3d"loading-spinner-img" class\x3d"loading-spinner-img" src\x3d"'+a+'"/\x3e','\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"loading-spinner-blocker-doc" class\x3d"loading-spinner-blocker" style\x3d"display:none;"\x3e\x3c/div\x3e\x3cdiv id\x3d"spinner-anchor" class\x3d"spinner-anchor" style\x3d"display:none"\x3e\x3c/div\x3e'].join("")),e=h=b=null,"1"===k("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),k("body").prepend(a));k("input[name\x3duseModifiedSpinnerResizeFn]").length&&
(v=!0);k("#useRelativeSpinner").length&&(u=!0);k("#modifiedBlockerDivSize").length&&(z=!0)});return{showSpinner:function(a,r,t){if(u&&!r&&z&&v&&t)return w=!0,g.showSpinner(a,t);d()?c.showSpinner():(w=!1,0!==a.length&&(m=(n=r)?F:t,b||(b=k(".loading-spinner.template").clone().removeClass("template"),b.show()),a.append(b),n?(h=k("#loading-spinner-blocker-doc"),a.find(".loading-spinner-blocker").hide()):h=a.find(".loading-spinner-blocker"),h.show(),n&&l.markFeatureUnavailable("continue-action"),e=a.find(".loading-spinner-inner"),
f(a)))},hideSpinner:function(a,e){if(d())return c.hideSpinner();if(w)return w=!1,g.hideSpinner(a,e);w=!1;h&&(n&&(h.hide(),l.markFeatureAvailable("continue-action")),b.detach());e&&a.hide()},adjustSize:function(a){return d()?c.adjustSize():w?g.adjustSize():f(a)}}});"use strict";q.when("A","error-feature-detection").register("loading-spinner-spp-controller",function(a,l){function g(){if(d&&f){var a=h.innerHeight(),b=h.innerWidth();d.width(b).height(a);f.css("left",b/2-f.width()/2+"px").css("top",a/
2-f.height()/2+"px")}}var c=a.$,d,f,k,h,e;a.on("a:popover:positionUpdated",function(a){e&&e.name===a.popover.name&&g()});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",b=c("#first-pipeline-load-page-spinner-img");b.length&&(a=c.trim(b.attr("src")));1>c(".loading-spinner-spp").length&&(a=c(['\x3cdiv class\x3d"template loading-spinner-spp" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-spp-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-spp-inner"\x3e',
'\x3cimg class\x3d"loading-spinner-spp-img" src\x3d"'+a+'"/\x3e',"\x3c/div\x3e\x3c/div\x3e"].join("")),f=d=k=null,"1"===c("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),c("body").prepend(a))});return{showSpinner:function(a,b){0!==a.length&&(e=b,h=a,k||(k=c(".loading-spinner-spp.template").clone().removeClass("template"),k.show()),b.getContent().before(k),h.prepend(k),d=h.find(".loading-spinner-spp-blocker"),d.show(),f=h.find(".loading-spinner-spp-inner"),
g())},hideSpinner:function(a,b){d&&k.detach();b&&a.hide()},adjustSize:g}});"use strict";q.when("A","error-feature-detection").register("loading-spinner-aui-controller",function(a,l){function g(){return c("#checkoutDisplayPage").outerHeight()}var c=a.$;return{showSpinner:function(){l.markFeatureUnavailable("continue-action");var d=c("#checkout-spinner");a.show(c("#checkout-spinner-overwrap").height(g()));d.attr("aria-busy","true");a.show(d)},hideSpinner:function(){l.markFeatureAvailable("continue-action");
var d=c("#checkout-spinner");a.hide(c("#checkout-spinner-overwrap"));d.attr("aria-busy","false");a.hide(d)},adjustSize:function(){var d=c("#checkout-spinner-overwrap");d.is(":visible")&&a.show(d.height(g()))}}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","client-side-metrics","safe-mash","cache-page-data-controller","ajax-wrapper","widget-streamer","widget-streamer-utils","weblab-helper","temporary-preference-indicator").register("page-conductor",
function(a,l,g,c,d,f,k,h,e,n,b,m,v){function u(a){p.ueLogError&&p.ueLogError({message:a},{logLevel:"WARN",attribution:"CheckoutCommonAsset-PageConductor"})}function z(a){ja&&(a?(a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"),a["x-amz-checkout-type"]||(a["x-amz-checkout-type"]="spp")):a={"x-amz-checkout-transition":"ajax","x-amz-checkout-type":"spp"});m.isPipelineDispatchSendHeaderEnabled()&&(a?a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"):a={"x-amz-checkout-transition":"ajax"});
return a}function w(){na=!1;ca=null;sa=0;T=!1;qa=ua=va=null}function B(a){var b=parseInt(Q("#checkoutDisplayPage").data("delaySetTitle"),10)||0;b?p.setTimeout(function(){document.title=a},b):document.title=a}function r(b){"function"===typeof a.state.parse&&a.state.parse();a.trigger("checkout:beforeReload");a.trigger("checkout:reload");b&&("spp-revieworder"===b?a.trigger("checkout:reload:spc"):a.trigger("checkout:reload:"+b));a.trigger("checkout:afterReload")}function t(a){l.show();var b="/gp/buy/addtocart/handlers/display.html";
a&&(b+="?errorType\x3d"+a);p.location=b}function H(b){(b=Q("#pageTypeRedirectedTo").text())&&a.trigger("checkout:reload:"+b)}function y(b,c){var d;if(c.getResponseHeader("x-amz-force-full-page-update"))G(b);else{if(c.getResponseHeader("x-amz-checkout-redirect-addtocart")){(c=g.jsonify(b))?t(c.errorCode):t();return}d=ha(b)}b=Q("#pipelinedPageTitle").text();B(b);var e=c.getResponseHeader("x-amz-checkout-page");ja?a.delay(function(){r(e)},d):r(e)}function G(a){var b=document.open("text/html","replace");
b.write(a);b.close()}function E(a,b){try{if(b.getResponseHeader("x-amz-force-full-page-update"))G(a);else{if(!wa)throw Error("Member _updateDisplayPageContent not set in page-conductor. Make sure 'initFunc' is called.");wa(a)}}catch(c){a="Error while replacing page content.",c.message&&(a+="  Error message: "+c.message),q.error(a,"page-conductor","replaceDisplayPage",c)}a=Q("#pipelinedPageTitle").text();B(a);b=b.getResponseHeader("x-amz-checkout-page");r(b)}function I(a){var b=parseInt(Q("#showPageTransition").attr("content"),
10);(b=isNaN(b)?1:b)||l.hide();b="/gp/buy/shared/handlers/dispatch.html";a&&(a.conductoraction&&a.conductoraction.url?b=a.conductoraction.url:a.pipedata&&a.pipedata.conductoraction&&a.pipedata.conductoraction.url&&(b=a.pipedata.conductoraction.url));b=0<b.indexOf("?")?b+"\x26":b+"?";Q("input[name\x3dfromAnywhere][value\x3d1]").length&&(b+="fromAnywhere\x3d1");b=A(b);k&&Q("html").hasClass("a-tablet")&&-1<b.indexOf("/gp/cart/view.html")&&(b="/gp/aw/c?app-action\x3dcart");p.location=b}function da(a,
b,c,d,e){d=d||{};d.pushNewFrame=d.pushNewFrame||"true";d.anchor=d.anchor||F;w();"true"===d.pushNewFrame&&k&&k.navigate&&Q("#checkoutDisplayPage").data("useMashNavigateForTransitions")?k.navigate({url:null,transitionEffect:"slide",successCallback:function(){D(a,b,c,d,e)},failCallback:function(a){}}):D(a,b,c,d,e);d.keepCachedPagesData||h.clearCache()}function W(){var a=Q("input#isPipelinedPage");return 0<a.length&&"1"===a.val()}function P(a){return m.isExecutionIdInQueryStringEnabled()?a?a.getResponseHeader("x-amz-checkout-executionid"):
d.getQueryStringParameter(p.location.href,"executionId"):Q("input#executionId").val()}function D(d,e,h,n,t){function k(a){var b=h.getResponseHeader(a);null==b&&(f.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader"),f.increaseCount("Checkout:PageConductor:Ajax:Update:MissingHeader:"+a),u("performUpdatePageFromResponse is missing required header "+a));return b}function l(a){var b=/^\s*\<(?:!doctype|html)/;if("string"===typeof a&&a.match(b)){var b=(new DOMParser).parseFromString(a,"text/html"),
c=Q(b).find("#checkoutDisplayPage");if(0<c.length)return f.increaseCount("Checkout:PageConductor:Ajax:Update:CenterContentExtracted"),c[0].outerHTML;b=Q(b).find("body");if(0<b.length)return f.increaseCount("Checkout:PageConductor:Ajax:Update:BodyExtracted"),b[0].outerHTML}return a}n=n||{};n.pushNewFrame=n.pushNewFrame||"true";n.anchor=n.anchor||F;var ga=k("x-amz-checkout-page"),v=k("x-amz-checkout-requestid");c.setCurrentPage(ga);if(n.freshLoad)n.freshLoad=!1,q.when("first-load-dependencies").execute(function(a){D(d,
e,h,n)});else if(ga){Q("head .aui-page-asset").removeAttr("disabled");Q("head .old-pipeline-asset").removeAttr("disabled");f.setAsyncRequestId(v);var Z=h.getResponseHeader("x-amz-checkout-redirect");if(Z)I({conductoraction:{url:Z,type:"redirect"}});else{m.isIngressEnabled()&&(d=l(d));if(m.isAJAXWeblabOn()&&b.isStreamingAjax(h))m.isAjaxStreamingEnabled()?r(ga):(H(h),U(d,ga));else if(a.trigger("checkout:unload"),0<Q("#checkoutDisplayPage").length?E(d,h):y(d,h),m.isAjaxStreamingEnabled()&&W()){var Z=
Q("#pipelinedPageTitle").text(),B=k("x-amz-checkout-url"),G=h.getResponseHeader("x-amz-checkout-additional-page-args");N(ga,Z,B,P(h),G,n.anchor,n.pushNewFrame)}!m.isAjaxStreamingEnabled()&&W()&&(Z=Q("#pipelinedPageTitle").text(),B=k("x-amz-checkout-url"),G=h.getResponseHeader("x-amz-checkout-additional-page-args"),N(ga,Z,B,P(h),G,n.anchor,n.pushNewFrame));n.anchor&&(ga=Q(n.anchor),0===ga.length&&(ga=n.anchor.replace("#",""),ga=Q(document.getElementsByName(ga))),ga.length&&Q(document).scrollTop(ga.offset().top));
n.logUsedPrefetch&&q.when("action-logger").execute(function(a){a.logUsedPrefetch(k("x-amz-checkout-page-type"),k("x-amz-checkout-sub-page-type"),v,t)})}}else{if(p.getOldAjaxSuccessCallback)return p.getOldAjaxSuccessCallback("ajaxConductor","generalErrorHandling","generalErrorHandling")(d,e,h);d=g.jsonify(d);I(d)}}function N(a,b,c,e,h,f,g){b&&c&&p.history&&p.history.pushState&&(m.isExecutionIdInQueryStringEnabled()?"true"!==g||history.state&&history.state.page===a||(c=A(c),f&&(c+=f),e&&(c=d.addQueryStringParameterOrDeleteIfEmpty(c,
"executionId",e)),history.pushState({page:a,additionalURLArgs:h},b,c)):(c=A(c),f&&(c+=f),e&&(c=d.addQueryStringParameter(c,"executionId",e)),"true"===g&&history.state&&history.state.page!==a&&history.pushState({page:a,additionalURLArgs:h},b,c)))}function U(a,b){a.executeActions();a=Q("#pipelinedPageTitle").text();B(a);r(b)}function x(){p.location=Fa?"/gp/buy/addtocart/handlers/display.html":"/gp/buy/payselect/handlers/error.html"}function L(c,d,h,f,g,n){f=f||{};f.refTag=f.refTag||"";f.pushNewFrame=
f.pushNewFrame||"true";f.anchor=f.anchor||F;f.refTag&&0!==f.refTag.indexOf("/ref\x3d")&&(f.refTag="/ref\x3d"+f.refTag);c="fromPage\x3d"+c+"\x26page\x3d"+d;(n=P(n))&&(c+="\x26executionId\x3d"+n);h&&(c+="\x26"+h);h=function(){};n=function(){};var t;"function"===typeof f.resultscallback?(d=function(a,b,c){f.resultscallback(a,b,c)},t=function(a,b,c){f.resultscallback(F,b,a)}):(h=function(b){a.trigger("checkout:beforeLoadPage");K&&K.abort();K=b},d=function(a,c,d){m.isAJAXWeblabOn()&&b.isStreamingAjax(d)||
f.callbackBeforePageUpdate&&f.callbackBeforePageUpdate();da(a,c,d,f);f.callbackAfterPageUpdate&&f.callbackAfterPageUpdate()},t=function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===e.READY_STATE.UNSET?q.when("a-tv","mash").execute(function(a,b){p.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):(ba(a,b),x()))},n=function(a){K=null});g={type:"GET",url:(g?g:"/gp/buy/shared/handlers/pipeline-dispatch.html")+f.refTag,data:c,dataType:"text",async:!0,beforeSend:h,success:d,error:t,complete:n,
cache:!1};if(ja||m.isPipelineDispatchSendHeaderEnabled())g.headers=z({"x-amz-checkout-transition":"ajax"});return m.isAJAXWeblabOn()?(g.useXMLHttp=!0,g=m.isAjaxStreamingEnabled()?O(g,f.callbackBeforePageUpdate,f.anchor,f.pushNewFrame):O(g,f.callbackBeforePageUpdate),e.aui(g)):Q.ajax(g)}function O(d,e,h,f){d.timeout=5E4;d.data=V(d.data,"acceptsStreaming\x3d1");var g;g=d.data.match(/.*isAsync=1.*/)?!0:!1;M=n({$target:Q("#checkoutDisplayPage"),updateTriggerEvent:"pageReady",immediateExecution:!g,updateTarget:Q("#checkoutDisplayPage"),
onUpdate:function(b){"function"===typeof e&&e();a.trigger("checkout:unload");B(b.title);N(b.page,b.title,b.url,b.executionId,b.additionalURLArgs,h,f||"true");c.setCurrentPage(b.page)}});d.chunk=M.chunkHandler;if(!m.isAjaxStreamingEnabled()){var t=d.success;d.success=function(a,c,d){t&&b.isStreamingAjax(d)?t(M,c,d):t&&t(a,c,d)}}return d}function V(a,b){return a?a+"\x26"+b:b}function ba(a,b){f.increaseCount("Checkout:PageConductor:Ajax:Error");m.isAJAXWeblabOn()?(a?(f.increaseCount("Checkout:AUI:Ajax:jqXHR:defined"),
u("jqXHR defined throw CheckoutErrorAW under AJAX Weblab, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===F?(f.increaseCount("Checkout:AUI:Ajax:jqXHR:undefined"),u("jqXHR undefined throw CheckoutErrorAW under AJAX Weblab")):null===a&&(f.increaseCount("Checkout:AUI:Ajax:jqXHR:null"),u("jqXHR null throw CheckoutErrorAW under AJAX Weblab")),f.increaseCount("Checkout:AUI:Ajax:Error:textStatus:"+b),f.increaseCount("Checkout:AUI:Ajax:Error:statusCode:"+a.status),f.increaseCount("Checkout:AUI:Ajax:Error:readyState:"+
a.readyState)):(a?(f.increaseCount("Checkout:jQuery:Ajax:jqXHR:defined"),u("jqXHR defined throw CheckoutErrorAW using jQuery, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===F?(f.increaseCount("Checkout:jQuery:Ajax:jqXHR:undefined"),u("jqXHR undefined throw CheckoutErrorAW using jQuery")):null===a&&(f.increaseCount("Checkout:jQuery:Ajax:jqXHR:null"),u("jqXHR null throw CheckoutErrorAW using jQuery")),f.increaseCount("Checkout:jQuery:Ajax:Error:textStatus:"+b),f.increaseCount("Checkout:jQuery:Ajax:Error:statusCode:"+
a.status),f.increaseCount("Checkout:jQuery:Ajax:Error:readyState:"+a.readyState))}function fa(a,b,c,h){var g=a;b=V(b,"isClientTimeBased\x3d1");var n;if(m.refactorExtractURL()){n=d.extractURLParts(a);a=n.normalizedUrl;if(!a)return f.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:T1"),u("Unable to normalize url ["+g+"]. Ajax request aborted."),!1;var t=a.indexOf("/gp/buy/");0<t?(a=a.substring(t),f.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:T1")):f.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:T1");
n.query?(b+="\x26"+n.query,f.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:T1")):f.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:T1");n=n.refMarker;n||(f.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:T1"),n="");n&&-1===n.indexOf("ref\x3d")&&(f.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:T1"),n="")}else{var k=a.indexOf("?");0<k?(b+="\x26"+a.substring(k+1),a=a.substring(0,k),f.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:C")):
f.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:C");t=a.indexOf("/gp/buy/");0<t?(a=a.substring(t),f.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:C")):f.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:C");if(k=-1!=a.indexOf("/checkout/p/p-"))a=a.slice(a.indexOf("/checkout/p/p-")),f.increaseCount("Checkout:PageConductor:submitAjax:url:chewbacca:C");else{if(-1===a.indexOf(".html"))return f.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:C"),
u("url ["+g+"] is missing html extension and not a chewbacca call. Ajax request aborted."),!1;g=a.indexOf(".html");n=a.substring(g+5);a=a.substring(0,g+5)}n||f.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:C");n&&-1===n.indexOf("ref\x3d")&&(f.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:C"),n="")}b+="\x26handler\x3d"+a;a={type:"POST",url:k?a:"/gp/buy/shared/handlers/async-continue.html"+n,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
headers:z({"x-amz-checkout-transition":"ajax"}),data:b,dataType:"text",async:!0,success:c,error:function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===e.READY_STATE.UNSET?q.when("a-tv","mash").execute(function(a,b){p.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):"function"===typeof h&&(ba(a,b),h()))},cache:!1};return m.isAJAXWeblabOn()?(a.useXMLHttp=!0,O(a),e.aui(a)):Q.ajax(a)}function aa(a,b,c,d,e){e=e&&e.action?e.action:a.attr("action");a=a.serialize();d&&(a+="\x26isAsync\x3d1");
return fa(e,a,b,c)}function X(a,b,c,d){a=A(a.attr("href"));d&&(a+="\x26isAsync\x3d1");return fa(a,"",b,c)}function ea(a){a=a||{};a.logUsedPrefetch=1;da(ca.data,ca.status,ca.response,a,ca.refMarker)}function A(a){-1===a.toLowerCase().indexOf("hasworkingjavascript")&&(a+=(0<=a.indexOf("?")?"\x26":"?")+"hasWorkingJavascript\x3d1");return a}function Y(a){T=!1;var b=c.getCurrentPage(),d=qa-ua,e=sa;xa&&clearTimeout(xa);if(a.is("form"))Z(a)?(ea(),f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+
e+":Success"),f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":TimeSaved",d)):(aa(a,da,x),f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":Failure:Invalid"));else if(a.is("a"))if(ka(a)){var h;1===parseInt(a.data("keepCachedPagesData"),10)&&(h={keepCachedPagesData:1});ea(h);f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":Success");f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":TimeSaved",d)}else X(a,da,x),f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+
e+":Failure:Invalid");else f.increaseCount("Checkout:"+b+":PageConductor:Prefetch:"+e+":Failure:NoTrigger"),q.error("function called without a trigger","page-conductor","handleContinueAction")}function Z(a){return a.is("form")&&null!==ca&&ca.serializedValue===a.serialize()}function ka(a){return a.is("a")&&null!==ca&&A(ca.serializedValue)===A(a.attr("href"))}function ga(a){return ia&&(a.is("form")&&ia!==a.serialize()||a.is("a")&&A(ia)!==A(a.attr("href")))}function R(a,e,h,n,t){function k(c,d,v){var E=
!0;if("success"===d){if(!m.isAJAXWeblabOn()||!b.isStreamingAjax(v)){var B=g.jsonify(c);null!==B&&B&&B.result&&"noPrefetch"===B.result&&(ca=null,E=!1)}E&&(ca={},ca.serializedValue=Z,ca.data=c,ca.status=d,ca.response=v,ca.refMarker=ga,null==qa&&(qa=(new Date).getTime()))}else ca=null,f.increaseCount("Checkout:"+l+":PageConductor:Prefetch:"+sa+":Failure:Response");na=!1;ja&&q.when("spp-button-blocker").execute(function(a){a.hideDefaultContinueBtnBlocker()});if(T)return Y(va),!0;if(E){var u=function(){n?
R(a,e,h,!0,t):ra(a)};if(null===ca||"form"===r&&ca.serializedValue!==a.serialize())return u(),!0;e&&(0===e?f.increaseCount("checkoutPrefetchTimeoutSetToZero",1):xa=setTimeout(function(){ca=null;u()},1E3*e))}return!0}if(!W()||0===a.length)return!1;var r=a.get(0).tagName.toLowerCase();if("form"!==r&&"a"!==r||"function"===typeof t&&!t(r))return!1;e=e||0;h=h||0;n=n||!1;if(na||sa>=h)return!1;na=!0;ja&&q.when("spp-button-blocker").execute(function(a){a.showDefaultContinueBtnBlocker()});sa++;var l=c.getCurrentPage();
ua=(new Date).getTime();qa=null;f.increaseCount("Checkout:"+l+":PageConductor:Prefetch:"+sa+":Attempted");xa&&clearTimeout(xa);var ga=d.extractURLParts("form"===r?a.attr("action"):a.attr("href")).refMarker,v,Z=null;"form"===r?(Z=a.serialize(),v=m.isAJAXWeblabOn()?aa(a,k,k,!0):aa(a,null,null,!0)):"a"===r&&(Z=A(a.attr("href")),v=m.isAJAXWeblabOn()?X(a,k,k,!0):X(a,null,null,!0));m.isAjaxStreamingEnabled()&&Z&&(ia=Z);"object"!==typeof v||"function"!==typeof v.always||m.isAJAXWeblabOn()||v.always(k)}function ra(a){var b=
parseInt(a.data("prefetchTimeout"),10),c=parseInt(a.data("maxPrefetches"),10);return R(a,b,c,!1,function(b){if(a.find("input:checked").hasClass("no-prefetch"))return!1;if(m.disablePrefetchForScheduledDeliveryWeblabOn()){var c=a.find("div.one-shipment:not(:hidden)").find("input:checked");if(c.parents('[data-a-input-name\x3d"'+c.attr("name")+'"]').hasClass("no-prefetch"))return!1}return"1"===Q("input#block-prefetch").val()||"1"===Q("input#block-all-prefetch").val()||"form"===b&&!a.data("checkoutFormReady")?
!1:!0})}function ta(){var a=c.getCurrentPage();return"payselect"===a||"spp-payment"===a||"pay"===a}function S(b,c){na&&null==qa&&(qa=(new Date).getTime());b&&b.preventDefault();v.isTemporaryPaymentPreferenceFeatureEnabled&&v.isTemporaryPaymentPreferenceFeatureEnabled()&&ta()&&v.hasActiveTemporaryPreference&&v.hasActiveTemporaryPreference()&&w();var d=b?Q(b.currentTarget):c;b=function(){if(ja){l.blockAllActions();var a=d.data("shrink-panel"),b=d.data("loading-text");(a=Q("#"+a))&&a.length?a.hasClass("expanded")||
l.shrinkPanel(Q(".spp-panel.expanded"),!1):a=Q(".spp-panel.expanded");l.shrinkPanel(a,!0,b)}else l.show()};f.resetMetrics();!ya||Z(d)||ka(d)?b():a.delay(b,0);try{T=!0,va=d,m.isAjaxStreamingEnabled()&&M&&!ga(d)&&M.enableExecution(),na||Y(d)}catch(e){b="An error occured while click on the continue button.",e.message&&(b+="  Error message: "+e.message),q.error(b,"page-conductor","continueClicked",e)}}function Ba(){Q("#checkout-btf-spinner").addClass("aok-hidden")}var Q=a.$,na,ua,qa,K,ca,sa,T,va,xa,la,
wa,ia,ha=function(a){if(!la)throw Error("Member _updatePageContent not set in page-conductor. Make sure 'initFunc' is called.");return la(a)},ja=!1,Fa=!1,oa=!1,ya=!1,za=!1,M;w();a.declarative("page-transit-no-update-action","click",function(b){if(!oa){b.$event.preventDefault();f.resetMetrics();var d=b.data.targetDeclarativeActionId;if(d&&(d=Q("#"+d),d.length)){d.trigger("click");return}var e=b.data.toPage,d=b.data.fromPage||c.getCurrentPage(),g=b.data.refTag||"chk_"+d+"_cancel_pri",n=b.data.args,
t=b.$currentTarget.find("a.checkout-pipeline-pref-link");ja&&(m.isCachingOfPSPPanelOnTrueSPCDisabled()&&"spp-payment"===d?f.increaseCount("checkout:trueSPC:disableCachingPSP:"+e,1):h.setCachedPageData(d,e));if(h.getCachedPageData(e,d)){f.increaseCount("checkout:"+d+":cancelpri",1);g=h.getCachedPageData(e,d);w();c.setCurrentPage(g.page);var k;k=m.isAJAXWeblabOn()?ha(g.curPageData):ha(JSON.stringify(g.curPageData));if(ja)if(f.isTransitionLoggingEnabled()){var ga=(new Date).getTime();f.logPageTransition(d+
"-cached",e,F,function(b){b=(new Date).getTime()-ga;b<k?a.delay(function(){r(e)},k-b):r(e)})}else a.delay(function(){r(e)},k);else r(e);g.title&&g.url&&p.history&&p.history.pushState&&history.state&&history.state.page!==g.page&&history.pushState(g.state,g.title,g.url)}else t.length?S(null,t):(f.increaseCount("checkoutSPPCancelNoCachedData",1),t=function(){if(ja)if(l.blockAllActions(),b.data.noShrink)l.show();else{var a=b.data.loadingText,c=Q("#"+b.data.shrinkPanel);c.length||(c=b.$currentTarget.closest("div.spp-panel"));
l.shrinkPanel(c,!0,a)}else l.show()},ya?a.delay(t,0):t(),L(d,e,n,{refTag:g,keepCachedPagesData:1}))}});m.isAjaxStreamingEnabled()&&(a.on("checkout:page:atf",function(){l.hide();Q("#checkout-btf-spinner").removeClass("aok-hidden")}),a.on("checkout:page:end",function(){Ba()}));a.on("ready",function(){ya=0<Q("#executeNonBlockingAnimations").length;za=0<Q("#prefetchFromAddressEnabled").length});a.on("checkout:afterReload",function(){l.hide();m.isAjaxStreamingEnabled()&&Ba();a.delay(f.sendUEPageLoadStats);
if(W()){var b=Q("form.checkout-page-form:not(:disabled):first"),c=Q("a.checkout-continue-link:not(:disabled):first");Q("#useFirstActivePrefetch").length&&(c=Q("a.checkout-continue-link:not(:disabled)").filter(function(){return 0<(parseInt(Q(this).data("maxPrefetches"),10)||0)}).first());var d=!1;b.length&&(d=ra(b));!d&&c.length&&(d=ra(c));!d&&ja&&(b=Q("a.checkout-pipeline-pref-link:not(:disabled):first"),b.length&&(c=b.data("fromPage"),d=b.data("toPage"),h.getCachedPageData(d,c)||(d=ra(b))))}});return{ajaxUpdatePage:da,
ajaxRedirect:I,ajaxSorryPage:x,isPageLoadRequestInProgress:function(){return K?1:0},submitFormAjax:aa,reloadPage:function(){var a=c.getCurrentPage();L(a,a)},loadPage:L,usePrefetch:ea,makePrefetch:ra,makePrefetchWithParams:R,isPrefetchValidFor:function(a){if(null!==ca){var b=ca.response.getResponseHeader("x-amz-checkout-page");return a===b}return!1},redirect:I,continueClicked:S,initFunc:function(a,b){la=a;wa=b},overrideIsSPP:function(a){ja=a},isSPP:function(){return ja},overrideAddToCart:function(a){Fa=
a},isAnimating:function(){return oa},overrideIsAnimating:function(a){oa=a},setAjaxTransitionHeader:z,isPipeliningOn:W,disablePageNoUpdateTransition:function(){za&&q.when("a-button").execute(function(a){var b=Q(".spp-panel.expanded").data("stepIndex");Q(".expand-collapsed-panel-trigger").each(function(){var c=Q(this),d=c.parents(".spp-panel").data("stepIndex");if(!b||!d||d>b)c.filter(".clickable-heading").removeClass("clickable-heading").addClass("off-clickable-heading"),a(c.filter(".expand-panel-button")).disable(),
c.filter("a.expand-panel-button").addClass("disabled-link"),c.parents(".a-declarative").addClass("off-declarative").removeClass("a-declarative")});Q(".panel-cancel-row").hide()})},enablePageNoUpdateTransition:function(){za&&q.when("a-button").execute(function(a){Q(".off-clickable-heading").addClass("clickable-heading").removeClass("off-clickable-heading");a(".expand-collapsed-panel-trigger.expand-panel-button").enable();Q(".off-declarative").addClass("a-declarative").removeClass("off-declarative")})},
isNonBlockingAnimationEnabled:function(){return ya},isPrefetchFromAddressEnabled:function(){return za},getExecutionId:P,isPrefetchRequestInProgress:function(){return na}}});q.when("jQuery","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","page-conductor","cache-page-data-controller","client-side-metrics","weblab-helper","ready").execute(function(a,l,g,c,d,f,k,h,e){if(f.isPipeliningOn()){p.history&&a(p).bind("popstate",function(){var b=this.history.state,
d=c.getCurrentPage();b&&b.page&&d&&(b.page!==d||f.isPageLoadRequestInProgress())&&(l.show(),d=a("#checkoutDisplayPage"),d.data("wipeOnPipelineBackTransition")&&d.empty(),h.resetMetrics(),a("#useFastBackButton").length&&f.isPrefetchValidFor(b.page)?f.usePrefetch({pushNewFrame:!1}):(d="spc"===b.page?"":b.page,f.loadPage(c.getCurrentPage(),d,b.additionalURLArgs,{refTag:"pipelinedBackButton",pushNewFrame:"false"})))});a(document).delegate("form.checkout-page-form","change",function(b){a(b.target).parent().hasClass("no-prefetch-on-change")||
(b=a(b.currentTarget),f.makePrefetch(b))});a(document).delegate("form.checkout-page-form","submit",function(a){f.continueClicked(a)});a(document).delegate("a.checkout-continue-link","click",function(a){f.continueClicked(a)});a(document).delegate("form.checkout-page-form .submit-button-with-name","click",function(b){b=a(b.currentTarget);a("\x3cinput\x3e").attr({type:"hidden",name:b.attr("name"),value:b.val()}).appendTo(b.closest("form.checkout-page-form"))});var n=!1;a(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a",
"touchmove",function(a){n=!0});a(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","click keypress touchend",function(b){if(n)n=!1,b.preventDefault();else if(d.protectAgainstDoubleAction("pipeline-link"))b.preventDefault();else if("keypress"!==b.type||13===b.which){var c=a(b.currentTarget),e=c.data("pipelineLinkFromPage"),g=c.data("pipelineLinkToPage"),z=c.data("pipelineLinkAnchor"),w=c.data("pipelineLinkRef");w||((w=d.extractURLParts(c.attr("href")).refMarker)?h.increaseCount("Checkout:PageConductor:LoadPage:AddedRefMarker"):
h.increaseCount("Checkout:PageConductor:LoadPage:NoRefMarkerInUrl"));c=c.data("pipelineLinkArgs");g&&(h.resetMetrics(),b.preventDefault(),f.isSPP()&&k.setCachedPageData(e,g),l.show(),b={refTag:w,anchor:z},f.isSPP()&&(b.keepCachedPagesData=1),f.loadPage(e,g,c,b))}});a(document).delegate("a.spclite-dispatch-link","click keypress touchend",function(b){if("keypress"!==b.type||13===b.which){var c=a(b.currentTarget),d=c.data("spcliteLinkFromPage"),e=c.data("spcliteLinkToPage");c.data("spcliteLinkAnchor");
var h=c.data("spcliteLinkRef"),c=c.data("spcliteLinkArgs"),g=a("input#executionId").val(),c=c?c+("\x26executionId\x3d"+g):"executionId\x3d"+g;e&&(b.preventDefault(),l.show(),f.loadPage(d,e,c,{refTag:h},"/gp/buy/shared/handlers/spclite-dispatch.html"))}})}a(document).delegate("input.submit","click touchend",function(){h.resetMetrics()});a(document).delegate("form","submit",function(){h.resetMetrics()});a(document).delegate(".panel-cancel-row a, .clickable-heading","click",function(){h.isTransitionLoggingEnabled()&&
h.resetMetrics()});e.isExecutionIdInQueryStringEnabled()&&(a.ajaxSetup({beforeSend:function(a,c){c.url&&(a=d.getQueryStringParameter(p.location.href,"executionId"),c.url=d.addQueryStringParameterOrDeleteIfEmpty(decodeURIComponent(c.url),"executionId",a));return!0}}),a(document).ajaxSuccess(function(a,c,e){if(e&&e.url&&e.url.match(/\/async-continue|\/set-|\/update-|\/new/i)&&(a=c.getResponseHeader("x-amz-checkout-sub-page-type")||"Unknown",!a.match(/^p-/))){e=f.getExecutionId(c);if(p.history&&p.history.replaceState){var g=
d.addQueryStringParameterOrDeleteIfEmpty(p.location.href,"executionId",e,!0);p.history.replaceState(p.history.state,"",g)}else h.increaseCount("Checkout:PageConductor:NoReplaceState");e||(c=c.getResponseHeader("x-amz-checkout-page-type")||"Unknown",h.increaseCount("Checkout:PageConductor:"+(null===e?"ExecutionIdIsNotSet":"ExecutionIdIsEmpty")+":"+c+":"+a,1))}}))});"use strict";q.when("A","a-popover-base","a-popover-util").register("checkout-modal-popover",function(a,l,g){function c(b){return b.disableHide?
function(){}:function(){var c=this;c.animating=!0;a.fadeOut(this.$popover,250);b.secondaryPopover||e("#a-popover-modal").hide();a.delay(function(){c.animating=!1},250)}}function d(a,b){var d=c(b);a=a.$event.triggerPositioningElement?a.$event.triggerPositioningElement:a.$declarativeParent;(n=l.show({$trigger:a,name:b.name,skin:m(b.header,b.closeButton,b.closeTextOverride),content:b.content,url:b.url,data:b.data,update:u,alone:b.alone?"true"===b.alone:!0,position:b.position||"triggerVertical",hide:d}))&&
n.$trigger!==a&&(n.$trigger=a,n.updatePosition())}function f(a,d){d.disableHide=!0;var h=c(d);b=!1;(d=l.show({$trigger:a.$declarativeParent,skin:v(d.header,d.footer,d.closeButton,d.contentClass),name:d.name,requestURL:d.url,position:"windowCenter",update:u,data:d.data,updatePosition:d.allowScrollOnPage?z:w,modal:!0,alone:d.alone?"true"===d.alone:!0,show:function(){this.animating=!0;this.$popover.show();e("#a-popover-modal").show();this.animating=!1},hide:h}))&&d.$trigger!==a.$declarativeParent&&(d.$trigger=
a.$declarativeParent,d.updatePosition())}function k(b){var c=b.$declarativeParent;a.delay(function(){h(b,c)},250)}function h(b,c){n&&(g.eventOccursWithin(b,c)||g.eventOccursWithin(b,n.$popover))?a.delay(function(){h(b,c)},250):l.hide(c)}var e=a.$,n,b=!1,m=function(a,b,c){return function(d){var h=c;c===F&&(h=e("input#closeButtonText").val()||"");var f="";h&&(f='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+h+"\x3c/a\x3e\x26nbsp;");h="false"===
b?"":['\x3cdiv class\x3d"popover-close-section"\x3e',f,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',a||h?['\x3cdiv class\x3d"a-popover-header"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",h,"\x3c/div\x3e"].join(""):"",'\x3cdiv class\x3d"a-popover-inner"\x3e',d,'\x3c/div\x3e\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}},
v=function(a,b,c,d){return function(h){var f=e("input#closeButtonText").val()||"",g="";f&&(g='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+f+"\x3c/a\x3e\x26nbsp;");f="false"===c?"":['\x3cdiv class\x3d"popover-close-section"\x3e',g,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");f=a||f?['\x3cdiv class\x3d"a-popover-header huawei-device-header-fix"\x3e\x3ch4\x3e',
a,"\x3c/h4\x3e",f,"\x3c/div\x3e"].join(""):"";g="";if(b){var n=e("#a-popover-footer-"+b);0<n.length&&(g=['\x3cdiv class\x3d"a-popover-footer"\x3e',n.html(),"\x3c/div\x3e"].join(""))}return['\x3cdiv class\x3d"a-popover a-popover-modal"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',f,'\x3cdiv class\x3d"a-popover-inner ',d,'"\x3e',h,"\x3c/div\x3e",g,'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}};a.declarative("custom-popover-close",
["click","touchend"],function(b){b.$event.preventDefault();var c=b.$target;e("html").hasClass("a-ie6")||e("html").hasClass("a-ie7")||e("html").hasClass("a-ie8")?c.closest(".a-popover").hide():a.fadeOut(c.closest(".a-popover"),250);e("#a-popover-modal").hide();a.trigger("a:declarative:a-popover-close:click",{$target:c,$event:b.$event,$currentTarget:b.$currentTarget})});a.on("a:popover:positionUpdated",function(a){a=a.popover.$popover;0>a.offset().left&&a.offset({left:0});0>a.offset().top&&a.offset({top:0})});
a.on("a:popover:show",function(a){if(a.popover&&a.popover.$trigger){var b=a.popover.$trigger.data("aCheckoutModalPopover");b&&b.allowScrollOnPage&&a.popover.$popover.css("position","absolute")}});var u=function(a){e(".a-popover-inner",this.$popover).html(a)},z=function(a){if(!b||a)w.call(this,!0),b=!0},w=function(a){var b=e(p),c=b.height()/2,d=b.width()/2,h=this.$popover.height()/2,f=this.$popover.width()/2,c=c-h;if(a||"fixed"!==this.$popover.css("position"))c+=b.scrollTop();a=Math.max(0,d-f);c=Math.max(0,
c);this.$popover.css({top:c,left:a})};a.declarative("a-checkout-popover",["click","mouseenter","mouseleave","keyup","touchend"],function(a){a.data.showOnHover&&"touchend"!==a.type?"mouseenter"===a.type||"click"===a.type?d(a,a.data):"mouseleave"===a.type&&k(a):("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&d(a,a.data)});a.declarative("a-checkout-modal-popover",["click","keyup","touchend"],function(a){("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&
f(a,a.data)});a.on("checkout:reload",function(){a.defer(function(){0===e("#a-popover-modal").length&&e("body").append('\x3cdiv id\x3d"a-popover-modal" /\x3e')})});return{hideById:function(a){l.hide(a)},createModal:f}});"use strict";(function(){var a=!1;q.when("A").register("page-detector",function(l){function g(){return c("checkout-as")}function c(a){h||(h={});h.hasOwnProperty(a)||(h[a]=0<k("div."+a).length);return h[a]}function d(){return c("checkout.pay")}function f(){return c("checkout.spc")}var k=
l.$,h;l.on("checkout:reload",function(){h={};a||q.when("page-detector-current-initializer").execute(function(a){a.initializeDetectorWithCurrentPage(null)})});return{isAddressSelect:g,isAddressTranslation:function(){return c("translate-address-form")},isDesktopPayment:function(){return d()&&c("pay-desktop")},isDesktopSpc:function(){return f()&&c("spc-desktop")},isMobileAddressSelect:function(){return g()&&c("checkout-as-mobile")},isMobilePayment:function(){return d()&&c("pay-mobile")},isMobileSpc:function(){return f()&&
c("spc-mobile")},isTabletAddressSelect:function(){return g()&&c("checkout-as-tablet")},isTabletPayment:function(){return d()&&c("pay-tablet")},isTabletSpc:function(){return f()&&c("spc-tablet")},isSpcLite:function(){return f()&&c("spclite")},isPayment:d,isSosp:function(){return c("checkout.sosp")},isSpc:f,isMobile:function(){return c("checkout.mobile")},isTablet:function(){return c("checkout.tablet")}}});q.register("page-detector-current-initializer",function(){return{initializeDetectorWithCurrentPage:function(l){if(!a){var g=
l;q.register("page-detector-current-page",function(){return{getCurrentPage:function(){return g},setCurrentPage:function(a){var d=g;g=a;q.when("A").execute(function(f){f.trigger("page-detector:page-changed",d,a)})}}});a=!0}}}})})();"use strict";q.when("jQuery","loading-spinner-controller").register("page-spinner-controller",function(a,l){function g(){"function"===typeof z.blockAllActions&&z.blockAllActions()}function c(){"function"===typeof z.unblockAllActions&&z.unblockAllActions()}function d(a){"function"===
typeof z.showTransitionInContainer&&z.showTransitionInContainer(a)}function f(){var b=a(p).width(),c=a(p).height(),d=a(p),e=0;null!==u&&(e=u.outerHeight()-a(p).scrollTop(),0>e&&(e=0));m.css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c);"1"!==a("input[name\x3dfromAnywhere]").val()&&a("#loading-spinner-blocker-doc").css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c)}function k(){var b;b=document.activeElement?a(document.activeElement):
a(":focus:first");b.is("button, a, input:enabled")&&b.blur()}function h(){if(w){g();q.when("spp-button-blocker").execute(function(a){a.hideContinueBtnBlocker()});var c=a(".spp-panel.expanded");if(0<c.length&&c.is(":visible")){d(c,1);return}}if(v)return m.length&&m.find(".loading-spinner-inner").show(),!1;v=!0;k();m=a("#spinner-anchor");m.find(".loading-spinner-inner").show();a("#unblockHeader").length&&(u=a("#header"));n=m.css("z-index");a(p).unbind("scroll.checkout-page-spinner").bind("scroll.checkout-page-spinner",
function(a){b&&p.clearTimeout(b);b=setTimeout(function(){f();b=null},50)});a(p).unbind("resize.checkout-page-spinner").bind("resize.checkout-page-spinner",function(){f();l.adjustSize(m)});a(p).unbind("orientationchange.checkout-page-spinner").bind("orientationchange.checkout-page-spinner",function(){f();l.adjustSize(m)});f();m.show();m.css("z-index",2E3);l.showSpinner(m,!0);return!0}function e(){if(w)c(),"function"===typeof z.hideSpinner&&z.hideSpinner();else{a("#first-pipeline-load-page-spinner").remove();
if(!v)return!1;v=!1;m.length&&m.find(".loading-spinner-inner").show();m&&(a(p).unbind(".checkout-page-spinner"),m.hide(),m.css("z-index",n),l.hideSpinner(m));return!0}}var n,b=null,m,v=!1,u=null,z={},w=!1;return{show:h,showPageTransition:function(){return"0"===a("#showPageTransition").attr("content")?!1:h()},hide:e,hidePageTransition:function(){"0"===a("#showPageTransition").attr("content")&&e();return!0},hideAnimatedSpinnerImage:function(){m.length&&m.find(".loading-spinner-inner").hide()},initFunc:function(a){null!==
a&&(z=a,w=!0)},blockAllActions:g,unblockAllActions:c,showTransitionInContainer:d,shrinkPanel:function(a,b,c){"function"===typeof z.shrinkPanel&&z.shrinkPanel(a,b,c)},clearFocus:k}});"use strict";q.when("A").execute(function(a){a=a.$;var l="",l="mash-transitions"===a("input[name\x3dpageTransitionType]").val()?"page-mash-transition-controller":"page-spinner-controller";q.when(l).register("page-transition-controller",function(a){q.when("A").execute(function(c){c.declarative("page-spinner-show",["click"],
{allowLinkDefault:!0},function(c){c=c.$target;c.hasClass("a-button-disabled")||c.closest(".a-button-disabled").length||a.showPageTransition()})});q.when("A").execute(function(c){c.declarative("page-spinner-show-on-submit",["submit"],{allowLinkDefault:!0},function(c){a.showPageTransition()})});return{show:a.show,hide:a.hide,showPageTransition:a.showPageTransition,hidePageTransition:a.hidePageTransition,blockAllActions:a.blockAllActions,unblockAllActions:a.unblockAllActions,showTransitionInContainer:a.showTransitionInContainer,
shrinkPanel:a.shrinkPanel}})});"use strict";q.when("A","page-conductor","client-side-metrics","page-detector-current-page","a-popover","ready").execute(function(a,l,g,c){function d(a,c,d){l.isSPP()&&g.setmarker&&g.setmarker("af");g.sendUEPageLoadStats()}var f=a.$,k=!1;a.on("a:popover:afterHide",function(a){a.popover&&(k=!1)});a.on("a:popover:beforeShow",function(a){var c=a.popover;c&&(k=!0,c.$trigger.find(".modal-parameters").each(function(){f.each(f(this).data(),function(a,b){c.attrs(a,b)})}))});
a.on("a:popover:dismiss",function(a){a=a.popover;if(g.isTransitionLoggingEnabled()&&a&&k){k=!1;var e,f;"prime-acquisition-spc-popover"===a.name&&(e="prime-acquisition",f=c.getCurrentPage());e||f||!a.attrs||(e=a.attrs("returnfrom"),f=a.attrs("returnto"));e&&f&&(g.resetMetrics(),g.logPageTransition(e,f,d))}})});"use strict";q.when("A","page-detector-current-page","checkout-general-utils","client-side-metrics").register("first-load-dependencies-base",function(a,l,g,c){function d(){"function"===typeof p.uet&&
"function"===typeof p.uex&&(p.uet("cf","first-load-dependencies-ready",{wb:1}),p.uex("ld","first-load-dependencies-ready",{wb:1}));c.startWidgetTiming("first-load-dependencies:checkout:beforeReload");a.trigger("checkout:beforeReload");c.finishWidgetTiming("first-load-dependencies:checkout:beforeReload");c.startWidgetTiming("first-load-dependencies:checkout:reload");a.trigger("checkout:reload");c.finishWidgetTiming("first-load-dependencies:checkout:reload");var d;k&&(d="spp-revieworder"===k?"spc":
k);d&&(c.finishWidgetTiming("first-load-dependencies:checkout:reload:"+d),a.trigger("checkout:reload:"+d),c.finishWidgetTiming("first-load-dependencies:checkout:reload:"+d));c.startWidgetTiming("first-load-dependencies:checkout:afterReload");a.trigger("checkout:afterReload");c.finishWidgetTiming("first-load-dependencies:checkout:afterReload");setTimeout(function(){var a=f("#first-pipeline-load-page-spinner");a.is(":visible")&&(a.remove(),c.increaseCount("checkout:pageload:timeout"),g.logError("The page has taken more than 90 seconds to load, or there was a JS error preventing it from loading, hiding page spinner."))},
9E4)}var f=a.$,k=l.getCurrentPage();"function"===typeof p.uet&&p.uet("bb","first-load-dependencies-ready",{wb:1});return{allDependenciesCheck:function(a){if(a&&a.length){var e=!1,n={};f.each(a,function(a,b){c.startWidgetTiming("checkout:dependency:"+b+":ready");n[b]=1;q.when(b).execute(function(){c.finishWidgetTiming("checkout:dependency:"+b+":ready");delete n[b]})});var b=function(a){a="Page ("+k+") is missing dependencies ["+a.join(", ")+"] after 5 secs.";c.increaseCount("checkout:dependency:missed:regular-page:error");
g.logErrorOnLevel(a,"ERROR")},m=setTimeout(function(){if(!e){var a=[];f.each(n,function(b){c.increaseCount("checkout:dependency:"+b+":missed");a.push(b)});c.increaseCount("checkout:dependency:missed");0<f("#assets-prefetch").length?c.increaseCount("checkout:dependency:missed:assets-prefetch"):(c.increaseCount("checkout:dependency:missed:regular-page"),b(a));d()}},5E3);q.when.apply(q,a).execute(function(){e=!0;p.clearTimeout&&m&&p.clearTimeout(m);d()})}else d()}}});"use strict";q.when("A","page-detector",
"client-side-metrics").register("gift-utility",function(a,l,g){var c=a.$,d=/[^\s\u0020-\u007E\u00A0-\u00FF]/g,f=p.P&&p.P.AUI_BUILD_DATE,k=/((?:file|https?|ftps?|sip):\/\/)/im,h=/((?:\b|[\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?])www\.(?:(?:[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+\.[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+))+)(?:[\s!@#$%^&*()_=+[\]{}\|;:'",<>\?]|$|\b)/im,e=/([^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?\/]+\.(?:[a-z][a-z]|aero|arpa|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|om|pro|qa|tel|travel|xxx)(?:\b|$))/im,
n=/^\S+\@\S+\.\S+$/im;return{getInput:function(a){return a.is("input")?a:a.find("input")},getCharCount:function(a,c){return c?p.unescape(encodeURIComponent(a)).length:a.length},getLineCount:function(a,c){var d=a.split("\n").length;c=Math.floor(c);a=a.split("\n");for(var e=0;e<a.length;e++)a[e].length>c&&(d+=Math.floor(a[e].length/c),0===a[e].length%c&&d--);return d},getNameWithNoTitle:function(a){var c=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(c=!0);c&&
a.shift();return a.join(" ")},getFirstName:function(a){var c=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(c=!0);c&&a.shift();return a.shift()},toggleGiftMessageWarning:function(a,e){var h=e.find(".gift-message-warning");if(d.test(a.val())){var n=e.find(".gift-message-preview-trigger"),k=a.val().replace(d,"?");f?q.when("a-popover").execute(function(a){var b=a.get(n);b?b.update({content:k}):a.create(n,{inlineContent:k,position:"triggerVertical",closeButton:"false"})}):
(g.increaseCount("removeauijs13"),n.unbind("click.preview").bind("click.preview",function(a){q.when("a-popover-base").execute(function(b){var d=c(a.target);d.data("popoverid")&&(b=b.get(d.data("popoverid")))&&(b.update(k),b.updatePosition())})}));a.addClass("a-form-error");h.show()}else a.removeClass("a-form-error"),h.hide()},valueContainsUrl:function(a){return k.test(a)||h.test(a)||e.test(a)},isValidEmail:function(a){return n.test(""+a)}}});"use strict";q.when("A","page-detector","safe-mash","client-side-metrics").register("help-popup",
function(a,l,g,c){function d(){if(f("div#help-popover").length){f(p).unbind("resize.checkout-help-popover");var a=f("#help-popover-frame")[0];f(a.contentWindow?a.contentWindow:a.contentDocument.defaultView).undelegate("a","click");f("div#help-popover").remove()}}var f=a.$;l=l.isMobile();c=f("input#isPipelinedPage");c=0<c.length&&"1"===c.val();var k=l&&c&&g&&g.navigate;a.declarative("help-popup",["click"],function(a){if(!f(".a-touch").length||k){a.$event.preventDefault();a.data&&"1"===a.data.stopPropagation&&
a.$event.stopPropagation();var c=a.$target.closest("a").attr("href");a=a.data;k?g.navigate({url:c,transitionEffect:"slide"}):(a.width||(a.width="340"),a.height||(a.height="340"),p.open(c,"AmazonHelp","width\x3d"+a.width+",height\x3d"+a.height+",left\x3d10,top\x3d10,resizable\x3dyes,scrollbars\x3dyes,menubar\x3dno,toolbar\x3dyes,location\x3dno,directories\x3dno,status\x3dyes"))}else p.open(a.$target.closest("a").attr("href"),"AmazonHelp")});if(k)a.on("checkout:reload",d)});"use strict";q.execute("persistent-order-controller",
function(){return{}});"use strict";q.when("jQuery","page-conductor").register("quantity-service",function(a,l){function g(c,d){d=d||{};var f;d.additionalData&&(f=d.additionalData);var g="/gp/buy/pipeline/handlers/update-quantity.html",h={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};f&&f.deletePrimeMembership&&f.primeMembershipASIN&&(h.deletePrimeMembershipItemIn=f.deletePrimeMembership,h.deletedPrimeMembershipASINIn=f.primeMembershipASIN);d.ref&&(g+=
"/ref\x3d"+d.ref,delete d.ref);f=d.success;delete d.success;var e=l.ajaxRedirect;d.error&&(e=d.error,delete d.error);a.extend(h,d);d=[];for(var n in c)c[n]!==F&&(d.push(n),h[n]=c[n]);h.entityids=d;c=l.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});a.ajax({type:"POST",url:g,data:a.param(h,!0),dataType:"text",async:!0,cache:!1,headers:c,success:f,error:e})}return{callBatch:function(a,d){g(a,d)},call:function(a,d,f){var k={};k[a]=d;g(k,f)}}});"use strict";q.when("jQuery").register("scroll-controller",
function(a){return{scrollToTop:function(){a(p).scrollTop(0)},toggleScrollOn:function(){a(document).unbind("touchmove")},toggleScrollOff:function(){a(document).bind("touchmove",function(a){a.preventDefault()})}}});"use strict";q.when("A","checkout-general-utils","ready").execute(function(a,l){a.$("#checkout-mash-will-load").length?q.when("mash").execute(function(a){var c;"object"===typeof a?c=a:p.amazon&&p.amazon.mash&&(c=p.amazon.mash);"object"!==typeof c?l.logError("MASH is expected but can't be found"):
q.register("safe-mash",function(){return c})}):q.register("safe-mash",function(){})});"use strict";q.when("A","scheduled-delivery-external-interface","shipping-speed-selection-controller","page-detector","ready").register("scheduled-delivery-controller",function(a,l,g,c){var d=a.$,f={};g=function(){f={};d("div.fake-label input[type\x3d'radio']:checked").each(function(){var a=d(this),c=a.closest("div.fake-label");(c=l.getSdWidgetRootId(c))&&(f[a.attr("name")]=c)})};a.on("checkout:reload:shipoptionselect",
g);a.on("checkout:reload:spp-revieworder",g);c.isSosp()&&g();d(document).delegate("div.fake-label","click",function(){if(c.isSosp()){var g=d(this),h=g.find("input[type\x3d'radio']");h.attr("disabled")||(h=h.attr("name"),g=l.getSdWidgetRootId(g),a.trigger("scheduled-delivery:ship-option-changed",{current:g,previous:f[h]}),f[h]=g)}});d(document).delegate(".ship-option.is-scheduled-delivery","click",function(){if(c.isSpc()){var f=d(this);f.find("input[type\x3d'radio']").attr("disabled")||(f=l.getSdWidgetRootId(f))&&
a.trigger("scheduled-delivery:ship-option-changed",{current:f,previous:null})}});a.on("scheduled-delivery:unblock-continue",function(){q.when("button-blocker").execute(function(a){a.hide("scheduled-delivery")})});a.on("scheduled-delivery:block-continue",function(a){q.when("button-blocker").execute(function(c){c.show("scheduled-delivery",a)})});a.on("scheduled-delivery:disable-ship-option",function(a,f){var e;a=d("#"+a);if(0!==a.length){if(c.isSpc())a=a.closest(".shipping-speed");else if(c.isSosp())a=
a.closest("div.fake-label.a-box");else return;e=a.find("input[type\x3d'radio']");e.attr("disabled",!0);e.is(":checked")&&f&&(f=d("input[name\x3d"+e.attr("name")+"]:radio:not(:disabled):first"),f.prop("checked",!0),f.trigger("change"));a.addClass("sd-disabled")}});a.on("scheduled-delivery:enable-ship-option",function(a){var f;a=d("#"+a);if(0!==a.length){if(c.isSpc())a=a.closest(".shipping-speed");else if(c.isSosp())a=a.closest("div.fake-label.a-box");else return;f=a.find("input[type\x3d'radio']");
f.removeAttr("disabled");a.removeClass("sd-disabled")}})});"use strict";q.when("A","ready").register("mobile-nav-bar-back-controller",function(a){a.capabilities.history&&(a=a.$,a=a("#mobile-top-bar-navigation-back"),1<=a.length&&a.click(function(a){a.preventDefault();p.history.back()}))});"use strict";q.when("A","page-spinner-controller","page-detector","page-conductor","weblab-helper","ready").execute(function(a,l,g,c,d){function f(a,b){var c=[];a.addressId||c.push("addressId");a.slotKey||c.push("slotKey");
a.shippingOfferingId||c.push("shippingOfferingId");a.conflictItems&&!m.isArray(a.conflictItems)&&c.push("conflictItems");if(0<c.length){a="Error calling fresh widget callback on "+b+": Bad or Missing Input: "+c[0];for(b=1;b<c.length;b++)a+=", "+c[b];console.error(a);return 0}return 1}function k(){m("#freshSlotKey").val("");m("#freshAddressId").val("");m("#freshReservationToCancel").val("");m("#freshConflictingItems").val("");m("#freshShipOfferingId").val("")}function h(a){var b="",c=d.sospPartialAvailabilityWeblabOn();
if(a&&m.isArray(a)&&0<a.length)for(var b=a[0].asin+":"+a[0].merchantId+(c?"|"+a[0].maxQtyAvailable:""),e=1;e<a.length;e++)b+="-"+a[e].asin+":"+a[e].merchantId+(c?"|"+a[e].maxQtyAvailable:"");return b}function e(a){var b;b="page\x3dspc\x26returnFullHTML\x3d1\x26callSetters\x3d1\x26freshSlotKey\x3d"+a.addressId;b+="\x26freshAddressId\x3d"+a.slotKey;a.reservationToCancel&&(b+="\x26freshReservationToCancel\x3d"+a.reservationToCancel);(a=h(a.conflictItems))&&(b+="\x26freshConflictingItems\x3d"+a);a=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});
l.show();m.ajax({type:"POST",url:"/gp/buy/shared/handlers/handle-fresh-widget-results.html/ref\x3dset-fresh-information",data:b,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,b,d){return d.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,b,d):c.redirect(a)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function n(){m(".sosp-continue-button").removeClass("js-hide").removeClass("aok-hidden");m(".continue-button-blocker").addClass("aok-hidden")}function b(){m(".sosp-continue-button").addClass("aok-hidden");
m(".continue-button-blocker").removeClass("aok-hidden")}var m=a.$;a.on("handle-fresh-results",function(a){if(m("#isfresh").val())if(a)if(g.isSosp())if(f(a,"sosp")){m("#freshSlotKey").val(a.slotKey);m("#freshAddressId").val(a.addressId);m("#freshReservationToCancel").val(a.reservationToCancel);var d=h(a.conflictItems);m("#freshConflictingItems").val(d);m("#freshShipOfferingId").val(a.shippingOfferingId);d&&0<d.length?m("input#block-prefetch").val(1):m("input#block-prefetch").val(0);d=m("#shippingOptionFormId");
a.conflictItems&&0<a.conflictItems.length||c.makePrefetch(d);n()}else k(),b();else g.isSpc()?f(a,"spc")&&e(a):console.error("remote fresh widget JS callback called on unsupported page.");else console.error("remote fresh widget JS callback called with empty data.");else console.error("remote fresh widget JS callback called without isfresh flag on page")});a.on("block-continue",function(a){m("#isfresh").val()?a?"undefined"===typeof a.blockContinue?console.error("block continue callback - missing blockContinue"):
g.isSosp()?1===a.blockContinue?(b(),k()):0===a.blockContinue?n():console.error("block continue callback - invalid value"):console.error("block continue callback called on unsupported page."):console.error("block continue callback called with no argument"):console.error("block continue callback called without isfresh flag on page")});a.on("confirm-and-continue",function(){m("div.sosp-fresh #shippingOptionFormId").submit()});a.on("redirect-to-spc",function(){c.redirect({conductoraction:{url:'/gp/buy/spc/handlers/display.html/ref\x3d"cancel-fresh-address-select"',
type:"redirect"}})})});"use strict";q.when("A","ready").execute(function(a){function l(){(0<g(".change-preference-block").length||0<g(".mobile-change-preference-block").length)&&!1===c&&(q.register("loadVasRcxCheckoutAsset",function(){}),c=!0)}var g=a.$,c=!1;l();a.on("checkout:reload:spc",l);a.on("checkout:reload:shipoptionselect",l);a.on("checkout:reload:spp-revieworder",l)});"use strict";q.register("time-left-formatter",function(){function a(a,c,d,f,k){return 0>=c?a:a+c+" "+(1===c?k.HOUR:k.HOURS)+
(!f&&0<d?" "+k.AND+" ":"")}function l(a,c,d,f,k){return 0>=c?a:a+c+" "+(1===c?k.MINUTE:k.MINUTES)+(!f&&1>d?" "+k.AND+" ":"")+(1===f&&1>d?" ":"")}return{getTimeLeftFormatted:function(g,c,d){var f="",k=86400<g?(g-g%86400)/86400:0,h=3600<g?(g-g%3600)/3600:0;g-=3600*h;var e=60<g?(g-g%60)/60:0;g-=60*e;if(c&&0<k)return f+k+" "+(1===k?d.DAY:d.DAYS);if(c&&0<h)return a(f,h,e,c,d);if(c&&5<=e)return l(f,e,h,c,d);f=a(f,h,e,c,d);f=l(f,e,h,c,d);1<=h||(f=f+g+" "+(1===g?d.SECOND:d.SECONDS));return f}}});"use strict";
q.register("email-validation",function(){function a(a){if(1!==a.length)throw Error("Invalid length for character");return a}var l={isISOControl:function(g){"string"===typeof g&&(a(g),g=g.charCodeAt(0));return 31>=g||127===g},isWhitespace:function(g){g=a(g);return null!==g.match(/\s/g)},isLetterOrDigit:function(g){g=a(g);return null!==g.match(/[A-Za-z0-9]/g)}};return function(a){var c;if(!a||64<a.length)return!1;for(c=0;c<a.length;c++)if(127<a.charCodeAt(c))return!1;c=a.indexOf("@");if(c!==a.lastIndexOf("@")||
1>c||c===a.length-1)return!1;var d=a.substring(0,c),f=a.substring(c+1);if("."===f.charAt(0)||"."===f.charAt(f.length-1)||f.match(/[a-zA-Z\d\-.]+/)[0]!==f)return!1;for(c=0;c<f.length;c++)if(a=f.charAt(c),c<f.length-1&&"."===a&&"."===f.charAt(c+1))return!1;if(-1===f.indexOf("."))return!1;var k=f=!1;for(c=0;c<d.length;c++)if(a=d.charAt(c),f){switch(a){case "\\":k=!k;break;case '"':k||(f=!1);break;default:if(k&&!l.isLetterOrDigit(a))return!1;k=!1;if(l.isISOControl(a))return!1}if(!f&&('"'===d.charAt(c-
1)||d.length-1!==c&&"."!==d.charAt(c+1)))return!1}else switch(a){case '"':if(0!==c&&"."!==d.charAt(c-1))return!1;f=!0;break;case ".":if(0===c)return!1;break;case "(":case ")":case "\x3c":case "\x3e":case "[":case "]":case "\\":case ":":case ";":case ",":return!1;default:if(l.isISOControl(a)||l.isWhitespace(a))return!1}return!0}});"use strict";q.when("A","page-transition-controller","checkout-general-utils","page-detector","page-detector-current-page","safe-mash","loading-spinner-controller","weblab-helper").register("shipoptionselect-controller",
function(a,l,g,c,d,f,k,h){function e(a){var b=w(".delivery-window-groups .more-window");k.showSpinner(b,!1);a=a.$currentTarget.closest(".delivery-window-groups").data("orderid");b=w("input[name\x3dlineItemEntityIds_"+a+"]").attr("value");w.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/long-calendar-content.html",data:"lineitemids\x3d"+b+"\x26orderid\x3d"+a+"\x26isMobile\x3d1\x26fromPage\x3dsosp",dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:function(a){k.hideSpinner();
if(a&&a.deliveryWindowGroups){var b=w(".delivery-window-groups .a-box-group");b.empty();w.each(a.deliveryWindowGroups,function(a,c){b.append(c)});a=w(".delivery-window-groups .selected-group");a.length&&a.trigger("click")}}})}function n(a,b){var c=w("div.one-shipment:visible");a=y?w("div.one-shipment").slice(parseInt(a,10),parseInt(b,10)+1):w("div.one-shipment#"+a);r&&0!==a.size()&&c.last().attr("id")!==a.last().attr("id")&&(c.hide(),a.show(),w(p).scrollTop(0))}function b(){if(r){var a=(location.hash?
location.hash.replace("#",""):"0-"+H).split("-");2===a.length&&n(a[0],a[1])}}function m(){function e(a,b){w.ajax({type:"POST",url:"/gp/buy/gift/handlers/remove-gift-option.html",data:b,dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:a,error:function(a,b,c){l.hide()}})}function g(a){var b=a.closest("div."+k);a.is(":checked")?(b.siblings("div."+k+".selected").removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),
b.addClass("selected").find(".a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active")):b.removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");u("triggerChangeEvent",[a])}0<w(".prime-calendar-container").length&&w(".prime-calendar-container").contents().each(function(a,b){8===b.nodeType&&w(b).replaceWith(b.nodeValue)});var m=w(".delivery-window-groups .selected-group");
m.length&&m.trigger("click");B=w(".sosp-continue-button");r="1"===w("#isClientSidePagingEnabled").val()?1:0;H=h.isDigitalAsinIndexingFixedOnSOSPEnabled()?(w("div.shipment-with-ship-options:visible").length-1).toString():(w("div.one-shipment:visible").length-1).toString();t="1"===w("#useMashNavigateForClientSidePaging").val()?1:0;y="1"===w("#collapseDigitalShipmentsEnabled").val()?1:0;var k=(m=p.P&&p.P.AUI_BUILD_DATE)?"selectable-box":"fake-label";r&&(w(".one-shipment:gt("+H+")").hide(),b());B.bind("click",
function(b){function e(a,b){var c=d.getCurrentPage();if(p.history&&p.history.pushState){var f=location.href;0<f.indexOf("#")&&(f=f.substring(0,f.indexOf("#")));f+="#"+a.attr("id")+"-"+b.attr("id");history.pushState({page:c,id:a.attr("id")},w("title"),f)}}if(h.isFreshComingledPurchaseEnabled()){var g=w("div.one-shipment:visible input[id\x3d'fresh-block-continue']");if(g){if("1"===g.val())return a.trigger("f3:fresh-sosp-continue:blocked"),b.preventDefault(),!1;"0"===g.val()&&a.trigger("f3:fresh-sosp-continue:allowed")}}var m=
!1;w("div.one-shipment:visible input[type\x3d'radio'][checked]").each(function(){if(w(this).data("blockingOn"))return alert(w(this).data("blockingOn")),b.preventDefault(),m=!0,!1});if(m)return!1;if(h.removesGiftOptionOnRush()&&c.isMobile()&&null!=G){var g=w("div.one-shipment:visible"),k=g.find("input[type\x3d'radio']:checked").closest(".shipping-option");if("1"===g.find("input[type\x3dhidden][name\x3disGiftWrapped]").attr("value")&&1===k.data("nosupportforgiftoption"))return G.show(),!1}v();g=w("div.one-shipment:visible");
k=g.nextAll("div.one-shipment:hidden");if(0<k.length){b.preventDefault();var l=k.first(),r=l;y&&(r=k.filter(".shipment-with-ship-options"),r=1<r.length?r.eq(1).prev():k.last());t&&f&&f.navigate?f.navigate({url:null,transitionEffect:"slide",successCallback:function(){e(l,r)},failCallback:function(a){}}):e(l,r);n(l.attr("id"),r.attr("id"));a.trigger("active-shipment-changed")}z("logInlineCalMetrics",[g])});w(".gift-option-removal-cancel-button").bind("click",function(a){G.hide()});w(".gift-option-removal-confirm-button").bind("click",
function(a){l.show();G.hide();a="lineItemsToRemoveGiftOptionFrom\x3d"+w("div.one-shipment:visible").find("input[name^\x3dlineItemEntityIds_]").attr("value");var b=w("div.one-shipment:visible"),c=b.nextAll("div.one-shipment:hidden");e(function(a,d,e){b.find("input[type\x3dhidden][name\x3disGiftWrapped]").each(function(){w(this).remove()});0<c.length?(B.click(),l.hide()):w(".checkout-page-form").submit()},a)});w(p).bind("popstate",function(a){c.isSosp()&&b()});w(document).delegate("div."+k,"click",
function(a){a=w(this);a.find("input[type\x3d'radio']").trigger("change",["setActive"]);a.parent().hasClass("timeslot-picker")&&(a=a.find(".a-button-selected").length,B&&B.length&&(a?B.removeClass("a-button-disabled").addClass("a-button-primary").find("input").prop("disabled",!1):B.removeClass("a-button-primary").addClass("a-button-disabled").find("input").prop("disabled",!0)))});var q;a.declarative("faster-than-same-day-sosp-save",["click","submit"],function(){var b="lineItemsToRemoveGiftOptionFrom\x3d"+
q.closest(".one-shipment").find("input[name^\x3dlineItemEntityIds_]").attr("value");a.$("div.a-popover button.a-button-close").trigger("click");l.show();e(function(a,b,c){q.closest(".one-shipment").find(".isGiftWrapped").each(function(){w(this).remove()});q.attr("checked",!0);g(q);l.hide()},b)});w(document).delegate("div."+k+" input[type\x3d'radio']","change",function(a,b){a=w(this);if("setActive"===b&&!a.attr("disabled")&&h.removesGiftOptionOnRush()&&0<a.closest(".one-shipment").find(".isGiftWrapped").length&&
1==a.data("nosupportforgiftoption"))q=a,a.is(":checked")&&(b=a.closest("div."+k).siblings("div."+k+".selected").find('input[type\x3d"radio"]'),q.attr("checked",!1),b.attr("checked",!0)),setTimeout(function(){w("#faster-than-same-day-sosp-popover").trigger("click")},10);else{if("setActive"===b){if(a.attr("disabled"))return;a.attr("checked",!0)}if("disabling"===b)if(a.attr("disabled",!0),a.is(":checked"))a.removeAttr("checked");else return;g(a)}});w("div."+k+" input[type\x3d'radio']:checked").change();
w("h3").children().removeAttr("style");0===w("div."+k+".scheduled-delivery").length&&w("form.checkout-page-form").data("checkoutFormReady",!0).change();m&&w(document).delegate(".a-touch-radio a","click",function(a){if(!h.isSOSPExclusiveJSHandlerWeblabOn()||c.isSosp()){var b=w(a.target).attr("href");!b||b.startsWith("#")||b.toLowerCase().startsWith("javascript:")||(f&&f.navigate?f.navigate({url:b,transition:"slide"}):a.preventDefault=!1)}})}function v(){if(1===w("div.store-upsell-ship-options").length){var a=
"/gp/buy/shared/handlers/store-upsell-async.html",b="ox_store_upsell_continue_",c=w("div.ship-speed, div.store-upsell-ship-options").find("input.shipping-option, input.store-upsell-ship-option"),d=[],e;w.each(c,function(a,c){a=w(c);c=a.attr("value");d.push(c.toLowerCase());a.is(":checked")&&(e=a.attr("value"),b=a.hasClass("store-upsell-ship-option")?b+"success":b+"failure")});a=g.addQueryStringParameter(a,"ref",b);w.ajax({url:a,type:"POST",async:!0,data:{shown:d.toString(),clicked:e}})}}function u(a,
b){q.when("checkout-federation-wrapper","shipspeed-provider").execute(function(c,d){c.wrap(function(){d&&!w.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"VasCheckoutShipSpeedProvider")})}function z(a,b){q.when("checkout-federation-wrapper","sd-methods").execute(function(c,d){c.wrap(function(){d&&!w.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"CricketInlineCalendarHeavyBulkyIN")})}var w=a.$,B,r,t,H,y=0,G;a.declarative("sosp-change-quantity-link",["click"],function(a){var b=
a.$currentTarget,c=w("\x3cinput type\x3d'hidden' /\x3e").attr("name","change-quantities-or-delete").val("1");b.hasClass("pipeline-link")?(a.$event.preventDefault(),b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click")):b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click").end().trigger("submit")});q.when("A","a-sheet").register("shipoptionselect-gift-removal-controller-mobile",
function(a,b){G=b.create({name:"gift-removal-popover",height:220,preloadDomId:"gift-option-removal-message",closeType:"icon",sheetType:"web"})});a.declarative("sosp-extender-toggle",["click","touchend"],function(a){if(!g.protectAgainstDoubleAction("sosp-extender-toggle")){var b=a.$target.closest("a"),c=w(".delivery-window-groups .a-box-group").find(".lazy-loaded");if(b.hasClass("aui-extender"))c.length?c.remove():e(a);else{var d=b.find("i"),b=b.closest("div.extender-section");d.hasClass("a-icon-extender-expand")?
(b.find(".collapsed").hide(),b.find(".expanded").slideDown("fast"),d.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse"),e(a)):(b.find(".collapsed").show(),b.find(".expanded").slideUp("fast"),d.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"),c.length&&c.remove())}}});a.declarative("sosp-select-prime-slot",["click","touchend"],function(a){if(!g.protectAgainstDoubleAction("sosp-select-prime-slot")){a=a.$currentTarget;var b=a.closest(".valid-slot");if(b.closest(".prime-calendar").hasClass("long-calendar")){var c=
b.closest(".prime-calendar").data("orderid"),d=w("#calendar-"+c),c=w("#calendar-delivery-message-"+c),e=a.closest(".long-calendar");e.find(".selected-slot").removeClass("selected-slot");0<b.length&&b.addClass("selected-slot");w(".a-button-close").trigger("click");b=a.data("slotid");b=d.find(".slot-"+b);if(0<b.length)d.show(),c.parent().hide(),b.closest(".prime-calendar").find(".selected-slot").removeClass("selected-slot"),b.closest(".valid-slot").addClass("selected-slot");else{var f=a.parent()[0],
h=a.parent().parent().find(".rhead")[0],b=h.innerText;b||(b=h.textContent);f=f.cellIndex;e=e.find("th")[f];f=e.innerText;f||(f=e.textContent);c.text(f+" "+b);d.hide();c.parent().show()}}else c=b.closest(".prime-calendar-container").data("orderid"),d=w("#calendar-"+c).find(".selected-slot"),0<d.length&&(d.removeClass("selected-slot"),0<b.length&&b.addClass("selected-slot"));d=a.closest(".prime-calendar-container").data("orderid");a.data("key")&&w("#order_"+d+"_ShippingSpeed").val(a.data("key"));a.data("isscheduleddeliveryslot")&&
w("#sdData"+d).val(a.data("sddatastring"))}});a.declarative("sosp-select-delivery-window",["click","touchend"],function(a){if(!g.protectAgainstDoubleAction("sosp-select-delivery-window")){a=a.$currentTarget;a.length&&!a.hasClass("dwg-button")&&(a=a.find(".dwg-button"));w(".dwg-button").removeClass("selected-dwg-button");a.addClass("selected-dwg-button");var b=a.closest(".delivery-window-groups").data("orderid"),c=a.data("key");!c&&a.find("button").length&&(c=a.find("button").data("key"));c&&w("#order_"+
b+"_ShippingSpeed").val(c);c=a.data("isscheduleddeliveryslot");!c&&a.find("button").length&&(c=a.find("button").data("isscheduleddeliveryslot"));c&&(c=a.data("sddatastring"),!c&&a.find("button").length&&(c=a.find("button").data("sddatastring")),w("#sdData"+b).val(c))}});a.on("checkout:reload:shipoptionselect",m);a.on("checkout:reload:spp-shipoption",m);if(h.isFreshComingledPurchaseEnabled())a.on("checkout:reload:spp-f3-sosp",m)});q.when("jQuery","page-detector").register("deliv-prefs-sosp",function(a,
l){function g(){a(".sosp .order-delivery-time-preference").each(function(){var c=a(this);c.bind("selectionChanged",function(){0===c.find(".delivery-time-preference-group").length?c.hide():(c.show(),0===c.find("input:checked").length&&c.find("input:first").trigger("change",["setActive"]))}).bind("empty",function(){c.find(".delivery-time-preference-group").detach()});var d=c.closest(".one-shipment").find("input.shipping-option");c.find(".delivery-time-preference-group").each(function(){var d=a(this),
g=d.data("shippingoptionid"),g=a("#"+g);d.is(".template")&&d.detach().removeClass("template");g.change(function(){c.trigger("empty");d.appendTo(c);c.trigger("selectionChanged")}).addClass("hasDeliveryTimePreference")});d.not(".hasDeliveryTimePreference").change(function(d,g){"disabling"===g||a(this).is(":disabled")||(c.trigger("empty"),c.trigger("selectionChanged"))});c.trigger("selectionChanged")})}q.when("A").execute(function(a){a.on("checkout:reload:shipoptionselect",g)})});q.when("A","shipoptionselect-controller").execute(function(a){var l=
a.$,g={},c={};a.on("checkout:reload:shipoptionselect",function(){var a=l("#shippingOptionFormId"),f=a.find("input[name\x3dtrialKey]");if(1===f.length){for(var k in g)g.hasOwnProperty(k)&&(g[k].abort(),delete g[k]);g={};c={};var h=function(a){return a.join("::").replace(/\s+/g,"_")},e=function(){return l.map(a.find("input[type\x3dradio]:checked"),function(a){return a.name})},n=function(){return l.map(a.find("input[type\x3dradio]:checked"),function(a){return a.value})},b=function(a,b){if(g.hasOwnProperty(a)||
c.hasOwnProperty(a))return!1;console.debug('initiating ajax call for trial key "'+a+'"');b=l.ajax({type:"POST",url:"/gp/buy/shipoptionselect/handlers/launch-delivery-trial.html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:{"x-amz-checkout-transition":"ajax"},data:b,dataType:"json",async:!0,success:function(b){b?console.debug('trial "'+a+'" success'):console.debug('trial "'+a+'" failed');c[a]=b;delete g[a]},error:function(b,c,d){delete g[a];"abort"!==d&&(console.debug("trial "+
a+" error"),q.error("issue with set-delivery-options trial: "+c,d))},cache:!1});g[a]=b;return!0},m=function(){for(var a=n(),a=h(a),b=Object.keys(g),c=0;c<b.length;++c){var d=b[c];d!==a&&(console.debug('removing ajax call for trial key "'+d+'"'),g[d].abort(),delete g[d])}};l(document).delegate("#shippingOptionFormId","change",function(c){c=n();if(h(c)!==f.val())a:{m(),c=e();var g=n(),k=h(g);f.val(k);var w=b(k,a.serialize()),k=0;w&&++k;for(var B=0;B<c.length;++B)for(var r=a.find('input[type\x3dradio][name\x3d"'+
c[B]+'"][value!\x3d"'+g[B]+'"]'),t=0;t<r.length;++t){var H=r[t],w=g.slice(0);w[B]=H.value;for(var w=h(w),y=H.name,H=H.value,G=a.serializeArray(),E=0;E<G.length;++E)G[E].name===y&&(G[E].value=H),"trialKey"===G[E].name&&(G[E].value=w);y=l.param(G);if((w=b(w,y))&&5===++k)break a}}});l(document).delegate("#shippingOptionFormId","submit",function(a){m()})}})});q.when("A","button-blocker","page-detector").register("scheduled-delivery-readiness-checker",function(a,l,g){function c(){g.isMobile()&&g.isSosp()&&
k("div.scheduled-delivery").length&&(k(document).delegate("div."+e+":visible input[type\x3d'radio'].shipping-option","change",function(){f(k(this).closest("div."+e))}),a.on("active-shipment-changed",f))}function d(a){h||(a.hasClass("scheduled-delivery-loading")?h=a.find(".loading-tooltip").text():a.hasClass("scheduled-delivery-picking")&&(h=a.find(".picking-tooltip").text()))}function f(a){h=null;a?d(a):k("div.one-shipment:visible div."+e+".scheduled-delivery").each(function(){var a=k(this);a.find("input").is(":checked")&&
d(a)});h?l.show("scheduled-delivery",h):l.hide("scheduled-delivery")}var k=a.$,h,e=p.P&&p.P.AUI_BUILD_DATE?"selectable-box":"fake-label";if(g.isMobile())a.on("checkout:reload:shipoptionselect",c);return{check:f}});"use strict";q.when("A","quantity-service","page-conductor","page-detector","ajax-utility","page-transition-controller","gift-utility","client-side-metrics").register("gift-form-base-controller",function(a,l,g,c,d,f,k,h){function e(a){a.is(":checked")||(Y?a.is(":checked")||a.closest("label").click():
(h.increaseCount("removeauijs4"),a.attr("checked",!0).trigger("change")))}function n(a){a.attr("disabled","disabled");Y&&a.closest("div").bind("click.disable",function(a){a.stopPropagation()})}function b(a){a.removeAttr("disabled");Y&&a.closest("div").unbind("click.disable")}function m(){q.when("a-dropdown").execute(function(a){var b=A(".select-recipient");b.empty();for(var c=0;c<aa.length;c++){var d=A("\x3coption/\x3e").attr({value:aa[c].value}).text(aa[c].text);b.append(d)}b.each(function(){var b=
A(this).closest(".gift-connection-section"),c=b.find(".include-gift-connection-checkbox").is(":checked"),d=b.find(".item-id").val(),e=b.find(".item-giftlist-type-id").val(),f;!e||"0"!==e&&"1"!==e&&"2"!==e?e&&"3"===e&&(f=b.find(".item-giftlist-id").val()):f=e;!f&&c&&(c=b.find(".item-registry-id").val())&&ea&&ea[c]&&(f=ea[c]);f&&(a.setValue(A(this).attr("id"),f),(e&&"1"===e||"2"===e)&&b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show(),H(d))})})}function v(){A(".gift-connection-recipient-section").unbind("click").bind("click",
function(){if(!X)return A(this).find(".select-recipient-spinner").removeClass("aok-hidden").show(),!1});A(".select-recipient").each(function(){A(this).unbind("change").bind("change",function(){var a=A(this),b=a.next().find(".a-dropdown-prompt"),c=A("\x3cdiv/\x3e").html(a.find(":selected").text()).clone().html();setTimeout(function(){b.html(c)},0)})});q.when("a-dropdown").execute(function(a){A(".gift-connection-section").each(function(){var b=A(this),c=b.find(".item-id").val(),d=b.find(".item-giftlist-type-id").val();
b.find(".item-giftlist-id").val();var e=b.find(".item-occasion-id").val(),f=b.find(".item-occasion-month").val(),h=b.find(".item-occasion-day").val(),g=b.find(".item-age").val();b.find("#input-recipient-first-name-"+c).unbind("keyup").keyup(function(){H(c)});b.find("#input-recipient-last-name-"+c).unbind("keyup").keyup(function(){H(c)});if("1"===d||"2"===d)a.setValue(b.find(".select-recipient").attr("id"),d),b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show();a.setValue(b.find(".select-occasion").attr("id"),
e);a.setValue(b.find(".select-occasion-month").attr("id"),f);a.setValue(b.find(".select-occasion-day").attr("id"),h);a.setValue(b.find(".select-occasion-age").attr("id"),g);if("1"===e||"2"===e)b.find(".gift-connection-occasion-extra").removeClass("aok-hidden").show(),"2"===d&&b.find(".select-occasion-age-row").removeClass("aok-hidden").show();"1"!==e&&"2"!==e&&"3"!==e&&H(c)})});var a="/gp/buy/pipeline/handlers/list-of-giftlists.html",b=A(".item-registry-id").map(function(){if(A(this).val())return A(this).val()}).get().join();
b&&(a+="?fromRegistryIds\x3d"+b);aa?(m(),A(".select-recipient-spinner").hide(),X=!0):(X=!1,A.ajax({type:"POST",url:a,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(a){!aa&&a.options&&0<a.options.length&&(aa=a.options);a.registryIdMapping&&(ea=a.registryIdMapping);aa&&m();A(".select-recipient-spinner").hide();X=!0},error:function(a,b,c){A(".select-recipient-spinner").hide();X=!0}}))}function u(){ba=[];a.state("giftNotificationEmailConstraints",[]);a.state("giftDeliveryDateConstraints",
[]);A('[data-action\x3d"gift-form-element"]').each(function(){var a=A(this);a.is("span")?a.find("input, textarea, select:first").trigger({type:"change",isInit:!0}):a.trigger({type:"change",isInit:!0})});A("textarea").unbind("keyup.gift-textarea click.gift-textarea").bind("keyup.gift-textarea click.gift-textarea",function(){A(this).trigger("change")});0<A(".enable-gift-connections").length&&v()}function z(a,b){var c=31;if("1"===b)c=0===a%4&&0!==a%100||0===a%400?29:28;else if("3"===b||"5"===b||"8"===
b||"10"===b)c=30;return c}function w(a,b,c){a=d.jsonify(a);g.redirect(a)}function B(a){q.when("a-dropdown").execute(function(b){A(".gift-connection-recipient-extra-"+a).hide();b.setValue("select-recipient-"+a,"0");A("#input-recipient-first-name-"+a).val("");A("#input-recipient-last-name-"+a).val("")})}function r(a){q.when("a-dropdown").execute(function(b){A(".gift-connection-occasion-extra-"+a).hide();b.setValue("select-occasion-"+a,"0");b.setValue("select-occasion-month-"+a,"0");b.setValue("select-occasion-day-"+
a,"0");b.setValue("select-occasion-age-"+a,"-1");A("#occasion-has-reminder-checkbox-"+a).attr("checked",!0)})}function t(a,b){q.when("a-dropdown").execute(function(c){for(var d=0;d<aa.length;d++)b&&b===aa[d].value&&aa[d].bMonth&&aa[d].bDay&&(c.setValue("select-occasion-month-"+a,aa[d].bMonth),c.setValue("select-occasion-day-"+a,aa[d].bDay))})}function H(a){q.when("a-dropdown").execute(function(b){var c=A("#select-recipient-"+a).find(":selected").val();"0"!==c&&("1"!==c&&"2"!==c||A("#input-recipient-first-name-"+
a).val()||A("#input-recipient-last-name-"+a).val())?b.updateSelect("select-occasion-"+a,{status:"enabled"}):(r(a),b.updateSelect("select-occasion-"+a,{status:"disabled"}))})}function y(a,b,c){"1"===b&&"2"===c?A("#select-occasion-age-row-"+a).removeClass("aok-hidden").show():A("#select-occasion-age-row-"+a).hide()}function G(){var a=A("#hidePricesCheckbox"),b=A("#kindle-reg-radio-your-account");Y?b.is(":checked")?A("#kindle-reg-radio-another-account").closest("label").click():a.is(":checked")||a.closest("label").click():
(h.increaseCount("removeauijs6"),a.is(":checked")||a.attr("checked","checked").trigger("change"),b.is(":checked")&&(b.removeAttr("checked").trigger("change"),A("#kindle-reg-radio-another-account").attr("checked","checked").trigger("change")))}function E(){var a=A("#hidePricesCheckbox"),b=A("#kindle-reg-radio-another-account");Y?b.is(":checked")?A("#kindle-reg-radio-your-account").closest("label").click():a.is(":checked")&&a.closest("label").click():(h.increaseCount("removeauijs7"),a.is(":checked")&&
a.removeAttr("checked").trigger("change"),b.is(":checked")&&(b.removeAttr("checked").trigger("change"),A("#kindle-reg-radio-your-account").attr("checked","checked").trigger("change")))}function I(){A("#hidePricesCheckboxLabel").hide();var a=A("#hidePricesCheckbox");Y&&(a.is(":checked")||a.closest("label").click());a.attr("disabled",!0).hide().trigger("change");A("#kindle-reg-radio-another-account").attr("disabled",!0).trigger("change");A("#kindle-reg-radio-your-account").attr("disabled",!0).trigger("change");
A("#hidePricesDisabledMessage").show();A("#hidePricesDisabledMessage").removeClass("aok-hidden");Y&&(A("label.a-touch-checkbox.hide-prices-checkbox").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}),A("label.a-touch-radio.kindle-reg-option").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}))}function da(a){var b=!1;A(".afn-wrap-checkbox").each(function(){var a=A(this),a=a.is("input")?a:a.find("input");if(a.is(":checked"))return b=
!0,!1});A(".mfn-no-wrap-radio").each(function(){var a=A(this),a=a.is("input")?a:a.find("input");if(!a.is(":checked"))return b=!0,!1});if(b)G(),I();else if(A("#hidePricesCheckbox").is(":disabled"))A("#hidePricesCheckboxLabel").show(),A("#hidePricesCheckbox").removeAttr("disabled").show().trigger("change"),A("#kindle-reg-radio-another-account").removeAttr("disabled").trigger("change"),A("#kindle-reg-radio-your-account").removeAttr("disabled").trigger("change"),A("#hidePricesDisabledMessage").hide(),
Y&&(A("label.a-touch-checkbox.hide-prices-checkbox").removeClass("a-touch-selector-disabled").unbind("click.disable"),A("label.a-touch-radio.kindle-reg-option").removeClass("a-touch-selector-disabled").unbind("click.disable"));else if(a.is("input")||(a=a.find("input")),"hidePricesCheckbox"===a.attr("id"))a.is(":checked")?G():E();else if("kindle-reg-radio-another-account"===a.attr("id")||"kindle-reg-radio-your-account"===a.attr("id"))A("#kindle-reg-radio-your-account").is(":checked")?E():G()}function W(a){var b=
A("#giftwrap-carousel-wrap-pane-"+a+" ul li").size();b&&(A("#giftwrap-carousel-wrap-holder-"+a).css("width",90*b),A("#giftwrap-carousel-wrap-pane-"+a).css("width",90*fa));P(a)}function P(a){A("#giftwrap-carousel-wrap-holder-"+a).find("ul li, ol li").each(function(b,c){b=A(c);b.find("input").is(":checked")&&D(b,{itemId:a})})}function D(a,b){a.parent().find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".giftwrap-carousel-item-image").addClass("selected-giftwrap-image");
a.parent().find(".wrap.a-button-selected").removeClass("a-button-selected");a.addClass("a-button-selected");var c=b.itemId;b=b.wrapNo;var d=g.isSPP(),e=a.find("input[type\x3dradio]");e.attr("checked",!0);d||(d=a.data("giftwrap-id"),e.val(d).change());var e=a.data("wrap-no"),d=A("#giftwrap-option-preview-imagearea-default-"+c),f=A("#giftwrap-option-preview-imagearea-image-"+c),h=A(".selectedWrapLargeLink","#item-"+c),c=A(".wrapNo-"+c+"-"+b);a.hasClass("none-wrap")?(d.removeClass("aok-hidden"),f.addClass("aok-hidden"),
h.length&&(h.addClass("aok-hidden"),h.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),f.find("img").attr("src",a),d.addClass("aok-hidden"),f.removeClass("aok-hidden"),h.length&&(h.addClass("aok-hidden"),h.removeClass("selectedWrapLargeLink")),c.length&&(c.addClass("selectedWrapLargeLink"),c.removeClass("aok-hidden")));a=A(".selectedWrapLargeLink");c=A(".larger-image-link-carousel-"+e);a.removeClass("selectedWrapLargeLink").addClass("aok-hidden");c.removeClass("aok-hidden").addClass("selectedWrapLargeLink")}
function N(a,b){var c;c=b.itemId;b=A("#giftwrap-option-preview-imagearea-default-"+c);c=A("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function F(a,b){var c=b.itemId;b=A("#giftwrap-option-preview-imagearea-default-"+c);c=A("#giftwrap-option-preview-imagearea-image-"+c);if(a.parent().find(".selected-giftwrap-image").parents("li").hasClass("none-wrap"))b.removeClass("aok-hidden"),
c.addClass("aok-hidden");else{var d=".selected-giftwrap-image img";g.isSPP()&&(d="img.selected-giftwrap-image");a=a.parent().find(d).attr("src");c.find("img").attr("src",a);b.addClass("aok-hidden");c.removeClass("aok-hidden")}}function x(a,b){var c=a.find(".empty-message-warning"),d=a.find(".no-receipt-warning"),e=a.find("textarea");a=a.find(".message-counter");b&&!d.is(":visible")?(a.hide(),c.show(),e.addClass("gift-warning")):(c.hide(),e.removeClass("gift-warning"),a.show())}function L(a){var b=
A("#"+a.id),c=k.getCharCount(b.val(),a.useByteSize),b=k.getLineCount(b.val(),a.maxChars/a.maxLines);return{length:c,charDelta:a.maxChars-c,lineDelta:a.maxLines-b}}function O(a,b){b=A("#item-"+b.itemId);var c=a.is(":checked")&&!a.hasClass("mfn-no-wrap-radio");g.isSPP()&&A("#carouselGiftWrap").length&&(c=!a.hasClass("mfn-no-wrap-radio"));c?(b.find(".gift-message-pslip").hide(),b.find(".gift-message-card").show()):(b.find(".gift-message-card").hide(),b.find(".gift-message-pslip").show())}function V(b,
c){var d=c.itemId;c=g.isSPP()?c.currentTab:b.data("current-tab");var e=A("#afn-gift-options-wrapper-"+d).data("active-tab");c!==e&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),b.addClass("selected-giftwrap-tab"),A("#afn-gift-options-wrapper-"+d).data("active-tab",c),b="#item-"+d,e=g.isSPP()?A("#giftwrap-carousel-wrap-holder-"+d,b):b,e.length&&a.trigger("checkout:gift:changeCarouselWrapOptions",e,c,d),c=A(".none-wrap",A(b)).find("input"),c.prop("checked",!0),c.val("").change(),
g.isSPP()?(c=A("#afn-gift-options-wrapper-"+d),c.length&&(c=c.data("active-tab"),a.trigger("checkout:gift:adaptCarouselGiftPanel",d,c))):a.trigger("checkout:gift:adaptCarousel",d),A("#giftwrap-carousel-wrap-holder-"+d).removeClass("a-button-selected").find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),A("#giftwrap-carousel-item-image-"+d).addClass("selected-giftwrap-image").parents(".wrap").addClass("a-button-selected"),A("#giftwrap-option-preview-imagearea-default-"+d).removeClass("aok-hidden"),
A("#giftwrap-option-preview-imagearea-image-"+d).addClass("aok-hidden"),c=A(".selectedWrapLargeLink"),c.length&&(c.addClass("aok-hidden"),c.removeClass("selectedWrapLargeLink")),c=g.isSPP(),b="#item-"+d,A("#gift-message-noshi-warning-"+d).addClass("aok-hidden"),A("#includeMessageCheckbox-"+d).removeAttr("disabled"),c?A("#afn-message-span-"+d,A(b)).removeClass("aok-hidden"):(A("#afn-message-span",A(b)).removeClass("disable-message-area").addClass("enable-message-area"),A("#gift-message-heading-"+d).removeClass("disable-message-area").addClass("enable-message-area"),
A("#message-area-"+d).removeAttr("disabled")))}var ba,fa=4,aa,X=!1,ea,A=a.$,Y=p.P&&p.P.AUI_BUILD_DATE&&c.isMobile(),Z=k.getInput;a.declarative("save-gift-for-later",["click"],function(a){f.show();a=a.$currentTarget.data("entityId")||a.data.entityId;l.call(a,0,{success:w})});q.register("gift-base/init-carousel",function(){return W});q.register("gift-base/set-carousel-size",function(){return function(a){fa=a}});var ka={toggleGiftDataAndDeliveryOptions:function(a){a=a.closest(".gift-options-wrapper");
var b=Z(a.find(".includeMessageCheckbox"));b&&b.is(":checked")?(a.find(".gift-delivery-option").show(),a.find(".item-wrap-span").show(),a.find(".item-wrap-row").show(),a.find(".item-gift-message-span").show()):(a.find(".gift-delivery-option").hide(),a.find(".item-wrap-span").hide(),a.find(".item-wrap-row").hide(),a.find(".item-gift-message-span").hide())},toggleGiftDeliveryOptions:function(a){var b=a.closest(".gift-options-wrapper");a.is("input[type\x3dcheckbox]")?a.is(":checked")?b.find(".gift-notification-email").removeClass("a-form-disabled"):
b.find(".gift-notification-email").addClass("a-form-disabled"):(b.find(".gift-notification-email").removeClass("a-form-disabled"),a=b.find(".includeMessageCheckbox"),e(a.find("input[type\x3dcheckbox]")),Y&&(a=a.find("i.a-icon"),a.length&&(a.removeClass("a-icon-checkbox-inactive"),a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-checkbox-active"),a.addClass("a-icon-touch-checkbox-active"))))},initGiftNotificationEmail:function(b){var c=a.state("giftNotificationEmailConstraints");
c.push({id:b.attr("id")});a.state("giftNotificationEmailConstraints",c)},initGiftDeliveryDate:function(b){var c=a.state("giftDeliveryDateConstraints");b.hasClass("year-select")||(b=b.parents("div.del-opt-date-section").find("select.year-select:first"));c.push({id:b.attr("id")});a.state("giftDeliveryDateConstraints",c)},updateDateDropdown:function(a){var b=a.closest(".gift-options-wrapper");a=b.find(".month-select").val();var c=b.find(".day-select");c.val();var b=b.find(".year-select").val(),d=z(b,
a);if(c.hasClass("a-native-dropdown"))q.when("a-dropdown").execute(function(a){a=a.getSelect(c);if(a.getOptions().size()>d)for(var b=a.getOptions().size()-1;b>=d;b--)a.removeOption(b);else for(b=a.getOptions().size();b<d;b++)a.addOption({text:b+1,value:b+1},b)});else{if(c.find("option").length>d)c.find("option:gt("+(d-1)+")").remove();else for(a=c.find("option").length+1;a<=d;a++)c.append(A("\x3coption\x3e",{value:a}).text(a));c.trigger("change")}},initSelectedTabAndWrapHolderWidth:W,initGiftMessage:function(a,
b){Y&&!a.is("textarea")&&(a=a.find("textarea"));ba.push({id:a.attr("id"),maxChars:parseInt(b.maxChars,10),maxLines:parseInt(b.maxLines,10),useByteSize:b.useByteSize});Z(a.closest(".gift-options-wrapper").find(".includeMessageCheckbox")).is(":checked")||a.addClass("a-form-disabled");"1"===A("#multipleAFNGiftWrapOption").val()&&(a=a.attr("id").substring(a.attr("id").lastIndexOf("-")+1,a.attr("id").size),W(a))},enforceSelectorParity:da,enforceGiftReceiptParity:function(a,c){a=A("#item-"+c.itemId);if(0!==
a.length){c=a.find(".item-receipt-row label");var d=Z(a.find(".includeReceiptCheckbox")),f=a.find(".mfn-hide-price-row label"),h=Z(a.find(".mfnHidePriceCheckbox")),g=a.find(".item-message-row label"),m=Z(a.find(".includeMessageCheckbox")).is(":checked"),t=!1;0<a.find(".afn-wrap-checkbox").length?Z(a.find(".afn-wrap-checkbox")).is(":checked")&&(t=!0):0<a.find(".mfn-no-wrap-radio").length&&(Z(a.find(".mfn-no-wrap-radio")).is(":checked")||(t=!0));if(t||m)e(d),e(h);t||m&&g.is(":visible")?(n(d),c.addClass("checkout-gift-option-disabled"),
n(h),f.addClass("checkout-gift-option-disabled")):(b(d),b(h),c.removeClass("checkout-gift-option-disabled"),f.removeClass("checkout-gift-option-disabled"))}},enforceHidePriceParity:function(a){var b=!1;A(".includeReceiptCheckbox").each(function(){if(Z(A(this)).is(":checked"))return b=!0,!1});var c=!1;A(".mfnHidePriceCheckbox").each(function(){if(Z(A(this)).is(":checked"))return c=!0,!1});b||c?(G(),A(".kindle-reg-msg-your-account").hide(),A(".kindle-reg-msg-another-account").show()):(E(),A(".kindle-reg-msg-another-account").hide(),
A(".kindle-reg-msg-your-account").show())},toggleNoReceiptWarning:function(a){var b=Z(a).is(":checked"),c=a.closest(".gift-options-wrapper");a=c.find(".no-receipt-warning");var d=c.find(".empty-message-warning"),c=c.find(".item-message-row").find(".includeMessageCheckbox"),f=Z(c);b?(a.hide(),c.is(":visible")||e(f)):(d.hide(),a.show(),f.is(":checked")&&(Y?f.is(":checked")&&f.closest("label").click():(h.increaseCount("removeauijs5"),f.removeAttr("checked").trigger("change"))))},toggleMessageArea:function(a){var b=
a.closest(".gift-options-wrapper");if(a.is("textarea"))b=Z(b.find(".includeMessageCheckbox")),e(b);else{a=Z(b.find(".includeMessageCheckbox")).is(":checked");var c=b.find(".item-message-row label").is(":visible"),d=0<b.find(".empty-message-warning").length,f=b.find("textarea"),h=f.data("default-text"),g=0<f.val().length;a?(b.find(".gift-message-edit").show(),b.find(".gift-message-label").removeClass("a-color-secondary"),f.removeClass("a-form-disabled"),h&&f.val(h)):(c&&b.find(".gift-message-edit").hide(),
b.find(".gift-message-label").addClass("a-color-secondary"),f.addClass("a-form-disabled"),h&&f.val(""));d&&(a&&g?x(b,!1):x(b,!0))}},toggleMessageLocationText:O,toggleMessageBoxDisplay:function(c,d){var f=A("#item-"+d.itemId);if(0!==f.length){var h=f.find(".item-message-row");d=f.find(".item-receipt-row");var g=f.find(".gift-message-on-card"),m=f.find(".gift-message-on-receipt"),t=h.find("label"),h=Z(h.find(".includeMessageCheckbox")),k=a.trim(f.find(".gift-message-default-placeholder").text()),l=
a.trim(f.find(".gift-message-with-wrap-placeholder").text()),f=f.find("textarea"),r=c.hasClass("mfn-no-wrap-radio")||c.closest("div").hasClass("mfn-no-wrap-radio");Z(c).is(":checked")&&!r?(m.hide(),g.show(),f.attr("placeholder",l),d.is(":visible")&&(e(h),t.is(":visible")&&(n(h),t.addClass("checkout-gift-option-disabled")))):(g.hide(),m.show(),f.attr("placeholder",k),b(h),t.removeClass("checkout-gift-option-disabled"))}},updateContinueButtons:function(){for(var b=!0,c,d=0;d<ba.length;d++)if(c=A("#"+
ba[d].id),c.closest(".gift-options-wrapper").find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]').is(":checked")&&(c=L(ba[d]),0>c.charDelta||0>c.lineDelta))b=!1;b?(A(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").show(),A(".save-gift-button-box span.a-button-disabled").hide()):(A(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").hide(),b=A(".save-gift-button-box span.a-button-disabled"),b.removeClass("aok-hidden"),b.show());a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")},
updateMessageCounter:function(a){Y&&!a.is("textarea")&&(a=a.find("textarea"));for(var b,c=0;c<ba.length;c++)a.attr("id")===ba[c].id&&(b=L(ba[c]));if(b){a=a.closest(".gift-options-wrapper");c=a.find(".message-counter");c.find(".remaining-count").hide();if(0<a.find(".empty-message-warning").length){if(0===b.length){x(a,!0);return}x(a,!1)}(-1>b.charDelta?c.find(".remaining-char-over-multiple").show():0>b.charDelta?c.find(".remaining-char-over-single").show():1===b.charDelta?c.find(".remaining-char-single").show():
c.find(".remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(b.charDelta));(-1>b.lineDelta?c.find(".remaining-line-over-multiple").show():0>b.lineDelta?c.find(".remaining-line-over-single").show():1===b.lineDelta?c.find(".remaining-line-single").show():c.find(".remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(b.lineDelta));c.show()}},updateSelectedGiftWrap:D,clearGiftConnection:function(a,b){A("#include-gift-connection-checkbox-"+b.itemId).is(":checked")||
(B(b.itemId),H(b.itemId))},toggleGiftConnectionAgeDropdown:y,toggleGiftConnectionRecipientArea:function(a,b){a=A("#select-recipient-"+b.itemId).find(":selected").val();var c=A("#select-occasion-"+b.itemId).find(":selected").val();!a||"1"!==a&&"2"!==a?(A(".gift-connection-recipient-extra-"+b.itemId).hide(),"1"===c&&a&&t(b.itemId,a)):A(".gift-connection-recipient-extra-"+b.itemId).removeClass("aok-hidden").show();y(b.itemId,c,a);H(b.itemId)},toggleGiftConnectionOccasionArea:function(a,b){a=A("#select-occasion-"+
b.itemId).find(":selected").val();var c=A("#select-recipient-"+b.itemId).find(":selected").val();!a||"1"!==a&&"2"!==a?A(".gift-connection-occasion-extra-"+b.itemId).hide():("1"===a&&c&&"1"!==c&&"2"!==c&&t(b.itemId,c),A(".gift-connection-occasion-extra-"+b.itemId).removeClass("aok-hidden").show());y(b.itemId,a,c)},includeGiftConnection:function(a,b){(a=A("#select-recipient-"+b.itemId).find(":selected").val())&&"0"===a||A("#include-gift-connection-checkbox-"+b.itemId).attr("checked",!0)},updateGiftOptionsTabSelection:V,
updatePreviewImageOnMouseEnter:N,updatePreviewImageOnMouseLeave:F,toggleGiftMessageWarning:function(a){var b=A("#"+a.attr("id"));k.toggleGiftMessageWarning(b,a.closest(".item-gift-message-span"))}};a.declarative("gift-form-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(ka[b[c]])ka[b[c]](a.$target,a.data)});a.declarative("gift-form-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",
mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(ka[b[c]])ka[b[c]](a.$currentTarget,a.data,a)});a.declarative("select-gift-wrap","click",function(a){D(a.$target.parents("li"),{itemId:a.data.itemId,wrapNo:a.data.wrapNo});da(a.$target);var b=a.$target.parents("li").find(".gift-hidden-radio");O(b,{itemId:a.data.itemId})});a.declarative("select-gift-wrap","mouseenter",function(a){N(a.$target.parents("li"),a.data)});a.declarative("select-gift-wrap","mouseleave",function(a){F(a.$target.parents("li"),
a.data)});a.declarative("update-gift-options-tab-selection",["click"],function(a){var b=a.$target.parents("li");b.attr("data",a.data);V(b,a.data)});a.on("checkout:reload:giftselect",u);a.on("checkout:reload:spp-giftoptions",u);return{extendFunctions:function(a){A.extend(ka,a)}}});"use strict";q.when("A","page-transition-controller","page-conductor").register("gift-form-del-opt-controller",function(a,l,g){function c(a){var c=a.closest(".expando-box");c&&(c=c.find(".a-expander-header"),a.closest(".expando-content").is(":hidden")&&
c.click())}function d(a){var c=a.closest(".gift-options-wrapper"),b=c.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(b&&!b.is(":checked"))return!0;b=c.find(".email-error-selector");c.find(".gift-notification-email-error").hide();b.removeClass("a-form-error");if(64<p.unescape(encodeURIComponent(a.val())).length)return b.addClass("a-form-error"),c.find(".gift-notification-email-length-exceeded-error").removeClass("aok-hidden").show(),!1;if(/^\S+[@]\S+[.]\S+$/.test(a.val()))return!0;
b.addClass("a-form-error");c.find(".gift-notification-invalid-email-error").removeClass("aok-hidden").show();return!1}function f(){h("#giftForm").find(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").unbind("click").bind("click",function(a){a.preventDefault();k(a)});h(".checkout-gift-image-preview-trigger \x3e a").show();h("#gift-kindle-imb").show()}function k(e){e=h("#giftForm");var f=e.find('input[name\x3d"hidePrices"]'),b=f.is(":disabled");b&&f.removeAttr("disabled");for(var m=
!0,k=a.state("giftNotificationEmailConstraints"),u=a.state("giftDeliveryDateConstraints"),z=0;z<k.length;z++){var w=h("#"+k[z].id);d(w)||(m=!1,c(w))}for(k=0;k<u.length;k++){z=h("#"+u[k].id);var w=z.closest(".gift-options-wrapper"),B=w.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(B&&!B.is(":checked"))w=!0;else{var r=w.find(".month-select").val(),t=w.find(".day-select").val(),B=w.find(".year-select"),H=B.val(),y=w.find("#current-date").val().split("-"),r=new Date(H,r,t),y=new Date(y[0],
y[1]-1,y[2]),t=new Date(y.getTime());t.setMonth(t.getMonth()+12);w.find(".gift-delivery-date-error").hide();H=w.find(".date-error-selector");B=B.hasClass("a-native-dropdown")?"error-border a-form-error":"a-form-error";H.removeClass(B);r>=t||r<y?(w.find(".gift-delivery-date-error").removeClass("aok-hidden").show(),H.addClass(B),w=!1):w=!0}w||(m=!1,c(z))}a.state("continueAction",{enable:m});if(a.state("continueAction").enable)g.isSPP()||l.showPageTransition(),e.submit();else return h("html, body").animate({scrollTop:h(".a-form-error").closest("div").offset().top},
500),!1;b&&f.attr("disabled",!0)}var h=a.$;a.declarative("submit-gift-options","click",function(a){k(a)});a.declarative("discard-gift-options","click",function(a){h('#giftForm input[type\x3d"checkbox"]').prop("checked",!1);h("#giftForm textarea").addClass("a-form-disabled");k(a)});a.on("checkout:reload:giftselect",f);a.on("checkout:reload:spp-giftoptions",f)});"use strict";q.when("A").register("teen-message-controller",function(a){var l=a.$;a.declarative("teen-message-form-element","click keyup",
function(a){a=a.data.maxChars;var c=l("#teen-message-box").val(),d=c.match(/(\r\n|\n|\r)/g),f=0;d&&(f=d.length);c=c.length+f;l(".remaining-char").text(Math.max(a-c,0))});l("#aui-teen-message-box").length&&l(".remaining-char").length&&q.when("A").execute(function(a){function c(a){a=a.val();var c=(a.match(/(\r\n|\n|\r|\n\r)/g)||{}).length||0;return a.length+c}a=a.$;var d,f,k;d=a("#aui-teen-message-box");d.bind("change keypress",function(a){return c(d)>=k?(a.preventDefault(),!1):!0});d.bind("paste",
function(a){if(a&&a.originalEvent&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.getData("Text")){var e=a.originalEvent.clipboardData.getData("Text"),f=c(d);if(f+e.length>=k)return e=e.substring(0,k-f),e=d.val()+e,d.attr("value",e),a.preventDefault(),!1}return!0});d.bind("click keyup",function(){var a=Math.max(k-c(d),0);f.text(a)});f=a(".remaining-char");k=d.parent().data("maxchars")})});"use strict";q.when("A","page-transition-controller","page-conductor","loading-spinner-controller",
"client-side-metrics").register("concealment-form-del-opt-controller",function(a,l,g,c,d){function f(a){var c=h("#concealmentForm");c.find("input:checked").length?(a=a.data.saveConcealmentRefTag,d.increaseCount("CPEX.Checkout.Select.Concealment",1)):(a=a.data.cancelConcealmentRefTag,d.increaseCount("CPEX.Checkout.Cancel.Concealment",1));c.find("input[name\x3dref]").val(a);c.attr("action",c.attr("action")+"/ref\x3d"+a)}function k(a){a=h("#concealmentForm");g.isSPP()||l.showPageTransition();a.submit()}
var h=a.$;a.declarative("submit-concealment-options","click",function(a){f(a);k(a)});a.declarative("discard-concealment-options","click",function(a){h('#concealmentForm input[type\x3d"checkbox"]').prop("checked",!1);f(a);k(a)});a.declarative("submit-concealment-form","click",function(a){f(a);a.$target.closest(".a-button").addClass("a-button-disabled");c.showSpinner(a.$target.closest("form"))})});"use strict";q.when("A","page-transition-controller","page-conductor","address-popovers","checkout-general-utils",
"a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-address-controller",function(a,l,g,c,d,f,k,h,e){function n(){u(".lineitem").each(function(a,b){a=u(b);a.find(".no-js-address-dropdown").remove();a.find(".no-js-address-select").remove();a.find(".js-address-dropdown").prop("disabled",!1);a.find(".address-dropdown").removeClass("a-button-disabled")});u("#suppressAddAddressPopover").val()&&u('select[name^\x3d"addressID."]').find("option").each(function(){var a=u(this);
"New"===a.val()&&a.closest("optgroup").remove()})}function b(a){var b=(new Date).getTime(),c=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});h.isHeadersCleaned()?u.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+b,data:a,dataType:"text",headers:c,error:g.ajaxRedirect,success:function(a,b,c){var f=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==f&&f!==F)p.location=f;else if(m(a)){a=e.jsonify(a);v(a,c);var h;
c=r.find('input[name^\x3d"previousAddress."]');if(null!==c||c!==F)h=w||c.val();var n=r.find('select[name^\x3d"addressID."]');null===n&&n===F||q.when("a-dropdown").execute(function(a){a.setValue(n.attr("id").replace(/\./g,"\\."),h);n.find("option").removeAttr("selected");n.find('option[value\x3d"'+h+'"]').attr("selected","selected")});l.hide()}else g.ajaxUpdatePage(a,b,c),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}):u.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+
b,data:a,dataType:"text",headers:c,error:g.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==e&&e!==F)p.location=e;else if(m(c)){v(a,c);var f;a=r.find('input[name^\x3d"previousAddress."]');if(null!==a||a!==F)f=w||a.val();var h=r.find('select[name^\x3d"addressID."]');null===h&&h===F||q.when("a-dropdown").execute(function(a){a.setValue(h.attr("id").replace(/\./g,"\\."),f);h.find("option").removeAttr("selected");h.find('option[value\x3d"'+f+'"]').attr("selected",
"selected")});l.hide()}else g.ajaxUpdatePage(a,b,c),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function m(a){var b;if(h.isHeadersCleaned()){if(a=e.jsonify(a))b=a.showAddonWarning}else b=a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==b&&b!==F}function v(a,b){h.isHeadersCleaned()?(b=a.showAddonWarning,a=a.asins):b=b.getResponseHeader("x-amz-checkout-show-addon-warning");u(".item-list").hide();a.trim().split(",").forEach(function(a){u('[data-asin\x3d"'+
a+'"]').show()});a=u("#addon-warning-"+b+"-launcher");a.length&&(u(".delete-title").hide(),u(".reduce-title").hide(),u(".select-address-title").show(),u("input[name\x3duseLiveAUI]").length?f.get(a).attrs({$trigger:B,position:"triggerHorizontal"}).show():(b=u.Event("keyup",{triggerPositioningElement:B,manualTrigger:!0}),a.trigger(b)))}var u=a.$,z,w,B,r;a.declarative("itemselect-get-address",["click","touchend"],function(a){d.protectAgainstDoubleAction("itemselect-get-address",200)||(w=a.$currentTarget.find(".js-address-dropdown").val())});
a.declarative("itemselect-update-address",["change"],function(a){if(!d.protectAgainstDoubleAction("itemselect-update-address",200)){k.resetMetrics();var e=a.$currentTarget.is("select")?a.$currentTarget:a.$currentTarget.find("select");z=e.val();if("New"===z)c.actionTriggerPopoverFromDropdown(a),q.when("a-dropdown").execute(function(a){a.setValue(e.attr("id").replace(/\./g,"\\."),w)});else{l.show();r=e.closest(".lineitem");var f,h;if(r){var g=r.find('input[name^\x3d"lineItemEntityID."]');g&&(f=g.val());
(g=r.find('input[name^\x3d"quantity."]'))&&(h=g.val());(g=r.find(".js-address-dropdown"))&&(z=g.val())}B=a.$currentTarget.is("select")?a.$currentTarget.closest(".address-dropdown"):a.$currentTarget;a=0;g=u("#addon-indicator");g.length&&"true"===g.attr("data-has-addon-items")&&(a=1);b({lineitems:f,addresses:z,quantities:h,isTrial:a})}}});a.declarative("itemselect-update-pantry-address",["change"],function(a){if(!d.protectAgainstDoubleAction("itemselect-update-pantry-address",200)){z=a.$currentTarget.val();
l.show();var c="";a=a.$currentTarget.closest(".pantry-row");u(a).find(".pantry-item").each(function(a,b){a=u(b);c+="lineitems\x3d"+a.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26";c+="addresses\x3d"+z+"\x26";c+="quantities\x3d"+a.find('input[name^\x3d"quantity."]').val()+"\x26"});b(c)}});a.declarative("addon-delete-items",["click","touchend"],function(a){if(B!==F&&null!==B&&!d.protectAgainstDoubleAction("itemselect-delete-addons",200)){u(".a-button-close").trigger("click");l.show();a=(new Date).getTime();
var b=u("#useCase").val(),c=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"}),e=r.find('input[name^\x3d"lineItemEntityID."]').val(),f=r.find('input[name^\x3d"quantity."]').val();u.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+a,data:{lineitems:e,addresses:z,quantities:f,isTrial:0,deleteAddons:1,returnHTML:1,useCase:b},headers:c,error:g.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-redirect-to-cart");
null!==e&&e!==F?p.location=e:(e=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==e&&e!==F?p.location=e:(g.ajaxUpdatePage(a,b,c),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.on("checkout:reload:itemselect",n);a.on("checkout:reload:spp-itemselect",n)});"use strict";q.when("A","page-transition-controller","page-conductor","checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-delete-controller",function(a,
l,g,c,d,f,k,h){function e(a,b){n(a,null===b||b===F?a.$currentTarget.closest(".lineitem"):b)}function n(a,b){a.$event.preventDefault();if(!c.protectAgainstDoubleAction("itemselect-delete-single-item",200)){f.resetMetrics();l.show();w=b;r=a.$currentTarget.is("select")?a.$currentTarget.closest(".quantity-dropdown"):a.$currentTarget;a=w.find('input[name^\x3d"lineItemEntityID."]').val();b=0;(new Date).getTime();var d=z("#addon-indicator");d.length&&"true"===d.attr("data-has-addon-items")&&(b=1);m({lineitems:a,
isTrial:b})}}function b(a,b){a.$event.preventDefault();if(!c.protectAgainstDoubleAction("itemselect-delete-multiple-items",200)){l.show();B=b;r=a.$currentTarget;var d="";a=0;b=z("#addon-indicator");b.length&&"true"===b.attr("data-has-addon-items")&&(a=1);b=B.hasClass("pantry-row")?!0:!1;B.find(b?".pantry-item":".lineitem").each(function(a,b){d+="lineitems\x3d"+z(b).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"});m(d+"isTrial\x3d"+a)}}function m(a){var b=(new Date).getTime(),c=z('input[name\x3d"useCase"]').val(),
d=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});z.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3ddelete\x26useCase\x3d"+c+"\x26cachebuster\x3d"+b,data:a,dataType:"text",headers:d,error:g.ajaxRedirect,success:v})}function v(a,b,d){var e;e=d.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==e&&e!==F?(p.location=e,e=!0):e=!1;if(!e)if(e=d.getResponseHeader("x-amz-checkout-fatal-error"),null!==e&&e!==F)p.location=e;else{var f;if(k.isHeadersCleaned()){if(e=
h.jsonify(a))f=e.showAddonWarning}else f=d.getResponseHeader("x-amz-checkout-show-addon-warning");f=null!==f&&f!==F?!0:!1;f?(u(a,d),l.hide()):(g.ajaxUpdatePage(a,b,d),c.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}}function u(a,b){k.isHeadersCleaned()?(a=h.jsonify(a),b=a.showAddonWarning,a=a.asins):b=b.getResponseHeader("x-amz-checkout-show-addon-warning");z(".item-list").hide();a.trim().split(",").forEach(function(a){z('[data-asin\x3d"'+a+'"]').show()});a=z("#addon-warning-"+
b+"-launcher");a.length&&(z(".delete-title").show(),z(".reduce-title").hide(),z(".select-address-title").hide(),z("input[name\x3duseLiveAUI]").length?d.get(a).attrs({$trigger:r,position:"triggerHorizontal"}).show():(b=z.Event("keyup",{triggerPositioningElement:r,manualTrigger:!0}),a.trigger(b)))}var z=a.$,w,B,r;a.declarative("itemselect-delete-item",["click","touchend"],e);a.declarative("itemselect-delete-item-row",["click","touchend"],function(a){b(a,a.$currentTarget.closest(".item-row"))});a.declarative("addon-delete-items",
["click","touchend"],function(a){if(r!==F&&!c.protectAgainstDoubleAction("itemselect-delete-addons",200)){z(".a-button-close").trigger("click");l.show();var b="";null!==B&&B!==F?(a=B.hasClass("pantry-row")?B.find(".pantry-item"):B.find(".lineitem"),z(a).each(function(a,c){b+="lineitems\x3d"+z(c).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"})):null!==w&&w!==F&&(b+="lineitems\x3d"+w.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26");m(b+"isTrial\x3d0\x26deleteAddons\x3d1")}});a.declarative("itemselect-delete-pantry-item",
["click","touchend"],function(a){n(a,a.$currentTarget.closest(".pantry-item"))});a.declarative("itemselect-delete-pantry",["click","touchend"],function(a){b(a,a.$currentTarget.closest(".pantry-row"))});a.declarative("itemselect-delete-popover-item",["click","touchend"],function(a){var c=a.$currentTarget.data("entityidtodelete");b(a,z('a[data-entityid\x3d"'+c+'"]').closest(".item-row"))});return{actionDeleteItem:e}});"use strict";q.when("A","page-transition-controller","page-conductor","itemselect-delete-controller",
"checkout-general-utils","a-popover","client-side-metrics","weblab-helper","ajax-utility").register("itemselect-quantity-controller",function(a,l,g,c,d,f,k,h,e){function n(){B(".lineitem, .pantry-item").each(function(a,b){a=B(b);a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))})}function b(a){a.find(".quantity-input").val(a.find('input[name^\x3d"previousQuantity."]').val())}
function m(a){var c=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),d=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),e;e="itemselect-show-update-pantry-button"===a.action?".pantry-item":".lineitem";0===parseInt(d,10)||""===d?("change"===a.type&&b(a.$currentTarget.closest(e)),c.hide()):(a=a.$currentTarget.closest(e).find('input[name^\x3d"previousQuantity."]').val(),d!==a?c.show():c.hide())}function v(a){a.$event.preventDefault();
if(!d.protectAgainstDoubleAction("itemselect-update-quantity",200)){k.resetMetrics();H=a.$currentTarget.closest("itemselect-update-pantry-quantity"===a.action||"itemselect-update-pantry-quantity-text-field"===a.action?".pantry-item":".lineitem");var f=H.find(".js-address-dropdown").val(),n=a.$currentTarget.find("select"),m=n.length?n:a.$currentTarget;r=m.is("select")?m.val():H.find(".quantity-input").val();if(0===parseInt(r,10)||""===r)b(H);else if("Delete"===r)q.when("a-dropdown").execute(function(a){a.setValue(m.attr("id").replace(/\./g,
"\\."),t)}),c.actionDeleteItem(a,H);else{l.show();a=H.find('input[name^\x3d"lineItemEntityID."]').val();var n=0,v=(new Date).getTime(),P=B("#useCase").val(),D=B("#addon-indicator");y=m.is("select")?m.parent():H.find(".quantity-input");D.length&&"true"===D.attr("data-has-addon-items")&&(n=1);D=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});h.isHeadersCleaned()?B.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+v,data:{lineitems:a,
quantities:r,address:f,isTrial:n,returnHTML:1,useCase:P},dataType:"text",headers:D,error:g.ajaxRedirect,success:function(a,b,c){var f=c.getResponseHeader("x-amz-checkout-fatal-error");null!==f&&f!==F?p.location=f:z(a)?(a=e.jsonify(a),w(a,c),u(t===F?H.find('input[name^\x3d"previousQuantity."]').val():t,c),l.hide()):(g.ajaxUpdatePage(a,b,c),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}}):B.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+
v,data:{lineitems:a,quantities:r,address:f,isTrial:n,returnHTML:1,useCase:P},dataType:"text",headers:D,error:g.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-fatal-error");null!==e&&e!==F?p.location=e:z(c)?(w(a,c),u(t===F?H.find('input[name^\x3d"previousQuantity."]').val():t,c),l.hide()):(g.ajaxUpdatePage(a,b,c),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}}function u(a,b){10>a?(q.when("a-dropdown").execute(function(b){var c=H.find('select[name^\x3d"quantity."]');
b.setValue(c.attr("id").replace(/\./g,"\\."),a);c.find("option").removeAttr("selected");c.find('option[value\x3d"'+a+'"]').attr("selected","selected")}),H.find(".quantity-dropdown").show(),H.find(".quantity-text-field").hide(),H.find(".js-select").prop("disabled",!1),H.find(".quantity-input").prop("disabled",!0)):(H.find(".quantity-dropdown").hide(),H.find(".quantity-text-field").show(),H.find(".update-quantity-link").hide(),H.find(".js-select").prop("disabled",!0),H.find(".quantity-input").prop("disabled",
!1));H.find(".quantity-input").val(a);H.find('input[name^\x3d"previousQuantity."]').val(a)}function z(a){var b;if(h.isHeadersCleaned()){if(a=e.jsonify(a))b=a.showAddonWarning}else b=a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==b&&b!==F?!0:!1}function w(a,b){h.isHeadersCleaned()?(b=a.showAddonWarning,a=a.asins):b=b.getResponseHeader("x-amz-checkout-show-addon-warning");B(".item-list").hide();a.trim().split(",").forEach(function(a){B('[data-asin\x3d"'+a+'"]').show()});a=B("#addon-warning-"+
b+"-launcher");a.length&&0<a.length&&(B(".reduce-title").show(),B(".delete-title").hide(),B(".select-address-title").hide(),B("input[name\x3duseLiveAUI]").length?f.get(a).attrs({$trigger:y}).show():(b=B.Event("keyup",{triggerPositioningElement:y,manualTrigger:!0}),a.trigger(b)))}var B=a.$,r,t,H,y;a.declarative("itemselect-get-quantity",["click","touchend"],function(a){d.protectAgainstDoubleAction("itemselect-get-quantity",200)||a.$currentTarget.find("select").length&&(t=a.$currentTarget.find("select").val())});
a.declarative("itemselect-update-quantity",["change"],v);a.declarative("itemselect-update-pantry-quantity",["change"],v);a.declarative("addon-delete-items",["click","touchend"],function(a){if(y!==F&&!d.protectAgainstDoubleAction("itemselect-delete-addons",200)){B(".a-button-close").trigger("click");l.show();a=H.find('input[name^\x3d"lineItemEntityID."]').val();var b=(new Date).getTime(),c=B("#useCase").val(),e=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});B.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+
b,data:{lineitems:a,quantities:r,isTrial:0,deleteAddons:1,returnHTML:1,useCase:c},headers:e,error:g.ajaxRedirect,success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==e&&e!==F?p.location=e:(e=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==e&&e!==F?p.location=e:(g.ajaxUpdatePage(a,b,c),d.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.declarative("itemselect-sanitize-input",["keydown"],function(a){d.limitInputToNumbers(a)});
a.declarative("itemselect-update-quantity-text-field",["click","touchend"],v);a.declarative("itemselect-update-pantry-quantity-text-field",["click","touchend"],v);a.declarative("itemselect-show-update-button",["change","keyup"],m);a.declarative("itemselect-show-update-pantry-button",["change","keyup"],m);a.on("checkout:reload:itemselect",n);a.on("checkout:reload:spp-itemselect",n)});"use strict";q.when("A","page-transition-controller","page-conductor","checkout-general-utils","client-side-metrics").register("itemselect-ship-to-multiple-controller",
function(a,l,g,c,d){var f=a.$;a.declarative("itemselect-ship-to-multiple",["click","touchend"],function(a){a.$event.preventDefault();d.resetMetrics();if(!c.protectAgainstDoubleAction("itemselect-ship-to-multiple",200)){l.show();var h=null,e=null,n=null;a.$currentTarget.closest(".item-row").find(".lineitem").each(function(a,b){a=f(b);b=a.find('select[name^\x3d"quantity."]');var c=a.find('input[type\x3d"number"]');if(a.find(".quantity-dropdown").is(":visible")&&1<b.val())return h=a.find('input[name^\x3d"lineItemEntityID."]').val(),
e=b.val(),n=a.find(".js-address-dropdown").val(),!1;if(a.find(".quantity-text-field").is(":visible")&&1<c.val())return h=a.find('input[name^\x3d"lineItemEntityID."]').val(),e=c.val(),n=a.find(".js-address-dropdown").val(),!1});if(null!==h){a=(new Date).getTime();var b=g.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});f.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dship-to-multiple\x26cachebuster\x3d"+a,data:{lineitem:h,quantity:e,address:n},headers:b,dataType:"text",
error:g.ajaxRedirect,success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-fatal-error");null!==e&&e!==F?p.location=e:(g.ajaxUpdatePage(a,b,d),c.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}})});"use strict";q.when("A").register("safe-apx-helper",function(a){var l={},g=a.$;return{get:function(a){return l[a]},set:function(){1===arguments.length?l=g.extend(l,arguments[0]):2===arguments.length?l[arguments[0]]=arguments[1]:p.console&&p.console.error&&p.console.error("Unexpected number of arguments: %d. Expected 1 or 2.",
arguments.length)}}});"use strict";q.when("A","weblab-helper").register("mobile-carrier-billing-util",function(a,l){var g=!1;return{determineIsMCBEnabled:function(a){g=0<a.paymentRows.find('input[type\x3d"radio"][name\x3dpaymentMethod]').filter("[value^\x3dMCB]").size()},toggleGCForMCB:function(a,d){if(!l.isMCBMultiTenderWeblabEnabled()&&g&&(a=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]'),a.length)){var f=d.paymentRows.find('input[type\x3d"checkbox"][name\x3duseAvailableBalance]'),f=d.existingBalance||
f,k=0<d.paymentRows.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,h="paymentsForm"in d&&0<d.paymentsForm.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,k=k||h;0<a.filter("[value^\x3dMCB]").size()&&k?(f.length&&(f.prop("checked",!1),f.prop("disabled",!0)),d.mcbBalanceWarning&&d.mcbBalanceWarning.show()):(f.length&&f.prop("disabled",!1),d.mcbBalanceWarning&&d.mcbBalanceWarning.hide())}},showMCBWarningMessageForPoints:function(a){g&&a.mcbPointsWarning&&a.mcbPointsWarning.show()},
hideMCBWarningMessageForPoints:function(a){g&&a.mcbPointsWarning&&a.mcbPointsWarning.hide()}}});"use strict";q.when("A").register("emi-utils",function(a){var l=a.$;return{addEMIMenuSelectionAttributes:function(){var a=l("#emiPaymentMethodsSelectList").val();l("#pmEmiPaymentOptions").val(a);var c=a.split(".");1<c.length&&(a=c[1]);var a=l("."+a),d;a&&(d=a.find("#emiMenuIdentifier"));d&&(d.attr("name","isFromEMIMenu"),d.attr("value","1"))},removeEMIMenuSelectionAttributes:function(){var a=l("#selectedSectionEmiPaymentMethod").find("#emiMenuIdentifier");
a.removeAttr("name");a.removeAttr("value")},isEMIPaymentInstrument:function(a){return 1==a.length&&1==l(a[0]).find("#pmEmiPaymentOptions").length?!0:!1},getEMIMenuSelectedCardSection:function(){var a=l("#emiPaymentMethodsSelectList").val(),c=a.split(".");1<c.length&&(a=c[1]);return l("."+a)}}});"use strict";q.when("A","emi-utils").register("emi-helper",function(a,l){function g(){l.addEMIMenuSelectionAttributes()}function c(){l.removeEMIMenuSelectionAttributes()}function d(a){var c;if("CreditCard"===
a)c=f(k.newEMI).find(".new-emi-card-fields").hide();else if(a=a.split("."),1<a.length){var d=a[0];if("emiCreditCard"===d||"netbankingEMI"===d)c=f(k.newEMI).find("."+a[1]).hide()}return c}var f=a.$,k={selectedEMIMenuSection:"#selectedSectionEmiPaymentMethod",emiDisabledText:"#emiDisabledText",emiDisabledWhy:"#emiDisabledWhy",newEMI:"#newEmiCard"};return{addEMIMenuSelectionAttributes:g,removeEMIMenuSelectionAttributes:c,disableEMIPaymentMethods:function(a){a.prop("disabled",!0);a.is(":checked")&&(a.prop("checked",
!1),f(k.newEMI).find(".payment-selected").removeClass("payment-selected"));a.parent().siblings().addClass("a-color-secondary");f(k.selectedEMIMenuSection).hide();f(k.emiDisabledText).show();f(k.emiDisabledWhy).show()},enableEMIPaymentMethods:function(a){a.prop("disabled",!1);a.parent().siblings().removeClass("a-color-secondary");a.is(":checked")&&f(k.selectedEMIMenuSection).show();f(k.emiDisabledText).hide();f(k.emiDisabledWhy).hide()},isEMIPaymentInstrument:function(a){return l.isEMIPaymentInstrument(a)},
getEMIMenuSelectedCardSection:function(){return l.getEMIMenuSelectedCardSection()},showPaymentOptionBlock:d,toggleEMIMenu:function(a){var e=f(k.newEMI).find("#emiPaymentMethodsSelectList").find("option:selected").val(),n;a.find("#emiPaymentMethodsSelectList").length?(a.find("#emiMenuErrors_VCC").length&&a.find("#emiMenuErrors_VCC").hide(),f(k.newEMI).find(".section-emi-payment-method").show(),"SelectOption"===e?f(k.newEMI).find("#selectedSectionEmiPaymentMethod").show():n=d(e),n&&(g(),f(k.newEMI).find("#selectedSectionEmiPaymentMethod").show(),
n.show())):(c(),f(k.newEMI).find("#selectedSectionEmiPaymentMethod").hide())}}});"use strict";q.when("A","pay-common-util").register("instant-bank-discount-helper",function(a,l){var g={instantBankDiscountAmazonPaySelectedText:".instant-bank-discount-apay-selected",instantBankDiscountAmazonPayDeselectedText:".instant-bank-discount-apay-deselected"};return{showInstantBankDiscountAmazonPayDeselected:function(){var a=l.getElements(g);a.instantBankDiscountAmazonPaySelectedText.addClass("aok-hidden");a.instantBankDiscountAmazonPayDeselectedText.removeClass("aok-hidden")},
showInstantBankDiscountAmazonPaySelected:function(){var a=l.getElements(g);a.instantBankDiscountAmazonPayDeselectedText.addClass("aok-hidden");a.instantBankDiscountAmazonPaySelectedText.removeClass("aok-hidden")}}});"use strict";q.when("A","page-detector","checkout-general-utils").register("pay-common-lib",function(a,l,g){function c(a,b){b.attr("name")&&(a[b.attr("name")]=b.val());b.attr("id")&&(a[b.attr("id")]=b.val())}function d(a,b){if(!b)return a;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);
return a}function f(a,b,c){k.each(b,function(b,d){a[b]=c?c.find(d):k(d)})}var k=a.$,h="checkbox hidden password radio text number tel month".split(" "),e={};a.declarative("move-to-next-field",["keypress"],function(a){13===a.$event.charCode&&(g.moveToNextInput(a.$declarativeParent),a.$event.preventDefault())});a.declarative("scroll-to-input",["keypress"],function(a){13===a.$event.charCode&&(k(p).scrollTop(a.$declarativeParent.offset().top),a.$event.preventDefault())});return{getAttributeData:function(a,
b){if(a)return a.attr(b)||a.attr("data-"+b)||a.data(b)},getElements:function(a,b){var c={};f(c,a,b);return c},getInputValues:function(a){var b=a.find(".data-row").data()||{};a.find("input").each(function(){var a=k(this),d=a.attr("type");("radio"!==d&&"checkbox"!==d||a.is(":checked"))&&-1<k.inArray(d,h)&&c(b,a)});a.find("select").each(function(){c(b,k(this))});return b},isDesktopCX:l.isDesktopPayment,isMobileCX:l.isMobilePayment,isPayPage:l.isPayment,isTouchCX:l.isTabletPayment,mergeFrom:function(a,
b){b=d({},b);return d(b,a)},prop:function(a,b,c){if(a){if(1<arguments.length)return b===F?delete e[a]:e[a]={isOneTime:c?1:0,value:b},b;var d=e[a];if(d)return d.isOneTime&&delete e[a],d.value}},refreshElements:f,scrollTopTo:function(a){a&&a.length&&k("html,body").animate({scrollTop:a.offset().top-20},"fast")},selectDefaultPaymentMethodIfNotSelected:function(){var a=k("#existing-payment-methods .payment-row").find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),b=a.closest("div.payment-selected");
b&&0<b.length||(a=a.closest("div.default-payment-marker"))&&a.length&&(a.addClass("payment-selected"),a.find("[name\x3dpaymentMethod]").attr("checked",!0))},processSubmissionParameters:function(a){for(var b={},c=0;c<a.length;c++)b[a[c].name]=a[c].value;return b}}});"use strict";q.when("A","pay-common-lib","a-popover-base","ajax-utility","loading-spinner-controller","page-conductor","page-transition-controller").register("pay-desktop-util",function(a,l,g,c,d,f,k){function h(a){a.$event.preventDefault();
a.$target.closest(".a-popover").hide();a.$target.siblings("span.error-message").hide()}function e(a){a.preventDefault();var b=t(a.currentTarget),c=b.closest("div.expando-section");a=c.find("div.expando-content");var c=c.find("div.expando-reverse-content"),d=a.is(":visible"),e=function(){var a=b.find("i");a.hasClass("a-icon-collapse")||a.hasClass("a-icon-expand")?d?(a.removeClass("a-icon-collapse").addClass("a-icon-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):
(a.removeClass("a-icon-expand").addClass("a-icon-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show()):d?(a.removeClass("a-icon-section-collapse").addClass("a-icon-section-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):(a.removeClass("a-icon-section-expand").addClass("a-icon-section-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show())};d?(c.slideDown("fast"),
a.slideUp("fast",e)):(c.slideUp("fast"),a.slideDown("fast",e))}function n(a){var b=a.$target.closest("a");a=b.closest("div.extender-section");b=b.find("i");b.hasClass("a-icon-extender-expand")?(a.find(".collapsed").hide(),a.find(".expanded").slideDown("fast"),b.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse")):(a.find(".collapsed").show(),a.find(".expanded").slideUp("fast"),b.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"))}function b(a){I.msgPopovers.filter(":visible").hide();
a.$event.preventDefault();a.$event.stopPropagation();a=a.$target.parent().find(".a-popover");a.is(":visible")||a.show()}function m(a,b,c){var d=a||{},e="string"===typeof a;c=c&&c.useSif?t('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0;e?(d+="\x26ajaxResponse\x3d1\x26returnjson\x3d1",c&&(d+="\x26isAmazonApp\x3d1")):(d.ajaxResponse=1,d.returnjson=1,c&&(d.isAmazonApp=1));for(c=0;c<E.length;c++){var f=E[c],h=t("input[name\x3d"+f+"]").val();e?-1===b.search(f)&&-1===a.search(f)&&(d=d+"\x26"+
f+"\x3d"+h):d[f]=h}return d}function v(a,b){if(0>a)return 0;isNaN(b)||(a=Number(a).toFixed(b));a=a.toString();b=0<=a.lastIndexOf(".")?a.lastIndexOf("."):a.length;return 3>=b?a:v(a.substring(0,b-3),0)+","+a.substring(b-3)}function u(a,b,c,d){a="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a.status?"pay-ajax-500":"pay-ajax-error";if(c){a=c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+a):
c+("\x26ref\x3d"+a);I.pageContainer.find("#tempForm").remove();c=t('\x3cform id\x3d"#tempForm" method\x3d"post"\x3e\x3c/form\x3e');c.attr("action",a);if("string"===typeof d){a={};b=d.split("\x26");for(var e=0;e<b.length;e++){var f=b[e].split("\x3d");2===f.length&&(a[f[0]]=f[1])}}else a=d;for(var h in a)"ajaxResponse"!==h&&"returnjson"!==h&&(a=t('\x3cinput type\x3d"hidden"/\x3e').attr("name",h).val(d[h]),c.append(a));I.pageContainer.append(c);c.submit()}}function z(a,b,d,e){var h=f.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),
h={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:m(b,a,e),dataType:"text",headers:h,timeout:y,type:"POST",url:a,beforeSend:function(a,b){d&&d.beforeHandler&&d.beforeHandler(a,b)},complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b)},error:function(c,e){d&&d.errorHandler?d.errorHandler(c,e):u(c,e,a,b)},success:function(a,b,e){var h=e.getResponseHeader("x-amz-checkout-page");if("payselect"!==h&&"spp-payment"!==h)return a=c.jsonify(a),f.redirect(a);d&&d.successHandler?
d.successHandler(a,b,e):f.ajaxUpdatePage(a,b,e)}};t.extend(h,e);p.push(t.ajax(h))}function w(a,b,c,d){var e=f.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),e={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:m(b,a,d),dataType:"text",headers:e,timeout:y,type:"POST",url:a,error:function(d,e){c&&c.errorHandler?c.errorHandler(d,e):u(d,e,a,b)},success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-page");"payselect"!==e&&"spp-payment"!==e&&c&&c.pageUpdater?
c.pageUpdater(a):f.ajaxUpdatePage(a,b,d)}};t.extend(e,d);p.push(t.ajax(e))}function B(){y=parseInt(t("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10);y=isNaN(y)?1E4:y;l.isMobileCX()?H&&(H=!1):(I=l.getElements(q),H&&(a.declarative("close-popover",["click"],h),a.declarative("toggle-msg-popover",["click"],b),a.declarative("a-extender-toggle",["click"],n),H=!1),I.pageContainer.undelegate(".expando-link","click").delegate(".expando-link","click",e),I.pageContainer.find("form select.a-touch-select-input").unbind("change",
r).bind("change",r),t(".a-dropdown-container").each(function(){g.remove(t(this).find("select").attr("name"))}),t(document).bind("click",function(a){a.isPropagationStopped()||0===t(a.target).closest(".pay-popover-msg").length&&I.msgPopovers.filter(":visible").hide()}))}function r(a){var b=t(a.currentTarget);a=b.siblings("a.a-placeholder");b=b.find(":selected").text();a.html(b);return!1}var t=a.$,H=!0,y,p=[],E=["forceResponsive","fromAnywhere","hasWorkingJavascript"],I={},q={msgPopovers:"div.pay-popover-msg",
pageContainer:"div.a-container"};a.on("checkout:reload:payselect",B);a.on("checkout:reload:spp-payment",B);return l.mergeFrom({decodeJSONResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:I,getNumberWithSeparators:v,handleForm:function(a,b,c){a.$event.preventDefault();
var d=a.$declarativeParent;d.is("span")&&(d=d.find("form"));d=d.serializeArray();d=l.processSubmissionParameters(d);z(a.data.action,d,b,c)},makeAjaxCall:z,handleAjaxError:u,handlePaymentsPortalForm:function(a,b,c,d){a=l.processSubmissionParameters(a.submissionParameters);z(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,c,d){a=l.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;w(b,a,c,d)}},l)});"use strict";q.when("A","pay-common-lib","page-transition-controller").register("pay-mobile-util",
function(a,l,g){function c(a,b,c){a=a||{};var d=z.fromAnywhereField.val(),e=c&&c.useSif?m('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0,f=k();"string"===typeof a?(a=a+"\x26ajaxResponse\x3d1\x26currentPage\x3d"+f,-1===b.search("fromAnywhere")&&-1===a.search("fromAnywhere")&&(a=a+"\x26fromAnywhere\x3d"+d),e&&(a+="\x26isAmazonApp\x3d1")):(a.ajaxResponse=1,a.currentPage=f,-1===b.search("fromAnywhere")&&(a.fromAnywhere=d),e&&(a.isAmazonApp=1),c&&c.isAddCardAndContinueEnabled&&(a.isHideSpinnerDisabled=
!0));return a}function d(){v&&v.abort("abort-for-cleanup");v=null}function f(a,b,c,d){a=a&&a.status;b="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a?"pay-ajax-500":"unknown"===a?"pay-unknown-page":"pay-ajax-error";c&&(c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+b):c+("\x26ref\x3d"+b),n(c,d))}function k(){var a;m.each(u,function(b,c){if(c.pageId&&m(c.pageId).is(":visible"))return a=
b,!1});return a}function h(a){(a=u[a]&&u[a].componentId)&&q.when(a).execute(function(a){a.init&&a.init()})}function e(a,b,d,e,n){n&&n.suppressSpinner||g.show();n={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:c(b,a,e),dataType:"text",timeout:r,type:"POST",url:a,beforeSend:function(a,b){d&&d.beforeHandler&&d.beforeHandler(a,b)},complete:function(a,c){d&&d.completeHandler&&d.completeHandler(a,c);b&&b.isHideSpinnerDisabled||g.hide()},error:function(c,e){d&&d.errorHandler?d.errorHandler(c,
e):f(c,e,a,b)},success:function(c,e,g){var n=g.getResponseHeader("x-amz-checkout-pay-page-name");if(n){var k=g.getResponseHeader("x-amz-checkout-pay-page-title");k&&z.pageTitle.text(decodeURIComponent(k));d&&d.successHandler?d.successHandler(c,e,g):z.pageContainer.html(c);h(n)}else f(null,"unknown",a,b)}};m.extend(n,e);v=m.ajax(n)}function n(a,b,c){var d=m("#tempForm",z.pageContainer);0<d.length&&d.remove();d=m('\x3cform method\x3d"post"\x3e\x3c/form\x3e');d.attr("action",a);c&&c.target&&d.attr("target",
c.target);if("string"===typeof b)for(a=b.split("\x26"),b=0;b<a.length;b++)c=a[b].split("\x3d"),2===c.length&&"ajaxResponse"!==c[0]&&(c=m('\x3cinput type\x3d"hidden"/\x3e').attr("name",c[0]).val(c[1]),d.append(c));else for(var e in b)"ajaxResponse"!==e&&d.append(m('\x3cinput type\x3d"hidden"/\x3e').attr("name",e).val(b[e]));z.pageContainer.append(d);d.submit()}function b(a,b,d,e,n){n&&n.suppressSpinner||g.show();n={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:c(b,a,e),dataType:"text",
timeout:r,type:"POST",url:a,complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b);g.hide()},error:function(c,e){d&&d.errorHandler?d.errorHandler(c,e):f(c,e,a,b)},success:function(a,b,c){var e=c.getResponseHeader("x-amz-checkout-pay-page-name");if(!e&&d&&d.pageUpdater)d.pageUpdater(a);else{var f=c.getResponseHeader("x-amz-checkout-pay-page-title");f&&z.pageTitle.text(decodeURIComponent(f));d&&d.successHandler?d.successHandler(a,b,c):z.pageContainer.html(a);h(e)}}};m.extend(n,e);v=m.ajax(n)}
var m=a.$,v=null,u={main:{componentId:"page-main",pageId:"#select-payments-view"},"credit-card-rewards":{componentId:"page-rewards",pageId:"#select-payment-rewards-view"},"financial-offer":{componentId:"page-financial-offer",pageId:"#select-payment-financial-offer-view"},"new-payment-methods":{pageId:"#new-payments-view"},"gil-estimates":{pageId:"#gil-estimates-subpage"}},z={},w={cvvHelper:"div#cvv-help-popover",fromAnywhereField:"input[name\x3dfromAnywhere]",jppoints:"div#jppoints",pageContainer:"div#page-container",
pageTitle:"head title"},B=!0,r;return l.mergeFrom({decodeJSonResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:z,getCurrentPage:function(){return z.pageContainer.children("div.page").filter(":visible")},getCurrentPageName:k,getPageId:function(a){a=
a.getResponseHeader("x-amz-checkout-pay-page-name");return u[a]&&u[a].pageId},handleForm:function(a,b,c){a.$event.preventDefault();e(a.data.action,a.$target.serialize(),{successHandler:function(a,c,d){b(a,c,d)}},c)},submitFormRequest:n,init:function(){l.isMobileCX()&&(p.onbeforeunload=d,l.refreshElements(z,w),r=parseInt(m("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10),r=isNaN(r)?1E4:r,B&&(B=!1,m("div.pay-mobile").bind("keypress",function(a){l.prop("activeGoElement",13===a.keyCode?
document.activeElement:null,!0)})))},makeAjaxCall:e,handleAjaxError:f,pages:u,handlePaymentsPortalForm:function(a,b,c,d){a=l.processSubmissionParameters(a.submissionParameters);e(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,c,d,e){a=l.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;b(c,a,d,e)}},l)});"use strict";q.when("page-detector","pay-desktop-util","pay-mobile-util").register("pay-common-util",function(a,l,g){return a.isMobile()?g:l});"use strict";
q.when("A","pay-common-util","pay-rewards-currency","checkout-federation-wrapper","safe-apx-helper","weblab-helper").register("pay-validator",function(a,l,g,c,d,f){function k(){function a(b,c,d,e){X.push({identifier:b,priority:d||100,target:c,isPincodeError:e})}function k(a){if(!a)return null;var b=new RegExp(String.fromCharCode(32),"g"),c=new RegExp(String.fromCharCode(45),"g");return a.replace(b,"").replace(c,"")}function v(){return 0<X.length}function u(a){if(!a||0===a.length)return!1;for(var b=
0,c=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);c&&(e*=2,9<e&&(e-=9));b+=parseInt(e,10);c=!c}return 0===b%10}function z(a,b){return a&&a.match(/^[0-9]+$/)&&a.length===b}function w(a,b,c){return a&&a.match(/^[0-9A-Za-z]+$/)&&a.length>=b&&a.length<=c}function B(a,b){if(!a||!b)return!1;a=parseInt(a,10);b=parseInt(b,10);return r(a,b)}function r(a,b){var c=new Date,d=c.getFullYear();return b>d||b===d&&a>=c.getMonth()+1}function t(a){a=a.val();return!a||0===a.length}function p(){var c=h("#pm_pay_by_check").is(":checked"),
d=h("#existing-balance [paymentmethodid\x3d'availablebalance'] input").is(":checked");c&&d&&a("continue_BadCombinationCheckExistingBalance")}function y(c){if(h("#jppoints").length){var d,e=!1;1===c.length&&"jppoints"===c.attr("id")?(d=c,e=!0):d=c.filter("#jppoints");if(d&&d.find("#redeemPoints").is(":checked")){c=d.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val();c=parseInt(c,10);h('input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]').is(":checked")&&(c-=parseInt(d.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),
10));var f=parseInt(d.find("#redeemableAmount").text(),10),g=d.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');d.find("#jpPointsMax").is(":checked")?d=f:(d=parseInt(g.val(),10))||(d=0);d>f?a("continue_jpPointsExceedsRedeemableAmount",g):e&&d<c?a("continue_notEnoughJPPoints"):d>c&&a("continue_jpPointsExceedsTotalPurchase")}}}function G(c){c&&(c=c.find(".pci-blocking-cvv"),c.length&&c.is(":visible")&&a("PCI_Block_CVV"))}function E(c){var d=c.find(".currency-list");d.length&&d.is(":visible")&&
(c=d.find("[type\x3dradio]:checked").val(),d=d.find("#cardCurrencyDropDown option:selected").val(),c&&("Other"!==c||"-1"!==d&&"-2"!==d)||a("continue_SelectCardCurrency"))}function I(c){var d=c.find("#existingCvvNum");if(0!==d.length){var f=d.val();c=e?c.data("validcvvlength"):c.attr("validcvvlength");z(f,parseInt(c,10))||a("continue_BadSecurityCode",d)}}function da(c){var d=c.find('input[name\x3d"paymentMethod"]').val();/^creditCard/.test(d)&&c.find("#savedCardSuppressed").length&&a("continue_BankTemporarilyNotAvailable")}
function W(c){c=c.find("#existingPincodeNum");if(0!==c.length){var d=c.val();d?w(d,4,8)||a("existingCreditCard_PincodeInvalid",c,null,!l.isMobileCX()):a("continue_EmptyPincode",c)}}function P(c){if(c&&c.length)for(var d=0;d<c.length;d++){var e=h(c[d]);G(e.parent());I(e);W(e);"netBanking"===e.find('input[name\x3d"paymentMethod"]').val()&&(h("#netBanking_select").val(),h("#net-banking-list").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable"));da(e);var f=e;f.find('input[name\x3d"paymentMethod"]').val();
f.find("#vdcBanksSelect").val();h("#vdcBanksSelect").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable");aa(e);e=e.siblings("#upi-acceptance-input").find("#vpaCollect");if(!e||e.length)(f=e.val())&&f.match(/.+@.+/)||a("continue_BadVpaForUpi",e)}}function D(c){var d=c.find("#newMonth"),e=c.find("#newYear");c=c.find("#newExpDate");!(d=d.length&&!B(d.val(),e.val()))&&(d=c.length)&&((c=c.val())?(d=c.split("-"),c=parseInt(d[0],10),d=parseInt(d[1],10),c=r(d,c)):c=!1,d=
!c);d&&a("continue_BadExpiration")}function N(c){"domesticCards"===c.find('input[name\x3d"paymentMethod"]').val()&&((c=c.find("select").val())&&c.match(/^[0-9]*$/)||a("continue_BlankSlate"))}function U(c){var d=h("#existing-balance input[name\x3duseFlexiblePayments]").is(":checked");c=l.getAttributeData(c,"paymentmethodtype");d&&"creditCard"!==c&&a("continue_FlexiblePaymentsNeedsCreditCard")}function x(c){"thirdPartyAccounts"===c.find('input[name\x3d"paymentMethod"]').val()&&((c=c.find("select").val())&&
0!==c.length||a("continue_BlankSlate"))}function L(c){var d=c.find(".rewards-list");if(d.length&&d.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")){c=d.find("input.custom-rewards-input");var e=c.val();if(d.hasClass("show-currency-input-widget-new")){var d=c.data("country-code"),f=g.getCurrencyFormatByCountryCode(d),d=c.data("min"),e=g.getAmount(e,f.decimalPlace);e<d&&a("continue_BadRewardsMin")}else/^\s*$/.test(e)||isNaN(e)?a("continue_BadRewardsValue"):(e=parseFloat(c.val()),
d=c.data("min"),0>=e||e<d?a("continue_BadRewardsMin"):e>c.data().max&&a("continue_BadRewardsMax"))}}function O(c){var d=c.find('input[name\x3d"paymentMethod"]').val();"verifiedCreditCard"===d?a("continue_BlankSlate"):"verifiedDebitCard"===d&&(d=c.find("#vdcBanksSelect").val(),(""===d||"OtherBanks"===d||"1"===h("#save_citi_card").val()&&"CIT"===d)&&a("continue_BlankSlate"),c.find("option:selected").prop("disabled")&&a("continue_BankTemporarilyNotAvailable"))}function V(c){"cashOnDeliveryCash"===c.find('input[name\x3d"paymentMethod"]').val()&&
c.find(".phonenumberNotVerified").length&&a("continue_OTPforCOD")}function ba(c){if("netBanking"===c.find('input[name\x3d"paymentMethod"]').val()){var d=c.find("#net-banking-select-list").val();c=c.find("option:selected").prop("disabled");""===d&&a("continue_BlankSlate");c&&a("continue_BankTemporarilyNotAvailable")}}function fa(c){"morePaymentMethod"===c.find('input[name\x3d"paymentMethod"]').val()&&""===c.find("#more-payment-methods-select-list").val()&&a("continue_BlankSlate")}function aa(c){var d=
c.find('input[name\x3d"paymentMethod"]').val();if("StandaloneInstallment"===d||"StandaloneCreditCardInstallment"===d||"StandaloneReusableCreditLineInstallment"===d)c.find('input[name\x3d"gilShowContinueBlocker"]').val()&&("StandaloneCreditCardInstallment"===d?a("continue_GilCCContinueError"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueError"):a("continue_GilContinueError")),c.find('input[name\x3d"showIneligibleItemSubpage"]').val()&&("StandaloneCreditCardInstallment"===
d?a("continue_GilCCContinueErrorIneligibleItems"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueErrorIneligibleItems"):a("continue_GilContinueErrorIneligibleItems")),c.find('input[name\x3d"gilShowContinueBlockerIfPromotions"]').val()&&0<h("#existing-balance input[name\x3duseAvailableBalance]:checked").length&&("StandaloneCreditCardInstallment"===d?a("continue_GilCCContinueErrorPromotions"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueErrorPromotions"):
a("continue_GilContinueErrorPromotions"))}var X=[],ea=null,A=null,Y=function(a){n=a};n||(l.isMobileCX()?q.when("rewards-section-mobile").execute(Y):q.when("rewards-section-desktop").execute(Y));return{displayErrors:function(a,b){(ea=a)&&ea.hide().find(".error-message").hide().addClass("hidden");(A=b)&&A.find(".a-form-error").removeClass("a-form-error");if(v()){for(a=0;a<X.length;a++){b=X[a];if(b.target){var c=b.target.parent();c.hasClass("a-input-text-wrapper")&&!c.hasClass("a-form-error")?c.addClass("a-form-error"):
b.target.hasClass("a-form-error")||b.target.addClass("a-form-error")}b=b.identifier;(ea&&ea.length?ea.find("#"+b):h("#"+b)).show().removeClass("hidden")}ea&&ea.length&&ea.show()}},getHighestErrorId:function(){for(var a={priority:100},b=0;b<X.length;b++){var c=X[b],d;(d=c.identifier)?(d=ea&&ea.length?ea.find("#"+d):h("#"+d),d=parseInt(l.getAttributeData(d,"priority"),10),d=isNaN(d)?100:d):d=100;d<=a.priority&&(a={identifier:c.identifier,priority:d,isPincodeError:c.isPincodeError,target:c.target})}return a},
hasErrors:v,isValidCardCVV:z,isValidCardPincode:w,validateBankAccountNum:function(c,d){t(c)&&a("addBankAccount_NoAccountNumber",d)},validateBankAccountNumConfirm:function(c,d,e){c.val()!==d.val()&&a("addBankAccount_AccountNumberMismatch",e)},validateBankDriverLicense:function(c,d){t(c)&&a("addBankAccount_NoDLNumber",d)},validateBankDriverLicenseState:function(c,d){c.val()!==F&&""!==c.val()&&"0"!==c.val()||a("addBankAccount_NoDLState",d)},validateBankHolderName:function(c,d){t(c)&&a("addBankAccount_NoName",
d)},validateBankRoutingNum:function(c,d){9!==c.val().length&&a("addBankAccount_ShortRoutingNumber",d)},validateCreditCardCVV2:function(c,d,e){e="true"===c.attr("isaddresschallenge")?c.attr("issuer"):e&&e.charAt(0);"R"!==e&&(c=c.val(),z(c,"A"===e?4:3)||a("addCreditCard_BadSecurityCode",d))},validateCreditCardDate:function(c,d,e,f){B(c.val(),e.val())||(a("addCreditCard_BadExpiration",d),a("addCreditCard_BadExpiration",f))},validateCreditCardMobile:function(c,d){c=c.val();f.isUpdateMobileNumberEnabled()?
c&&c.replace(/[^0-9]/g,"").match(/^1[0-9]{10}$/)||a("addCreditCard_BadMobileNumber",d):c&&c.replace(/[^0-9]/g,"").match(/^1[34578]{1}[0-9]{9}$/)||a("addCreditCard_BadMobileNumber",d)},validateCreditCardPincode:function(c,d){(c=c.val())&&c.match(/^[a-zA-Z0-9]{4,8}$/)||a("addCreditCard_BadPincode",d)},validateCreditCardName:function(c,d){t(c)&&a("addCreditCard_NoName",d)},validateCreditCardNumber:function(c,d){var e=k(c.val());e&&10<e.length&&u(e)||a("addCreditCard_BadNumber",d);e=h("#creditCardIssuersBlocked").val();
c=c.data("issuer");e&&""!==e&&c&&""!==c&&-1<h.inArray(c,e.split(","))&&a("addCreditCard_IssuerUnsupported",d)},validateSBIMaestroCardNumberLength:function(c,d){19!==k(c.val()).length&&a("addCreditCard_SBIMaestro_BadNumberLength",d)},isAMEXCreditCard:function(a){a=k(a.val());return null!==a?0===a.indexOf("37")||0===a.indexOf("34"):!1},validateCreditCardTail:function(c,d){var f=k(c.val());f&&10<f.length&&u(f)?(c=(l.isMobileCX()&&e?c.parent().data():c.data()).tail+"",f.substr(f.length-c.length)!==c&&
a("addCreditCard_NotMatch",d)):a("addCreditCard_NotMatch",d)},validateCreditCardType:function(c,d){c.is(":visible")&&((c=c.val())&&c.match(/^[A-Z][0-9]*$/)||a("addCreditCard_NoType",d))},validateRegistrationResult:function(c){c.cardStatus?1===c.checkStatusCount&&a("addCreditCard_RegisterFailed"):0<c.errors.length&&a("addCreditCard_RegisterFailed")},validateDirectDebitAccountName:function(c,d){t(c)&&a("addDirectDebit_NoAccountOwnerName",d)},validateDirectDebitAccountNum:function(c,d){t(c)&&a("addDirectDebit_NoAccountNumber",
d)},validateDirectDebitRoutingNum:function(c,d){t(c)&&a("addDirectDebit_NoRoutingNumber",d)},validateInvoiceFirstName:function(c,d){t(c)&&a("addInvoiceAccount_NoFirstName",d)},validateInvoiceLastName:function(c,d){t(c)&&a("addInvoiceAccount_NoLastName",d)},validateLocName:function(c,d){t(c)&&a("addLoc_NoName",d)},validateLocNumber:function(c,d){t(c)&&a("addLoc_BadNumber",d)},validateNewGiftPromotion:function(c,d){t(c)&&a("addGiftCardOrPromo_NoCode",d)},validatePayment:function(d){if(l.isMobileCX())P(d),
n&&c.wrap(function(){n.validatePaymentRewardsInRewardsSection(a)},"shopwithpointsmobile");else if(p(),d&&d.length){for(var e=0;e<d.length;e++){var f=h(d[e]);"true"===l.getAttributeData(f,"isaddresschallenge")&&a("continue_AddressChallenge");"true"===l.getAttributeData(f,"isverifiedfail")&&a("continue_VerifiedFail");"true"===l.getAttributeData(f,"iscupcardexpired")&&a("continue_CUPExpired");G(f);E(f);I(f);W(f);D(f);N(f);U(f);x(f);L(f);O(f);ba(f);fa(f);aa(f);V(f);da(f)}n&&c.wrap(function(){n.validatePaymentRewardsInRewardsSection(a)},
"shopwithpoints");y(d)}else a("continue_BlankSlate")},validateGetCreditCardTypeResult:function(c){if(c.errors&&0<c.errors.length)for(var d=0;d<c.errors.length;d++)a(c.errors[d])},validateEMIMenuForContinueButton:function(c){var d=c.find("#emiPaymentMethodsSelectList").find("option:selected").val();if("CreditCard"===d||"SelectOption"===d)a("continue_BlankSlate");else if(d=d.split("."),1<d.length){var e=d[0];if("emiCreditCard"===e||"netbankingEMI"===e)c=c.find("."+d[1]),c=c.find(".emiMenuTenuresDropDown"),
c.length&&!c.find("option:selected").val()&&a("continue_BlankSlate")}},apxValidatePayment:function(a,b){var c=d.get("payselect");c&&c.validatePayments(this,b,a)},addError:a,errors:X,validatePCICVVBlock:G}}var h=a.$,e=p.P&&p.P.AUI_BUILD_DATE,n=F;return{create:function(){return new k}}});"use strict";q.when("A","ajax-utility","pay-common-util","pay-validator").register("pay-credit-card",function(a,l,g,c){function d(a,c,b,d){a&&a.length&&(c=b+"-"+c,(b=g.prop(c))&&(a=a.find(d).val(b))&&a.length&&(g.isMobileCX()?
a.closest(".card-cvv-field").hide().data("isHidden",1):a.closest(".a-column").hide(),g.prop(c,F)))}var f=a.$,k={cc:!1,vcc:!1,vdc:!1},h=p.P&&p.P.AUI_BUILD_DATE;return{confirmCreditCard:function(a,c,b){a.currentPaymentInstrumentID=a.paymentmethodid;a.recommendedPaymentMethodId=a.paymentmethodid;if(a.newMonth&&a.newYear)a.month=a.newMonth,a.year=a.newYear;else if(a.newExpDate){var d=a.newExpDate.split("-");a.year=parseInt(d[0],10);a.month=parseInt(d[1],10)}else a.expmonth&&a.expyear&&(a.month=a.expmonth,
a.year=a.expyear);(d="existingCvvNum"in a?a.addCreditCardVerificationNumber=a.existingCvvNum:a.addCreditCardVerificationNumber)&&g.prop("cvv-"+a.paymentmethodid,d);(d="existingPincodeNum"in a?a.addCreditCardPincode=a.existingPincodeNum:a.addCreditCardPincode)&&g.prop("pincode-"+a.paymentmethodid,d);g.makeAjaxCall(b,a,{successHandler:c,errorHandler:function(b,c){a.handler="confirm-credit-card";g.handleAjaxError(b,c,"/gp/buy/payselect/handlers/submit.html",a)}},{useSif:!0})},handleCreditCardType:function(a,
d){var b=a.$target,f=a.data.type,h=c.create();a.$currentTarget.data("issuer","");h.validateCreditCardNumber(b,b);h.hasErrors()||(k[f]=!0,g.makeAjaxCall(a.data.url,{addCreditCardNumber:b.val(),returnjson:1},{completeHandler:function(){k[f]=!1},successHandler:function(b){b=l.jsonify(b);d(b,f);a.$currentTarget.data("issuer",b.issuer)}},{useSif:!0},{suppressSpinner:!0}))},isWaitingForType:function(a){return k[a]},runConfirmCardValidator:function(a,d){var b=a.find("#existingCvvNum"),b=b.length?b:a.find("#addCreditCardVerificationNumber"),
f=a.find("#addCreditCardNumber"),h=a.find("#newMonth"),g=a.find("#newYear"),k=c.create();k.validateCreditCardTail(f,f);h.length&&g.length&&k.validateCreditCardDate(h,h.closest(".card-date").find(".a-button"),g,g.closest(".card-date").find(".a-button"));b.length&&(f=(f=a.find("#issuer"))&&f.val(),k.validateCreditCardCVV2(b,b,f));k.displayErrors(d,a);return k.hasErrors()},setDateSelectorStatus:function(a,c){var b=c.find(".card-date").find("select");b&&b.length&&q.when("a-dropdown").execute(function(c){b.each(function(){var b=
f(this).attr("id");c.updateSelect(b,{status:"21"===a.brand&&"G"===a.issuer?"disabled":"enabled"})})})},setNewCardCVVInputStatus:function(a){(g.prop("cvv-newcard")||g.prop("pincode-newcard"))&&a.each(function(){var a=f(this);if("1"===(h?a.data("isnewcard")+"":a.attr("isnewcard")))return d(a,"newcard","cvv","#existingCvvNum"),d(a,"newcard","pincode","#existingPincodeNum"),!1})},setCardPasswordInputStatus:d}});"use strict";q.when("A","ajax-utility","pay-common-util","pay-validator","page-transition-controller",
"page-conductor","pay-credit-card").register("pay-credit-card-reregistration",function(a,l,g,c,d,f,k){function h(a,d){var e=c.create(),f=n("#cupMobileNumber-"+a),h=n("#cupSecurityCode-"+a),g=n("#reRegisterCCErrors-"+a);a=n("#reRegisterCCInputs-"+a);e.validateCreditCardCVV2(h,h,d);e.validateCreditCardMobile(f,f);e.displayErrors(g,a);return e.hasErrors()}function e(a,c,d){f.ajaxUpdatePage(a,c,d)}var n=a.$;return{actionReregisterCardInBox:function(a){a.$event.preventDefault();d.show();var c=a.data.type,
f=n("#cupMobileNumber-"+a.data.paymentMethodID).val(),u=n("#cupSecurityCode-"+a.data.paymentMethodID).val();h(a.data.paymentMethodID,c)?d.hide():(c={isReregistering:a.data.isReregistering,currentPaymentInstrumentID:a.data.paymentMethodID,name:a.data.holderName,year:a.data.expiredYear,month:a.data.expiredMonth,addCreditCardMobileNumber:f,addCreditCardVerificationNumber:u},f={useSif:g.isMobileCX()?!0:!1,success:function(a,c,b){a=l.jsonify(a);c=n("#reRegisterCCErrors-"+a.paymentInstrumentId);k.waitForCreditCardStatus(a,
e,c)}},a.$event.preventDefault(),g.makeAjaxCall(a.data.url,c,null,f))}}});"use strict";q.when("A","client-side-metrics","ajax-utility","pay-common-util","pay-validator","existing-payments","page-conductor","checkout-modal-popover","page-transition-controller","pay-credit-card","pay-gil","new-verified-debit-card","emi-helper").register("new-payments",function(a,l,g,c,d,f,k,h,e,n,b,m,v){function u(a){a.$event.preventDefault();var b=a.data.type;if(n.isWaitingForType(b))e.show(),setTimeout(function(){u(a)},
50);else{var d;d="vdc"===b?S.newVDC:"emi"===b?S.newEMI:S.newVCC;if(ka(d,b))e.hide();else{e.show();var f=c.getInputValues(d),h="vdc"===b?"_VDC":"_VCC";d=f["addCreditCardVerificationNumber"+h];var g=f["addCreditCardPincode"+h],b={addCreditCardNumber:f["addCreditCardNumber"+h],addCreditCardVerificationNumber:d,addCreditCardPincode:g,handler:f["handler"+h],month:f["month"+h],name:f["name"+h],newPaymentType:b,year:f["year"+h],cctype:f["cctype"+h],isSBIInternationalMaestroSelected:f["isSBIInternationalMaestroSelected"+
h],isCardSavedFromEMIMenu:f["isCardSavedFromEMIMenu"+h]};c.prop("cvv-newcard",d);g&&c.prop("pincode-newcard",g);c.makeAjaxCall(a.data.url,b,{successHandler:function(a,c,b){I(a,c,b);n.setNewCardCVVInputStatus(S.paymentRows)}},{useSif:!0})}}}function z(a){a.$event.preventDefault();var b=a.data.type;if(n.isWaitingForType(b))e.show(),setTimeout(function(){z(a)},50);else{var d=S.newCCFormContent;if(ka(d,b))e.hide();else{e.show();b=c.getInputValues(d);b.handler=b.handler_addCCInBox;var d=a.data.url,f={};
R("#cupSecurityCode").is(":visible")&&R("#cupMobileNumber").is(":visible")?(d="/gp/buy/payselect/handlers/add-credit-card.html",f={successHandler:function(a){a=g.jsonify(a);W(a)}}):f={successHandler:I};c.makeAjaxCall(d,b,f,{useSif:!0})}}}function w(a){a.$event.preventDefault();var b=R("#new-giftcard-promotion"),b=c.getInputValues(b);R("input[name\x3disUnifiedActionsDesignEnabled]").length&&B(a)||(b.handler=b.handler_addGCInBox,a=a.data.url,e.show(),c.makeAjaxCall(a,b,{successHandler:function(a,b,
d){k.ajaxUpdatePage(a,b,d);ta||c.scrollTopTo(R("#existing-balance"))}},{useSif:!0}))}function B(a){a=a.$declarativeParent;var b=R("#gcpromoinput"),c=d.create();c.validateNewGiftPromotion(b,b);c.displayErrors(S.newGCErrors,a);return c.hasErrors()}function r(a){var b=R(a.currentTarget).parents("div.new-payment-line").find(".card-date select");if(b&&b.length){var c=R(a.currentTarget).val();q.when("a-dropdown").execute(function(a){b.each(function(){var b=R(this).attr("id");a.updateSelect(b,{status:"G21"===
c?"disabled":"enabled"})})})}}function t(a){var b=S.newVDC.find(".vdc-form-fields"),c=S.newVDC.find("#vdc-logo-prompt"),d=S.newVDC.find(".top-cell");a?b.show():b.hide();a?c.show():c.hide();a?d.addClass():d.removeClass()}function p(a){var b=R(a.currentTarget).val(),c=S.newVDC.find("#suppressedVerifiedDebitCard").hide(),d=S.newVDC.find(".vdc-selected-bank-prompt").hide();t(!1);var e="1"===S.newVDC.find("#isRupayAsSavedCardEnabled").val()&&"URP"===b;"OtherBanks"===b||"1"===R("#save_citi_card").val()&&
"CIT"===b||e?(t(!0),R.isEmptyObject(m)||m.showExpiryDateAndCvv()):"SMP"!==b||R.isEmptyObject(m)?""!==b&&(b=R(a.currentTarget).find("option:selected").prop("disabled"),a=R(a.currentTarget).find("option:selected").text(),b?c.show().find(".suppressed-card-text").html(a):d.show().find(".bank-name-text").html(a)):(t(!0),m.hideExpiryDateAndCvv())}function y(a,b){if(!R.isEmptyObject(v)&&a)return a(b)}function G(a){y(v.removeEMIMenuSelectionAttributes);S.newEMI.find(".emi-group").hide();a=R(a.currentTarget).find("option:selected").val();
S.newEMI.find("#emiMenuErrors_VCC").length&&S.newEMI.find("#emiMenuErrors_VCC").hide();if(a=y(v.showPaymentOptionBlock,a))y(v.addEMIMenuSelectionAttributes),a.show()}function E(a){n.handleCreditCardType(a,ga)}function I(a,b,d){k.ajaxUpdatePage(a,b,d);ta||c.scrollTopTo(f.getSelectedPayment())}function da(a){a.$event.preventDefault();var b=a.data.type;n.isWaitingForType(b)?(e.show(),setTimeout(function(){da(a)},50)):ka(a.$declarativeParent,b)?e.hide():(ca&&ca.hide(),Q&&Q.hide(),e.show(),R("#cupSecurityCode").is(":visible")&&
R("#cupMobileNumber").is(":visible")?(b=a.$declarativeParent.serializeArray(),b=c.processSubmissionParameters(b),c.makeAjaxCall("/gp/buy/payselect/handlers/add-credit-card.html",b,{successHandler:function(a){a=g.jsonify(a);W(a)}},{useSif:!0})):c.handleForm(a,{successHandler:I},{useSif:!0}))}function W(a){var b={};b.paymentInstrumentId=a.paymentInstrumentId;a.checkStatusCount&&(b.checkStatusCount=a.checkStatusCount);var f={successHandler:function(a){a=g.jsonify(a);var b=d.create();"VERIFIED"===a.cardStatus?
c.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{newPaymentMethodId:a.paymentInstrumentId},{successHandler:I}):"PENDING"===a.cardStatus?(a.checkStatusCount?(a.checkStatusCount=parseInt(a.checkStatusCount,10),isNaN(a.checkStatusCount)&&(a.checkStatusCount=1)):a.checkStatusCount=3,b.validateRegistrationResult(a),1===a.checkStatusCount?(e.hide(),b.displayErrors(S.newCCErrors)):(--a.checkStatusCount,W(a))):(b.validateRegistrationResult(a),e.hide(),b.displayErrors(S.newCCErrors))}};setTimeout(function(){c.makeAjaxCall("/gp/buy/payselect/handlers/check-credit-card-status.html",
b,f)},2500)}function P(a){a.$event.preventDefault();var b=a.$declarativeParent,f=b.find("#loc-name"),h=b.find("#loc-number"),g=d.create();g.validateLocName(f,f);g.validateLocNumber(h,h);g.displayErrors(b.find("#error-box-new-loc"),b);g.hasErrors()||(ua&&ua.hide(),e.show(),c.handleForm(a,{successHandler:I}))}function D(a){a.$event.preventDefault();var b=a.$declarativeParent,f=b.find("#gcpromoinput");b.find("#gcpromosuccessblock").hide();var h=d.create();h.validateNewGiftPromotion(f,f);h.displayErrors(S.newGCErrors,
b);h.hasErrors()||(e.show(),c.handleForm(a,{successHandler:function(a,b,d){k.ajaxUpdatePage(a,b,d);ta?S.newGCErrors.is(":visible")&&R("#gc-link-expander").trigger("click"):c.scrollTopTo(R("#existing-balance"))}}))}function F(a){a.$event.preventDefault();R("#ccAddCard").trigger("submit")}function U(a){a.$event.preventDefault();R("#bank-address-popover-submit").trigger("submit")}function x(a){a.$event.preventDefault();R("#direct-debit-popover-submit").trigger("submit")}function L(a){a.$event.preventDefault();
R("#new-loc-popover-submit").trigger("submit")}function O(a){a.$event.preventDefault();R("#new-invoice-popover-submit").trigger("submit")}function V(a){a.$event.preventDefault();R("#brdcAddCard").trigger("submit")}function ba(a){a.$event.preventDefault();var b=a.$declarativeParent,f=d.create(),h=b.find("#bank-name"),g=b.find("#bank-routing-number"),k=b.find("#bank-account-number"),n=b.find("#bank-account-number-confirm"),m=b.find("#bank-dl"),l=b.find("#bank-dl-state");f.validateBankHolderName(h,h);
f.validateBankRoutingNum(g,g);f.validateBankAccountNum(k,k);f.validateBankAccountNumConfirm(k,n,n);f.validateBankDriverLicense(m,m);f.validateBankDriverLicenseState(l,l.parents("div.a-button-dropdown"));f.displayErrors(b.find("#new-bank-error-box"),b);f.hasErrors()||(na&&na.hide(),e.show(),c.handleForm(a,{successHandler:I}))}function fa(a){a.$event.preventDefault();var b=a.$declarativeParent,f=d.create(),h=b.find("#debit-bank-routing-number"),g=b.find("#debit-account-number"),k=b.find("#debit-account-name");
f.validateDirectDebitRoutingNum(h,h);f.validateDirectDebitAccountNum(g,g);f.validateDirectDebitAccountName(k,k);f.displayErrors(b.find("#new-direct-debit-error"),b);f.hasErrors()||(qa&&qa.hide(),e.show(),c.handleForm(a,{successHandler:I}))}function aa(a){a.$event.preventDefault();var b=a.$declarativeParent,f=d.create(),h=b.find("#invoice-first-name"),g=b.find("#invoice-last-name");f.validateInvoiceFirstName(h,h);f.validateInvoiceLastName(g,g);f.displayErrors(b.find("#new-invoice-error-box"),b);f.hasErrors()||
(K&&K.hide(),e.show(),c.handleForm(a,{successHandler:I}))}function X(a){a=R("#order-summary-total");var b=R("#order-summary-container");a.prev().addClass("a-first");b.addClass("a-box-group");a.show();c.isTouchCX()&&b.parent().find(".bottom-order-summary").show();S.newCCFormContent.is(":visible")||R("#wrapper-new-cc").find("a.a-link-expander").trigger("click");R("#ecard-help-link").show()}function ea(a){var b="Unknown";c.isDesktopCX()?b="Desktop":c.isMobileCX()?b="Mobile":c.isTouchCX()&&(b="Tablet");
l.increaseCount("PayPage-ClientSide-AddCupClick-"+b,1);b=R("#cupForm");if(0<b.length)b.submit();else{var d=R("\x3cform\x3e\x3c/form\x3e");d.attr({target:"_blank",method:"POST",action:a.data.url});R("#cup-dc").find("input").each(function(){var a=R(this);"hidden"===a.attr("type")&&a.clone().appendTo(d)});R("body").append(d);d.submit();d.remove()}}function A(b){var d=b.$target.closest(".a-popover"),f=d.data("a-popover-id");h.hideById(f);d.hide();R("#a-popover-modal").hide();e.show();c.makeAjaxCall(b.data.url,
void 0,{successHandler:function(b){R("#existing-payment-methods").replaceWith(R(b).find("#existing-payment-methods"));a.trigger("checkout:reload:payselect");e.hide()}})}function Y(a){a.$event.preventDefault();a=a.data;e.show();b.submitNewGilPayment(a.subtype)}function Z(){if(!c.isMobileCX()){0===R("#form-add-credit-card").length&&(R("#ccAddCard").parents("div.cc-submit").hide(),R("#ccAddCardWithButton").parents("div.cc-submit").show());R("html").hasClass("a-ie6")&&(R("#cup-mbdc").show(),R(".mbdc-link").attr("data-action",
"redirect-cup"));S=c.getElements(Ba);S.bankNumberConfirm.show();S.newVDC.find(".payment-row").data("hasstatus")||S.newVDC.find(".vdc-form-fields").hide();S.newVDC.find("#suppressedVerifiedDebitCard").hide();S.newCCFormContent.find(".cup-card-field").hide();S.newPayments.find("#cupInfoMessage").hide();S.newPayments.find("#use-ecard-link").show();S.newPayments.find(".mbdc-link").show();S.newPayments.find(".mbdc-button").hide();ta=!1;S.newPayments.each(function(){var a=R(this),b=a.data();b&&0===b.hasstatus?
(a.find("a.a-link-expander i.js-hide").remove(),a.find("a.a-link-section-expander i.js-hide").remove()):b&&1===b.hasstatus&&!ta&&(c.scrollTopTo(a),ta=!0)});var b=S.newVCC.find("#requireCVVOrPincode");b&&b.length&&b.val("1");ra&&(a.declarative("new-cc",["submit"],da),a.declarative("new-brdc",["submit"],da),a.declarative("new-loc",["submit"],P),a.declarative("show-card-image",["change"],E),a.declarative("new-giftcard-promotion",["submit"],D),a.declarative("new-verified-card",["click"],u),a.declarative("new-cc-in-dashboard",
["click"],z),a.declarative("new-gc-in-dashboard",["click"],w),a.declarative("add-bank-account",["submit"],ba),a.declarative("add-direct-debit",["submit"],fa),a.declarative("add-invoice",["submit"],aa),a.declarative("show-order-summary",["click"],X),a.declarative("redirect-cup",["click"],ea),a.declarative("cup-popover-close",["click"],A),a.declarative("add-new-debit-and-cc-popover-submit",["click"],F),a.declarative("add-bank-account-popover-submit",["click"],U),a.declarative("add-loc-account-popover-submit",
["click"],L),a.declarative("new-gil-payment",["click"],Y),a.declarative("add-direct-debit-popover-submit",["click"],x),a.declarative("add-invoice-account-popover-submit",["click"],O),a.declarative("add-new-br-debit-card-popover-submit",["click"],V),ra=!1);S.cardTypeDropdown.unbind("change",r).bind("change",r);S.vdcBankDropdown.unbind("change",p).bind("change",p);S.emiCardsDropdown.unbind("change",G).bind("change",G);R("div.pay-desktop a.a-link-expander").unbind("keypress");R("div.pay-desktop .a-declarative, div.pay-desktop .a-button").filter("[data-action\x3da-checkout-modal-popover]").unbind("keypress");
a.on("a:popover:show:add-new-debit-cc-modal",function(a){Q=a.popover});a.on("a:popover:show:add-new-bank-account-modal",function(a){na=a.popover});a.on("a:popover:show:add-new-direct-debit-modal",function(a){qa=a.popover});a.on("a:popover:show:add-new-loc-account-modal",function(a){ua=a.popover});a.on("a:popover:show:add-invoice-account-modal",function(a){K=a.popover});a.on("a:popover:show:add-br-debit-card-modal",function(a){ca=a.popover})}}function ka(a,b){var c,f,e,h,g,k,n,m,l,r,t;"vcc"===b?(c=
"#vccCVVNum",b="#newVCCErrors",f="#vccMonth",e="#vccName",h="#newVerifiedCreditCardNumber",g="#vccType",k="#vccYear",n="#vccPincode",t=r=l=m=void 0):"vdc"===b?(c="#vdcCVVNum",b="#newVDCErrors",f="#vdcMonth",e="#vdcName",h="#newVerifiedDebitCardNumber",g="#vdcType",k="#vdcYear",m="#isSBIMaestroAsSavedCardEnabled",l="#isSBIInternationalMaestroSelected",t=r=n=void 0):"emi"===b?(c="#vccCVVNum",b="#newEMIErrors",f="#vccMonth",e="#vccName",h="#newVerifiedCreditCardNumber",g="#vccType",k="#vccYear",n="#vccPincode",
t=r=l=m=void 0):"brdc"===b?(b="#newBRDCErrors",f="#brdcMonth",e="#brdcName",h="#addCreditCardNumber_BRDC",k="#brdcYear",t=r=l=m=n=g=c=void 0):(r="#cupSecurityCode",t="#cupMobileNumber",c="#ccCVVNum",b="#newCCErrors",f="#ccMonth",e="#ccName",h="#addCreditCardNumber",g="#ccType",k="#ccYear",l=m=n=void 0);c=a.find(c);r&&0===c.length&&a.find(r).is(":visible")&&(c=a.find(r));m="1"===a.find(m).val()&&"1"===a.find(l).val();e=a.find(e);h=a.find(h);t=t?a.find(t):null;f=a.find(f);g=a.find(g);k=a.find(k);var u;
n&&a.find(n).is(":visible")&&(u=a.find(n));n=g.val();l=d.create();l.validateCreditCardName(e,e);l.validateCreditCardNumber(h,h);m&&l.validateSBIMaestroCardNumberLength(h,h);m=f.parent();m=m.hasClass("a-button")?m:m.find(".a-button");e=k.parent();e=e.hasClass("a-button")?e:e.find(".a-button");"G21"!==n&&l.validateCreditCardDate(f,m,k,e);l.validateCreditCardType(g,g.closest(".card-type-field").find(".a-button"));k=n?n.substr(0,1):"";c.length&&"R"!==k&&c.is(":visible")&&l.validateCreditCardCVV2(c,c,
n);t&&t.length&&t.is(":visible")&&l.validateCreditCardMobile(t,t);u&&u.length&&l.validateCreditCardPincode(u,u);l.displayErrors(R(b),a);return l.hasErrors()}function ga(a,b){if(a){"1"===a.isDebitCard?S.newCCWarnings.show().removeClass("hidden"):S.newCCWarnings.hide().addClass("hidden");if("1"===a.hasErrors){var e=d.create();e.validateGetCreditCardTypeResult(a);if(e.hasErrors()){e.displayErrors(S.newCCErrors);return}}b="vcc"===b?S.newVCC:"vdc"===b?S.newVDC:"emi"===b?S.newEMI:"brdc"===b?S.newBRDCFormContent:
S.newCCFormContent;var e=a.specificFields,f=b.find(".cup-card-field");0!==f.length&&(e&&1===e.securityCode&&1===e.mobileNumber?(c.isTouchCX()&&b.find("#addCreditCardNumber").closest(".a-input-text-wrapper").removeClass("last-child"),f.show()):f.hide());e=a.specificFields;f=b.find(".amex-field");if(0!==f.length){var h=b.find(".cvv-field");0!==h.length&&(e&&1===e.pincode?(h.hide(),f.show()):e&&0===e.pincode&&0===e.securityCode?(f.hide(),h.hide()):(f.hide(),h.show()))}e=b.find(".card-images");e.find("img").hide();
h=a.installmentProgram;f=!1;h&&(h=e.find('img[data-installmentprogram\x3d"'+h+'"]'),0!==h.length&&(h.show(),f=!0));f||(a.issuerdisplayimage?e.find("img[data-issuer\x3dATM]").attr("src",a.issuerdisplayimage).show():(f=a.issuer+a.brand,e.find("img[data-issuer\x3d"+f+"]").show(),b.find(Ba.cardTypeDropdown).val(f).trigger("change")));n.setDateSelectorStatus(a,b)}}var R=a.$,ra=!0,ta=!1,S={},Ba={bankNumberConfirm:"#wrapper-bank-account-number-confirm",btnAddCard:"#ccAddCard",btnAddLoc:"#button-new-loc",
btnAddGC:"#button-add-gcpromo",btnAddBank:"#button-add-bank-account",btnAddDirectDebit:"#button-add-direct-debit",btnAddInvoice:"#button-add-invoice",cardImages:"#newCreditCardImages",cardTypeDropdown:".card-type-dropdown select",newCCFormContent:"#new-cc",newBRDCFormContent:"#new-brdc",newGCErrors:"#gcpromoerrorblock",newGCFormContent:"#gc_entry",newPayments:"div.new-payment-line",newVCC:"#new-verified-credit-cards-table",newVDC:"#new-verified-debit-cards-table",newEMI:"#newEmiCard",paymentRows:"#existing-payment-methods .payment-row",
vdcBankDropdown:"#vdcBanksSelect",emiCardsDropdown:"#emiPaymentMethodsSelectList",cardList:"#existing-credit-cards-box",newCCErrors:"#newCCErrors",newCCWarnings:"#newCCWarnings"},Q,na,ua,qa,K,ca;a.on("checkout:reload:payselect",Z);a.on("checkout:reload:spp-payment",Z);return{actionShowOrderSummary:X,handleFormHandlerScrollToSelected:I}});q.when("A","page-detector","client-side-metrics","ready").execute(function(a,l,g){function c(a,c,h,e){a=d(c).is(":checked");p.P&&p.P.AUI_BUILD_DATE?a?d(h).val(d(h).parent().data("account-name")):
d(h).val(""):(g.increaseCount("removeauijs8"),a?(d(e).removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active"),d(h).val(d(h).data("account-name"))):(d(e).removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),d(h).val("")));h="undefined"!==typeof p.ue&&"undefined"!==typeof p.ue.count;e=l.isMobilePayment()?"mobile":"tablet";a=d("#showNameOnCardCheckbox").is(":checked");h&&p.ue.count(e+"NameOnCardCheckBox"+(a?"Checked":"Unchecked"),1)}var d=
a.$;a.declarative("show-card-name",["click"],function(a){c(a,"#showNameOnCardCheckbox","#ccName","#showNameOnCardIcon")});a.declarative("show-br-debit-card-name",["click"],function(a){c(a,"#showNameOnCardCheckbox_BRDC","#brdcName","#showNameOnCardIcon_BRDC")})});"use strict";q.when("A").register("pay-rewards-currency",function(a){var l=function(a,c){c=Math.pow(10,c);a=a.replace(/[^0-9]/g,"");return parseFloat(a)/c},g={CA:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},DE:{groupingSeparator:".",
decimalSeparator:",",decimalPlace:2},GB:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},JP:{groupingSeparator:",",decimalSeparator:".",decimalPlace:0},US:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2}},c=function(a,c,d,e,g){this.groupingSeparator=a;this.decimalSeparator=c;this.currencyDecimalPlace=d;this.pointsDecimalPlace=e;this.ratio=g;this.getCurrencyAmount=function(a){return l(a,this.currencyDecimalPlace)};this.getPointsAmount=function(a){return this.getCurrencyAmount(a)/
this.ratio};this.format=function(a,c){var d=parseInt(a,10);a=parseFloat(a-d).toFixed(c);a=this.decimalSeparator+a.slice(2);d=d.toString();c=3<d.length?d.length%3:0;d=(0<c?d.substr(0,c)+this.groupingSeparator:"")+d.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+this.groupingSeparator);return a===F||a===this.decimalSeparator?d:d+a};this.formatCurrency=function(a){return this.format(a,d)};this.formatPoints=function(a){return this.format(a,e)}},d=function(c,d,h,e){this.maxAmount=e;this.rewardsFormatter=h;this.currencyElement=
c;this.pointElement=d;var g=this;this.isControlKey=function(a){switch(a.which){case 8:case 46:return!0;case 86:case 88:return a.ctrlKey;default:return!1}};this.isNavigationKey=function(a){switch(a.which){case 9:case 16:case 17:case 35:case 36:case 37:case 39:return!0;case 65:case 67:return a.ctrlKey;default:return!1}};this.isValidKey=function(a){var c=a.which;return 48<=c&&57>=c||96<=c&&105>=c||8===a.which||46===a.which};this.getCaret=function(){var a=g.currencyElement,c=a.get(0),d=0,e=0;if("number"===
typeof c.selectionStart&&"number"===typeof c.selectionEnd)d=c.selectionStart,e=c.selectionEnd;else{var f=document.selection.createRange();if(f!==F&&f.parentElement()===c){var a=a.val(),e=a.length,h=c.createTextRange();h.moveToBookmark(f.getBookmark());c=c.createTextRange();c.collapse(!1);-1<h.compareEndPoints("StartToEnd",c)?d=e:(d=-h.moveStart("character",-e),d+=a.slice(0,d).length-1,-1<h.compareEndPoints("EndToEnd",c)||(e=-h.moveEnd("character",-e),e+=a.slice(0,e).length-1))}}return{start:d,end:e}};
this.setCaret=function(a){var c=g.currencyElement.get(0);c.setSelectionRange?c.setSelectionRange(a,a):c.createTextRange&&(c=c.createTextRange(),c.collapse(!0),c.moveStart("character",a),c.moveEnd("character",a),c.select())};this.bind=function(){g.currencyElement.unbind();g.currencyElement.bind("keydown",function(a){g.isNavigationKey(a)||g.isControlKey(a)||g.isValidKey(a)||a.preventDefault()});g.currencyElement.bind("keyup",function(b){if(!g.isNavigationKey(b)){b=g.getCaret();var c=g.currencyElement.val().length;
g.format();var d=g.currencyElement.val().length;b.start===b.end&&g.setCaret(Math.min(b.start+(d-c),d));a.trigger("inlineFormatter:formattingCompleted",g)}})};this.unbind=function(){g.currencyElement.unbind("keydown keyup")};this.format=function(a){a=g.currencyElement.val();a=g.rewardsFormatter.getCurrencyAmount(a);isNaN(a)&&(a=0);a>g.maxAmount&&(a=g.maxAmount);a=g.rewardsFormatter.formatCurrency(a);g.currencyElement.val(a)}};a.on("inlineFormatter:formattingCompleted",function(a){var c=a.pointElement,
d=a.currencyElement.val(),d=a.rewardsFormatter.getPointsAmount(d);a=a.rewardsFormatter.formatPoints(Math.round(d));c.html(a)});return{getCurrencyFormatByCountryCode:function(a){(a=g[a])||(a=g["default"]);return a},getAmount:l,initializeInlineFormatting:function(f,g,h){var e=f.maxAmount;h=new c(h.groupingSeparator,h.decimalSeparator,h.decimalPlace,g.decimalPlace,g.ratio);f=new d(f.$element,g.$element,h,e);f.bind();f.format(0);a.trigger("inlineFormatter:formattingCompleted",f)}}});"use strict";q.when("A",
"pay-common-util","pay-validator","page-conductor","mobile-carrier-billing-util","weblab-helper").register("jppoints",function(a,l,g,c,d,f){function k(){!l.isMobileCX()&&p("#jppoints").length&&(y=l.getElements(G),m())}function h(){var a=y.paymentRows.find('input[type\x3d"radio"][name\x3d"paymentMethod"]');a.closest("div.payment-selected").removeClass("payment-selected");a.attr("checked",!1);l.isTouchCX()&&e(a,"radio")}function e(a,b){a.siblings("i").removeClass("a-icon-touch-"+b+"-active").addClass("a-icon-touch-"+
b+"-inactive")}function n(a,b){a.is(":disabled")||a.siblings("i").removeClass("a-icon-touch-"+b+"-inactive").addClass("a-icon-touch-"+b+"-active")}function b(){return p('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]').is(":checked")}function m(){if(y.jppoints&&y.jppoints.length){b()&&v();y.jppoints.show();var a=y.jppoints.find("#redeemPoints");l.isTouchCX()?a.parents("label").bind("click",w):a.bind("click",w);y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("click",
function(){var a=y.jppoints.find("#jpPointsCustom");a.attr("checked",!0);var b=y.jppoints.find("#redeemPoints");b.attr("checked",!0);l.isTouchCX()&&(n(a,"radio"),e(y.jppoints.find("#jpPointsMax"),"radio"),n(b,"checkbox"))});y.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]').bind("click",u);y.jppoints.find("#jpPointsCustom").bind("click",function(){y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').focus()});y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("keyup",
t)}}function v(){var a=y.jppoints.find("#redeemPoints"),b=y.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),d=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),f=y.jppoints.find("#redeemableAmount"),h=y.jppoints.find("#redeemableValue");a.attr("checked",!1);a.attr("disabled",!0);b.attr("checked",!1);b.attr("disabled",!0);y.jppoints.find("#jpPointsError").hide();d.val("");d.removeClass("a-form-error");d.attr("disabled",!0);h.text(y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val());
f.text(y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val());c.isSPP()&&(y.jppoints.find("label").addClass("disabled-color"),y.jppoints.removeClass("payment-selected"));l.isTouchCX()&&(e(a,"checkbox"),e(b,"radio"),a.siblings("i").addClass("a-button-disabled"),b.siblings("i").addClass("a-button-disabled"))}function u(b){var c=b.currentTarget,d=y.jppoints.find("#redeemPoints");d.attr("checked",!0);if(l.isTouchCX()){n(p("#"+c.id),"radio");var f;f="jpPointsMax"===c.id?y.jppoints.find("#jpPointsCustom"):
y.jppoints.find("#jpPointsMax");e(f,"radio");n(d,"checkbox")}"true"===c.value&&(y.jppoints.find("#jpPointsError").hide(),c=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),c.removeClass("a-form-error"),c.val(""),d=y.jppoints.find("#redeemableAmount"),f=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10),c=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),d=parseInt(d.text(),10)*f,p('input[name\x3d"useAvailableBalance"]').is(":checked")&&
(f=y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),c-=parseInt(f.val(),10)),d>=c&&h());q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",p(b.currentTarget))})}function z(a){var b=y.jppoints.find("#redeemableAmount"),c=y.jppoints.find("#redeemableValue"),d=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),f;a.is(":checked")?(a=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val(),
f=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val(),d-=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),10)):(a=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),f=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val());var g=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10)*a;b.text(a);c.text(f);0>=parseInt(a,10)?
(b=y.jppoints.find("#redeemPoints"),b.attr("checked",!1),c=y.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),c.attr("checked",!1),l.isTouchCX()&&(e(b,"checkbox"),e(c,"radio"))):y.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"][value\x3d"true"]').is(":checked")?g>=d&&h():t()}function w(){var d=y.jppoints.find("#redeemPoints");if(!d.is(":disabled")){d=d.is(":checked");if(l.isTouchCX())d?(e(y.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),
r()):(n(y.jppoints.find("#jpPointsMax"),"radio"),e(y.jppoints.find("#jpPointsCustom"),"radio"),B());else if(d)B(),c.isSPP()&&y.jppoints.addClass("payment-selected");else if(r(),c.isSPP()){y.jppoints.removeClass("payment-selected");if(b())return;l.selectDefaultPaymentMethodIfNotSelected()}q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",y.jppoints)})}}function B(){var a=y.jppoints.find("#jpPointsMax");a.attr("checked",!0);
var b=parseInt(y.jppoints.find("#redeemableAmount").text(),10),d=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),f=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10);l.isTouchCX()&&(e(y.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),n(a,"radio"));y.jppoints.find("#jpPointsMax").is(":checked")&&(b>=f?h():c.isSPP()&&y.paymentRows.find("#gcPromo, input[name\x3d'useAvailableBalance']").is(":checked")&&(a=y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),
f-=parseInt(a.val(),10),d>=f&&h()))}function r(){var a=y.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]');a.attr("checked",!1);var b=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');b.val("");b.removeClass("a-form-error");y.jppoints.find("#jpPointsError").hide();l.isTouchCX()&&e(a,"radio")}function t(){var b=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),c=parseInt(b.val(),10);!c||0>c?(b.val(""),y.jppoints.find("#jpPointsError").hide(),y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error")):
(b.val(c),parseInt(y.jppoints.find("#redeemableAmount").text(),10)<c?(y.jppoints.find("#jpPointsError").show(),y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').addClass("a-form-error")):(y.jppoints.find("#jpPointsError").hide(),y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error"),b=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),
10),c>=b&&h(),q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleJPPointsSection",c)})))}var p=a.$,y={},G={paymentRows:"#existing-payment-methods .payment-row",jppoints:"#jppoints",mcbPointsWarning:"#mcbPointsWarning"};a.on("checkout:reload:payselect",k);a.on("checkout:reload:spp-payment",k);return{handleJPPointsOnPaymentRows:function(a){a=p(a.currentTarget);if("jppoints"!==a.attr("id"))if("useAvailableBalance"===a.attr("name"))z(a);else{f.isMCBMultiTenderWeblabEnabled()||
d.hideMCBWarningMessageForPoints(y);var b=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]');if(!f.isMCBMultiTenderWeblabEnabled()&&b.length&&0<b.filter("[value^\x3dMCB]").size())d.showMCBWarningMessageForPoints(y),v();else if("availablebalance"===a.attr("value")||a.find("#pm_300")&&"availablebalance"===a.find("#pm_300").attr("value"))v();else{a=y.jppoints.find("#redeemPoints");var b=y.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),e=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),
h=y.jppoints.find("#redeemableAmount"),g=y.jppoints.find("#redeemableValue");c.isSPP()&&y.jppoints.find("label").removeClass("disabled-color");a.attr("disabled",!1);b.attr("disabled",!1);e.attr("disabled",!1);p('#existing-balance input[type\x3d"radio"][value\x3d"availablebalance"]').length&&(h.text(y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val()),g.text(y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val()));l.isTouchCX()&&(a.siblings("i").removeClass("a-button-disabled"),
b.siblings("i").removeClass("a-button-disabled"))}}},handleJPPointsWithGC:z}});"use strict";q.when("A","ajax-utility","client-side-metrics","pay-common-util","pay-validator","page-transition-controller","page-conductor","a-popover-position","inline-points-register-controller","jppoints","pay-credit-card","checkout-general-utils","a-popover-base","a-dropdown","pay-rewards-currency","cache-page-data-controller","pay-credit-card-reregistration","mobile-carrier-billing-util","emi-helper","instant-bank-discount-helper",
"recommendation-helper","safe-apx-helper","apb-limit-messaging-helper").register("existing-payments",function(a,l,g,c,d,f,k,h,e,n,b,m,v,u,z,w,B,r,t,H,y,G,E){function I(){return C.paymentRows.filter(function(){return J(this).hasClass("payment-selected")||J(this).find("#redeemPoints").is(":checked")})}function da(a){f.show();a.$event.preventDefault();var b=I().find(".card-unreg-rewards").data();b.recommendedPaymentMethodId=b.paymentinstrumentid;c.makeAjaxCall(a.$target.attr("href"),b)}function F(b){b=
J(b.currentTarget);var d=b.data();if(!(0>=d.ratio)){var e=b.val()/d.ratio;if(!isNaN(e)){var f=b.val();f<d.min&&(e=0);b=c.getNumberWithSeparators(e,d.decimalplaces);I().find(".custom-reward-points").html(b);q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleRewardsSection",f)})}}}function P(a){1===a.data.refresh&&(f.show(),c.makeAjaxCall(a.data.url))}function D(a){Ca(a)?(a=C.continueBtns,a.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),
a.find(".a-button-disabled").removeClass("aok-hidden")):J("#payPageContinueBtnStateFixEnabled").length&&V(a)}function N(a){c.isTouchCX()&&(Ca()?a.$event.preventDefault():(C.continueErrPopover.hide().find(".error-message").hide(),f.show()))}function U(a){c.isTouchCX()&&(Ca()||C.continueErrPopover.hide().find(".error-message").hide())}function x(a){a=J(a.currentTarget);a.click();a=a.closest(".payment-container");a.find("#cc-errors").is(":visible")?a.find(".tv-update .a-button-primary").focus():a.click()}
function L(a){a.$event.preventDefault();var d=I();if(!b.runConfirmCardValidator(d,d.find("#cc-errors"))){f.show();var e=(d=c.getInputValues(d))||{},h=c.getInputValues(C.hiddenFormFields),g;for(g in h)h.hasOwnProperty(g)&&(e[g]=h[g]);b.confirmCreditCard(d,K,a.data.url)}}function O(){C.continueErrPopover.filter(":visible").length&&C.continueErrPopover.hide()}function V(){C.continueErrPopover.filter(":visible").length&&C.continueErrPopover.hide().find(".error-message").hide();var a=I();C.disableSubmitButtons.length?
a.find(".no-address").length||(a.find(".continue-center").removeClass("aok-hidden"),a.find(".a-button-disabled").addClass("aok-hidden")):(C.continueBtns.find(".a-button-primary:not(.a-button-disabled)").removeClass("aok-hidden"),C.continueBtns.find(".a-button-disabled").addClass("aok-hidden"));if(a){var b=a.find(".a-form-error");b&&b.length&&(b.removeClass("a-form-error"),(a=a.find(".pincode-err-block").filter(":visible"))&&a.length&&(C.continueErrPopover.hide().find(".error-message").hide(),C.continueBtns.find(".a-button-primary").removeClass("aok-hidden"),
C.continueBtns.find(".a-button-disabled").addClass("aok-hidden"),a.hide()))}}function ba(){C.continueErrPopover.filter(":visible").length||C.continueBtnTop.trigger("click")}function fa(a){if(13===a.which){var b=J(document.activeElement),d=b.closest("div.payment-row"),e=b.closest(".a-button"),b=b.get(0).tagName;if(d.length&&!e.length&&"A"!==b&&"a"!==b)return d=d.find('input[type\x3d"submit"]'),d.length?d.trigger("click"):(C.continueErrPopover.filter(":visible").length&&C.continueErrPopover.hide(),
Ca(a)?(c.isTouchCX()||(C.continueBtns.find(".a-button-primary").addClass("aok-hidden"),C.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")),a.preventDefault()):C.continueBtnTop.trigger("click")),!1}}function aa(a){f.show();var b=I(),d=b.find("input[type\x3dradio][name\x3dpaymentMethod]").val(),e=b.find(".card-unreg-rewards").data(),b=c.isTouchCX()?b.find(".flag-register-rewards"):C.rewardsRegister,b=c.getInputValues(b);b.programid=e.programid;b.paymentinstrumentid=e.paymentinstrumentid;
b.CARD_EXPIRATION_DATE=e.expiredate;b.CARD_HOLDER_NAME=e.holdername;b.returnRefreshedPage=a.data.returnRefreshedPage;b.rewardsdateofbirthmonth&&b.rewardsdateofbirthday&&(b.DATE_OF_BIRTH=b.rewardsdateofbirthmonth+b.rewardsdateofbirthday);-1===a.data.url.toLowerCase().indexOf("cachebuster")&&(a.data.url=m.addQueryStringParameter(a.data.url,"cacheBuster",(new Date).getTime()));c.makeAjaxCall(a.data.url,b,{successHandler:function(a,b,e){f.hide();if(a){a=l.jsonify(a);C.rewardsRegister.find(".register-content").hide();
var h=c.isTouchCX()?I().find(".register-error"):C.rewardsRegister.find(".register-error");h.hide();a.error?h.show().find(".error-message").hide().filter("#"+a.error).show():(k.ajaxUpdatePage(a.refreshedPage,b,e),b=C.paymentRows.find('input[type\x3dradio][name\x3dpaymentMethod][value\x3d"'+d+'"]').closest(".payment-row"),b.trigger("click"),c.scrollTopTo(b))}}})}function X(a){a=J(a.currentTarget).parents("div.currency-list");var b=a.find("label.a-touch-radio");b.length?b.trigger("click"):a.find("input[type\x3dradio][value\x3dOther]").trigger("click")}
function ea(a){a=a.$target.closest("div.payment-row");var b=a.find(".currency-list");if(k.isSPP()){var d=u.getSelect(b.find("select"));null!==d&&d.setValue("")}a.find(".change-currency").hide();b.show();c.isTouchCX()&&(a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"),a.find(".bottom-cell").show());ca();Aa()}function A(a){a=a.$target.closest("div.payment-row");a.find(".expire-info, .expire-date").hide();a.find(".enter-date, .expire-date-fields").show();ca();sa()}function Y(a){var b=
a.$target.closest("div.payment-row"),d="true"===c.getAttributeData(b,"isaddresschallenge")?1:0;b.find(".expire-date-fields").length?(A(a),b.find("#newExpDate").focus()):d&&b.find("#addCreditCardNumber").focus()}function Z(a){setTimeout(function(a){var b=J(a.target);a=document.createEvent("UIEvents");a.initUIEvent("DOMActivate",!0,!0,p,1);b.get(0).dispatchEvent(a)},0,a)}function ka(a){var b=J(a.target).closest("div.payment-row");""!==J(a.target).val()&&("true"===c.getAttributeData(b,"isaddresschallenge")?
b.find("#addCreditCardNumber").focus():ba())}function ga(){var a=I();a.find("div.flag-register-rewards").is(":visible")?(a.find(".bottom-cell").hide(),a.find(".top-cell").removeClass("bottom-line"),a.find(".card-unreg-rewards").show()):(a.find(".card-unreg-rewards").hide(),a.find(".bottom-cell").show(),a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"))}function R(){ga()}function ra(a){a.$event.preventDefault();if("1"===I().find("div.flag-register-rewards").attr("cached"))ga();
else{var b=a.$target.attr("href");-1===b.toLowerCase().indexOf("cachebuster")&&(b=m.addQueryStringParameter(b,"cacheBuster",(new Date).getTime()));f.show();c.makeAjaxCall(b,a.data,{successHandler:function(a){f.hide();var b=l.jsonify(a);a=c.decodeJSONResponse(b.widgetHTML);var d=I();d.find("div.flag-register-rewards").html(a);d.find("div.flag-register-rewards").attr("cached",1);d.find("div.flag-register-rewards .error-message").each(function(){var a=J(this),c=a.data("errorid");a.html(b.displaydata[c])});
ga()}})}}function ta(b){var d=J(b.target);if(!d.is(":visible"))return b.preventDefault(),b.stopPropagation(),!1;k.isSPP()&&(k.isPrefetchFromAddressEnabled()?k.disablePageNoUpdateTransition():J("#payment").find(".panel-cancel-row").hide(),w.clearCache());var e=J(b.currentTarget);C.jppoints.length&&n.handleJPPointsOnPaymentRows(b);var f=e.find("[name\x3duseAvailableBalance]");if("useAvailableBalance"!==b.target.name&&!f.length)if(Ba(e),r.toggleGCForMCB(e,C),S(e),e.hasClass("payment-selected")||e.hasClass("payment-label"))C.disableSubmitButtons.length&&
(na(e,e,!1),!d.hasClass("continue-center")&&e.find(".continue-center").length||ba());else if(b=e.find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),b.length&&"disabled"!==b.attr("disabled")){ab();b=I();k.isSPP()?b.filter(function(){var a=J(this).attr("id");return"gcPromo"===a?(a=J(this).find('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]'))&&a.length:"jppoints"!==a}).removeClass("payment-selected"):b.removeClass("payment-selected");b.find("[name\x3dpaymentMethod]").attr("checked",
!1);b.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");b.find(".top-cell").removeClass("bottom-line");T(b);c.isTouchCX()&&(b.find(".bottom-cell").hide(),b.find(".card-unreg-rewards").show());e.addClass("payment-selected");e.find("[name\x3dpaymentMethod]").attr("checked",!0);e.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active");var d="true"===c.getAttributeData(e,
"isaddresschallenge")?1:0,f=e.find('.rewards-list input[type\x3d"radio"]').length,h="1"===c.getAttributeData(e,"hasDerivedCurrency")?1:0,g=e.find(".vcc-form-fields").length,l=e.find(".card-ref-num").length;c.isTouchCX()&&(d||f||g||l||h)&&(e.find(".top-cell").removeClass("align-top bottom-line").addClass("bottom-line"),e.find(".bottom-cell").show());q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:select-payment-row",e,Aa)});Ga(e);Ma(e);Oa(e);Pa(e);bb(e);"1"===
J("#suppressionMessageFixEnabledStatus").val()&&cb(e);db(e);Qa(e);Ra(e);Sa(e);eb(e);fb(e);Ta(e);Da(t,t.toggleEMIMenu,e);Ua(e);gb();ua(e);Ya();ca();sa();U();ha();qa(e,b);La();J.isEmptyObject(y)||y.toggleCustomerNudgingMessage(e);C.hideInputBoxes.length&&(Na(e,b),Ia(e));C.disableSubmitButtons.length&&na(e,b,!0);Ha();Aa();C.disableSubmitButtons.length&&!e.find(".continue-center").length&&ba()}}function S(a){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=J("input[type\x3d'hidden'][name\x3d'paySelectLocale']");
b.length&&"IN"===b.val()&&a.length&&q.when("client-side-metrics").execute(function(a){a.increaseCount("PayPage-COD-NonMobile",1)})}function Ba(a){var b=J("#isGlobalCODEligible").val();if(b&&"0"!==b){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=J("#button-add-gcpromo"),c=J("#button-add-gcpromo").parent().parent();a.length?(c.addClass("a-button-disabled"),b.attr("disabled","disabled")):(c.removeClass("a-button-disabled"),b.removeAttr("disabled"))}}function Q(a){q.when("A",
"a-tv").execute(function(b,c){b=b.$;var d=b(a);d.length&&(b(".tv-lastSelected").removeClass("tv-lastSelected"),d.addClass("tv-lastSelected"),c.select(d))})}function na(a,b,c){c&&b.find(".billing-address, .cc-continue-button").hide();if(a.find(".tv-update").length)Na(a,b),Ia(a);else{var d=a.find(".billing-address, .cc-continue-button");if(d.length&&!d.is(":visible")){var e=!1;a.find(".no-address").length&&(e=!0,a.find(".a-button-primary").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden"));
q.when("a-tv").execute(function(f){c&&(b.find(".payment-container").hasClass(".a-tv-navigate")||f.add(b.find(".payment-container")));f.remove(a.find(".payment-container"));f=e?a.find(".billing-address-link"):d.find(".continue-center");Q(f)});d.show()}}}function ua(a){var b=J("#one-click-final-review-message");b.length&&(a.find("#canTryTFX").length?b.removeClass("aok-hidden"):b.addClass("aok-hidden"))}function qa(a,b){if(c.isTouchCX()&&(b&&b.find(".top-cell .data-row").children(".a-column").height("auto"),
a)){a=a.find(".top-cell .data-row");var d=a.find(".addr-challenge-card-scan .a-box");if(d.length){b=a.height();var d=d.height(),e=a.children(".a-column:first");a.children(".a-column").height(d);e.height(b);e.children(".vertical-center-grid:first").height(d)}else a.children(".a-column").height(a.height())}}function K(d){f.hide();var e=l.jsonify(d);e.imbWidgetHTML&&J("#imb-wrapper").html(c.decodeJSONResponse(e.imbWidgetHTML));if(e.cardWidgetHTML&&(d=I(),d.replaceWith(c.decodeJSONResponse(e.cardWidgetHTML)),
null!=e.rewardsAccountsWidgetHTML&&q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:refresh-rewards-section",c.decodeJSONResponse(e.rewardsAccountsWidgetHTML))}),a.trigger("checkout:reload"),a.trigger("checkout:reload:payselect"),d=I(),"true"!==c.getAttributeData(d,"isaddresschallenge"))){b.setCardPasswordInputStatus(d,e.newpaymentmethodid,"cvv","#existingCvvNum");b.setCardPasswordInputStatus(d,e.newpaymentmethodid,"pincode","#existingPincodeNum");if(C.cvvColumnLabel.length){var h=
!1;C.paymentRows.each(function(){if("true"===c.getAttributeData(J(this),"isaddresschallenge"))return h=!0,!1});h||C.cvvColumnLabel.hide()}C.disableSubmitButtons.length&&ba()}}function ca(){C.paymentRows.each(function(){var a=J(this),b=a.find('.currency-list input[type\x3d"radio"]').length,d=a.find('.rewards-list input[type\x3d"radio"]').length,e=a.find(".card-reg-info").is(":visible"),f=a.find(".expire-date-fields").is(":visible"),h=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),
g=a.find(".bottom-cell .inner-grid-left"),k=a.find(".bottom-cell .inner-grid-right");f?b||d||e?(g.removeClass("hidden a-span10 a-span12").addClass("a-span8"),k.removeClass("a-span12 a-span2 hidden").addClass("a-span4")):(g.removeClass("a-span8 a-span10 a-span12").addClass("hidden"),k.removeClass("a-span4 a-span2 hidden").addClass("a-span12")):h?(g.removeClass("a-span12 a-span8 hidden").addClass("a-span10"),k.removeClass("hidden a-span4 a-span12").addClass("a-span2")):(g.removeClass("a-span10 a-span8 hidden").addClass("a-span12"),
k.removeClass("a-span2 a-span4 a-span12").addClass("hidden"));!c.isTouchCX()&&h&&(b||d||e)&&a.find(".bottom-cell").removeClass("align-top").addClass("align-top")});var a=I(),b=a.find("a[data-action\x3dshow-expire-date-fields]").filter(":visible").length,d=a.find(".top-cell.bottom-line").length;b&&!d||a.find(".bottom-cell").removeClass("align-top")}function sa(){c.isTouchCX()&&C.paymentRows.each(function(){var a=J(this),b="true"===c.getAttributeData(a,"isaddresschallenge")?1:0,d=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),
e=a.find(".expire-date-fields").is(":visible"),f=a.find(".card-reg-info").is(":visible"),h=a.find(".rewards-info").is(":visible"),g=a.find(".change-currency").is(":visible");d?a.find(".top-cell .second-row").addClass("align-top"):a.find(".top-cell .second-row").removeClass("align-top");b=b||g||f||h;f=e||d;h=a.find(".top-cell .inner-grid-left");a=a.find(".top-cell .inner-grid-right");b||(h.removeClass("a-span6 a-span8 a-span12").addClass("hidden"),a.removeClass("a-span4 a-span6 hidden").addClass("a-span12"));
f||(h.removeClass("a-span6 a-span8 hidden").addClass("a-span12"),a.removeClass("a-span4 a-span6 a-span12").addClass("hidden"));b&&d&&(h.removeClass("a-span6 a-span12 hidden").addClass("a-span8"),a.removeClass("a-span6 a-span12 hidden").addClass("a-span4"));b&&e&&(h.removeClass("a-span6 a-span8 hidden").addClass("a-span6"),a.removeClass("a-span4 a-span12 hidden").addClass("a-span6"))})}function T(a){var b=a.find(".currency-list");if(b.length){var c=b.find("[type\x3dradio]:checked").val(),b=b.find("#cardCurrencyDropDown option:selected").val();
"Other"!==c||"-1"!==b&&"-2"!==b||a.find(".currency-list input[type\x3dradio][value!\x3dOther]").attr("checked",!0)}}function va(a){var b=J(a.currentTarget);a=b.find("option:selected");if(""===a.val())b.parents("div.selected-section").find(".selected-note-content").hide();else{var c=a.prop("disabled"),b=b.parents("div.selected-section"),d=b.find("#active-bank-content"),e=b.find("#disable-bank-content");c?(e.show(),d.hide()):(d.show(),e.hide());b.find("span.selected-note-bank").text(a.text()).show()}}
function xa(a){var b=J(a.currentTarget);a=b.find("option:selected");""===a.val()?b.parents("div.selected-section-more-payment-method").find(".selected-more-payment-content").hide():(b=b.parents("div.selected-section-more-payment-method"),b.find("span.selected-payment-option").text(a.text()).show(),b.find("span.selected-more-payment-content").show())}function la(a){(C.continueErrPopover.filter(":visible").length||Ca())&&a.$event.preventDefault()}function wa(b){b=J(b.currentTarget);var c=b.find("input[type\x3dcheckbox]");
c.attr("checked")?(c.attr("checked",!1),b.find(".checked-checkbox").addClass("aok-hidden"),b.find(".empty-checkbox").removeClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").addClass("aok-hidden")):(c.attr("checked",!0),b.find(".checked-checkbox").removeClass("aok-hidden"),b.find(".empty-checkbox").addClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").removeClass("aok-hidden"));q.when("a-tv").execute(function(b){setTimeout(function(){b.select(".tv-lastSelected")},500);a.trigger("a:tv:resize")})}
function ia(a){a=J(a.currentTarget);"1"===a.attr("isclicked")?a.attr("isclicked",0):a.attr("isclicked",1);ha()}function ha(a){var b=J("#pm_promo");a=J("#pm_gc_radio");var d=J("#pm_gc_checkbox"),e;J("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").length&&(e=J("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").val());if(a&&a.length||d&&d.length){var f=J("input[name\x3dgcBalanceRaw]").val();J("input[name\x3damBalanceRaw]").length&&(f=J("input[name\x3damBalanceRaw]").val());
var h=J("input[name\x3disAPBLimitMessagingLaunchWeblabEnabled]").val(),g=J("input[name\x3dhasAPBRedeemableLimitExhausted]").val(),k=J("input[name\x3damAvailableBalanceRaw]").val(),n=J("input[name\x3dremainingBalanceRaw]").val(),l=J("input[name\x3dpurchaseTotalRaw]").val(),m,r,t=J(".purchase-total").length;t?(r=J(".purchase-total").html(),m=J(".remaining-balance").html()):(r=J("input[name\x3dpurchaseTotal]").val(),m=J("input[name\x3dremainingBalance]").val());var ma=J(".balance-applied");t?ma.html(r):
ma.text(r);(c.isTouchCX()&&"checkbox"===b.attr("type")?"1"===b.closest(".a-control-row").attr("isclicked"):b.is(":checked"))?(b=n,0<b&&(t?ma.html(m):ma.text(m))):b=l;h&&E.renderAPBMessagingRemainingBalance({purchaseTotal:r,remainingBalance:m,balanceApplied:ma,isPurchaseTotalInSpan:t},f,l,k);m=a.closest(".radio-col");r=d.closest(".radio-col");n=J(".amazon-money-limit-breached");t=J(".long");ma=J(".short");"1"===h&&"1"===g?E.displayAPBRedeemableLimitExhaustedMessaging({gcRadioContainer:m,gcCheckboxContainer:r,
gcCheckbox:d,gcRadio:a,shortMsg:ma,longMsg:t,amazonMoneyLimitBreachedMsg:n}):0<=f-l?("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),m.removeClass("hidden"),a.is(":checked")&&m.trigger("click"),r.addClass("hidden"),d.attr("disabled","disabled"),0==f-l?(t.hide(),ma.show()):(t.show(),ma.hide())):0<f-b?0>=b?(r.removeClass("hidden"),d.attr("disabled","disabled"),c.isTouchCX()&&r.find("i").addClass("a-button-disabled checkbox-disabled"),m.addClass("hidden"),a.attr("disabled","disabled"),ma.show(),
t.hide()):("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),m.removeClass("hidden"),a.is(":checked")?m.trigger("click"):c.isTouchCX()&&m.find("i").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),r.addClass("hidden"),d.attr("disabled","disabled"),t.show(),ma.hide()):("disabled"===d.attr("disabled")&&(d.removeAttr("disabled"),c.isTouchCX()&&r.find("i").removeClass("a-button-disabled checkbox-disabled")),r.removeClass("hidden"),(g=r.closest(".payment-row"))&&
g.hasClass("payment-selected")&&g.removeClass("payment-selected"),m.addClass("hidden"),a.attr("disabled","disabled"),"1"===h?E.renderAPBInsufficientMessaging({shortMsg:ma,longMsg:t},f,k):(ma.show(),t.hide()));"1"===e&&(a.attr("disabled","disabled"),d.attr("disabled","disabled"),(g=r.closest(".payment-row"))&&g.hasClass("payment-selected")&&g.removeClass("payment-selected"))}}function ja(b){var c=I().find(".enter-custom-rewards");if("rewardscustom"===J(b.currentTarget).children('input[type\x3d"radio"]').val()){c.show();
var d=c.find("input.custom-rewards-input");d.focus();C.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")&&(c=d.val().length,d=d.get(0),d.setSelectionRange?d.setSelectionRange(c,c):d.createTextRange&&(d=d.createTextRange(),d.collapse(!0),d.moveStart("character",c),d.moveEnd("character",c),d.select()))}else c.hide();q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",J(b.currentTarget))});Aa()}function Fa(a){a=
a.$target||J(a.currentTarget);oa(a)}function oa(b){if(b.length){var c=C.paymentRows.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]'),d=C.paymentRows.find(".installments-select.a-row"),e=d.siblings(".installments-message"),f=d.siblings(".card-offers"),h=C.paymentRows.find('input[type\x3d"radio"][value\x3d"morePaymentMethod"]'),g=C.installmentsOnlyCards,k=C.paymentRows.find('input[type\x3d"radio"][id\x3d"pmEmiPaymentOptions"]'),n=C.paymentRows.find('input[type\x3d"radio"][value\x3d"amazonBusinessCredit"]');
if(c.length){var l=c.closest(".payment-row"),m=h.closest(".payment-row"),r=k.closest(".payment-row"),ma=n.closest(".payment-row");b.is(":checked")?(c.prop("disabled",!0),c.is(":checked")&&(c.prop("checked",!1),l.removeClass("payment-selected")),c.parent().siblings().addClass("a-color-secondary"),Da(t,t.disableEMIPaymentMethods,k),q.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",n)}),H.showInstantBankDiscountAmazonPaySelected(),za(h,m),(b=d.find("select"))&&b.each(function(){var a=
this.id.replace(/\./g,"\\.");u.setValue(a,"")}),d.find(".installments-enabled-text").hide(),e.find(".installments-enabled-text").hide(),f.find(".installments-enabled-text").hide(),d.find(".installments-disabled-text").show(),e.find(".installments-disabled-text").show(),f.find(".installments-disabled-text").show(),J("#isGurupaPspToggleGcBugfixEnabled").length&&"1"===J("#isGurupaPspToggleGcBugfixEnabled").val()?g.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").filter(":checked").removeAttr("checked"):
g.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").removeAttr("checked"),g.removeClass("payment-selected")):(l.find(".payment-invalid").length||(c.prop("disabled",!1),c.parent().siblings().removeClass("a-color-secondary")),m.find(".payment-invalid").length||ya(h,m),r.find(".payment-invalid").length||Da(t,t.enableEMIPaymentMethods,k),ma.find(".payment-invalid").length||q.when("abc-helper").execute(function(b){a.trigger("abc-helper:enable-payment",n)}),H.showInstantBankDiscountAmazonPayDeselected(),
d.find(".installments-disabled-text").hide(),e.find(".installments-disabled-text").hide(),f.find(".installments-disabled-text").hide(),d.find(".installments-enabled-text").show(),e.find(".installments-enabled-text").show(),f.find(".installments-enabled-text").show(),g.find("input[name\x3dpaymentMethod]").removeAttr("disabled"))}}}function ya(a,b){a.prop("disabled",!1);a.parent().siblings().removeClass("a-color-secondary");b.find(".selected-section-more-payment-method").show();b.find(".more-payment-gc-disabled-text").hide()}
function za(a,b){a.prop("disabled",!0);a.is(":checked")&&(a.prop("checked",!1),b.removeClass("payment-selected"));a.parent().siblings().addClass("a-color-secondary");b.find(".selected-section-more-payment-method").hide();b.find(".more-payment-gc-disabled-text").show()}function M(a){var b=a.$target||J(a.currentTarget);a=b.closest(".currency-list");b=b.val();!0===(c.isTouchCX()?"Other"===b:"Other"!==b)?(a.find("select").attr("disabled",!0),a.find(".a-button.a-button-dropdown").addClass("a-button-disabled"),
a.find(".a-button.a-touch-select").addClass("a-button-disabled")):(a.find("select").attr("disabled",!1),a.find(".a-button.a-button-dropdown").removeClass("a-button-disabled"),a.find(".a-button.a-touch-select").removeClass("a-button-disabled"));Aa()}function ma(a){B.actionReregisterCardInBox(a);c.scrollTopTo(I())}function Wa(a){Aa()}function Xa(){C.paymentRows.each(function(){var a=J(this),b=".card-ref-num, .addr-challenge, .addr-challenge-msg, .cup-expired-msg, .enter-date, .expire-date-fields, .rewards-static-help-link, .verified-fail-msg, .tv-update, .billing-address, .cc-continue-button",
d=".card-info, .card-name, .card-reg-info, .expire-info, .rewards-err-msg, .rewards-list label, .rewards-list div.a-radio, .rewards-dynamic-help-link, .financial-offer-err-detail";a.hasClass("payment-selected")&&("1"===c.getAttributeData(a,"hasDerivedCurrency")||"1"===c.getAttributeData(a,"hasPreferredCurrency")&&"1"===c.getAttributeData(a,"isNewCard"))||(b+=", .currency-list");"1"===c.getAttributeData(a,"hasPreferredCurrency")&&"1"!==c.getAttributeData(a,"isNewCard")&&(d+=", .change-currency");a.find(b).hide();
a.find(d).show()})}function Ya(){C.paymentRows.each(function(){var a=J(this),b="#cc-errors, .enter-date, .expire-date-fields",d=".expire-info";if(a.hasClass("payment-selected")&&"1"===c.getAttributeData(a,"hasDerivedCurrency"))b+=", .change-currency",d+=", .currency-list";else{var e=a.find(".currency-list"),f=e.find("[type\x3dradio]:checked").val();if(f){var h;if("Other"!==f)h=e.find(".currencyNameLabel").html();else{var f=e.find("#cardCurrencyDropDown option:selected"),g=f.val();"-1"!==g&&"-2"!==
g&&(h=f.text())}h&&(d+=", .change-currency",e.closest("div.payment-row").find(".change-currency .currencyNameLabel").html(h))}b+=", .currency-list"}a.find(b).hide();a.find(d).show()})}function Za(){var a=J("#aan-ads-box");if(a.length){var b=a.data("adsendpoint"),c=a.data("adsclient"),d="https://"+b+"/2009-09-09/ad/",b="/jsc?pt\x3dstatic\x26slot\x3dlib\x26pt2\x3daanjs";a.data("useaannojq")&&(b+="-nojq");J.getScript(d+c+b,function(){p.d16g&&p.d16g.requestAanAd({elemId:"aan-ads-box",baseUrl:d,afterOnload:!0,
client:c,pt:"checkout",slot:"display-ad-right",pt2:"payselect"})})}}function $a(){Va&&(a.declarative("auto-rewards-reg",["click"],da),a.declarative("complete-rewards-register",["click"],P),a.declarative("confirm-card",["click"],L),a.declarative("register-card-rewards",["click"],aa),a.declarative("cancel-register-card-rewards",["click"],R),a.declarative("show-currencies",["click"],ea),a.declarative("show-expire-date-fields",["click"],A),a.declarative("focus-cc-update-fields",["click"],Y),a.declarative("show-rewards-reg",
["click"],ra),a.declarative("submit-payment-form",["submit"],la),a.declarative("toggle-tfx-option",["click"],M),a.declarative("reregister-cc-in-dashboard",["click"],ma),a.declarative("modify-expire-date-fields",["change"],Wa),c.isTouchCX()&&a.declarative("continue-button",["click"],N),Va=!1);C.paymentRows.unbind("click").has("input[name\x3dpaymentMethod]:enabled").bind("click",ta);q.when("apx-payselect-helper").execute(function(){var a=G.get("payselect");a&&a.initEvents(C.paymentRows,Aa)});C.paymentRows.find("input[name\x3dusePromoBalance]").unbind("change",
ha).bind("change",ha);C.disableSubmitButtons.length&&C.paymentRows.has("input[type\x3dcheckbox]:enabled").unbind("click",wa).bind("click",wa);C.existingPincodeNum.unbind("click",Ja).bind("click",Ja);C.paymentRows.find("select#cardCurrencyDropDown").unbind("change",X).bind("change",X);C.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")?C.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ja).each(function(b,c){c=a.$(c);b=c.find("input.custom-rewards-input");
c=c.find(".custom-reward-points");var d=a.$(b);b={$element:d,maxAmount:d.data("max")};c={$element:a.$(c),decimalPlaces:d.data("decimalplaces"),ratio:d.data("ratio")};d=d.data("country-code");d=z.getCurrencyFormatByCountryCode(d);z.initializeInlineFormatting(b,c,d)}):C.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ja).undelegate("input.custom-rewards-input","keyup").delegate("input.custom-rewards-input","keyup",F);if(c.isTouchCX())C.pageContainer.find("#existing-payment-methods").find("select, input[type\x3dtext], input[type\x3dpassword]").unbind("change",
U).bind("change",U),C.pageContainer.find("#existing-payment-methods").find("div.currency-list label.a-touch-radio").unbind("click").bind("click",M),C.pageContainer.find("#existing-payment-methods").find("label.promoLabel").unbind("click").bind("click",ia);else if(!k.isSPP()){var b=C.continueBtns.find(".a-button-text");J("#payPageContinueBtnStateFixEnabled").length?b.filter('input[type\x3d"button"]').unbind("mouseenter",Ea).bind("mouseenter",Ea).unbind("focus",Ea).bind("focus",Ea).unbind("mouseleave",
O).bind("mouseleave",O).unbind("blur",O).bind("blur",O):(b.filter('input[type\x3d"submit"]').unbind("mouseenter").bind("mouseenter",D).unbind("focus").bind("focus",D),b.filter('input[type\x3d"button"]').unbind("mouseleave").bind("mouseleave",V).unbind("blur").bind("blur",V))}C.netBankingSelect.unbind("change",va).bind("change",va);C.morePaymentMethodsSelect.unbind("change",xa).bind("change",xa);C.continueBtnBottom.unbind("click").bind("click",ba);0<J("input[name\x3d'needDisableCODandEMIforGC']").length&&
(b=J("input#pm_300[type\x3d'checkbox'], #pm_gc_checkbox"),b.length&&(b.bind("change",Fa),b.is(":checked")&&oa(b)));C.jppoints.length&&C.paymentRows.find('input[name\x3d"useAvailableBalance"]').bind("click",n.handleJPPointsOnPaymentRows);q.when("installments-payselect").execute(function(){a.trigger("installments-payselect:initEvents")});C.hideInputBoxes.length&&(C.paymentRows.find("#confirm-card").unbind("focus").bind("focus",x),C.paymentRows.find("#newExpDate").unbind("focus").bind("focus",Z),C.paymentRows.find("#newExpDate").unbind("change").bind("change",
ka))}function Ha(){var a=d.create();a.validatePayment(I());a.hasErrors()||k.makePrefetch(C.existingPaymentForm)}function Ja(a){a=C.showAmexWarning;null!==a&&(a.removeClass("hidden"),a.removeClass("amex_display"))}function pa(){if(!c.isMobileCX()){C=c.getElements(hb);C.paymentRows.filter(".payment-selected-marker").removeClass("payment-selected-marker").addClass("payment-selected");var b=I();q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:page-load",Aa)});q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:page-load")});
Pa(b);Ra(b);ua(b);Xa();Ga(b);Ma(b);Oa(b);Sa(b);Ta(b);Ua(b);Qa(b);ha();La();J.isEmptyObject(y)||y.toggleCustomerNudgingMessage(b);J(document).undelegate("div.pay-desktop .checkout-page-form","keypress").delegate("div.pay-desktop .checkout-page-form","keypress",fa);J(document).undelegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup").delegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup",Aa);C.addressChallengeCardList.length&&C.addressChallengeCardList.show();
C.paymentRows.find('input[type\x3d"radio"][value\x3d"rewardsmax"]').each(function(){J(this).siblings('[type\x3d"checkbox"]').remove()}).removeClass("hidden");sa();ca();$a();C.existingPaymentForm.data("checkoutFormReady",!0);Ha();Za();C.orderSummaryBottom.show();qa(b);U();Aa();Ba(b);r.determineIsMCBEnabled(C);r.toggleGCForMCB(b,C);J(".a-popover-preload").each(function(){var b=J(this).find(".rewards-registration").data("parentPaymentMethodId");b&&(a.off("a:popover:show:rewards-registration-"+b,e.displayRewardsRegister),
a.off("a:popover:hide:rewards-registration-"+b,e.hideRewardsRegister),a.on("a:popover:show:rewards-registration-"+b,e.displayRewardsRegister),a.on("a:popover:hide:rewards-registration-"+b,e.hideRewardsRegister))});q.when("a-tv").execute(function(c){a.trigger("a:tv:resize");b.find(".a-tv-navigate").length&&na(b,b,!1)})}}function Aa(b){k.isSPP()?(Ca()?C.disableSubmitButtons.length?(b=I(),b.find(".continue-center").addClass("aok-hidden"),b.find(".a-button-disabled").removeClass("aok-hidden")):(C.continueBtns.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),
C.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")):V(),a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")):J("#payPageContinueBtnStateFixEnabled").length&&D(b)}function Ka(a,b){a=J(a.target).closest(".order-summary-box").find(".continue-button-errors");a.length&&b.length&&(b=h.triggerLeft(a,b),a.show(),a.offset(b))}function Ea(a){if((!C.continueErrPopover.filter(":visible").length||c.isTouchCX())&&C.continueErrPopover.find(".error-message:not(.hidden)").length&&a&&
("mouseenter"===a.type||"focus"===a.type)){var b=J(a.target).closest(".continue-buttons").find(".a-button-disabled");Ka(a,b)}}function Ca(a){if(C.continueErrPopover.filter(":visible").length&&!c.isTouchCX())return!0;var b=I(),e=d.create();Da(t,t.isEMIPaymentInstrument,b)&&(e.validateEMIMenuForContinueButton(b),b=Da(t,t.getEMIMenuSelectedCardSection));e.validatePayment(b);e.apxValidatePayment(b,C.paymentRows);e=e.getHighestErrorId();if(!e||!e.identifier)return!1;C.continueErrPopover.find(".error-message").hide();
b=b.find(".pincode-err-block");b.hide();b&&b.length&&e.target&&e.target.length&&e.target.addClass("a-form-error");e.isPincodeError?(b.show(),b.addClass("a-form-error")):(C.continueErrPopover.find("#"+e.identifier).show(),C.continueErrPopover.find("#"+e.identifier).removeClass("hidden"),!a||"mouseenter"!==a.type&&"focus"!==a.type?k.isSPP||C.continueBtns.find(".a-button input").filter(":visible").each(function(){var a=J(this).closest(".order-summary-box").find(".continue-button-errors"),b=h.triggerLeft(a,
J(this));a.show();a.offset(b)}):(b=J(a.target).closest(".continue-buttons").find(".a-button-primary"),Ka(a,b)));return!0}function Ga(b){C.paymentRows.find(".addr-challenge, .addr-challenge-msg").hide();C.hideInputBoxes.length?C.paymentRows.find(".card-name").show():C.paymentRows.find(".card-info").show();if("true"===c.getAttributeData(b,"isaddresschallenge")){var d=b.find(".addr-challenge, .addr-challenge-msg");0===d.length&&g.increaseCount("Checkout:Payment:AddressChallengeMissingInputAndMsg");d.show();
C.hideInputBoxes.length?b.find(".card-name").hide():b.find(".card-info").hide();b=b.attr("paymentmethodid")?b.attr("paymentmethodid"):b.attr("data-paymentmethodid");a.trigger("checkout:payment:challenge:log",b)}}function Ia(a){C.paymentRows.find(".expire-date-fields").hide();a=a.find(".expire-date-fields");a.length&&a.show()}function La(){C.paymentRows.find(".pci-blocking-cvv").length&&C.paymentRows.each(function(){var a=J(this),b=a.find(".pci-blocking-cvv");a.find("[type\x3dradio]:checked").val()&&
b.length?b.show():b.length&&b.hide()})}function Na(a,b){q.when("a-tv").execute(function(c){c.add(b.find(".payment-container"));b.find(".tv-update").hide();var d=a.find(".tv-update");d.length&&(c.remove(a.find(".payment-container")),d.show(),Q(d.find(".a-button-primary")))})}function Ma(a){C.paymentRows.find(".verified-fail-msg").hide();"true"===c.getAttributeData(a,"isverifiedfail")&&a.find(".verified-fail-msg").show()}function Oa(a){C.paymentRows.find(".cup-expired-msg").hide();"true"!==c.getAttributeData(a,
"iscupcardexpired")&&"true"!==c.getAttributeData(a,"iscupcardexpiringsoon")||a.find(".cup-expired-msg").show()}function Pa(b){C.paymentRows.find(".rewards-list").hide();C.paymentRows.find(".top-cell .inner-grid-left").show().find(".rewards-info").show();var d=b.find('.rewards-list input[type\x3d"radio"]'),e=d.filter(":checked");C.paymentRows.find('.rewards-list input[type\x3d"radio"]').prop("checked",!1);0<e.length?e.prop("checked",!0):b.find(".rewards-list").hasClass("apply-by-default")?d.filter('[value\x3d"rewardsmax"]').prop("checked",
!0):d.filter('[value\x3d"rewardsnone"]').prop("checked",!0);d=b.find(".rewards-list").show();d.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")&&d.children(".enter-custom-rewards").show();c.isTouchCX()&&d.length&&(b.find(".rewards-info").hide(),b.find(".top-cell").addClass("bottom-line"),b.find(".bottom-cell").show());q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",b)})}function Ra(a){C.paymentRows.find(".financial-offer-list").hide();
C.paymentRows.find(".financial-offer-err-detail").hide();var b=a.find('.financial-offer-list input[type\x3d"radio"]'),d=b.filter(":checked");b.prop("checked",!1);0<d.length?d.prop("checked",!0):b.first().prop("checked",!0);b=a.find(".financial-offer-list").show();a.find(".financial-offer-err-detail").show();c.isTouchCX()&&b.length&&(a.find(".top-cell").addClass("bottom-line"),a.find(".bottom-cell").show())}function ab(){J(document.body).find(".a-dropdown").each(function(){v.hide(J(this))})}function bb(a){C.paymentRows.find(".installments-select").hide();
C.paymentRows.find(".installments-message").show();a.find(".installments-select").show();a.find(".installments-message").hide()}function cb(a){C.paymentRows.find("#savedCardSuppressed").hide();a.find("#savedCardSuppressed").show()}function db(a){C.paymentRows.find(".installments-list").hide();a.find(".installments-list").show()}function Qa(a){C.paymentRows.find(".card-ref-num, .selected-note, .selected-more-payment-option").hide();C.paymentRows.find(".card-benefit").show();a.find(".card-ref-num, .selected-note, .selected-more-payment-option").show();
a.find(".card-benefit").hide()}function eb(a){C.paymentRows.find(".otpBlock").hide();a.find(".otpBlock").show()}function fb(a){C.paymentRows.find(C.ovdWidgetSection).hide();a.find(C.ovdWidgetSection).show()}function Sa(a){C.paymentRows.find(".vcc-info-prompt,.vcc-form-fields").hide();a.find(".vcc-info-prompt,.vcc-form-fields").show()}function Ta(a){var b=C.newVDC.find("#vdcBanksSelect"),c=C.newVDC.find(".vdc-selected-bank-prompt").hide(),d=C.newVDC.find("#suppressedVerifiedDebitCard").hide(),e=b.val(),
f="1"===J("#save_citi_card").val()?"CIT"!==e:!0,h="1"===J("#save_citi_card").val()&&"CIT"===e;a.find("#vdcBanksSelect").length?""!==e&&"OtherBanks"!==e&&f&&(C.newVDC.find("option:selected").prop("disabled")?(d.show(),c.hide()):(d.hide(),c.show())):(("OtherBanks"===e||h)&&b.val(b.children("option").first().val()).trigger("change"),c.hide())}function Da(a,b,c){if(!J.isEmptyObject(a)&&b)return b(c)}function Ua(a){var b=J("#cash-back-ineligible-for-cod-message");b&&b.length&&((a=a.find("#cashOnDeliveryCash"))&&
a.length?b.removeClass("hidden"):b.addClass("hidden"))}function gb(){var a=J("#imb-wrapper");if(a.length&&a.is(":visible")){var b=a.find(".defaultPaymentMethodExpired"),c=a.find(".codUnavailable"),d=a.find("p").length;0===b.length&&0===c.length||1!==d||a.hide()}}var J=a.$,Va=!0,C={},hb={cardImages:"#newCreditCardImages",continueBtns:".continue-buttons:not(.place-order-button)",continueBtnTop:"#continue-top",continueBtnBottom:"#continue-bottom",continueErrPopover:".continue-button-errors",cvvColumnLabel:"#cvvColumnLabel",
existingPaymentForm:"form.checkout-page-form",netBankingSelect:"#net-banking-select-list",morePaymentMethodsSelect:"#more-payment-methods-select-list",newVDC:"#new-vdc",newEMI:"#newEmiCard",orderSummaryBottom:"#order-summary-bottom",pageContainer:"div.a-container",paymentRows:"#existing-payment-methods .payment-row",rewardsRegister:"#rewards-register",addressChallengeCardList:".address-challenge-card",hiddenFormFields:"#hiddenFormFields",jppoints:"#jppoints",gcpromo:"#gcPromo",disableSubmitButtons:"#disableSubmitButtons",
hideInputBoxes:"#hideInputBoxes",showAmexWarning:"#showAmexWarning",existingPincodeNum:"#existingPincodeNum",mcbBalanceWarning:"#mcbBalanceWarning",installmentsOnlyCards:".installments-only-card",ovdWidgetSection:"#ovdWidgetSection"};a.on("checkout:reload:payselect",pa);a.on("checkout:reload:spp-payment",pa);return{getSelectedPayment:I}});"use strict";q.when("A","page-detector").register("wechat-detector",function(a,l){var g=a.$,c=function(a){a&&!1!==a.isWeChatInstalled&&(a=g("#wechat_payment"),a.length&&
a.show())},d=function(a){},f="MShopWeChatPayment";a.on("checkout:reload:payselect",function(){g("#wechat_payment").length&&(g("#mShopWeChatApiName").length&&(f=g("#mShopWeChatApiName").val()),q.when("safe-mash").execute(function(a){p.cordova.require("cordova/exec")(c,d,f,"isWeChatInstalled",[])}))})});"use strict";q.when("A","page-main","client-side-metrics","ready").register("otp-for-cod",function(a,l,g){function c(){z=u("#cashOnDeliveryCash");if(z.length&&(w=z.find(x.verifyOTP),B=z.find(x.sendOTP),
I=w.length&&B.length,da=u(x.payMobile).length?1:0,I&&(r=z.find(x.submitSendOTP),t=z.find(x.submitVerifyOTP),p=z.find(x.submitResendOTP),y=z.find(x.changeOTPNumber),q=z.find(x.OTPPhoneNumber),E=z.find(x.otpCode),r.length&&t.length&&p.length&&y.length))){W=z.find(x.addURLHash).length;g.increaseCount(O.metricPrefix+O.block,1,1);r.click(function(){v();g.increaseCount(O.metricPrefix+O.send,1,1)});t.click(function(){P=q.val();U=E.val();m();var a=f(P),c;c=/^\d{6}$/;c=U&&c.test(U);a&&c&&""!==D?b("VerifyOTP",
D):c?a||z.find(x.otpServiceFailed).removeClass(x.aokHidden):z.find(x.invalidOTPError).removeClass(x.aokHidden);g.increaseCount(O.metricPrefix+O.verify,1,1)});if(W&&location.hash&&location.hash.length){for(var a=location.hash,a=a.replace("#",""),a=a.split(";"),c=0;c<a.length;c++)0<=a[c].indexOf(L.codehandle)&&(D=a[c].replace(L.codehandle,"")),0<=a[c].indexOf(L.contactid)&&(N=a[c].replace(L.contactid,"")),0<=a[c].indexOf(L.phonenumber)&&(P=a[c].replace(L.phonenumber,""),q.val(P));""!==D&&""!==N&&""!==
P&&h()}p.click(function(){g.increaseCount(O.metricPrefix+O.resend,1,1);v()});y.click(function(){w.addClass(x.aokHidden);B.removeClass(x.aokHidden);d(p,!1);d(t,!1);m();g.increaseCount(O.metricPrefix+O.changeNumber,1,1)})}}function d(a,b){b?a.addClass(x.aButtonDisabled):a.removeClass(x.aButtonDisabled);da?a.find("button").prop("disabled",b):a.find("input").prop("disabled",b)}function f(a){var b=/^\d{10}$/;return a&&b.test(a)}function k(){z.find(x.otpServiceFailed).removeClass(x.aokHidden)}function h(){var a=
z.find(x.verifyOTPPhoneNumber);z.find(x.invalidPhoneNumber).addClass(x.aokHidden);B.hasClass(x.aokHidden)?z.find(x.otpResentSuccess).removeClass(x.aokHidden):da&&z.find(x.otpSentSuccess).removeClass(x.aokHidden);B.addClass(x.aokHidden);w.removeClass(x.aokHidden);var b=P.substr(0,2)+"*****"+P.substr(7,9);a.text(b);d(p,!1)}function e(a){if(a!==F&&"object"!==typeof a)try{a=u.parseJSON(a)}catch(b){a={}}a=a||{};var c,d=W&&location.hash?location.hash:"#";W&&location.hash&&";"!==d.slice(-1)&&(d+=";");c=
a.status;a.codeHandle&&null!==a.codeHandle&&(D=a.codeHandle,W&&"SEND-SUCCESS"===c&&(d=n(d,L.codehandle,D)));a.contactId&&null!==a.contactId&&(N=a.contactId,W&&"SEND-SUCCESS"===c&&(d=n(d,L.contactid,N),d=n(d,L.phonenumber,P)));W&&(location.hash=d);z.find(x.otpAlertClass).addClass(x.aokHidden);if(V[c])V[c]();else V.DEFAULT()}function n(a,b,c){var d=a.indexOf(b);if(0<=d){var e=a.indexOf(";",d),e=0<=e?e:a.length;a=a.substring(0,d)+a.substring(e+1,a.length+1)}return a+b+c+";"}function b(b,c){a.ajax("/gp/buy/payselect/handlers/otpAjaxHandler.html",
{method:"get",params:{phoneNumber:P,method:b,codeHandle:c,contactId:N,otp:U},success:e,error:function(){e({status:"SERVICE-FAILED"})}})}function m(){E.val("");z.find(x.otpAlertClass).addClass(x.aokHidden)}function v(){m();P=q.val();f(P)?b("SendOTP",D):z.find(x.invalidPhoneNumber).removeClass(x.aokHidden)}var u=a.$,z,w,B,r,t,p,y,q,E,I,da,W,P="",D="",N="",U="",x={aokHidden:"aok-hidden",aRadio:".a-radio",aButtonHidden:"a-button-hidden",aButtonDisabled:"a-button-disabled",payMobile:".pay-mobile",invalidOTPError:".invalidOTPError",
verifyOTP:"#verifyOTP",sendOTP:"#sendOTP",submitSendOTP:"#submitSendOTP",submitVerifyOTP:"#submitVerifyOTP",submitResendOTP:"#submitResendOTP",changeOTPNumber:"#changeOTPNumber",OTPPhoneNumber:"#OTPPhoneNumber",otpCode:"#otpCode",cashOnDeliveryCash:"#cashOnDeliveryCash",invalidPhoneNumber:".invalidPhoneNumber",otpServiceFailed:".otpServiceFailed",enterOTPLabel:"#enterOTPLabel",reEnterOTPLabel:"#reEnterOTPLabel",maxOTPError:".maxOTPError",numberAlreadyUsed:".numberAlreadyUsed",verifiedOTPSuccess:".verifiedOTPSuccess",
verifyOTPPhoneNumber:"#verifyOTPPhoneNumber",otpResentSuccess:".otpResentSuccess",otpSentSuccess:".otpSentSuccess",otpAlertClass:".otpAlertClass",phonenumberNotVerified:"phonenumberNotVerified",addURLHash:".addURLHash"},L={codehandle:"codehandle:",contactid:"contactid:",phonenumber:"phonenumber:"},O={metricPrefix:"PayPage-COD-OTP-",block:"Block",send:"Send",verify:"Verify",resend:"ReSend",changeNumber:"ChangeNumber"},V={"SERVICE-FAILED":k,"SEND-SUCCESS":h,"VERIFY-SUCCESS":function(){B.addClass(x.aokHidden);
w.addClass(x.aokHidden);z.find(x.verifiedOTPSuccess).removeClass(x.aokHidden);z.find("."+x.phonenumberNotVerified).removeClass(x.phonenumberNotVerified);da&&l.setContinueButtonStatus(!0)},"INVALID-NUMBER":function(){z.find(x.invalidPhoneNumber).removeClass(x.aokHidden)},"NUMBER-ALREADY-USED":function(){d(p,!0);d(t,!0);z.find(x.numberAlreadyUsed).removeClass(x.aokHidden)},"MAX-OTP-REACHED":function(){z.find(x.maxOTPError).removeClass(x.aokHidden);d(p,!0)},"INVALID-OTP":function(){z.find(x.invalidOTPError).removeClass(x.aokHidden);
E.val("");da?E.attr("placeholder","Re-enter OTP"):(z.find(x.enterOTPLabel).addClass(x.aokHidden),z.find(x.reEnterOTPLabel).removeClass(x.aokHidden))},DEFAULT:k};a.on("checkout:reload:payselect",c);a.on("checkout:reload:spp-payment",c)});"use strict";q.when("A","pay-common-util","ready").execute(function(a,l){var g={productGls:"#productGls",gcTypes:"#gcDeliveryTypes",device:"#device"},c=l.getElements(g);a.on("checkout:payment:challenge:log",function(d){var f={},k;for(k in g)g.hasOwnProperty(k)&&c[k]&&
c[k].val()&&(f[k]=c[k].val());d&&(f.paymentInstrumentId=d);Object.keys&&Object.keys(f).length&&a.ajax("/gp/buy/payselect/handlers/log-payment-challenge.html?ref_\x3dcheckout-payment-challenge",{method:"POST",params:f,timeout:1E3,cache:!1})})});"use strict";q.when("A","page-spinner-controller","page-main","page-transition-controller","page-conductor","client-side-metrics","button-blocker","ready").register("pay-auth",function(a,l,g,c,d,f,k){function h(){var a=m("#otp_id").val(),b=/^\d{6}$/;a&&b.test(a)?
k.hide("pay-auth-otp-checks"):(a=m("#otp_invalid_msg").val(),k.show("pay-auth-otp-checks",a))}function e(b,c){l.show();a.ajax("validate-otp.html",{method:"post",params:{otp_name:b,paystationRequestId:c},success:function(a){!a||"APPROVED"!==a.status&&"PENDING"!==a.status?(m("#otp_id").addClass("a-form-error"),m("#otpBadCode").removeClass("hidden"),l.hide()):(m("#isFormValidated").val("1"),u.submit())},error:function(a){l.hide()}})}function n(){m("#otp_id").removeClass("a-form-error");m("#otpBadCode").addClass("hidden")}
function b(){f.increaseCount(z.metricPrefix+z.resend,1,1);var b="1"===m("#isPaystationFlow").val(),c;b?(c="resend-otp.html?returnHtml\x3d0\x26isPaystationFlow\x3d1",l.show()):c="resend-otp.html?returnHtml\x3d0";a.ajax(c,{method:"get",success:function(a){b&&(a&&1===a.successful&&(m("#authSourceId").val(a.authSourceId),m("#paystationRequestId").val(a.paystationRequestId)),l.hide())},error:function(a){b&&l.hide()}})}var m=a.$,v,u,z={metricPrefix:"Payauth-",resend:"Resend"};a.on("checkout:reload:payauth",
function(){v=m("#resend_form");u=m("#otp_form");u.submit(function(a){var b=m(a.currentTarget);if("1"===b.find('input[id\x3d"isPaystationFlow"]').val()&&(n(),"1"!==b.find('input[id\x3d"isFormValidated"]').val()))return a=b.find('input[id\x3d"otp_id"]').val(),b=b.find('input[id\x3d"paystationRequestId"]').val(),e(a,b),!1});v.submit(function(a){"1"===m("#isPaystationFlow").val()&&n();b();return!1});h();m("#otp_id").unbind("keyup").bind("keyup",h)})});"use strict";q.when("A","ajax-utility","client-side-metrics",
"loading-spinner-controller","pay-common-lib","pay-common-util","page-conductor","page-transition-controller","quantity-service","weblab-helper").register("pay-gil",function(a,l,g,c,d,f,k,h,e,n){function b(a){G=a.popover;var b=r(G);q("#gil-estimates-popover-"+b+" .gil-popover-content").html("");q("#gil-estimates-popover-"+b+" .gil-popover-error").html("");a.popover.updatePosition(!0)}function m(a){G=a.popover;var b=r(G),d=q("#gil-estimates-popover-"+b);d.find("input[name\x3dgil-subtype]").val(b);
c.showSpinner(d,!1,G);a="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime();var e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(b);q.ajax({type:"POST",url:a,data:e,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return l.jsonify(a)},success:function(a,e,f){r(G)===b&&(g.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverSuccess",1),e=G,c.hideSpinner(d),a&&a.errors&&0<a.errors.length?d.find(".gil-popover-error").show():a&&a.widgetHTML?
d.find(".gil-popover-content").html(decodeURIComponent(a.widgetHTML)):d.find(".gil-popover-error").show(),e.updatePosition(!0))},error:function(a){r(G)===b&&(g.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverError",1),a=G,c.hideSpinner(d),d.find(".gil-popover-error").show(),a.updatePosition(!0))}})}function v(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")}function u(a){a.$event.preventDefault();var b=r(G),d=q("#gil-estimates-popover-"+b);c.showSpinner(d,
!1,G);var f=z(a.$currentTarget.parents("#gil-estimates-popover-"+b));c.showSpinner(d,!1,G);e.callBatch(f,{success:function(c,d,e){r(G)===b&&(g.increaseCount("Checkout:GIL:"+b+":SubmitIneligiblePopoverSuccess",1),v(a),h.show(),1==parseInt(q("input[name\x3d'gil-rendered-using-apx']").val(),10)&&n.isGILCreditCardEnabled()?(c=q(".pmts-select-payment-instrument-form"),d=G,"APX_PSP_TO_RCX_SPC"==(d.attrs?d.attrs("data").onSubmit:d.data.onSubmit)&&c&&0<c.length?k.continueClicked(null,c):g.increaseCount("Checkout:GIL:"+
b+"Popover:ErrorRedirectingToSPC",1)):B(b))},error:function(a){r(G)===b&&(g.increaseCount("Checkout:GIL:"+b+":SubmitIneligiblePopoverError",1),a=G,c.hideSpinner(d),d.find(".gil-popover-error").show(),a.updatePosition(!0))},isTrial:0})}function z(a){var b={};a.find(".gil-ineligible-items").children(".gil-ineligible-item").each(function(a,c){a=q(c).find('input[name^\x3d"ineligible-item"]').val();b[a]=0});return b}function p(a){a.$event.preventDefault();var b=q("#gil-ineligible-"+a.data.subtype).find(".gil-ineligible-items"),
c=b.data("index"),d=b.data("size"),c=(c+("next"===a.data.direction?1:-1)+d)%d,d=(c+1)%d;b.find(".gil-ineligible-item").addClass("aok-hidden").removeClass("a-span-last");a=b.find("#gil-ineligible-item-"+c);d=b.find("#gil-ineligible-item-"+d);a.removeClass("aok-hidden");d.addClass("a-span-last").removeClass("aok-hidden");b.data("index",c)}function B(b){f.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{handler:"new-gil-payment",subtype:b},{successHandler:function(c,d,e){g.increaseCount("Checkout:GIL:"+
b+":NewToExistingSuccess",1);k.ajaxUpdatePage(c,d,e);f.scrollTopTo(q("#existing-payment-methods [value\x3d"+b+"]"));if(k.isSPP())a.on("checkout:afterReload",function D(){q("#existing-gil input[value\x3d"+b+"]").trigger("click");a.off("checkout:afterReload",D)});else q("#existing-gil input[value\x3d"+b+"]").trigger("click")},errorHandler:function(a,c,d){g.increaseCount("Checkout:GIL:"+b+":NewToExistingError",1);k.ajaxUpdatePage(a,c,d)}})}function r(a){return a.attrs?a.attrs("data").subtype:a.data.subtype}
function t(){y&&(a.declarative("gil-close-popover",["click"],v),a.declarative("gil-submit-popover",["click"],u),a.declarative("gil-ineligible-pagination",["click"],p));q("#gil-cc-payment-type").length&&(a.off("a:popover:beforeShow:gil-estimates",b),a.off("a:popover:show:gil-estimates",m),a.on("a:popover:beforeShow:gil-estimates",b),a.on("a:popover:show:gil-estimates",m));q("#gil-payment-type").length&&(a.off("a:popover:beforeShow:gil-si-estimates",b),a.off("a:popover:show:gil-si-estimates",m),a.on("a:popover:beforeShow:gil-si-estimates",
b),a.on("a:popover:show:gil-si-estimates",m));y=!1}var q=a.$,y=!0,G;a.on("checkout:reload:payselect",t);a.on("checkout:reload:spp-payment",t);return{submitNewGilPayment:B,displayGILEstimatesMobile:function(a,b,c){var d="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime(),e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(a);f.makeAjaxCall(d,e,{successHandler:function(c,d,e){var f=l.jsonify(c);f&&!f.errors&&f.widgetHTML?g.increaseCount("Checkout:GIL:"+
a+":Mobile:IneligibleSubPageSuccess",1):g.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);b(c,d,e)},errorHandler:function(b){g.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);c(b)}})},actionCloseGilMobileSubpage:function(a){a.$event.preventDefault();q("#gil-estimates-subpage").remove();q(f.pages.main.pageId).show()},actionSubmitGilMobileSubpage:function(a,b,c){a.$event.preventDefault();q("#gil-ineligible-view");var d=z(a.$currentTarget.parents("#gil-ineligible-view"));
e.callBatch(d,{success:function(c,d,e){g.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageSuccess",1);b(c,d,e)},error:function(b){g.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageError",1);c(b)},isTrial:0})}}});"use strict";q.when("A","pay-common-util","page-detector").register("new-verified-debit-card",function(a,l,g){function c(){d=g.isMobile()?l.getElements(f):l.getElements(k);h=d.newVDC.find("#expirationInput");e=d.newVDC.find("#vdcCvvNumInput");
n=d.newVDC.find("#vdcYear");b=d.newVDC.find("#vdcMonth");m=new Date;v=m.getFullYear()+20;u=m.getMonth();0===u&&(u=12,v--)}var d={},f={newVDC:"#new-verified-debit-card"},k={newVDC:"#new-verified-debit-cards-table"},h,e,n,b,m,v,u;return{showExpiryDateAndCvv:function(){c();n.find("option:selected").removeAttr("selected");b.find("option:selected").removeAttr("selected");d.newVDC.find("#isSBIInternationalMaestroSelected").val("0");h.show();e.show()},hideExpiryDateAndCvv:function(){c();var a=b.val(u).find("option[value\x3d"+
u+"]"),f=n.val(v).find("option[value\x3d"+v+"]");a.attr("selected",!0);f.attr("selected",!0);d.newVDC.find("#isSBIInternationalMaestroSelected").val("1");h.hide();e.hide()}}});"use strict";q.when().register("recommendation-helper",function(){return{}});"use strict";q.when("A").register("apb-limit-messaging-helper",function(a){var l=a.$;return{renderAPBMessagingRemainingBalance:function(a,c,d,f){var k=l(".am-balance").html(),h=a.remainingBalance,e=a.purchaseTotal,n=a.isPurchaseTotalInSpan;0<c-d?h=
e:0>c-f&&(h=k);n?a.balanceApplied.html(h):a.balanceApplied.text(h)},displayAPBRedeemableLimitExhaustedMessaging:function(a){a.gcRadioContainer.addClass("hidden");a.gcCheckboxContainer.addClass("hidden");a.gcCheckbox.attr("disabled","disabled");a.gcRadio.attr("disabled","disabled");a.shortMsg.hide();a.longMsg.hide();a.amazonMoneyLimitBreachedMsg.removeClass("hidden");a.amazonMoneyLimitBreachedMsg.show()},renderAPBInsufficientMessaging:function(a,c,d){c==d?(a.shortMsg.show(),a.longMsg.hide()):(a.longMsg.show(),
a.shortMsg.hide())}}});"use strict";q.when("A","jQuery","client-side-metrics","ready").register("temporary-preference-indicator",function(a,l,g){function c(){d()&&l.ajax({type:"GET",url:"/gp/shopwithpoints/temporaryPreference/has-active-temporary-preference.html",async:!0,dataType:"json",success:function(a){a.hasOwnProperty("Result")?(f=a.Result,g.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::Ajax::Success",1),g.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::TPPCheckBackendCall::Success",
1)):g.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::TPPCheckBackendCall::Failure",1)},error:function(){g.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::Ajax::Failure",1)}})}function d(){return"1"===l("meta[name\x3dSWP_TPP_FEATURE_ENABLED]").attr("content")}var f="False";a.on("checkout:reload:payselect",c);a.on("checkout:reload:spp-payment",c);a.on("checkout:reload:pay",c);return{hasActiveTemporaryPreference:function(){return"True"===f},isTemporaryPaymentPreferenceFeatureEnabled:d}});
q.when().register("rentals-ineligible-util",function(){return{}});q.when().register("rentals-ineligible",function(){return{}});"use strict";q.when("A","cvf","page-detector","weblab-helper","ready").register("cvf-old-amazon-aui-fixes",function(a,l,g,c){function d(){a.$(".cvf-widget-form .a-button-dropdown .a-button-text").css("text-overflow","unset")}function f(){var a=m(this).parent(),b=a.find(".a-native-dropdown option")[0];if(b&&b.hasAttribute("data-a-html-content")){var c=[];a.find(".cvf-widget-input.a-native-dropdown option").each(function(){c.push({phone_country_code:m(this).data("a-html-content"),
country_iso:m(this).val()})});var d=setInterval(function(){if(m(".a-popover-inner ul").length){var a="rtl"===m("html").attr("dir");m(".a-popover-inner ul").addClass("a-cvf-list-link");m.each(c,function(b,c){if(b=c.phone_country_code){if(a){b=b.split("+");var d=b[1];b=b[0].trim()+" "+d+"+"}m(".a-popover-inner [data-value\x3d'"+c.country_iso+"']").html(b)}});clearInterval(d)}},0)}m(".cvf-widget-form .a-button-dropdown").die("click")}function k(){var a=m(this).data("value");m(".cvf-widget-form .a-native-dropdown.cvf-widget-input").val(a).change()}
function h(){var a=m(this).parent().find(".a-dropdown-prompt"),b=m(this).find("option:selected").html().trim(),c=setTimeout(function(){a.html(b);clearTimeout(c)},0)}function e(){a.$(".cvf-widget-form .a-alert-inline.cvf-hidden").remove()}function n(){0===m(".cvf-widget-form").length&&(m("#apx-content .a-alert-info").first().remove(),m("[data-testid\x3d'pmts-cod-cash-description']").closest(".pmts-portal-component").find(".a-radio input").trigger("click"))}function b(){if(!v)if(u)a.on("a:pageUpdate a:ajax:complete",
e);else a.on("a:pageUpdate a:ajax:complete",d),m(".cvf-widget-form .a-button-dropdown").live("click",f),m(".a-cvf-list-link a").live("click",k),m(".cvf-widget-input.a-native-dropdown").live("change",h);a.on("cvf:verification:complete",n)}var m=a.$,v=g.isMobile(),u=p.P&&p.P.AUI_BUILD_DATE;c.isCvfOldAmazonUiFixesEnabled()&&(a.on("checkout:reload:payselect",b),a.on("checkout:reload:spp-payment",b))});"use strict";q.when("A","page-detector").register("alipay-detector",function(a,l){var g=a.$,c=function(){var a=
g("input[name\x3d'isAlipayAppPayment']");0<a.length&&l.isMobileSpc&&a.val("1")},d=function(a){},f=function(){var a=g("input[name\x3d'isAlipayRedirect']");0<a.length&&l.isMobileSpc&&a.val("1")},k=function(a){};a.on("checkout:reload:spc",function(){g("input[name\x3d'isAlipayAppPayment']").length&&q.when("safe-mash").execute(function(a){a=p.cordova.require("cordova/exec");a(c,d,"AlipayPlugin","isAlipayInstalled",[]);g("input[name\x3d'isAlipayRedirect']").length&&a(f,k,"AlipayPlugin","isAlipayFailReturnSupported",
[])})})});"use strict";q.when("A","page-transition-controller","page-detector").execute(function(a,l,g){function c(){var a=d("#backButtonProtection");a.length&&"1"===a.val()&&(l.showPageTransition(),document.location.reload())}var d=a.$;q.register("back-button-protection",function(){return{markAsDirty:function(){d("#backButtonProtection").val(1)}}});a.on("checkout:reload:spc",c);a.on("checkout:reload:spp-revieworder",c)});"use strict";q.when("A","page-transition-controller","loading-spinner-controller",
"ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","delivery-preferences-csm-helper").register("delivery-preferences-controller",function(a,l,g,c,d,f,k,h,e){function n(){k.isTabletSpc()&&(t=r("#spc-orders .delivery-preferences-options"),w(),t.find("select").trigger("change"),u())}function b(){var a=t.find("input[name\x3dpreference]:checked").val(),b=t.find("select[name\x3dSafePlaceLocation]");"NeighborDelivery"===a?(t.find("input[name\x3dneighbor-name]").removeAttr("disabled").removeClass("a-form-disabled"),
t.find("input[name\x3dneighbor-house]").removeAttr("disabled").removeClass("a-form-disabled"),d.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),t.find(".safe-place-error").hide()):"SafePlaceDelivery"===a?(d.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"enabled"})}):b.removeAttr("disabled").closest(".a-button").removeClass("a-button-disabled"),
t.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),t.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),t.find(".neighbor-name-error").hide(),t.find(".neighbor-house-error").hide()):(t.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),t.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),d.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):
b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),t.find(".neighbor-name-error").hide(),t.find(".neighbor-house-error").hide(),t.find(".safe-place-error").hide());m(!0)}function m(a){var b=t.find("input[name\x3dpreference]:checked").val();t.find(".safe-place-error").hide();t.find(".neighbor-name-error").hide();t.find(".neighbor-house-error").hide();t.find("input").removeClass("a-form-error");t.find("div.a-input-text-wrapper").removeClass("a-form-error");t.find("select").closest(".a-button").removeClass("a-button-error");
0<r("div.spc-tablet").length?t.find(".set-delivery-preferences-button").removeClass("a-button-disabled"):t.find(".set-delivery-preferences-button").show();t.find(".save-disabled").hide();t.find(".current-blocker-content").text("");var c=!1;if("NeighborDelivery"===b){var d=t.find("input[name\x3dneighbor-name]");d.data("defaultValueRemoved")&&d.val()||(t.find(".neighbor-name-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),t.find(".current-blocker-content").html(t.find(".neighbor-name-error-text").text()),
c=!0);d=t.find("input[name\x3dneighbor-house]");d.data("defaultValueRemoved")&&d.val()||(t.find(".neighbor-house-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),t.find(".current-blocker-content").html(t.find(".neighbor-house-error-text").text()),c=!0)}else"SafePlaceDelivery"===b&&(d=t.find("select[name\x3dSafePlaceLocation]"),d.val()||(t.find(".safe-place-error").show(),d.closest(".a-button").addClass("a-button-error"),t.find(".current-blocker-content").html(t.find(".safe-place-error-text").text()),
c=!0));d=r("#disableSaveBtnWhenNoDeliveryPrefSelected").val();if(a&&c||"true"===d&&b===F)0<r("div.spc-tablet").length?t.find(".set-delivery-preferences-button").addClass("a-button-disabled"):t.find(".set-delivery-preferences-button").hide(),t.find(".save-disabled").show();return!c}function v(a){a&&a.$event&&a.$event.preventDefault();a="hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26";var b="",f=t.find(".popover-deliv-prefs-content");f.data("obfuscatedEntityId")?
b=f.data("obfuscatedEntityId"):t.data("obfuscatedEntityId")&&(b=t.data("obfuscatedEntityId"));a+="obfuscatedEntityId\x3d"+b+"\x26";b=t.find("input[name\x3dpreference]:checked").val();""!==b&&(a+="prefDelLocation\x3d"+b+"\x26","NeighborDelivery"===b?(a+="neighborName\x3d"+encodeURIComponent(t.find("input[name\x3dneighbor-name]").val())+"\x26",a+="houseNo\x3d"+encodeURIComponent(t.find("input[name\x3dneighbor-house]").val())+"\x26"):"SafePlaceDelivery"===b&&(a+="safePlaceLocation\x3d"+t.find("select[name\x3dSafePlaceLocation]").val()+
"\x26"),b=t.find("input[name\x3ddefaultPreference]:checked").val(),b!==F&&""!==b&&(a+="isDefaultPreference\x3d1"));0<r("div.spc-tablet").length?l.show():g.showSpinner(t.find(".popover-deliv-prefs-content"),!1,H);e.recordCSMWithCurrentFieldValues("popover-submitted","preference","defaultPreference");r.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-delivery-preference.html",data:a,dataType:"text",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc",
"x-amz-checkout-transition":"ajax"},success:function(a,b,e){y=!0;0<r("div.spc-tablet").length?l.hide():g.hideSpinner(t.find(".popover-deliv-prefs-content"));e.getResponseHeader("x-amz-checkout-page")?(t.find(".a-button-close").trigger("click"),d.ajaxUpdatePage(a,b,e)):(a=c.jsonify(a),d.redirect(a));h.increaseCount("checkoutSpcDeliveryPref-save",1)},error:function(a,b,c){0<r("div.spc-tablet").length?l.hide():g.hideSpinner(t.find(".popover-deliv-prefs-content"));m(!0)}})}function u(){t.find("input[name\x3d'neighbor-name'], input[name\x3d'neighbor-house']").unbind("focus").bind("focus",
function(){if(!r(this).data("defaultValueRemoved")){if(k.isMobileSpc()||k.isDesktopSpc())r(this).val(""),r(this).css("color","black");r(this).data("defaultValueRemoved",!0)}}).each(function(){(k.isMobileSpc()||k.isDesktopSpc())&&r(this).data("defaultValueRemoved")&&r(this).css("color","black")});t.find("input:radio[name\x3dpreference]").unbind("click").bind("click",b);t.find("input[name^\x3dneighbor]").unbind("keyup").bind("keyup",function(){m(!1)});0<r("div.spc-tablet").length?t.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",
p):t.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",function(){m(!1)})}function p(a){m(!0)&&v(a)}function w(a){var b=r("#spc-orders .delivery-preferences-options"),c,d="";a?(c=a.$currentTarget.find("input"),d=b.find("input[name\x3dpreference]:checked").val()):c=b.find("input[name\x3dpreference]:checked");b=c.val();if(d!==b){t.find(".expand-content").hide();var d=c,e=d.closest(".delivery-preferences-options");e.find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
e.find("input").attr("checked",!1);d.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");d.attr("checked",!0);"NeighborDelivery"===b||"SafePlaceDelivery"===b?c.closest(".deliverypreference-option").siblings(".expand-content").show():a&&v(a)}}function B(a){(a=t.find("#delivery-preferences-set-default-checkbox"))&&1===a.length&&(a.prop("checked")?h.increaseCount("checkoutSpcDeliveryPref-setAsDefault",1):h.increaseCount("checkoutSpcDeliveryPref-setAsTemporary",
1))}var r=a.$;if(!r("html").hasClass("a-ie6")){var t,H,y;a.on("a:popover:beforeShow",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-delivprefs")&&(a.popover.$popover.find(".a-popover-inner").html(t.find(".current-blocker-content").text()),a.popover.updatePosition())});a.on("a:popover:show",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(h.increaseCount("checkoutSpcDeliveryPref-open",1),H=a.popover,t=H.$popover,y=!1,u(),e.recordCSMWithCurrentFieldValues("popover-displayed",
"preference","defaultPreference"),b(),t.find("select").trigger("change"))});a.on("a:popover:dismiss",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(y||h.increaseCount("checkoutSpcDeliveryPref-dismissed",1))});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(y||e.recordCSM("popover-dismissed"))});a.declarative("delivery-preferences-switch-tablet",["click"],function(a){w(a)});a.declarative("delivery-preferences-expander-toggle",
["click"],function(a){f.toggleExpanderContent(a)});a.declarative("set-delivery-preferences",["click","touchend"],function(a){a.$event.preventDefault();f.protectAgainstDoubleAction("set-delivery-preferences")||m(!0)&&v()});a.declarative("delivery-preferences-set-default-checkbox-triggered","change",B);a.on("checkout:reload:spc",n)}});"use strict";q.when("A","page-detector","time-left-formatter","weblab-helper").register("fast-track-controller",function(a,l,g,c){function d(){for(var b in u)u[b]&&clearInterval(u[b]);
a.defer(f)}function f(){m.DAY=b("#fasttrack-day").html();m.DAYS=b("#fasttrack-days").html();m.HOUR=b("#fasttrack-hour").html();m.HOURS=b("#fasttrack-hours").html();m.AND=b("#fasttrack-and").html();m.MINUTE=b("#fasttrack-minute").html();m.MINUTES=b("#fasttrack-minutes").html();m.SECOND=b("#fasttrack-second").html();m.SECONDS=b("#fasttrack-seconds").html();(b("#isfresh").length&&b(".checkout.spc-mobile").length||b("#lazy-fresh-promise-delivery-message").length?b("#spc-form"):b("#spc-orders")).find(".fasttrack-span").each(function(){var d=
b(this),e=d.find("input[name\x3d'countdownId']").val();!c.isDisableGoldBoxTimerFixForFastTrackEnabled()&&c.isTSPCGoldBoxTimerFixEnabled()?isNaN(v[e])&&(v[e]=parseInt(d.find("input[name\x3d'fasttrackExpiration']").val()),p[e]=a.now()/1E3+v[e]):(v[e]=parseInt(d.find("input[name\x3d'fasttrackExpiration']").val()),p[e]=a.now()/1E3+v[e]);k(d.find("input[name\x3d'countdownThreshold']").val(),d,d.find("input[name\x3d'showSimplifiedCountdown']").val(),e);d.show()})}function k(a,b,c,d){0>=v[d]?e(b,null):a&&
0<a&&v[d]>a?b.find("span.fasttrackavailable").hide():(h(b,c),u[d]=setInterval(function(){h(b,c,d)},1E3))}function h(c,d,f){0<v[f]?(v[f]=Math.round(p[f]-a.now()/1E3),d=g.getTimeLeftFormatted(v[f],1===d||"1"===d?!0:!1,m),b("html").hasClass("a-tablet")?c.find("span[data-field\x3d'fasttrackcountdown']").html("\x26nbsp;"+d):c.find("span[data-field\x3d'fasttrackcountdown']").html(d),c.find("span.fasttrackexpired").hide(),c.find("span.fasttrackcountdown").show(),c.find("span.fasttrackavailable").show()):
e(c,f)}function e(a,b){b?(u[b]&&clearInterval(u[b]),a.find("span.fasttrackavailable").hide(),a.find("span.fasttrackexpired").show()):clearInterval(u[b])}function n(){d()}var b=a.$;if(!b("html").hasClass("a-ie6")){var m={},v={},u={},p={};a.on("checkout:reload:spc",d);a.on("checkout:reload:spp-revieworder",d);return{spcLiteLazyLoadFastTrack:n}}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","client-side-metrics").register("gc-redeem-controller",function(a,l,g,
c,d){function f(a){if(!v){a.preventDefault();m(a.currentTarget);var b;0<m("#spc-gcpromoinput").length&&(b=encodeURIComponent(m("#spc-gcpromoinput").val()));0<m("#gc-promo-input").length&&(b=encodeURIComponent(m("#gc-promo-input").val()));var d=encodeURIComponent(m("#spc-usePromoOnly").val());if(b&&0!==b.length){var f=encodeURIComponent(m("input[name\x3dpurchaseTotal]").val());m("#gc-error").hide();m("#gc-promo-success").hide();m("#gc-success").hide();m("#gc-ineligible").hide();m("#promo-success").hide();
c.isSPP()?(l.blockAllActions(),l.showTransitionInContainer(m("#payment"))):l.show();var h=(new Date).getTime();a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_pay_page_gc_add";m(".checkout.spc.aui-templatized").length&&(a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_spc_gc_add");b="purchaseTotal\x3d"+f+"\x26claimcode\x3d"+b+"\x26disablegc\x3d"+d+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+m("input[name\x3dfromAnywhere]").val()+
"\x26cachebuster\x3d"+h;d=c.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});m.ajax({type:"POST",url:a,data:b,headers:d,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){v=!1},success:k,error:c.ajaxRedirect});v=!0}else e("addGiftCardOrPromo_NoCode")}}function k(a,b,d){var f=d.getResponseHeader("x-amz-checkout-page");if(f){if(c.ajaxUpdatePage(a,b,d),"spc"===f||"spclite"===f||"spp-revieworder"===
f)(a=parseInt(m("#checkoutDisplayPage").data("delaySetTitle"),10)||parseInt(m("#gc-promo-delay").data("egcDelayUpdateRedemptionMessage"),10)||0)?setTimeout(function(){h(d)},a):h(d)}else{a=g.jsonify(a);if(!a)return c.redirect();if(a.error)return e(a.error);if(a.errors)return e(a.errors);if(a.autohandlererror)return n(a.autohandlererror);c.redirect(a)}}function h(a){var c=a.getResponseHeader("x-updated-promo-type");a=a.getResponseHeader("x-updated-gc-applied-but-ineligible");c&&(a||m("#gc-promo-success").show(),
0<m("div.spc-desktop").length?(m("#spc-gcpromoinput").removeClass("a-form-error"),m("#gc-promo-input").removeClass("a-form-error")):(m("#spc-gcpromoinput").closest(".a-input-text-wrapper").removeClass("a-form-error"),m("#gc-promo-input").closest(".a-input-text-wrapper").removeClass("a-form-error")),"giftcard"===c?(b("applied"),a?(m("#gc-ineligible").show(),b("gcIneligible")):m("#gc-success").show()):m("#promo-success").show())}function e(a){l.hide();m("#gc-error p").hide();m("#gc-error").show();b("error");
0<m("div.spc-desktop").length?(m("#spc-gcpromoinput").addClass("a-form-error"),m("#gc-promo-input").addClass("a-form-error")):(m("#spc-gcpromoinput").closest(".a-input-text-wrapper").addClass("a-form-error"),m("#gc-promo-input").closest(".a-input-text-wrapper").addClass("a-form-error"));m(0<m("#gc-promo-input").length?"."+u[a]:"#"+a).show()}function n(a){if(a){var b=a.action,c="/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(a.type?a.type:b&&b.code?b.code:"string"===typeof a?
a:"Unknown:pipelineJSError");"fatal"===b?c+="\x26errorAction\x3dfatal":"redirect"===b&&(a.url?c=a.url:"cart"===a.page&&(c="/gp/cart/view.html"));p.location.href=c}else p.location.href="/gp/buy/payselect/handlers/error.html?errorType\x3dUnknown:pipelineJSError"}function b(b){var c=a.state("cxt-gc-redemption-method").method;d.increaseCount("rcxGCRedeem:"+c+":"+b,1)}var m=a.$,v=!1;if(!m("html").hasClass("a-ie6")){a.state("cxt-gc-redemption-method",{method:"type"});var u={addGiftCardOrPromo_Unknown:"UNKNOWN",
addGiftCardOrPromo_NoCode:"NO_CODE",addPromo_InvalidForPurchase:"PROMO_INVALID_FOR_PURCHASE",addPromo_BadCode:"PROMO_BAD_CODE",addPromo_ExpiredCode:"PROMO_EXPIRED_CODE",addPromo_InvalidForOrgUnit:"PROMO_INVALID_FOR_ORG_UNIT",addPromo_OfferNotYetBegun:"USED_BEFORE_START_DATE",addPromo_AlreadyRedeemed:"PROMO_ALREADY_REDEEMED",addGiftCard_AlreadyRedeemedByAnotherAccount:"GC_ALREADY_REDEEMED_BY_ANOTHER_ACCOUNT",addGiftCard_AlreadyRedeemedByThisAccount:"GC_ALREADY_REDEEMED_BY_THIS_ACCOUNT",addGiftCard_BadCode:"GC_BAD_CODE",
addGiftCard_ExpiredCode:"GC_EXPIRED_CODE",addGiftCard_Cancelled:"CANCELLED_CODE",addGiftCard_WrongOrgUnit:"GC_WRONG_ORG_UNIT",addGiftCard_ServiceDown:"GC_SERVICE_DOWN",addGiftCard_InvalidForAGS:"GC_INVALID_FOR_AGS",addGiftCard_PassedClaimByDate:"PASSED_CLAIM_BY_DATE",addGiftCard_OfferNotYetBegun:"GC_NOT_YET_BEGUN",addGiftCard_ExceededMaxLimit:"GC_EXCEED_MAX_LIMIT",addGiftCard_Disabled:"GC_DISABLED",addGiftCard_OTP_Required:"GC_OTP_REQUIRED",addGiftCard_SEVIS_Decline:"GC_SEVIS_DECLINE",addGiftCard_OCRAH_Decline:"GC_OCRAH_DECLINE",
addGiftCard_DEFAULT_Message:"GC_DEFAULT_MESSAGE"};a.declarative("gc-element",["click"],function(a){var b=a.data.click;b&&null!==b&&f(a.$event)});a.on("a:expander:redeem-gc-expander:toggle:expand",function(a){d.increaseCount("checkout:spp-payment:expand_addgc_coll",1)});m(document).delegate("#spc-gcpromoinput, #gc-promo-input","keypress",function(a){13===a.which&&f(a)});return{actionAddGiftPromotion:f,giftSystemErrorHandling:n}}});"use strict";q.when("A","page-transition-controller","loading-spinner-controller",
"ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","gift-utility","weblab-helper").register("gift-popover-controller",function(a,l,g,c,d,f,k,h,e,n){function b(){var a=T;a.find("#select-recipient").empty();for(var b=0;b<ha.length;b++){var c=K("\x3coption/\x3e").attr({value:ha[b].value}).text(ha[b].text);a.find("#select-recipient").append(c)}oa&&(b=a.find('#select-recipient option[value\x3d"'+oa+'"]').attr("selected","selected"),a.find("#select-recipient").closest("#popover-gift-connection-recipient").find(".a-placeholder").text(b.text()),
ka())}function m(){a.defer(function(){K("#spc-orders").find(".gift-popover-link").each(function(){K(this).data("action")&&K(this).removeAttr("href").attr("tabindex",0)})});K(".larger-image-link").find("a").removeAttr("href")}function v(a){var c=T;c.find(".gift-error-box").hide();c.find(".fake-label").each(function(){K(this).unbind("click").bind("click",function(){K(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&c.find(".popover-gift-top .gift-item-title span").html(a.item.title);
a&&a.item&&a.item.isAutoripEligible?c.find("#gift-autorip-unavailable-msg").show():c.find("#gift-autorip-unavailable-msg").hide();if(a&&a.obfuscatedEntityId){var d=c.find(".set-gift-options-button input");d.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,giftData:a},u);f.bindActionEnterKeyOnButton(d)}la?(ia=a&&a.item&&a.item.isAmazonFulfilled,wa=!(a&&a.address&&0===a.address.shipToSelf),ia&&(a&&a.options&&a.options.canHaveMessage||a&&a.options&&a.options.canBeWrapped)?(B(!0),
c.find(".mfn-hide-prices").hide(),c.find(".include-gift-receipt").show()):ia||(B(!0),c.find(".include-gift-receipt").hide(),c.find(".mfn-hide-prices").show(),c.find(".include-gift-message").show()),ya=c.find(".include-gift-message").is(":visible"),G()):a&&a.options&&a.options.canHidePrices?c.find(".hide-prices-checkbox").closest("div").show():c.find(".hide-prices-checkbox").closest("div").hide();a&&a.selected&&(d=M(c.find(".hide-prices-checkbox")),a.selected.hidePrices?d.attr("checked",!0):d.removeAttr("checked"));
if(a&&a.item&&a.item.purchaseIsKindle){if(d=c.find(".kindle-registration-box"),d.show(),d.find(".register-kindle-customer-name").html(c.find(".gift-customer-name").html()),!la){var d=M(c.find(".kindle-reg-radio-another-account")),h=M(c.find(".kindle-reg-radio-your-account"));a.selected.hidePrices||a.selected.isWrapped?(h.removeAttr("checked"),d.attr("checked",!0)):(d.removeAttr("checked"),h.attr("checked","checked"));M(c.find(".hide-prices-checkbox")).trigger("change")}}else c.find(".kindle-registration-box").hide();
if(a&&a.options&&a.options.canHaveMessage){a&&a.selected&&(d=a.selected.message,h=M(c.find(".include-gift-message-checkbox")),d&&d.length?(c.find("textarea[name\x3d'gift-message-text']").val(d),t(!0)):null===d&&(a.selected.isWrapped||a.selected.hasReceipt)?(h.removeAttr("checked"),c.find(".textarea[name\x3d'gift-message-text']").val("")):(c.find("textarea[name\x3d'gift-message-text']").val(""),d="",la?(d+=c.find(".sample-gift-msg-greeting").html(),a&&a.address&&a.address.firstName&&!wa&&(d+=" "+a.address.firstName),
d=d+",\n"+c.find(".sample-gift-msg").html(),d+="\n"):(d+=c.find(".sample-gift-msg").html(),d+="\n\n"),d+=c.find(".sample-gift-msg-from").text(),d=la?d+e.getNameWithNoTitle(c.find(".gift-customer-name").html()):d+e.getFirstName(c.find(".gift-customer-name").html()),c.find("textarea[name\x3d'gift-message-text']").val(d),!la||wa&&ya||t(!0)));var k=K(".gift-message-warning").length,d=function(){la&&t(!0);D(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);if(k){var b=
T.find("textarea[name\x3d'gift-message-text']");e.toggleGiftMessageWarning(b,T)}};if(a&&a.options){var n=c.find("textarea[name\x3d'gift-message-text']");n.bind("keyup",d);n.bind("mouseup",d);D(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);k&&e.toggleGiftMessageWarning(n,c);M(c.find(".include-gift-message-checkbox")).bind("change",function(){var b=K(this).is(":checked"),d=a.options.maxMessageChars,f=a.options.maxMessageLines,h=a.options.hasFixedGiftMsgLimit,g=
T,l=g.find("textarea[name\x3d'gift-message-text']");b?la&&y():(0<g.find(".validateInputCharactersOnBlur.a-form-error").size()&&(g.find(".validateInputCharactersOnBlur.a-form-error").removeClass("a-form-error"),0<g.find("#onblur-character-validation-error-gift-message-text").size()&&g.find("#onblur-character-validation-error-gift-message-text").remove()),la?G():(l.val(""),D(d,f,h)));k&&e.toggleGiftMessageWarning(n,c)})}}else c.find(".popover-gift-message-text").css("visibility","hidden"),c.find(".include-gift-message").css("visibility",
"hidden"),la&&(c.find(".include-gift-message").hide(),c.find(".popover-gift-message").css("visibility","hidden")),c.find(".popover-gift-message-not-available").show();a&&a.options&&!a.options.canBeWrapped?(c.find(".wrap-option").hide(),c.find(".popover-gift-no-wrap-available").show(),c.find(".hide-prices-amazon-msg").hide(),c.find(".hide-prices-note").hide(),c.find(".hide-prices-merchant-msg").show(),M(c.find(".hide-prices-checkbox")).attr("disabled",!1)):a&&a.item&&a.item.isAmazonFulfilled?(c.find(".wrap-option").hide(),
c.find(".popover-gift-fba-wrap").show(),c.find(".hide-prices-amazon-msg").show(),c.find(".hide-prices-merchant-msg").hide(),(d=a.options.wraps[0].imageurl)&&0<d.length&&(c.find(".large-preview").find("img").attr("src",d),c.find(".large-preview").show(),c.find(".fba-wrap-checkbox").show(),h=c.find(".larger-image-link"),h.unbind("click").bind("click",{imageURL:d},N),f.bindActionEnterKeyOnButton(h)),a.options.wraps[0].description&&c.find(".gift-wrap-title").show().html(a.options.wraps[0].description),
"1"===K("#multipleAFNGiftWrapOption").val()?a.options&&a.options.wraps&&1<=a.options.wraps.length&&(d=c.find(".popover-gift-amazon-wrap"),q(c,d),aa(a,"afn",d)):a.options&&a.options.wraps&&1===a.options.wraps.length?(c.find(".popover-gift-amazon-wrap").hide(),c.find(".popover-gift-merchant-wrap").hide(),c.find(".fba-wrap-checkbox .gift-wrap-price").html(a.options.wraps[0].price),h=M(c.find(".amazon-gift-wrap")),h.val(a.options.wraps[0].id),d=M(c.find(".hide-prices-checkbox")),a.selected.isWrapped?
(h.attr("checked",!0),a.item.purchaseIsKindle||(d.attr("checked",!0),d.attr("disabled",!0),c.find(".hide-prices-note").show())):(h.removeAttr("checked"),d.attr("disabled",!1),c.find(".hide-prices-note").hide())):a.options&&a.options.wraps&&1<a.options.wraps.length&&(d=c.find(".popover-gift-amazon-wrap"),q(c,d),ea(a,"afn",d))):(c.find(".wrap-option").hide(),M(c.find(".hide-prices-checkbox")).removeAttr("disabled"),c.find(".hide-prices-amazon-msg").hide(),c.find(".hide-prices-note").hide(),c.find(".hide-prices-merchant-msg").show(),
c.find(".large-preview").hide(),d=c.find(".popover-gift-merchant-wrap").show(),d.find(".mfn-wrap-copy").remove(),ea(a,"mfn",d));la&&(W(),P(),E());if(0<K(".enable-gift-connections").length){c.find("#popover-gift-connection select.a-touch-select-input").each(function(){K(this).unbind("change").bind("change",function(){var a=K(this),b=a.siblings("a.a-placeholder"),a=a.find(":selected").text();b.text(a);return!1})});c.find("#select-recipient").bind("change",function(a){R(a);return!1});c.find("#select-occasion").bind("change",
function(a){ra(a);return!1});c.find("#input-recipient-first-name").keyup(function(){ka()});c.find("#input-recipient-last-name").keyup(function(){ka()});c.find("#popover-gift-connection-recipient").unbind("click").bind("click",function(a){a=T;ja||a.find("#select-recipient-spinner").show()});oa=F;if(a.giftConnection){typeof a.giftConnection.giftlistTypeId!==F&&"0"===a.giftConnection.giftlistTypeId&&typeof a.giftConnection.occasionId!==F&&"0"===a.giftConnection.occasionId&&c.find("#include-gift-connection-checkbox").attr("checked",
!1);a.giftConnection.firstName&&c.find("#input-recipient-first-name").val(a.giftConnection.firstName);a.giftConnection.lastName&&c.find("#input-recipient-last-name").val(a.giftConnection.lastName);if("1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)d=c.find('#select-recipient option[value\x3d"'+a.giftConnection.giftlistTypeId+'"]').attr("selected","selected"),c.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(d.text()),c.find(".gift-connection-recipient-extra").show();
if(a.giftConnection.giftlistId&&"0"!==a.giftConnection.giftlistId)oa=a.giftConnection.giftlistId;else if("0"===a.giftConnection.giftlistTypeId||"1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)oa=a.giftConnection.giftlistTypeId;a.giftConnection.occasionId&&(d=c.find('#select-occasion option[value\x3d"'+a.giftConnection.occasionId+'"]').attr("selected","selected"),c.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(d.text()));a.giftConnection.occasionMonth&&
(d=c.find('#select-occasion-month option[value\x3d"'+a.giftConnection.occasionMonth+'"]').attr("selected","selected"),c.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text()));a.giftConnection.occasionDay&&(d=c.find('#select-occasion-day option[value\x3d"'+a.giftConnection.occasionDay+'"]').attr("selected","selected"),c.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text()));a.giftConnection.age&&(d=c.find('#select-occasion-age option[value\x3d"'+
a.giftConnection.age+'"]').attr("selected","selected"),c.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(d.text()));if("1"===a.giftConnection.occasionId||"2"===a.giftConnection.occasionId)c.find(".gift-connection-occasion-extra").show(),"2"===a.giftConnection.giftlistTypeId&&c.find("#select-occasion-age-row").show();a.giftConnection.hasReminder&&"0"===a.giftConnection.hasReminder&&c.find("#occasion-has-reminder-checkbox").attr("checked",!1)}(!a.giftConnection||
typeof a.giftConnection.occasionId===F||"1"!==a.giftConnection.occasionId&&"2"!==a.giftConnection.occasionId&&"3"!==a.giftConnection.occasionId)&&ka();ha&&(typeof oa!==F||a.registryId in pa)?(typeof oa===F&&(oa=pa[a.registryId]),b(),c.find("#select-recipient").show(),c.find("#select-recipient-spinner").hide(),ja=!0):(ja=!1,typeof oa!==F?ta():ta(a.registryId))}T.find(".content-container").css("visibility","visible");va.updatePosition(!0);g.hideSpinner(c.find(".popover-content-main"))}function u(a){var b=
T,e="";if(!(0<b.find(".validateInputCharactersOnBlur.a-form-error").size())){a&&a.data&&a.data.obfuscatedentityid&&(e+="obfuscatedEntityId\x3d"+a.data.obfuscatedentityid+"\x26");ia&&(e+="isAFN\x3d1\x26");M(b.find(".include-gift-receipt-checkbox")).is(":checked")&&(e+="includeReceipt\x3d1\x26");M(b.find(".include-gift-message-checkbox")).is(":checked")?(e+="includeMessage\x3d1\x26message\x3d"+encodeURIComponent(b.find("textarea[name\x3d'gift-message-text']").val())+"\x26",e+="maxChars\x3d"+a.data.giftData.options.maxMessageChars+
"\x26",e+="maxLines\x3d"+a.data.giftData.options.maxMessageLines+"\x26"):e+="includeMessage\x3d0\x26";e=M(b.find(".hide-prices-checkbox")).is(":checked")?e+"hidePrices\x3d1\x26":e+"hidePrices\x3d0\x26";b.find(".kindle-registration-box").is(":visible")&&(e+="isKindlePurchase\x3d1\x26");var f;if(b.find(".popover-gift-fba-wrap").is(":visible"))if(b.find(".popover-gift-amazon-wrap").is(":visible")){if((f=b.find("input[name\x3d'afn-gift-wrap']:checked").eq(0).val())&&f.length)for(e+="giftWrap\x3d"+f+"\x26",
f=0;f<a.data.giftData.options.wraps.length;f++)if(b.find(".popover-gift-amazon-wrap").find(".afn-wrap-"+f).is(":checked")){e+="currencyAmount\x3d"+a.data.giftData.options.wraps[f].priceAmount+"\x26";e+="currencyUnit\x3d"+a.data.giftData.options.wraps[f].unit+"\x26";break}}else f=M(b.find(".amazon-gift-wrap")),f.is(":checked")&&(e+="giftWrap\x3d"+f.val()+"\x26",a.data.giftData.options&&(e+="currencyAmount\x3d"+a.data.giftData.options.wraps[0].priceAmount+"\x26",e+="currencyUnit\x3d"+a.data.giftData.options.wraps[0].unit+
"\x26"));else if(b.find(".popover-gift-merchant-wrap").is(":visible")&&(f=b.find("input[name\x3d'mfn-gift-wrap']:checked").eq(0).val())&&f.length)for(e+="giftWrap\x3d"+f+"\x26",f=0;f<a.data.giftData.options.wraps.length;f++)if(b.find(".popover-gift-merchant-wrap").find(".mfn-wrap-"+f).is(":checked")){e+="currencyAmount\x3d"+a.data.giftData.options.wraps[f].priceAmount+"\x26";e+="currencyUnit\x3d"+a.data.giftData.options.wraps[f].unit+"\x26";break}if(0<K(".enable-gift-connections").length)if(b.find("#include-gift-connection-checkbox").is(":checked")){e+=
"includeGiftConnection\x3d1\x26";a=b.find("#select-recipient").val();e+="gcGiftlistTypeId\x3d"+a+"\x26";if("1"===a||"2"===a)e+="gcFirstName\x3d"+b.find("#input-recipient-first-name").val()+"\x26",e+="gcLastName\x3d"+b.find("#input-recipient-last-name").val()+"\x26";f=b.find("#select-occasion").val();e+="gcOccasionId\x3d"+f+"\x26";if("1"===f||"2"===f)e+="gcMonth\x3d"+b.find("#select-occasion-month").val()+"\x26",e+="gcDay\x3d"+b.find("#select-occasion-day").val()+"\x26","1"===f&&"2"===a&&(e+="gcAge\x3d"+
b.find("#select-occasion-age").val()+"\x26"),e+="gcHasReminder\x3d"+(b.find("#occasion-has-reminder-checkbox").is(":checked")?"1":"0")+"\x26"}else e+="includeGiftConnection\x3d0\x26";(a=K("input#executionId").val())&&(e+="executionId\x3d"+a+"\x26");a=(new Date).getTime();e+="isClientTimeBased\x3d"+K("input[name\x3d'useCtb']").val()+"\x26returnjson\x3d1\x26isDecoupleSPC\x3d1\x26hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+a;d.isSPP()&&(va.hide(),a=K("#setOrderingPrefsCheckbox"),
a.length&&a.is(":checked")&&(e+="\x26saveAsDefaultsSelected\x3d1"));l.show();a=d.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});K.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-gift.html",data:e,dataType:"text",async:!0,cache:!1,headers:a,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,e,f){f.getResponseHeader("x-amz-checkout-page")?(d.isSPP()||b.find(".a-button-close").trigger("click"),d.ajaxUpdatePage(a,e,
f)):(a=c.jsonify(a),d.redirect(a))},error:function(a,b,c){d.ajaxRedirect(a,b,c)}})}}function q(a,b){a.find(".fba-wrap-checkbox").hide();a.find(".large-preview").hide();b.show();b.find(".afn-wrap-copy").remove()}function w(){var a=T,b=a.find(".popover-gift-amazon-wrap").is(":visible"),c=M(a.find(".amazon-gift-wrap")),d=M(a.find(".afn-wrap-none")),e=M(a.find(".hide-prices-checkbox"));if(c.is(":checked")||!d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!0),a.find(".hide-prices-note").show();
else if(c.not(":checked")||d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!1),a.find(".hide-prices-note").hide()}function B(a){var b=T,c=M(b.find(".include-gift-receipt-checkbox")),b=M(b.find(".mfn-hide-prices-checkbox"));a?(ia&&!c.is(":checked")&&c.attr("checked",!0).trigger("change"),ia||b.is(":checked")||b.attr("checked",!0).trigger("change")):(ia&&c.is(":checked")&&c.removeAttr("checked").trigger("change"),!ia&&b.is(":checked")&&b.removeAttr("checked").trigger("change"))}function r(a){var b=
T,c=M(b.find(".include-gift-receipt-checkbox")),b=M(b.find(".mfn-hide-prices-checkbox"));a?(B(!0),ia?c.attr("disabled","disabled"):b.attr("disabled","disabled")):ia?c.removeAttr("disabled"):b.removeAttr("disabled")}function t(a){var b=M(T.find(".include-gift-message-checkbox"));a?(b.is(":checked")||b.attr("checked",!0).trigger("change"),H(!1),y()):(b.is(":checked")&&b.removeAttr("checked").trigger("change"),G())}function H(a){var b=T,c=b.find(".no-message-warning"),d=b.find(".no-receipt-warning"),
e=b.find("textarea[name\x3d'gift-message-text']"),b=b.find(".message-remaining-text");a&&!d.is(":visible")?(n.showGiftTextAreaOnWarning()||e.addClass("gift-message-warning"),b.hide(),c.show()):(n.showGiftTextAreaOnWarning()||e.removeClass("gift-message-warning"),c.hide(),b.show())}function y(){var a=T,b=a.find("textarea[name\x3d'gift-message-text']"),a=a.find(".gift-message-label");b.removeClass("gift-message-inactive");a.removeClass("a-color-secondary")}function G(){var a=T,b=a.find("textarea[name\x3d'gift-message-text']"),
a=a.find(".gift-message-label");b.addClass("gift-message-inactive");a.addClass("a-color-secondary")}function E(){var b=T,c=M(b.find(".include-gift-message-checkbox")),d=b.find(".gift-msg-on-card"),e=b.find(".gift-msg-on-receipt"),f=a.trim(b.find(".gift-message-default-placeholder").text()),h=a.trim(b.find(".gift-message-with-wrap-placeholder").text()),g=b.find("textarea"),k=!1;b.find(".amazon-gift-wrap").each(function(){M(K(this)).is(":checked")&&(k=!0)});b.find(".afn-gift-wrap").each(function(){M(K(this)).is(":checked")&&
(k=!0)});b.find(".mfn-gift-wrap").each(function(){M(K(this)).is(":checked")&&(k=!0)});k?(e.hide(),d.show(),g.attr("placeholder",h),ia&&(t(!0),ya&&c.attr("disabled","disabled"))):(d.hide(),ia&&e.show(),g.attr("placeholder",f),c.removeAttr("disabled"))}function I(){var a=T,b=M(a.find(".include-gift-message-checkbox")),a=a.find("textarea[name\x3d'gift-message-text']");!wa&&ia&&(b.is(":checked")&&0<a.val().length?H(!1):H(!0))}function da(){var a=T,b=M(a.find(".include-gift-receipt-checkbox")),c=a.find(".no-receipt-warning"),
a=a.find(".no-message-warning");b.is(":checked")?(c.hide(),ya||t(!0)):(a.hide(),c.show(),t(!1))}function W(a){a=T;var b=M(a.find(".include-gift-receipt-checkbox")),b=ia&&b.is(":checked"),c=M(a.find(".mfn-hide-prices-checkbox")),c=!ia&&c.is(":checked");b||c?(L(),a.find(".kindle-reg-msg-your-account").hide(),a.find(".kindle-reg-msg-another-account").show()):(O(),r(!1),a.find(".kindle-reg-msg-another-account").hide(),a.find(".kindle-reg-msg-your-account").show())}function P(a){a=T;var b=!1;M(a.find(".include-gift-message-checkbox")).is(":checked")&&
(b=!0);var c=!1;a.find(".amazon-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});a.find(".afn-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});a.find(".mfn-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});(b||c)&&B(!0);b&&ya||c?r(!0):r(!1)}function D(a,b,c){var e=T;ca=a;sa=b;if(a=e.find("textarea[name\x3d'gift-message-text']")){b=c?a.val().length:p.unescape(encodeURIComponent(a.val())).length;la&&!wa&&ia&&(0<b?H(!1):H(!0));var f=a.val().split("\n").length;
c=ca-b;f=sa-f;!la&&0<b&&e.find(".include-gift-message-checkbox").not(":checked")&&e.find(".include-gift-message-checkbox").attr("checked",!0);a=a.val().split("\n");for(var h in a)24<a[h].length&&(f=0===a[h].length%24?f-(Math.floor(a[h].length/24)-1):f-Math.floor(a[h].length/24));e.find(".popover-gift-center .remainder-count").hide();(-1>c?e.find(".popover-gift-center .remaining-char-over-multiple").show():0>c?e.find(".popover-gift-center .remaining-char-over-single").show():1===c?e.find(".popover-gift-center .remaining-char-single").show():
e.find(".popover-gift-center .remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(c));(-1>f?e.find(".popover-gift-center .remaining-line-over-multiple").show():0>f?e.find(".popover-gift-center .remaining-line-over-single").show():1===f?e.find(".popover-gift-center .remaining-line-single").show():e.find(".popover-gift-center .remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(f));if(0>c||0>f)d.isSPP()?(e.find(".set-gift-options-button").addClass("aok-hidden"),
e.find(".set-gift-options-button-disabled").removeClass("aok-hidden")):(e.find(".set-gift-options-button").hide(),e.find(".set-gift-options-button-disabled").show()),0>c?(e.find(".gift-char-limit-error").find(".char-limit-error").html(ca),e.find(".current-blocker-content").html(e.find(".gift-char-limit-error").html())):0>f&&(e.find(".gift-line-limit-error").find(".line-limit-error").html(sa),e.find(".current-blocker-content").html(e.find(".gift-line-limit-error").html()));-1<c&&-1<f&&(d.isSPP()?(e.find(".set-gift-options-button").removeClass("aok-hidden"),
e.find(".set-gift-options-button-disabled").addClass("aok-hidden")):(e.find(".set-gift-options-button").show(),e.find(".set-gift-options-button-disabled").hide()))}}function N(a){a.stopPropagation();var b=T;b.find(".popover-content-main").fadeOut(100,function(){b.find(".popover-content-gift-wrap-preview .gift-wrap-preview-image").attr("src",a.data.imageURL);b.find(".popover-content-gift-wrap-preview").fadeIn(100)});var c=b.find(".popover-content-gift-wrap-preview .back-to-gift-options-button");c.unbind("click").bind("click",
U);f.bindActionEnterKeyOnButton(c);xa=!0}function U(a){xa=!1;var b=T;a?b.find(".popover-content-gift-wrap-preview").fadeOut(100,function(){b.find(".popover-content-main").fadeIn(100)}):setTimeout(function(){b.find(".popover-content-gift-wrap-preview").hide();b.find(".popover-content-main").show()},500)}function x(a){var b=T,c=!1;K(".amazon-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});K(".afn-gift-wrap").each(function(){M(K(this)).is(":checked")&&(c=!0)});K(".mfn-gift-wrap").each(function(){M(K(this)).is(":checked")&&
(c=!0)});if(c)L(),V();else if(M(b.find(".hide-prices-checkbox")).is(":disabled"))ba();else if(a.is("input[type\x3dcheckbox]")&&(a.closest(".a-checkbox").hasClass("hide-prices-checkbox")||a.hasClass("hide-prices-checkbox")))a.is(":checked")?L():O();else if(d.isSPP())(b=a.closest(".a-radio"))&&a.is(":checked")&&(b.hasClass("kindle-reg-radio-your-account")?O():b.hasClass("kindle-reg-radio-another-account")&&L());else if(a.hasClass("kindle-reg-radio-another-account")||a.hasClass("kindle-reg-radio-your-account"))b.find(".kindle-reg-radio-your-account").is(":checked")?
O():L()}function L(){var a=T,b=M(a.find(".hide-prices-checkbox"));b.is(":checked")&&!d.isSPP()||b.attr("checked","checked");M(a.find(".kindle-reg-radio-your-account")).is(":checked")&&M(a.find(".kindle-reg-radio-another-account")).attr("checked",!0)}function O(){var a=T,b=M(a.find(".hide-prices-checkbox"));b.is(":checked")&&b.removeAttr("checked");M(a.find(".kindle-reg-radio-another-account")).is(":checked")&&M(a.find(".kindle-reg-radio-your-account")).attr("checked",!0)}function V(){var a=T;M(a.find(".hide-prices-checkbox")).attr("disabled",
"true");M(a.find(".kindle-reg-radio-another-account")).attr("disabled",!0);M(a.find(".kindle-reg-radio-your-account")).attr("disabled",!0);a.find(".hide-prices-merchant-cant").is(":visible")||a.find(".hide-prices-note").show()}function ba(){var a=T;M(a.find(".hide-prices-checkbox")).removeAttr("disabled");M(a.find(".kindle-reg-radio-another-account")).removeAttr("disabled");M(a.find(".kindle-reg-radio-your-account")).removeAttr("disabled");a.find(".hide-prices-note").hide()}function fa(a){var b=f.getPosition(a,
"#",2),c=f.getPosition(a,"#",3);return"60"===a.substring(b+1,c)}function aa(b,c,d){var e=X(),f,h;e?(f=d.find('li[class\x3d"a-carousel-card gift-wrap noshi-wrap none-wrap"]'),h=d.find(".carousel-gift-wrap").find("ol")):(f=d.find("."+c+"-wrap-template"),h=d.find("ul.allGiftWrapList"));e&&a.trigger("checkout:gift:removeEmptyCarouselCards",h);var g=(d.data("lineitemid")||b.obfuscatedEntityId||"").replace(":","-");"afn"!==c||e||(h.find('li[class!\x3d"none-wrap gift-wrap noshi-wrap"]').remove(),K("#giftwrap-carousel-wrap-holder-"+
g).css("width",90*(b.options.wraps.length+1)),K("#giftwrap-carousel-wrap-pane-"+g).css("width",360));for(var k=T,n=k.find(".larger-image-link-carousel-template"),l=0;l<b.options.wraps.length;l++){var m=f.clone(!0).removeClass(c+"-wrap-template").addClass(c+"-wrap-copy"),r=n.clone(!0).removeClass("larger-image-link-carousel-template").addClass("larger-image-link-carousel-"+l),t=c,u=b,v=l,Y=m,p=r,q=u.options.wraps[v].id;Y.find("input").addClass(t+"-wrap-"+v).val(q);Y.find("label").attr("for",t+"-wrap-"+
v);q=u.options.wraps[v].description;Y.find("."+t+"-wrap-description").html(q);q=u.options.wraps[v].price;Y.find("."+t+"-wrap-price").html(q);(u=u.options.wraps[v].imageurl)&&u.length?(Y.find("."+t+"-image").attr("src",u).show(),t=Y.find(".larger-image-link"),t.show(),t.unbind("click").bind("click",{imageURL:u},N),p.unbind("click").bind("click",{imageURL:u},N),p.find("a").unbind("click").bind("click",{imageURL:u},N)):"mfn"!==t||X()||(Y.find(".a-span3").hide(),Y.find(".a-span9").addClass("a-span12").removeClass("a-span9"),
Y.find(".a-color-price").removeClass("wrap-price"));if("afn"===c){v=b;p=l;Y=g;t=h;u=k;q=v.options.wraps[p].id;m.data("giftwrap-id",q);m.data("wrap-no",p);if(v.selected.wrap===q){t.find("li.none-wrap").find("img").removeClass("selected-giftwrap-image");m.find("img").addClass("selected-giftwrap-image");var v=m.find("img").attr("src"),B=K("#giftwrap-option-preview-imagearea-image-"+Y);B.find("img").attr("src",v);B.removeClass("aok-hidden");K("#giftwrap-option-preview-imagearea-default-"+Y).addClass("aok-hidden");
x(m.find("input"));w();r.removeClass("aok-hidden");r.addClass("selectedWrapLargeLink")}X()?(Y=fa(q)?"gift-wrap":"noshi-wrap",m.removeClass(Y).removeClass("none-wrap"),t.append(m.show())):(Y=fa(q)?"\x3cli class\x3dnoshi-wrap\x3e":"\x3cli class\x3dgift-wrap\x3e",t.append(K(Y).append(m.show())));m=u.find("#carousel-larger-image-div");m.find(".larger-image-link-carousel-"+p).length||m.append(r.show())}}d.find("."+c+"-wrap-checkbox").removeAttr("checked");b.selected&&b.selected.isWrapped?d.find("input[value\x3d'"+
b.selected.wrap+"']").attr("checked",!0):M(d.find("."+c+"-wrap-none")).attr("checked",!0);e&&a.trigger("checkout:gift:adjustCarouselInitial",b,d)}function X(){return d.isSPP()&&K("input[name\x3dsppGiftPopoverWithCarousel]").length}function ea(a,b,c){for(var e=c.find("."+b+"-wrap-template"),f=0;f<a.options.wraps.length;f++){var h=e.clone(!0).removeClass(b+"-wrap-template").addClass(b+"-wrap-copy"),g=a.options.wraps[f].id;h.find("input").addClass(b+"-wrap-"+f).val(g);h.find("label").attr("for",b+"-wrap-"+
f);g=a.options.wraps[f].description;h.find("."+b+"-wrap-description").html(g);g=a.options.wraps[f].price;h.find("."+b+"-wrap-price").html(g);if((g=a.options.wraps[f].imageurl)&&g.length){var k=h.find("."+b+"-image");d.isSPP()&&k.removeClass("hidden");k.attr("src",g).show();k=h.find(".larger-image-link");d.isSPP()&&k.removeClass("hidden");k.show();k.unbind("click").bind("click",{imageURL:g},N)}else h.find(".a-span3").hide(),h.find(".a-span9").addClass("a-span12").removeClass("a-span9"),h.find(".a-color-price").removeClass("wrap-price");
d.isSPP()&&h.removeClass("hidden");h.insertAfter(e).show()}c.find("."+b+"-wrap-checkbox").removeAttr("checked");a.selected&&a.selected.isWrapped?c.find("input[value\x3d'"+a.selected.wrap+"']").attr("checked",!0):M(c.find("."+b+"-wrap-none")).attr("checked",!0)}function A(){T.find("#include-gift-connection-checkbox").attr("checked",!0)}function Y(){if(T.find(".include-gift-connection-checkbox").not(":checked")){var a=T;a.find(".gift-connection-recipient-extra").hide();var b;b=a.find('#select-recipient option[value\x3d"0"]').attr("selected",
"selected");a.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(b.text());a.find("#input-recipient-first-name").val("");a.find("#input-recipient-last-name").val("");ka()}}function Z(a){for(var b=T,c=0;c<ha.length;c++)if(a&&a===ha[c].value&&ha[c].bMonth&&ha[c].bDay){var d;d=b.find('#select-occasion-month option[value\x3d"'+ha[c].bMonth+'"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text());d=
b.find('#select-occasion-day option[value\x3d"'+ha[c].bDay+'"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text())}}function ka(){var a=T,b=a.find("#popover-gift-connection #select-recipient").find(":selected").val();if(""!==b&&"0"!==b&&("1"!==b&&"2"!==b||a.find("#input-recipient-first-name").val()||a.find("#input-recipient-last-name").val()))a.find("#select-occasion").prop("disabled",!1),a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:1});
else{b=T;b.find(".gift-connection-occasion-extra").hide();var c;c=b.find('#select-occasion option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-month option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-day option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(c.text());
c=b.find('#select-occasion-age option[value\x3d"-1"]').attr("selected","selected");b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(c.text());b.find("#occasion-has-reminder-checkbox").attr("checked",!0);a.find("#select-occasion").prop("disabled",!0);a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:.5})}}function ga(a,b){var c=T;"1"===a&&"2"===b?c.find("#select-occasion-age-row").show():c.find("#select-occasion-age-row").hide()}function R(a){a=
T;var b=a.find("#popover-gift-connection #select-recipient").find(":selected").val(),c=a.find("#popover-gift-connection #select-occasion").find(":selected").val();!b||"1"!==b&&"2"!==b?(a.find(".gift-connection-recipient-extra").hide(),"1"===c&&b&&Z(b)):a.find(".gift-connection-recipient-extra").show();ga(c,b);ka()}function ra(a){a=T;var b=a.find("#popover-gift-connection #select-occasion").find(":selected").val(),c=a.find("#popover-gift-connection #select-recipient").find(":selected").val();!b||"1"!==
b&&"2"!==b?a.find(".gift-connection-occasion-extra").hide():("1"===b&&c&&"1"!==c&&"2"!==c&&Z(c),a.find(".gift-connection-occasion-extra").show());ga(b,c)}function ta(a){var c=T,d="/gp/buy/pipeline/handlers/list-of-giftlists.html?escape\x3d0";ha&&(d+="\x26mappingOnly\x3d1");a&&(d+="\x26fromRegistryIds\x3d"+a);K.ajax({type:"POST",url:d,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(d){c.find("#select-recipient").hide();!ha&&d.options&&0<d.options.length&&(ha=d.options);a&&d.registryIdMapping?
(pa[a]=d.registryIdMapping[a],oa=d.registryIdMapping[a]):a&&(pa[a]=F);ha&&b();c.find("#select-recipient").show();c.find("#select-recipient-spinner").hide();ja=!0},error:function(){c.find("#select-recipient").show();c.find("#select-recipient-spinner").hide();ja=!0}})}function S(b,c){var d=X(),e=c.lineItemId;c=X()?c.currentTab:b.data("current-tab");var f=K("#popover-gift-options-wrapper-"+e).data("active-tab");c!==f&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),b.addClass("selected-giftwrap-tab"),
b=K("#giftwrap-carousel-wrap-holder-"+e),d||b.css("left",0),f=K("#giftwrap-carousel-wrap-holder-"+e+" li"),d?(a.trigger("checkout:gift:changeCarouselWrapOptions",b,c,e),a.trigger("checkout:gift:adaptCarouselSPCPanel",e,c)):"all"===c?f.show():(f.hide(),f.filter("."+{"gift-wrap":"gift-wrap",noshi:"noshi-wrap"}[c]).show()),K("#popover-gift-options-wrapper-"+e).data("active-tab",c),f.find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),f.filter(".none-wrap").find("img").addClass("selected-giftwrap-image"),
K("#giftwrap-option-preview-imagearea-default-"+e).removeClass("aok-hidden"),K("#giftwrap-option-preview-imagearea-image-"+e).addClass("aok-hidden"),d=K("#allGiftWrapList-"+e).find(".none-wrap").find("input"),e=K(".selectedWrapLargeLink"),d.prop("checked",!0),d.val("").change(),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")))}function Ba(a,b,c){c.$event.preventDefault();a=b.lineItemId;b=parseInt(K("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);0>b&&(b=b+90+"px",K("#giftwrap-carousel-wrap-holder-"+
a).css("left",b))}function Q(a,b,c){c.$event.preventDefault();a=b.lineItemId;var d=K("#allGiftWrapList-"+a);b=d.find("li").size();c=d.find("li.gift-wrap").size();var d=d.find("li.noshi-wrap").size(),e=K("#popover-gift-options-wrapper-"+a).data("active-tab"),f;"all"===e?f=b:"gift-wrap"===e?f=c:"noshi"===e&&(f=d);b=parseInt(K("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);b>-90*(f-4)&&(b=b-90+"px",K("#giftwrap-carousel-wrap-holder-"+a).css("left",b))}function na(a,b){var c=b.lineItemId;K("#allGiftWrapList-"+
c).find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".afn-image").addClass("selected-giftwrap-image");b=a.parent();var d=a.data("giftwrap-id"),e=a.find("input"),f=a.data("wrap-no");e.prop("checked",!0);e.val(d).change();d=K("#giftwrap-option-preview-imagearea-default-"+c);c=K("#giftwrap-option-preview-imagearea-image-"+c);e=K(".selectedWrapLargeLink");f=K(".larger-image-link-carousel-"+f);b.hasClass("none-wrap")?(d.removeClass("aok-hidden"),c.addClass("aok-hidden"),e.length&&
(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),c.find("img").attr("src",a),d.addClass("aok-hidden"),c.removeClass("aok-hidden"),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")),f.length&&(f.addClass("selectedWrapLargeLink"),f.removeClass("aok-hidden")))}function ua(a,b){var c=b.lineItemId;b=K("#giftwrap-option-preview-imagearea-default-"+c);c=K("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),
c.addClass("aok-hidden")):(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function qa(a,b){var c=b.lineItemId;a=K("#giftwrap-option-preview-imagearea-default-"+c);b=K("#giftwrap-option-preview-imagearea-image-"+c);K("#allGiftWrapList-"+c).find(".selected-giftwrap-image").parentsUntil("ul","li").hasClass("none-wrap")?(a.removeClass("aok-hidden"),b.addClass("aok-hidden")):(c=K("#allGiftWrapList-"+c).find(".selected-giftwrap-image").attr("src"),
b.find("img").attr("src",c),a.addClass("aok-hidden"),b.removeClass("aok-hidden"))}var K=a.$;if(!K("html").hasClass("a-ie6")){var ca,sa,T,va,xa=!1,la=!1,wa=!0,ia=!0,ha,ja=!1,pa={},oa,ya=!1;a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")&&(d.isSPP()&&h.increaseCount("checkout:spp-revieworder:gift_pop_cancel_sec",1),xa&&U(),la&&(a=T,a.find(".gift-msg-on-card").hide(),a.find(".popover-gift-warning").hide(),a.find(".message-remaining-text").show(),M(a.find(".amazon-gift-wrap")).removeAttr("checked"),
t(!1),a.find('input[type\x3d"checkbox"]').removeAttr("disabled")))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")){T=a.popover.$popover;va=a.popover;0<T.find(".include-gift-receipt-checkbox").length&&(la=!0);g.showSpinner(T.find(".popover-content-main"),!1,va);T.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var b=va.data;
if(b)a+="\x26obfuscatedEntityId\x3d"+b;else throw{name:"MissingData",message:"lineItemId is undefined"};}catch(e){p.ueLogError&&p.ueLogError(e,{logLevel:"FATAL",attribution:"gift-popover",message:"[No lineItemId to open the gift-popover with]. "})}K.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/gift-select-content.html",data:a,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return c.jsonify(a)},success:function(a,b,c){a&&a.conductoraction&&a.conductoraction.url&&
d.redirect(a);null!==a?v(a,b,c):d.ajaxRedirect()},error:function(a,b,c){d.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-gift"))b=T,a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text()),a.popover.updatePosition(!0);else if(a.popover&&a.popover.$popover){var b=a.popover.$popover;a=b.find(".validateInputCharactersOnBlur.a-form-error");0<a.size()&&a.removeClass("a-form-error");
b=b.find("#onblur-character-validation-error-gift-message-text");0<b.size()&&b.remove()}});var za={enforceSelectorParity:x,enforceGiftReceiptParity:P,enforceHidePriceParity:W,disableHidePrice:w,toggleMessageBoxDisplay:E,toggleEmptyMsgWarning:I,toggleNoReceiptWarning:da,includeGiftConnection:A,clearGiftConnection:Y,toggleGiftConnectionRecipientArea:R,toggleGiftConnectionOccasionArea:ra,updateGiftOptionsTabSelection:S,updateCarouselOnLeftClick:Ba,updateCarouselOnRightClick:Q,updateSelectedGiftWrap:na,
updatePreviewImageOnMouseEnter:ua,updatePreviewImageOnMouseLeave:qa},M=e.getInput;a.declarative("gift-popover-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(za[b[c]])za[b[c]](a.$target,a.data)});a.declarative("gift-popover-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(za[b[c]])za[b[c]](a.$currentTarget,
a.data,a)});a.declarative("spc-update-gift-options-tab-selection","click",function(a){var b=a.$target.parents("li");b.attr("data",a.data);S(b,a.data)});a.on("checkout:reload:spc",m);a.on("checkout:reload:spp-revieworder",m)}});"use strict";q.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics").register("concealment-popover-controller",function(a,l,g,c,d,f,k,h){function e(){v("#spc-orders").find(".concealment-widgets-desktop").removeClass("no-js-hide");
a.defer(function(){v("#spc-orders").find(".concealment-popover-link").each(function(){v(this).data("action")&&v(this).removeAttr("href").attr("tabindex",0)})})}function n(a){return a.is("input")?a:a.find("input")}function b(a){var b=u;b.find(".fake-label").each(function(){v(this).unbind("click").bind("click",function(){v(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".concealment-item-title").html(a.item.title);if(a&&a.obfuscatedEntityId){var c=
b.find(".set-concealment-options-button input");c.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,concealmentData:a,quantity:a.quantity},m);f.bindActionEnterKeyOnButton(c)}w=a&&a.item&&a.item.isAmazonFulfilled;a&&a.selected&&(c=n(b.find(".conceal-item-checkbox")),a.selected.concealItem?c.attr("checked",!0):c.removeAttr("checked"));u.find(".content-container").css("visibility","visible");q.updatePosition(!0);g.hideSpinner(b.find(".popover-content-main"))}function m(a){var b=u,
e="";a&&a.data&&a.data.obfuscatedentityid&&(e+="obfuscatedEntityId.0\x3d"+a.data.obfuscatedentityid+"\x26");a&&a.data&&a.data.quantity&&(e+="quantity.0\x3d"+a.data.quantity+"\x26");var f="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.saveConcealmentRefTag&&(f=a.data.concealmentData.saveConcealmentRefTag);var g="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.cancelConcealmentRefTag&&(g=a.data.concealmentData.cancelConcealmentRefTag);(a=n(b.find(".conceal-item-checkbox")).is(":checked"))?
(w&&(e+="isAFN.0\x3d1\x26"),e=e+"includeReceipt.0\x3d1\x26includeMessage.0\x3d1\x26"+("message.0\x3d"+encodeURIComponent(v("input[name\x3d'concealment-item-message']").val())+"\x26"),e=e+"hidePrices.0\x3d0\x26saveOnly\x3d1"+("ref\x3d"+f+"\x26")):e+="ref\x3d"+g+"\x26";var k=v("input#executionId").val();k&&(e+="executionId\x3d"+k+"\x26");k="/gp/buy/gift/handlers/save-all.html/ref\x3d";a?(k+=f,h.increaseCount("CPEX.Checkout.Select.Concealment",1)):(k+=g,h.increaseCount("CPEX.Checkout.Cancel.Concealment",
1));d.isSPP()&&(b.find(".a-button-close").trigger("click"),f=v("#setOrderingPrefsCheckbox"),f.length&&f.is(":checked")&&(e+="\x26saveAsDefaultsSelected\x3d1"));l.show();v.ajax({type:"POST",url:k,data:e,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,e,f){f.getResponseHeader("x-amz-checkout-page")?(d.isSPP()||b.find(".a-button-close").trigger("click"),d.ajaxUpdatePage(a,
e,f)):(a=c.jsonify(a),d.redirect(a))},error:function(a,b,c){d.ajaxRedirect(a,b,c)}})}var v=a.$;if(!v("html").hasClass("a-ie6")){var u,q,w=!0;v(document).delegate(".concealment-popover-link, .concealment-options-button","click",function(){h.increaseCount("CPEX.Checkout.Concealment.Button.click",1)});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")&&(d.isSPP()&&h.increaseCount("checkout:spp-revieworder:concealment_pop_cancel_sec",1),n(u.find(".conceal-item-checkbox")).removeAttr("checked"))});
a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")){u=a.popover.$popover;q=a.popover;g.showSpinner(u.find(".popover-content-main"),!1,q);u.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var e=q.data.lineItemEntityId,f=q.data.itemId;if(e)a+="\x26obfuscatedEntityId\x3d"+e;else if(f)a+="\x26lineItemEntityId\x3d"+f;else throw{name:"MissingData",
message:"lineItemId is undefined"};var h=q.data.quantity;if(h)a+="\x26quantity\x3d"+h;else throw{name:"MissingData",message:"quantity is undefined"};}catch(k){p.ueLogError&&p.ueLogError(k,{logLevel:"FATAL",attribution:"concealment-popover",message:"[Data missing to open the concealment-popover]. "})}e=q.data.ref;v.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/concealment-select-content.html/ref\x3d"+e,data:a+("\x26ref\x3d"+e),dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},
dataFilter:function(a){return c.jsonify(a)},success:function(a,c,e){a&&a.conductoraction&&a.conductoraction.url&&d.redirect(a);null!==a?b(a,c,e):d.ajaxRedirect()},error:function(a,b,c){d.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-concealment")){var b=u;a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text());a.popover.updatePosition(!0)}});var B={};a.declarative("concealment-popover-element",
["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(B[b[c]])B[b[c]](a.$target,a.data)});a.declarative("concealment-popover-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(B[b[c]])B[b[c]](a.$currentTarget,a.data,a)});a.on("checkout:reload:spc",e);a.on("checkout:reload:spp-revieworder",e)}});"use strict";q.when("A",
"page-conductor","scroll-controller","page-detector","client-side-metrics","button-blocker","weblab-helper").register("gold-box-controller",function(a,l,g,c,d,f,k){function h(){a.defer(b);a.defer(m)}var e=a.$,n={};if(!e("html").hasClass("a-ie6")){var b=function(){var a=e("#goldbox-countdown"),b=e("#spc-orders");b&&0!==b.length||(b=e("#spclite-items-block"));b=b.find("input[name\x3dgoldboxexpirelefttime]");if(0!==b.length){if(1<b.size()){var c=parseInt(b.attr("data-timeleftms"),10),f=b;e.each(b,function(){var a=
e(this),b=parseInt(a.attr("data-timeleftms"),10);b<c&&(f=a,c=b)});b=f}var h=parseFloat(b.attr("data-pagestarttime")),m=parseFloat(b.attr("data-timeleftms")/1E3);if(!(isNaN(h)||isNaN(m)||0>=m)){var t=(new Date).getTime();k.isTSPCGoldBoxTimerFixEnabled()&&(isNaN(n[h])?(n={},n[h]=t):t=n[h]);var q=a.find("span[data-timefield\x3dminute]"),y=a.find("span[data-timefield\x3dsecond]"),G=p.setInterval(function(){var b=(new Date).getTime();m-=(b-t)/1E3;t=b;if(0>m&&G)y.html("00"),p.clearInterval(G),G=null,l.isSPP()&&
d.increaseCount("checkout:spp-revieworder:deal_expired",1),e("#gold-box-modal-launcher").trigger("click"),g.scrollToTop(),g.toggleScrollOff();else{var b=Math.floor(m/60%60),c=Math.floor(m%60),c=10>c?"0"+c:c;q.html(b);y.html(c);a.is(":visible")||a.show()}},1E3);l.isSPP()&&d.increaseCount("checkout:spp-revieworder:deal_countdown",1)}}},m=function(){var a=e("#gold-box-button-blocker");1===a.length&&f.show("place-order-gold-box-blocker",a.attr("data-blocker-message"))};a.on("checkout:reload:spc",h);a.on("checkout:reload:spclite",
h);a.on("checkout:reload:spp-revieworder",h)}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","currency-formatter","page-detector","client-side-metrics","pay-rewards-currency","weblab-helper").register("inline-points-controller",function(a,l,g,c,d,f,k,h,e){function n(){r("#spc-points-input")&&r("#spc-points-input").data("points-used")&&(r("#points-applied").show(),r("#inline-points-button").hide());r("#inline-points-register")&&r("#inline-points-register").removeAttr("href");
r("#spc-loyalty-points-input")&&r("#spc-loyalty-points-input").val()&&(r("#loyalty-points-applied").show(),r("#loyalty-points-button").hide());r("#spc-points-input")&&r("#spc-points-input").hasClass("show-currency-input-widget-new")&&r("#spc-points-input").each(function(b,c){var d=a.$(c);b={$element:d,maxAmount:d.data("max-dollar-amount")};c={$element:a.$("#inline-raw-points"),decimalPlaces:d.data("decimal-places"),ratio:d.data("conversion-ratio")};var e=d.data("country-code"),e=h.getCurrencyFormatByCountryCode(e);
h.initializeInlineFormatting(b,c,e);r(document).delegate("#spc-points-input","keydown",function(a){if(d.data("points-used")!==d.val){a=r("#inline-points-button");var b=!1;a.is("span")&&(b=!0);var c=a.find("span.apply"),e=a.find("span.change");r("#points-applied").hide();d.data("points-used")?(c.hide(),e.show()):(c.show(),e.hide());b?a.addClass("display-inline-block"):a.show()}})})}function b(a,b){a.preventDefault();if(m(b)){c.isSPP()?(l.blockAllActions(),l.showTransitionInContainer(r("#payment"))):
l.show();var d;a={"x-amz-checkout-page":"spc"};if(b)d=r("#loyalty-points-hidden-fields"),b="/gp/buy/spc/handlers/update-loyalty-points.html/ref\x3dox_spc_points_edit",d="\x26jpPointsPaymentInstrumentId\x3d"+encodeURIComponent(d.find("input[name\x3d'jpPointsPaymentInstrumentId']").val())+"\x26jpPointsCustomerRequestedAmount\x3d"+r("#spc-loyalty-points-input").val()+"\x26jpPointsConversionRate\x3d"+d.find("input[name\x3d'jpPointsConversionRate']").val()+"\x26jpPointsBaseCurrencyCode\x3d"+d.find("input[name\x3d'jpPointsBaseCurrencyCode']").val()+
"\x26jpPointsTargetCurrencyCode\x3d"+d.find("input[name\x3d'jpPointsTargetCurrencyCode']").val()+"\x26jpPointsAvailablePoints\x3d"+d.find("input[name\x3d'jpPointsAvailablePoints']").val()+"\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+r("input[name\x3duseCtb]").val();else{a=c.setAjaxTransitionHeader(a);d=r("#inline-points-hidden-fields");var e=d.find("input[name\x3d'useGCBalance']").val();b="/gp/buy/pipeline/handlers/update-reward-points.html/ref\x3d"+(c.isSPP()?"chk_pay_addswp_coll":"ox_pay_page_points_apply");
d="paymentMethodId\x3d"+d.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+d.find("input[name\x3d'paymentMethodType']").val()+"\x26rewardAccountId\x3d"+d.find("input[name\x3d'rewardAccountId']").val()+"\x26rewardAccountAmount\x3d"+r("#spc-points-input").val()+"\x26rewardAccountRate\x3d"+d.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+e+"\x26usePromoBalance\x3d"+e+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+
r("input[name\x3duseCtb]").val()}r.ajax({type:"POST",url:b,data:d,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:a,success:function(a,b,d){d.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,b,d):(a=g.jsonify(a),c.redirect(a))},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}}function m(a){var b=!1,c=r("input[name\x3drewardAccountAmount]"),d=r("#inline-points-error-block");a||r("#spc-points-input")&&!r("#spc-points-input").hasClass("show-currency-input-widget-new")?
(a&&(c=r("input[name\x3dloyaltyPointsValue]"),d=r("#loyalty-points-error")),d.hide(),d.find("p").hide(),u(c))?p(c,a)?q(c,a)||(d.find("p").filter(function(){return"badMax"===r(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badMin"===r(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badValue"===r(this).data("error")}).show().css("display","inline"),b=!0):a||p(c,a)||(d.find("p").filter(function(){return"badMin"===
r(this).data("error")}).show().css("display","inline"),b=!0);if(b)return d.show(),c.addClass("a-form-error"),!1;c.removeClass("a-form-error");return!0}function v(a,b){var c=r(a.currentTarget),e=c.val();a=r("#inline-raw-points");b&&(a=r("#loyalty-points-applied-value"));var f=a.html();if(b)!/^\s*$/.test(e)&&!isNaN(e)&&0<e?a.html(e):a.html(0);else if(!r("#spc-points-input").hasClass("show-currency-input-widget-new")){var h=c.data("min-dollar-amount");!/^\s*$/.test(e)&&!isNaN(e)&&0<e&&!isNaN(h)&&e>=
h?(h=c.data("conversion-ratio"),c=c.data("decimal-places"),e=d.getNumberWithSeparators(e/h,c),a.html(e)):a.html(0)}(b||r("#points-applied").is(":visible"))&&f!==a.html()&&(a=r("#spc-loyalty-points-display"),f=r("#loyalty-points-applied"),e=r("#loyalty-points-button"),c=!1,b||(a=r("#inline-points-button"),a.is("span")&&(c=!0),f=a.find("span.apply"),e=a.find("span.change"),r("#points-applied").hide()),f.hide(),e.show(),c?a.css("display","inline-block"):a.show())}function u(a){a=a.val();return/^\s*$/.test(a)||
!isNaN(a)}function p(a,b){if(b)return!0;b=a.val();if(/^\s*$/.test(b))return!0;b=parseFloat(b);return isNaN(b)||!a.data("min-dollar-amount")?!0:0===b||b>=a.data("min-dollar-amount")}function q(a,b){var c=a.val();if(/^\s*$/.test(c))return!0;var c=parseFloat(c),d=a.data("max-dollar-amount");b&&(d=a.data("available-points"));return isNaN(c)||!d?!0:c<=d}function B(a){switch(a.keyCode?a.keyCode:a.which){case 13:case 10:var c=r("#loyalty-points-button"),d=r("#spc-points-input");0<c.length&&c.is(":visible")?
b(a,1):0<d.length&&b(a,0)}}var r=a.$;r("html").hasClass("a-ie6")||(r(document).delegate("#spc-loyalty-points-input","keypress",function(a){B(a)}),r("#spc-points-input")&&!r("#spc-points-input").hasClass("show-currency-input-widget-new")&&(r(document).delegate("#spc-points-input","keypress",function(a){B(a)}),r(document).delegate("#spc-points-input","keyup",function(a){v(a,0)})),r(document).delegate("#spc-loyalty-points-input","keyup",function(a){v(a,1)}),r(document).delegate("#inline-points-button",
"click",function(a){b(a,0)}),r(document).delegate("#loyalty-points-button","click",function(a){b(a,1)}),a.on("a:expander:apply-point-expander:toggle:expand",function(a){k.increaseCount("checkout:spp-payment:expand_addswp_coll",1)}),a.on("checkout:reload:spc",n),a.on("checkout:reload:spp-revieworder",n))});"use strict";q.when("A","client-side-metrics","ready").execute(function(a,l){var g=a.$;a.on("checkout:reload:spc",function(){var a=g("input[name\x3d'rewardsProgramId']").val(),d=g("input[name\x3d'swpWidgetCase']").val();
a&&d&&l.increaseCount("Checkout::SPC::SWPWidgetCSM::"+a+"::"+d,1)})});"use strict";q.when("A","client-side-metrics","ready").execute(function(a,l){function g(){"1"!==c("meta[name\x3dSWP_TPP_FEATURE_ENABLED]").attr("content")||d||c.ajax({type:"POST",url:"/gp/shopwithpoints/temporaryPreference/verify-and-log-temporary-preference.html",data:{sourcePage:"SPC"},dataType:"text",async:!0,success:function(){d=!0;l.increaseCount("Checkout::SPC::LogTemporaryPaymentPreferenceAppliedAjax::Success",1)},error:function(){l.increaseCount("Checkout::SPC::LogTemporaryPaymentPreferenceAppliedAjax::Failure",
1)}})}var c=a.$,d=!1;a.on("checkout:reload:spc",g);a.on("checkout:reload:spclite",g);a.on("checkout:reload:spp-revieworder",g);a.on("checkout:reload:spp-collapsed",g)});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor").register("inline-fps-balance-controller",function(a,l,g,c){function d(a){a.preventDefault();f("#inline-fps-balance-checkbox").prop("disabled","disabled");c.isSPP()?(l.blockAllActions(),l.showTransitionInContainer(f("#payment"))):l.show();var d=f("#inline-fps-balance-hidden-fields"),
e=0;f("#inline-fps-balance-checkbox").prop("checked")&&(e=1);a=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});var n="/gp/buy/pipeline/handlers/update-fps-balance.html/ref\x3d"+(c.isSPP()?"chk_pay_"+(e?"apply":"remmove")+"_fps_balance_coll":"ox_spc_page_fps_balance_apply"),d="fpsPaymentMethodId\x3d"+d.find("input[name\x3d'fpsPaymentMethodId']").val()+"\x26useFlexiblePayments\x3d"+e+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+f("input[name\x3duseCtb]").val();
f.ajax({type:"POST",url:n,data:d,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,d,e){e.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,d,e):(a=g.jsonify(a),c.redirect(a))},error:function(a,d,e){c.ajaxRedirect(a,d,e)}})}var f=a.$;f("html").hasClass("a-ie6")||f(document).delegate("#inline-fps-balance-checkbox","click",function(a){d(a)})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","checkout-general-utils","error-feature-detection",
"page-detector","client-side-metrics","weblab-helper","a-modal").register("shipping-speed-selection-controller",function(a,l,g,c,d,f,k,h,e,n){function b(){V?x("fieldset div.a-radio").addClass("a-touch-radio"):a.defer(function(){var a=x("#spc-orders").find("div.ship-option");a.filter(".no-scheduled-delivery");a.each(function(){x(this).find("input.radio-image").remove()});a.each(function(){var a=x(this).find("input.radio-standard");a.attr("checked")&&a.attr("checked",!0)})});aa=x("#spc-orders").find("div.ship-option").find('input[type\x3d"radio"]:checked');
X=aa.attr("value");m();f.markFeatureAvailable("shipping-speed-selection-controller");v()}function m(){var a=0<x("#trigger-case-call-to-resolve-cv").length||0<x(".force-resolve-invalid-ship-option").length;if(c.isSPP()&&a){var a=function(){var a=p.setInterval(function(){c.isAnimating()||(l.show(),p.clearInterval(a))},50)},b=x("div.ship-option").filter(".call-set-to-resolve-cv").first().find("input[type\x3d'radio']");if(b&&b.length){var d=b.parents(".shipping-speeds").find("input.lineitemidinput[type\x3dhidden]").val();
E(b,null,null,{transitionAction:a,refTag:"chk_revieworder_set_ship_option_no_default",extraData:{callingCASEResolveCV:1,lineItemIds:d}})}}}function v(){x("#buy-button-disabled-state").length&&u(function(a){q(a)})}function u(a){e.isSDGoldenCXSPCDesktopEnabled()?x("div.sd-widgets").each(function(b,c){a(c)}):x("div.sd_widget_root").each(function(b,c){a(c)})}function q(a){var b=setInterval(x.proxy(function(){if(x(this).hasClass("sd_widget_initialized")){var a=x(this),c=x(a).attr("id");c&&(a=w(a),a["ScheduledDeliveryEntity.startDeliveryDate"]&&
E(null,c,a));p.clearInterval(b)}},a),1E3)}function w(a){var b={};B(a,function(a){var c=x(a).attr("key");a=x(a).val();b[c]=a||""});return b}function B(a,b){x(a).find("input[type\x3d'hidden']").each(function(a,c){b(c)})}function r(){L||(L=x("input[type\x3d'hidden'][name\x3d'scopeId']").val());return L}function t(a,b,d){if(d.getResponseHeader("x-amz-checkout-page")){var f=g.jsonify(a);return f&&f.success&&f.trialkey&&O[f.trialkey]?(a=O[f.trialkey],c.isSPP()&&"object"===typeof a&&(a=JSON.stringify(O[f.trialkey])),
e.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<x(".mobile-view").length?c.ajaxUpdatePage(a,b,d,{pushNewFrame:"false"}):c.ajaxUpdatePage(a,b,d),ba&&(clearTimeout(ba),ba=null),O={},!0):e.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<x(".mobile-view").length?c.ajaxUpdatePage(a,b,d,{pushNewFrame:"false"}):c.ajaxUpdatePage(a,b,d)}return c.redirect(a)}function H(a,b){if(a){var c=a.data(b);if(c!==F)return c;(a=a.closest(".radio-standard"))&&(c=a.data(b));return c}}function y(a){a.closest("fieldset").find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
a.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive")}function G(a){var b=a;x(".shipping-group").each(function(a,c){var d=!1;x(c).parents().each(function(a,b){return x(b).hasClass("shipment")?(d=!0,!1):!0});d||(b=b.add(c))});return b}function E(a,b,f,g){V&&y(a);g&&g.transitionAction?g.transitionAction():l.show();for(var k in fa)fa.hasOwnProperty(k)&&(fa[k].abort(),delete fa[k]);f=x("#spc-orders").find("input[type\x3d'hidden'][name\x3d'shiptrialprefix']").val();
var n;a||(a=x("#"+b).closest(".shipping-speed").find("input[type\x3d'radio']"));a.attr("value")!==X&&(h.increaseCount("checkout:spc:shipoption:change",1),X=a.attr("value"));n=a.closest(".shipment").data("orderid");a&&a.length&&a.hasClass("valid-btn")&&a.closest(".prime-calendar").hasClass("long-calendar")&&(n=a.closest(".prime-calendar").data("orderid"));var m="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";if(g&&g.extraData)for(var u in g.extraData)g.extraData.hasOwnProperty(u)&&
(m+="\x26"+u+"\x3d"+g.extraData[u]);var v=x(".shipment"),p=0;b=v.length;v=G(v);m+="\x26groupsadded\x3d"+(v.length-b);v.each(function(b,c){var d=x(c),f="",h=d.has(".prime-calendar-container"),g=d.find("input[name\x3d'currentshippingspeed']").attr("value"),k=d.find("input[name\x3d'currentshipsplitpreference']").attr("value");1===v.length&&(m+="\x26oldoption\x3d"+g+"."+k);var l=d.find("input[name\x3d'defaultshipsplitpreference."+p+"']").attr("value"),r=d.find("input[name\x3d'usingprimeshipping."+p+"']").attr("value");
l&&r&&(m+="\x26defaultshipsplitpreference."+p+"\x3d"+l,m+="\x26usingprimeshipping."+p+"\x3d"+r);l=d.find(".shipping-speed");l=a?l.find('input[type\x3d"radio"]:checked'):l.find("input[src*\x3dradio-on]");h&&!l.length&&(l=d.find("input[name\x3d'hiddenSelection"+p+"']"));r=d.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");1!==r.length&&(r=d.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));n===d.data("orderid")&&(H(a,"shippingofferingid")?
l=a:r=a,1===v.length&&(f=h?f+("\x26option\x3d"+l.data("key")+"."+(r?r.attr("value"):"")):f+("\x26option\x3d"+l.attr("value")+"."+(r?r.attr("value"):""))));var u=d.find("input[name\x3d'lineitemids"+p+"']");0<u.length&&(f+="\x26lineitemids"+p+"\x3d"+u.attr("value"));f+=N(d,p);l.length?(d=f,g=l,k=r,c="",f=p,H(g,"rcxsspdecoupling")?(c={},c["shippingspeed"+f]=h?g.attr("key"):g.attr("value"),c["shippingofferingid"+f]=H(g,"shippingofferingid"),c["guaranteetype"+f]=H(g,"guaranteetype"),c["issss"+f]=H(g,"issss"),
c["forceshipsplitpreference"+f]=H(g,"forceshipsplitpreference"),h="shipWhenComplete",k&&(h=k.attr("value")),1===H(g,"isscheduleddelivery")&&(c["isscheduleddelivery"+f]="1",h="shipWhenComplete"),c["shippriority"+f]=h,c["preferredSSP"+f]=H(g,"shipsplitpriority"),c["currentSSP"+f]=k.attr("value"),c["isShipWheneverValid"+f]=H(g,"isshipwhenevervalid"),c["isShipWhenCompleteValid"+f]=H(g,"isshipwhencompletevalid"),c=x.param(c),h="\x26"+c):(c=h?c+("\x26shippingspeed"+f+"\x3d"+g.data("key")):c+("\x26shippingspeed"+
f+"\x3d"+g.attr("value")),c+="\x26shippingofferingid"+f+"\x3d"+H(g,"shippingofferingid"),c+="\x26guaranteetype"+f+"\x3d"+H(g,"guaranteetype"),c+="\x26issss"+f+"\x3d"+H(g,"issss"),c+="\x26forceshipsplitpreference"+f+"\x3d"+H(g,"forceshipsplitpreference"),h="shipWhenComplete",k&&(h=k.attr("value")),1===H(g,"isscheduleddelivery")&&(c+="\x26isscheduleddelivery"+f+"\x3d1",h="shipWhenComplete"),h=c+("\x26shippriority"+f+"\x3d"+h)),f=d+h,1===H(l,"isscheduleddelivery")?(h=l.closest(".shipping-speed").find('[id^\x3d"sd_widgets_"]'),
e.isSDGoldenCXSPCDesktopEnabled()&&(h=x("#sd-widgets-"+b)),f+="\x26"+h.children(":input").serialize()):1===H(l,"isscheduleddeliveryslot")&&H(l,"sddatastring")&&(f+="\x26ScheduledDeliveryEntity.data."+p+"\x3d"+encodeURIComponent(l.data("sddatastring")))):0<d.find(".vas-scheduling-prefBlock").length?(b=f,h=p,l=""+("\x26shippingofferingid"+h+"\x3d"+d.find("input[type\x3d'hidden'][name^\x3d'shippingofferingid']").val()),l+="\x26guaranteetype"+h+"\x3d"+d.find("input[type\x3d'hidden'][name^\x3d'guaranteetype']").val(),
l+="\x26issss"+h+"\x3d"+d.find("input[type\x3d'hidden'][name^\x3d'issss']").val(),l+="\x26forceshipsplitpreference"+h+"\x3d"+d.find("input[type\x3d'hidden'][name^\x3d'forceshipsplitpreference']").val(),f=b+(l+("\x26shippingspeed"+h+"\x3d"+g)+("\x26shippriority"+h+"\x3d"+k))):e.isRemoveDigitalFlagForScheduledDeliveryShipmentEnabled()&&"1"===x(c).find("input[type\x3d'hidden'][name\x3d'previousSDSelected"+p+"']").attr("value")||(f+="\x26isdigital"+p+"\x3d1");p++;m+=f});0<p&&(m+="\x26groupcount\x3d"+
p);b="ox_spc_set_ship_option";c.isSPP()&&(b="chk_revieworder_set_ship_option",u=x("#setOrderingPrefsCheckbox"),u.length&&u.is(":checked")&&(m+="\x26saveAsDefaultsSelected\x3d1"));u=x("input[name\x3duseCtb]").val();m+="\x26isClientTimeBased\x3d"+u;1===H(a,"istrial")?(f=r()+":"+a.attr("name")+":"+a.attr("value"),m+="\x26trialkey\x3d"+f,O[f]&&(ba&&clearTimeout(ba),b="ox_spc_set_cached_ship_option",c.isSPP()&&(b="chk_revieworder_set_cached_ship_option"),m=m.replace("returnFullHTML\x3d1","returnFullHTML\x3d0"),
m+="\x26trialSuccess\x3d1")):"undefined"!==typeof f&&(f=f+":"+a.attr("name")+":"+a.attr("value"),m+="\x26trialkey\x3d"+f);g&&g.refTag&&(b=g.refTag);g&&g.removeGiftOption&&(m+="\x26giftOrderid\x3d"+a.closest(".shipment").data("orderid"));0===m.indexOf("\x26")&&(m=m.substr(1));g="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+b;f=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});e.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<x(".mobile-view").length&&(f=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc",
"x-amz-checkout-transition":"ajax"}));x.ajax({type:"POST",url:g,data:m,dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){t(a,b,c);d.nukeDropdowns("#b2brd-cadence-dropdown")},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function I(a,b){V&&y(a);a=b.find("input[name\x3d'ispuLoadingText']").attr("value");if(c.isSPP()&&a){var d=x("#shipaddress");d&&d.length&&(d.hasClass("expanded")?l.show():(l.shrinkPanel(x(".spp-panel.expanded"),!1),l.shrinkPanel(d,!0,a)))}else l.show();a="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+
(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";var d=b.find("input[name\x3d'storeAddressID']").attr("value"),e=b.find("input[name\x3d'storeId']").attr("value"),f=b.find("input[name\x3d'storeOwnerId']").attr("value"),h=b.find("input[name\x3d'lineItemsQuantity']").attr("value"),g=b.find("input[name\x3d'destinationType']").attr("value"),k=b.find("input[name\x3d'ispuShippingOfferingId']").attr("value"),n=b.find("input[name\x3d'ispuShipSplitPriority']").attr("value"),m=b.find("input[name\x3d'ispuGuaranteeType']").attr("value"),
r=b.find("input[name\x3d'ispuPageType']").attr("value");a=a+("\x26storeId\x3d"+e)+("\x26storeAddressId\x3d"+d)+("\x26storeOwnerId\x3d"+f);a+="\x26lineItemsQuantity\x3d"+h;a+="\x26destinationType\x3d"+g;a+="\x26shippingOfferingId\x3d"+k;a+="\x26shipPriority\x3d"+n;a+="\x26guaranteeType\x3d"+m;a+="\x26pageType\x3d"+r;b=b.find("input[name\x3d'retailProgram']");b.length&&(a+="\x26retailProgram\x3d"+b.attr("value"));b="chk_spc_ispu_ship_option";c.isSPP()&&(b="chk_revieworder_ispu_ship_option");b="/gp/buy/ispu/handlers/ispu-select-store.html/ref\x3d"+
b;d=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});0<x(".mobile-view").length&&(d=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));x.ajax({type:"POST",url:b,data:a,dataType:"text",async:!0,cache:!1,headers:d,success:function(a,b,c){t(a,b,c)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function da(a){var b=[a.closest(".shipment").data("orderid")];P(a,b)}function W(a){var b=[];x("#spc-orders").find(".shipment").each(function(a,c){b.push(a)});
h.increaseCount("checkout:spc:mobile:same-day-upsell-banner:clicked",1);P(a,b)}function P(a,b){l.show();var d="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1",e="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+a.data("reftag");x("#spc-orders").find(".shipment").each(function(c,e){d+="\x26lineitemids"+c+"\x3d"+x(e).find("input[type\x3d'hidden'][name\x3d'lineitemids"+c+"']").attr("value");d+=N(x(e),c);var f=x(e).find("input[type\x3d'hidden'][name^\x3d'shippriority']");
if(e=-1===b.indexOf(c)?x(e).find("#selected-ship-option-"+c):a)d+="\x26shippingofferingid"+c+"\x3d"+e.data("shippingofferingid"),d+="\x26guaranteetype"+c+"\x3d"+e.data("guaranteetype"),d+="\x26issss"+c+"\x3d"+e.data("issss"),d+="\x26forceshipsplitpreference"+c+"\x3d"+e.data("forceshipsplitpreference"),d+="\x26shippriority"+c+"\x3d"+e.data("targetshipoptionkey"),e.data("rcxsspdecoupling")&&(d+="\x26preferredSSP"+c+"\x3d"+e.data("shipsplitpriority"),d+="\x26currentSSP"+c+"\x3d"+f.attr("value"),d+="\x26isShipWheneverValid"+
c+"\x3d"+e.data("isshipwhenevervalid"),d+="\x26isShipWhenCompleteValid"+c+"\x3d"+e.data("isshipwhencompletevalid"))});var f=x("#spc-orders").find("input[type\x3d'hidden'][name\x3d'groupcount']").val(),d=d+("\x26groupcount\x3d"+f),d=d+("\x26isClientTimeBased\x3d"+x("input[type\x3d'hidden'][name\x3d'useCtb']").attr("value")),d=d+("\x26trialkey\x3d"+r()+":"+a.data("orderindex")+":"+a.data("targetshipoptionkey")),f=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});x.ajax({type:"POST",url:e,data:d,
dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){t(a,b,c)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function D(b,c,e,f){d.protectAgainstDoubleAction(c)||A||(a.trigger(e,b),b=b.$currentTarget.find("a"),f&&f(b))}function N(a,b){var c=a.find("input[name\x3d'onOrAfterAppointment"+b+"']").val();a=a.find("input[name\x3d'onOrAfterLineItemId"+b+"']").val();var d="";c&&a&&(d=d+("\x26onOrAfterAppointment"+b+"\x3d"+c)+("\x26onOrAfterLineItemId"+b+"\x3d"+a));return d}function U(){ea.closest("div.shipping-speed").find('input[type\x3d"radio"]').attr("checked",
!0);"undefined"!==typeof n?(0<x(".mobile-view").length?n.get(x("#faster-than-same-day-sosp-popover")):n.get(x("#faster-than-same-day-spc-popover"))).hide():a.$("div.a-popover button.a-button-close").trigger("click");E(ea,null,null,{removeGiftOption:!0})}var x=a.$;if(!x("html").hasClass("a-ie6")){var L,O={},V=x("html").hasClass("a-touch"),ba,fa={},aa,X,ea;p.spcpage.scheduledDeliverySetSOCallback=function(b,d){c.isSPP()&&a.objectIsEmpty(b)||(p.spcpage&&x("#spcpagecontent").is(":visible")?p.spcpage.actionSetShipOptions(null,
d,b):E(null,d,b))};p.spcpage.scheduledDeliverySetSOCallbackWithTarget=function(b,d,e){c.isSPP()&&a.objectIsEmpty(d)||(p.spcpage&&x("#spcpagecontent").is(":visible")?p.spcpage.actionSetShipOptions(null,e,d):E(b,e,d))};p.spcpage.scheduledDeliveryEnableSOCallback=function(){};p.spcpage.scheduledDeliveryMdwSetSOCallback=function(b,d,f){e.isSsdMdwEnabled()&&(c.isSPP()&&a.objectIsEmpty(d)||(p.spcpage&&x("#spcpagecontent").is(":visible")?p.spcpage.actionSetShipOptions(null,f,d):E(b,f,d)))};x(document).delegate(".ship-option",
"click",function(b){var c=x(b.target);e.isSPCMobileDisplayMoreShipOptionsEnabled()&&x(b.target).closest(".ship-option").hasClass("mobile-view")&&b.preventDefault();var f=x(b.currentTarget);h.resetMetrics();if(!(c.is('a[target\x3d"AmazonHelp"]')||c.is('a[target\x3d"PromoDetails"]')||c.hasClass("no-ship-option-selection-change")||f.is("input")||c.hasClass("a-button")||c.closest("a-button").length||c.is("img")&&(c.closest("div").is(".prime-ship-speed")||c.closest(".prime-fake-radio").parent().is(".prime-ship-speed"))))if(c=
f.find("div.prime-ship-speed"),0<c.length)c.find("a:first img").trigger("click");else if((c=f.find("input[type\x3d'image']").attr("src"))&&c.match(/radio-off/)&&x(".ap_popover_sprited").hide(),f=f.find("input[type\x3d'radio']"),(c=f.closest("div.shipping-speeds").data("sospargs"))&&1===f.data("isscheduleddelivery")&&!f.is(":checked"))l.show(),f.attr("checked",!0),y(f),d.redirectWithJavascript("/gp/buy/shipoptionselect/handlers/display.html?"+c);else if(e.removesGiftOptionOnRush()&&0<f.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&
1===f.closest(".radio-standard").data("nosupportforgiftoption")){ea=f;ea.is(":checked")&&(ea.attr("checked",!1),aa.attr("checked",!0));var g=0<x(".mobile-view").length?x("#faster-than-same-day-sosp-popover"):x("#faster-than-same-day-spc-popover");"undefined"!==typeof n?n.get(g).show():a.delay(function(){g.trigger("click")},10)}else if(f.hasClass("js-no-serverside-callback")&&(f.attr("checked",!0),y(f),f.closest(".a-section-expander-container").find(".a-link-section-expander").click()),!e.isSsdMdwEnabled()||
1!==f.closest(".radio-standard").data("callcaseforsdoverride"))if(!e.isSDGoldenCXSPCDesktopEnabled()||1!==H(f,"isscheduleddelivery")||!k.isDesktopSpc()){var c=x("#disableSubmitButtons").length,m=!1;e.isSPCMobileDisplayMoreShipOptionsEnabled()&&(b=x(b.currentTarget).closest(".ship-option"),b.hasClass("mobile-view")&&!b.hasClass("mobile-selected-option")&&(m=!0));!c&&f.is(":checked")&&!m||1===f.data("isscheduleddelivery")||(f.attr("checked",!0),E(f))}});x(document).delegate(".ship-option input[type\x3d'radio']",
"change",function(a){if(!e.isSPCMobileDisplayMoreShipOptionsEnabled()||!x(a.target).closest(".ship-option").hasClass("mobile-view")){a=x(a.currentTarget);var b=a.closest("div.prime-ship-speed");e.removesGiftOptionOnRush()&&0<a.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===a.closest(".radio-standard").data("nosupportforgiftoption")||e.isSsdMdwEnabled()&&1===a.closest(".radio-standard").data("callcaseforsdoverride")||e.isSDGoldenCXSPCDesktopEnabled()&&1===H(a,"isscheduleddelivery")&&
k.isDesktopSpc()||(0<b.length?b.find('input[type\x3d"radio"]').attr("checked",!1):1!==a.data("isscheduleddelivery")&&E(a))}});x(document).delegate(".ispu-ship-option","click",function(a){if(e.isISPUMasterEnabled()){x(a.target).closest(".ispu-ship-option").hasClass("mobile-view")&&a.preventDefault();x(a.target);var b=x(a.currentTarget);h.resetMetrics();var c=b.find("input[type\x3d'radio']"),d=!1;a=x(a.currentTarget).closest(".ispu-ship-option");a.hasClass("mobile-view")&&!a.hasClass("mobile-selected-option")&&
(d=!0);if(!c.is(":checked")||d)c.attr("checked",!0),I(c,b)}else h.increaseCount("checkout:ispu:selection:weblab:disabled",1)});x(document).delegate(".ispu-ship-option input[type\x3d'radio']","change",function(a){if(!e.isISPUMasterEnabled())h.increaseCount("checkout:ispu:selection:weblab:disabled",1);else if(!x(a.target).closest(".ispu-ship-option").hasClass("mobile-view")){a=x(a.currentTarget);var b=a.closest(".ispu-ship-option");I(a,b)}});x(document).delegate(".rush-ispu-ship-option","click",function(a){if(e.isRushISPUMasterEnabled()){x(a.target).closest(".rush-ispu-ship-option").hasClass("mobile-view")&&
a.preventDefault();x(a.target);var b=x(a.currentTarget);h.resetMetrics();var c=b.find("input[type\x3d'radio']"),d=!1;a=x(a.currentTarget).closest(".rush-ispu-ship-option");a.hasClass("mobile-view")&&!a.hasClass("mobile-selected-option")&&(d=!0);if(!c.is(":checked")||d)c.attr("checked",!0),I(c,b)}else h.increaseCount("checkout:rushIspu:selection:weblab:disabled",1)});x(document).delegate(".rush-ispu-ship-option input[type\x3d'radio']","change",function(a){if(!e.isRushISPUMasterEnabled())h.increaseCount("checkout:rushIspu:selection:weblab:disabled",
1);else if(!x(a.target).closest(".rush-ispu-ship-option").hasClass("mobile-view")){a=x(a.currentTarget);var b=a.closest(".rush-ispu-ship-option");I(a,b)}});x(document).delegate(".rush-ispu-view-details-link","click",function(a){a.preventDefault();a.stopPropagation()});a.declarative("shipping-speed-expander-toggle",["click"],function(a){var b=a.$target.closest(".a-box"),c,e;b.hasClass("a-single")?(c=b.find(".expanded-header-content"),e=b.find(".collapsed-header-content"),e.hide(),c.hasClass("prime-title")&&
c.find("div").attr("style",""),c.show()):(e=b.find(".collapsed-header-content"),c=b.find(".expanded-header-content"),b=b.siblings(".a-expander-content").find(".a-icon-touch-radio-active").siblings(".a-radio-label").html(),e.html(b),c.hide(),e.show());d.toggleExpanderContent(a)});a.declarative("select-prime-slot",["click"],function(a){a=a.$currentTarget;x(".a-button-close").trigger("click");a.closest(".valid-slot").hasClass("selected-slot")||E(a)});var A=!1;x(document).delegate(".mobile-upsell","touchmove",
function(a){A=!0});x(document).delegate(".mobile-upsell","touchstart",function(a){A=!1});a.declarative("select-upsell-shipping-speed",["click","touchend"],function(a){D(a,"select-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select",da)});a.declarative("select-all-upsell-shipping-speed",["click","touchend"],function(a){D(a,"select-all-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select-all",W)});a.declarative("faster-than-same-day-save",["click"],U);a.declarative("faster-than-same-day-sosp-save",
["click"],U);a.on("checkout:reload:spc",b);a.on("checkout:reload:spp-revieworder",b)}});"use strict";q.when("A","page-detector","spc-page-state","client-side-metrics","page-conductor","weblab-helper").register("order-summary-controller",function(a,l,g,c,d,f){function k(){q=b("#transactionalRadio");w=b("#marketplaceRadio");v=b("#tfx-see-exchange-rates");u=b("#tfx-switch-currency-options");m||(c.increaseCount("removeauijs15"),b("#transactionalRadioImage").remove(),b("#marketplaceRadioImage").remove(),
b("#acceptAccImage").remove());var a=b("#exchange-rate-link"),d=b("#switch-currency-link");if(0!==w.length){var e=u.find('input[name\x3d"switchCurrency"]'),f=e.not(":checked"),e=g.prop("currencyType")||e.filter(":checked").val();f.val()===e?f.trigger("click"):h(e);m||(c.increaseCount("removeauijs16"),a.find("i.a-icon-collapse").remove(),d.find("i.a-icon-collapse").remove())}}function h(e){b(".tfx-currency").each(function(){b(this).text(b(this).data(e))});g.prop("currencyType",e);var h=b("#subtotals-marketplace-table"),
k=b("#subtotals-transactional-table"),n=b("#subtotals-marketplace-spp-bottom"),u=b("#subtotals-transactional-spp-bottom"),p=b("#vatRetailSubtotals-transactional-table"),E=b("#vatGlobalSubtotals-transactional-table"),I=b("#vatMerchantSubtotals-transactional-table"),F=b("#vatRetailSubtotals-marketplace-table"),W=b("#vatGlobalSubtotals-marketplace-table"),P=b("#vatMerchantSubtotals-marketplace-table"),D=b(".place-your-order-button"),N=b("#fx-enable"),U=d.isSPP()?b(".place-order-button-text"):b(".place-your-order-button + span");
d.isSPP()||setTimeout(function(){var a=Math.max(h.outerHeight(),k.outerHeight());0<a&&(h.height(a),k.height(a))},500);if(!m){c.increaseCount("removeauijs17");var x=w.siblings("i"),L=q.siblings("i");if(x.hasClass("a-icon-touch-radio-inactive")||x.hasClass("a-icon-touch-radio-active"))"marketplace"===e?(x.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),L.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive")):(L.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),
x.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"))}"marketplace"===e?(b("#fxGoodNews-transactional").hide(),b("#fxGoodNews-marketplace").show(),k.hide(),h.show(),u.hide(),n.show(),p.hide(),E.hide(),I.hide(),F.show(),W.show(),P.show(),f.isTFXGuaranteedExchangeFeeEnabled()&&(v.hide(),N.hide()),D.val(b("#placeYourOrderTextMarketplace").val()),m&&U.text(b("#placeYourOrderTextMarketplace").val()),b("#currencyChanged").attr("value","true"),b("#fxCurrencyChoice").attr("value",
"marketplace"),b("#tfx-total-header").addClass("aok-hidden"),b("#mkt-total-header").removeClass("aok-hidden")):(b("#fxGoodNews-transactional").show(),b("#fxGoodNews-marketplace").hide(),h.hide(),k.show(),n.hide(),u.show(),F.hide(),W.hide(),P.hide(),p.show(),E.show(),I.show(),f.isTFXGuaranteedExchangeFeeEnabled()&&(v.show(),N.show()),D.val(b("#placeYourOrderTextTransactional").val()),m&&U.text(b("#placeYourOrderTextTransactional").val()),b("#currencyChanged").attr("value","false"),b("#fxCurrencyChoice").attr("value",
"transactional"),b("#mkt-total-header").addClass("aok-hidden"),b("#tfx-total-header").removeClass("aok-hidden"));a.trigger("checkout:spc:ordersummary:sizeChanged");l.isMobileSpc()&&(n=b("#vatBreakdownNote"),0<n.size()&&(u=n.attr("href"),u=0<u.lastIndexOf(".html?")?u+("\x26currencyType\x3d"+e):u+("?currencyType\x3d"+e),n.attr("href",u)))}function e(a){var d=b("#tfx-footer"),e=b("#tfx-header");if(!m){c.increaseCount("removeauijs18");var f=b("#fxApplicabilityDecision").siblings("i"),g=b("#fxApplicabilityAdoption").siblings("i");
if(g.hasClass("a-icon-touch-checkbox-inactive")||g.hasClass("a-icon-touch-checkbox-active"))g.removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),f.removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active")}"accept"===a?(n()?(b("#fx-terms-and-conditions").show(),b("#fxCardCurrencySubcondition").hide()):(b("#fx-enable").show(),b("#fx-disable").hide()),b("#fxApplicabilityDecision").prop("checked",!0),e.show(),h("transactional"),d.show(),
b("#marketplaceRadio").prop("checked",!1),b("#transactionalRadio").prop("checked",!0),b("#fxApplicabilityChoice").attr("value","accept")):(n()?(b("#fx-terms-and-conditions").hide(),b("#fxCardCurrencySubcondition").show()):(b("#fx-enable").hide(),b("#fx-disable").show()),b("#fxApplicabilityAdoption").prop("checked",!1),e.hide(),h("marketplace"),d.hide(),b("#transactionalRadio").prop("checked",!1),b("#marketplaceRadio").prop("checked",!0),b("#fxApplicabilityChoice").attr("value","decline"))}function n(){return d.isSPP()&&
b("input[name\x3disNewTFXExperienceEnabled]").length}var b=a.$;if(!b("html").hasClass("a-ie6")){var m=p.P&&p.P.AUI_BUILD_DATE,v,u,q,w;f.isTFXCurrencyToggleOnTabletFixed()?(b(document).delegate("#checkoutCurrencyTransactional","click",function(){h("transactional")}),b(document).delegate("#checkoutCurrencyMarketplace","click",function(){h("marketplace")})):(b(document).delegate("#transactionalRadio","click",function(){h("transactional")}),b(document).delegate("#marketplaceRadio","click",function(){h("marketplace")}));
b(document).delegate("#fxApplicabilityDecisionCheckbox","click",function(){e("decline")});b(document).delegate("#fxApplicabilityAdoptionCheckbox","click",function(){var a=n()&&!b("#fxApplicabilityAdoption").is(":checked");e(a?"decline":"accept")});a.on("a:expander:tfx-options-expander:toggle:expand",function(a){c.increaseCount("checkout:spp-ordersummary:expand_tfx_options",1)});a.on("a:expander:tfx-see-rate-expander:toggle:expand",function(a){c.increaseCount("checkout:spp-ordersummary:expand_tfx_see_rate",
1)});return{changeCurrency:h,initOrderSummary:k}}});"use strict";q.when("A","ready").register("spc-page-state",function(a){var l={};return{prop:function(a,c){if(a&&"string"===typeof a)return 1<arguments.length&&(l[a]=c),l[a]}}});"use strict";q.when("A","ready").execute(function(a){function l(){0<g("#spcCachedPromiseData").length&&(c=(new Date).getTime(),g(".place-your-order-button").click(function(){var a=(new Date).getTime()-c;g("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'spcWaitingTime' value\x3d'"+
a+"' /\x3e")}))}var g=a.$,c=0;a.on("checkout:reload:spc",l);a.on("checkout:reload:spclite",l);a.on("checkout:reload:spp-revieworder",l)});"use strict";q.when("A","client-side-metrics","ready").register("spc-apx-standin",function(a,l){function g(c){var f=a.state("apx-standin-state");f.timestamp=(new Date).toISOString();f.metricName=c;return f}if(a.state("apx-standin-state")){var c=g("APX_STANDIN_ENABLED");l.emitNexusMetrics(c,c.producerId,c.schemaId);a.on("a:popover:show",function(a){if(a.popover&&
a.popover.name&&"apx-popover"==a.popover.name||a.popover&&a.popover.originalFocus&&a.popover.originalFocus.id&&"payChangeButtonId"==a.popover.originalFocus.id)a=g("APX_STANDIN_POPOVER_SHOW"),l.emitNexusMetrics(a,a.producerId,a.schemaId)});a.on("a:sheet:afterShow:apx_standin_bottom_sheet_instance",function(a){a=g("APX_STANDIN_POPOVER_SHOW");l.emitNexusMetrics(a,a.producerId,a.schemaId)})}});"use strict";q.when("A","page-transition-controller","scroll-controller","loading-spinner-controller","page-conductor",
"checkout-general-utils","ready").register("changeCustomerDetailsPopover",function(a,l,g,c,d,f){function k(){return 0<n("#onblur-character-validation-error-changeNameInput").size()}function h(){b&&b.find("button[data-action\x3da-popover-close]").trigger("click")}function e(){var a=n("#saveButton");if(a.length){var b=n("#changeNameInput"),c=n("#changePostNumberInput"),d=n("#changePhoneInput"),e=1,f=1,h=1;b.length&&!b.val()&&(e=0);c.length&&!c.val()&&(f=0);d.length&&!d.val()&&(h=0);e&&f&&h&&!k()?(a.removeClass("a-button-disabled"),
a.removeAttr("disabled")):(a.addClass("a-button-disabled"),a.attr("disabled","true"))}}var n=a.$,b;a.declarative("clickedsave","click submit",function(a){if(!k()){var b=n("#changeNameInput").val(),c=n("#changePhoneInput").val(),e=n("#changePostNumberInput").val(),f=n("#changeAccountNameCheckBox").is(":checked")?1:0,g=n("#changePostNumberCheckBox").is(":checked")?1:0,b="custName\x3d"+encodeURIComponent(b)+"\x26changeAccountName\x3d"+encodeURIComponent(f);c&&(b=b+"\x26custPhoneNumber\x3d"+encodeURIComponent(c));
e&&(b=b+"\x26dhlPostNumber\x3d"+encodeURIComponent(e),g&&(b=b+"\x26changeDhlPostNumberInEmbu\x3d"+encodeURIComponent(g)));c=a.data.changeDetailUrl;d.isSPP()&&(c=a.$target.data("changedetailurl"),n("#cancelReminderPopover").click());d.isSPP()||(b+="\x26usePipelineDispatch\x3d1");l.show();c&&n.ajax({type:"POST",data:b,url:c,dataType:"html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:d.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,
b,c){h();l.hide();d.ajaxUpdatePage(a,b,c)},error:function(a,b,c){d.ajaxRedirect(a,b,c)}})}});a.declarative("clickedsave","mouseenter mousemove touchstart",function(a){e()});a.declarative("changeNameKeyIn changePostNumberKeyIn changePhoneNumberKeyIn","keydown keyup change keypress mouseenter mouseleave mousemove",function(a){e()});a.declarative("clickedcancel","click submit",function(a){h()});a.on("a:popover:beforeShow:changeDetailPopover",function(a){k()&&n("#onblur-character-validation-error-changeNameInput").remove()});
a.on("a:popover:show:changeDetailPopover",function(a){if(!d.isSPP()){var c=n(p).width(),f=n(p).height(),c=parseInt(.6*c,10),f=parseInt(.7*f,10);b=a.popover.$popover;var h=a.popover;b.css("position","absolute");b.css("top","50px");b.css("height",f+"px");b.css("width",c+"px");h.updatePosition()}c=d.isSPP()?a.popover.originalnamevalue:a.popover.$trigger.data("original-name-value");f=d.isSPP()?a.popover.originalcellphonevalue:a.popover.$trigger.data("original-cellphone-value");a=d.isSPP()?a.popover.originalpostnumbervalue:
a.popover.$trigger.data("original-postnumber-value");var h=n("#changeNameInput"),g=n("#changePhoneInput"),k=n("#changePostNumberInput");h.val(c);g.val(f);k.val(a);e()})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","page-detector","checkout-general-utils").register("prime-decline-controller",function(a,l,g,c,d,f){function k(){e("input[name\x3d'changeCardNoEndDatePrime']").attr("data-action","prime-decline-element")}function h(a,b,d){if(d.getResponseHeader("x-amz-checkout-page"))c.ajaxUpdatePage(a,
b,d);else{a=g.jsonify(a);if(!a)return c.redirect();a.error?l.hide():a.errors?l.hide():a.autohandlererror?(b=(a=a.autohandlererror)?a.action:null,d=a&&a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError",p.location.href="fatal"===b?"/gp/buy/payselect/handlers/error.html?errorAction\x3dfatal\x26errorType\x3d"+encodeURIComponent(d):"redirect"===b?a.url:"/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(d)):c.redirect(a)}}var e=a.$;e("html").hasClass("a-ie6")||
(a.declarative("prime-decline-element",["click","touchend"],function(a){f.protectAgainstDoubleAction("prime-decline-element")||(a.$event.preventDefault(),l.show(),a=(new Date).getTime(),a="changeCardNoEndDatePrime\x3d1\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26fromAnywhere\x3d"+e("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+a,e.ajax({type:"POST",url:"/gp/buy/spc/handlers/stuff-handler.html/ref\x3dox_spc_prime_renew_nodate",data:a,headers:{"Cache-Control":"no-cache",
pragma:"no-cache","x-amz-checkout-page":"spc"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:h,error:c.ajaxRedirect}))}),a.on("checkout:reload:spc",k),a.on("checkout:reload:spp-revieworder",k))});"use strict";q.when("A","loading-spinner-controller","page-conductor").register("prime-popover-controller",function(a,l,g){function c(){f={};a.defer(function(){0!==d("#spc-orders").find(".prime-popover-link").length&&(d("#spc-orders").find(".prime-popover-link").each(function(){var a=
d(this);if(a.data("action")){a.removeAttr("href").attr("tabindex",0);var c=a.data("aCheckoutModalPopover");var e=c.name,g="";c.width&&c.height&&(g="width:"+c.width+"px;height:"+c.height+"px;");0<d("#spc-orders").find("#"+e+"-popover").length||(c=d(['\x3cdiv id\x3d"a-popover-'+e+'" class\x3d"a-popover-preload" style\x3d"display:none;"\x3e','\x3cdiv id\x3d"'+e+'-popover" class\x3d"checkout" style\x3d"'+g+'"\x3e\x3c/div\x3e',"\x3c/div\x3e"].join("")),d("#spc-orders").append(c));a=a.data("aCheckoutModalPopover").name;
f[a]||(c=d(".prime-popover-content").html())&&0<c.length&&(f[a]=c,d("#"+a+"-popover").html(c))}}),d("#spc-orders").find(".a-box").each(function(){var a=d(this),c=a.find(".prime-ad-banner-content .prime-popover-link");1<c.length&&(c=c.first());a.find("a.primeAdLauncher").each(function(){var a=d(this);a.wrap('\x3cspan class\x3d"a-declarative" data-action\x3d"prime-event" data-prime-event\x3d\'{"metric":"lm3"}\'\x3e\x3c/span\x3e');a.replaceWith(c.clone().text(a.text()).addClass("a-size-mini"))})}))})}
var d=a.$;if(!d("html").hasClass("a-ie6")){var f={};a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("prime")&&(a=a.popover.name,!f[a])){var c=d("input#primePopopverFallbackContent").val()||"";f[a]=c;d("#"+a+"-popover").html(c)}});a.on("checkout:reload:spc",c);a.on("checkout:reload:spp-revieworder",c)}});"use strict";q.when("A","page-transition-controller","back-button-protection","page-conductor","continue-wrapper-selector","weblab-helper").register("place-order-controller",
function(a,l,g,c,d,f){function k(){if(!c.isAnimating()){var h=e("#spc-form");if("0"===e("#showPageTransition").attr("content"))if(h.hasClass("paylast-spc"))l.show();else{if(0<e("#enableAlternatePYOBlocker").length){var b;b=d.SELECTOR?e(d.SELECTOR):h.find(".a-button.continue-button");if("disabled"===b.find("input").attr("disabled"))return;b.find("input").attr("disabled","disabled");b.addClass("a-button-disabled");setTimeout(function(){b.removeClass("a-button-disabled");b.find("input").removeAttr("disabled")},
4E4)}}else l.showPageTransition();var k=e("#currencyChanged");0<k.length&&"true"===k.val()&&(k='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+e("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',e("#spc-form-inputs").append(k));if(f.isMfaPSD2DeviceDescriptionCollectionEnabled())for(var k=[{name:"javaEnabled",value:p&&p.navigator&&p.navigator.javaEnabled()},{name:"language",value:p&&p.navigator&&p.navigator.language},{name:"screenColorDepth",value:p&&p.screen&&
p.screen.colorDepth},{name:"screenHeight",value:p&&p.screen&&p.screen.height},{name:"screenWidth",value:p&&p.screen&&p.screen.width},{name:"timeZone",value:(new Date).getTimezoneOffset()}],q=0;q<k.length;q++)if(k[q].name!==F&&k[q].value!==F){var u='\x3cinput type\x3d"hidden" name\x3d"'+k[q].name+'" value\x3d"'+k[q].value+'" /\x3e';e("#spc-form-inputs").append(u)}0==h.find("input[type\x3d'hidden'][name\x3d'placeYourOrder1']").length&&h.append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");
(k=a.state("firetv-aws-attributes"))&&k.queryParams&&(q=h.attr("action"),q+=0<=q.indexOf("?")?"\x26":"?",q+=e.param(k.queryParams),h.attr("action",q));c.isSPP()&&h.append(e("#subtotalsSection").find("input").hide());g.markAsDirty();h.submit()}}function h(a){a.preventDefault();k(a.target)}var e=a.$;if(!e("html").hasClass("a-ie6"))return a.declarative("a-checkout-place-order",["click"],function(a){k(a.target)}),e(document).delegate("span.place-order-button-link","click",h),{placeOrderClick:k,placeOrderClickDelegate:h,
PLACE_ORDER_BUTTON_LINK_SELECTOR:"span.place-order-button-link"}});"use strict";q.register("continue-wrapper-selector",function(){return{SELECTOR:null}});"use strict";q.when("A","page-conductor","button-blocker","client-side-metrics","weblab-helper").register("verification-checkbox-controller",function(a,l,g,c,d){function f(a){w?k(a):h(a);B&&a&&a.blocking&&(c.setmarker("fn"),B=!1)}function k(a){var c=v(".continue-button"),d=v(".continue-button-blocker"),e=v(".place-order-blocker-message.custom-blocker-message");
if(a.blocking||!b())a.blocking?(e.text(a.message),c.addClass("aok-hidden"),d.removeClass("aok-hidden")):(e.empty(),c.removeClass("aok-hidden"),d.addClass("aok-hidden"),q.when("a-tooltip").execute(function(a){(a=a.get(d))&&a.isActive()&&a.hide()}))}function h(a){a.blocking?g.show("place-order-imb-checks",a.message):(g.hide("place-order-imb-checks"),v("#hasTVNavigation").length&&q.when("a-tv").execute(function(a){a.select(".continue-button")}))}function e(){var b,e={blocking:!1,message:""};if(w)b=v("#spc-imb").find(".verification-checkbox input:not(:checked)"),
0<b.length&&(e={blocking:!0,message:b.first().closest(".verification-checkbox").attr("data-blocker-message")});else{c.increaseCount("removeauijs23");if(!v("#spc-imb").find(".verification-checkbox").length)return;b=l.isSPP()?v("#spc-imb").find(".verification-checkbox input:not(:checked)"):v("#spc-imb").find(".verification-checkbox:not(:checked)");0<b.length&&(e={blocking:!0,message:l.isSPP()?b.first().closest(".spp-panel").hasClass("aok-hidden")?b.first().closest(".verification-checkbox").data("non-review-panel-blocker-msg"):
b.first().closest(".verification-checkbox").data("blocker-message"):b.first().attr("data-blocker-message")})}d.isPyoClientSideInitiationEnabled()?f(e):a.trigger("checkbox:primaryActionBlocker:blockingStateChanged",e)}function n(){var a=v("#wineNoticeCheckbox");a&&a.length&&(u?(a.attr("checked",""),z&&(a=a.siblings(".a-icon-touch-checkbox-inactive"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-touch-checkbox-active"))):(a.removeAttr("checked",""),z&&(a=a.siblings(".a-icon-touch-checkbox-active"))&&
a.length&&(a.removeClass("a-icon-touch-checkbox-active"),a.addClass("a-icon-touch-checkbox-inactive"))))}function b(){var a=v("input[name\x3disINExpressCheckoutCC]");return a&&a.length?1===parseInt(a.val(),10):!1}function m(){d.isPyoClientSideInitiationEnabled()||n();v('[data-client-component\x3d"PrimaryActionBlockerCheckbox"]').length||(e(),d.isPyoClientSideInitiationEnabled()&&n());var a=p.P&&p.P.AUI_BUILD_DATE?'.verification-checkbox input[type\x3d"checkbox"]':"input.verification-checkbox";v("#spc-imb").find(a).unbind("change.verification-checkbox").bind("change.verification-checkbox",
e)}var v=a.$,u,z=v("html").hasClass("a-touch"),w=!l.isSPP()&&p.P&&p.P.AUI_BUILD_DATE,B=!0;if(!v("html").hasClass("a-ie6")){if(!d.isPyoClientSideInitiationEnabled())a.on("checkbox:primaryActionBlocker:blockingStateChanged",f);a.declarative("change-wine-notice-checkbox",["change"],function(a){u=a.$target.is(":checked")?1:0});a.on("checkout:reload:spc",m);a.on("checkout:reload:spclite",m);a.on("checkout:reload:spp-revieworder",m);a.on("checkout:reload:spp-collapsed",m);a.on("checkout:unload",function(){B=
!0});a.on("checkout:afterReload",function(){B=!1});return{verifyCheckboxes:e,updatePyo:f}}});"use strict";q.when("A","page-transition-controller","scroll-controller","ajax-utility","page-conductor","quantity-service","checkout-modal-popover","page-detector","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("quantity-update-controller",function(a,l,g,c,d,f,k,h,e,n,b,m){function v(){ba=V=!1;a.defer(function(){var a=D("#spc-orders");a.find("a.quantity-change-button-static").remove();
"1"!==D("#spc-form-inputs").find("input[name\x3d'isQuantityInvariant']").val()&&a.find("div.quantity-value-static").remove()});D(".lineitem").each(function(a,b){a=D(b);a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))});var c=D("#pantry-mov-popover-content"),d=D("#pantry-mov-popover-placeholder");!c.length&&
d.length&&(c=d.attr("data-device"),D.ajax({type:"GET",url:"/gp/pantry/checkout/mov/get-pantry-mov-popover-contents.html",data:"device\x3d"+c,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,c,e){~a.indexOf("pantry-mov-popover-content")?d.append(a):b.increaseCount("checkout:pantry:pantry_mov_popover_contents:bad-content",1)},error:function(a,c,d){b.increaseCount("checkout:pantry:pantry_mov_popover_contents:"+d,1)}}))}function u(a,
b){a=D('.update-quantity-error[data-itemid\x3d"'+a+'"]');a.find(".error-message").hide();a.find('.error-message[data-error-type\x3d"'+b+'"]').show();a.find("i").show();a.find(".a-span12").show();a.show();b=a.closest(".item-details-right-column");b.find(".spc-quantity-dropdown-button").addClass("a-button-error");b.find(".spc-quantity-input").addClass("a-form-error");b=a.parents("div.update-quantity-error");a=b.siblings(".item-details");0<a.length&&(a.find(".a-input-text-wrapper").addClass("a-form-error"),
a.removeClass("a-spacing-large"),a.find(".a-touch-select").addClass("a-input-text a-form-error"));b.show()}function z(a,f,h){var k=h.getResponseHeader("x-amz-checkout-new-cart-quantity");e.updateCartByMash(k);if(h.getResponseHeader("x-amz-checkout-page"))d.ajaxUpdatePage(a,f,h,{pushNewFrame:"false"}),a=h.getResponseHeader("x-amz-checkout-updated-itemid"),h=h.getResponseHeader("x-amz-checkout-quantity-error"),a&&h&&u(a,h);else if(a=c.jsonify(a))if(a&&a.errors&&a.errors.pantry&&a.errors.pantry.mov)B(a.errors.pantry.showAddonInfo);
else{if(a&&a.errors&&a.errors.addon&&(d.isSPP()&&b.increaseCount("checkout:spp-revieworder:addon_warn_pri",1),h=a.errors.addon.type,f=a.errors.addon.asins,w(),D(".item-list").hide(),f.forEach(function(a){D('[data-asin\x3d"'+a+'"]').show()}),h=D("#addon-warning-"+h+"-launcher"),h.length)){D("input[name\x3duseLiveAUI]").length?n.get(h).attrs({$trigger:fa}).show():aa&&D("div.checkout.spc-mobile.aui-templatized").length?h.click():(b.increaseCount("removeauijs19"),a=D.Event("keyup",{triggerPositioningElement:fa,
manualTrigger:!0}),h.trigger(a),0<D("div.spc-mobile").length&&(g.scrollToTop(),g.toggleScrollOff()));l.hide();return}return d.redirect(a)}else d.redirect()}function w(){D("#a-popover-addon-warning-normal .select-address-title").hide();0<N?(D("#a-popover-addon-warning-normal .reduce-title").show(),D("#a-popover-addon-warning-normal .delete-title").hide()):(D("#a-popover-addon-warning-normal .delete-title").show(),D("#a-popover-addon-warning-normal .reduce-title").hide())}function B(a){var c=D("#pantry-mov-popover-launcher"),
e=D(".pantry-mov-reduce-prompt"),f=D(".pantry-mov-delete-prompt"),h=D("#pantry-mov-addon-info-container");c.length?(P()||b.increaseCount("checkout:pantry:pantry_mov_popover:non_spc",1),h.length&&h.empty(),a&&D("#addon-warning-normal-popover-content").length&&(w(),h.length||(h=D("\x3cdiv/\x3e",{id:"pantry-mov-addon-info-container"})),h.append('\x3chr class\x3d"a-divider-normal"\x3e').append(D("#addon-warning-normal-popover-content").html()).appendTo("#pantry-mov-popover-content")),0<N?(e.show(),f.hide()):
(f.show(),e.hide()),c.length&&(c.click(),l.hide())):(b.increaseCount("checkout:pantry:pantry_mov_popover_contents:no-launcher",1),d.redirect())}function r(a,b){l.show();var c={isClientTimeBased:D('input[name\x3d"useCtb"]').val(),fromAnywhere:D("input[name\x3dfromAnywhere]").val(),success:z};if(b)for(var e in b)b.hasOwnProperty(e)&&(c[e]=b[e]);d.isSPP()?(c.ref="chk_ship_chg_qty_pri",b=D("#setOrderingPrefsCheckbox"),b.length&&b.is(":checked")&&(c.saveAsDefaultsSelected=1)):D(".spc-mobile.aui-templatized").length&&
(c.ref="ox_spc_change_quantity");b=D("#addon-indicator")&&"true"===D("#addon-indicator").attr("data-has-addon-items");e=D("#pantry-mov-indicator")&&"true"===D("#pantry-mov-indicator").attr("data-has-pantry-items");a||!b&&!e||(c.istrial=1);f.call(x,N,c);L?L.data("currentQuantity",N):O&&O.data("currentQuantity",N)}function t(){l.hide();p.location="/gp/aw/c/ref\x3dox_spc_deal_expired?app-action\x3dcart"}function H(a){var b=U;N=U;L&&q.when("a-dropdown").execute(function(a){L&&(a.getSelect(L).setValue(b.toString()),
L.data("currentQuantity",N))});a===X.addOn&&g.toggleScrollOn();O&&(O.val(b),O.data("currentQuantity",N),a=O.closest(".quantity-block"),a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),a.find(".dynamic-quantity-update").hasClass("stay-visible")||a.find(".dynamic-quantity-update").addClass("hidden").children().addClass("hidden"))}function y(a,c){var d=a.$currentTarget.is("a")?
a.$currentTarget:a.$currentTarget.find("a");x=d.data("entityId");N=0;L=null;U=d.data("currentQuantity");fa=D("a.quantity-delete-button[data-entity-id\x3d'"+x+"']");fa.length||(fa=a.$currentTarget);O=d.closest(".dynamic-quantity-update").find(".quantity-input");O.length||(O=null);d.data("isBundleDelete")?m.isMobileBundleDeleteFixEnabled()?D("#pb-delete-trigger-"+d.data("bundleGroupId")).trigger("click"):setTimeout(function(){D("#pb-delete-trigger-"+d.data("bundleGroupId")).trigger("click")},100):m.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&
d.data("showItemAssocDeletePopover")?(b.increaseCount("checkout:item-association:delete:selected",1),setTimeout(function(){D("#ia-delete-trigger-"+d.data("itemAssocGroupId")).trigger("click")},100)):(r(!1,c),k.hideById(d.closest(".a-popover").data("aPopoverId")))}function G(a){if(!e.protectAgainstDoubleAction("order-summary-update-quantity",200)){b.resetMetrics();var c=a.$currentTarget,d=c.closest(".lineitem"),f=c.find("select"),h=f.length?f:c;x=d.data("entityId");f=D('.update-quantity-error[data-itemid\x3d"'+
x+'"]');O=L=null;h.is("select")?(L=c.find("select"),N=h.val()):(O=d.find(".quantity-input"),N=O.val());U!==N&&(fa=h.is("select")?L.parent():O,""===N?F(d):"Delete"===N||0===parseInt(N,10)?(a.$event.preventDefault(),e.protectAgainstDoubleAction("delete-item")||E(a)):(a=parseInt(D("#quantity-input-max-value").val(),10),e.validateNumber(N,0,a)?(f.hide(),d.blur(),d.data("isBundleDelete")?m.isMobileBundleDeleteFixEnabled()?D("#pb-delete-trigger-"+d.data("bundleGroupId")).trigger("click"):setTimeout(function(){D("#pb-delete-trigger-"+
d.data("bundleGroupId")).trigger("click")},100):r(!1)):u(x,"changeQuantity_quantityNotInRange")))}}function E(a,b){var c=a.$currentTarget.closest(".lineitem");x=c.data("entityId");N=0;c.data("isBundleDelete")?m.isMobileBundleDeleteFixEnabled()?D("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click"):setTimeout(function(){D("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):(r(!1,b),k.hideById(c.closest(".a-popover").data("aPopoverId")))}function I(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),
c=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),d=a.$currentTarget.find("input").data("currentQuantity");U=d;-1===parseInt(c,10)||""===c?("change"===a.type&&F(a.$currentTarget.closest(".lineitem")),b.hide()):parseInt(c,10)!==d?b.show():b.hide()}function F(a){a.find(".quantity-input").val(U)}function W(c,d,e){var f=d.data("itemAssocGroupId"),h="a:sheet:beforeShow:ia-delete-mbs-"+f,g="a:sheet:afterHide:ia-delete-mbs-"+f;a.on(h,function ra(b){b=b.sheet.getContentContainer();
var c=D("#ia-delete-"+f).html();c&&(b.empty(),b.html(c));a.off(h,ra)});q.when("a-dropdown").execute(function(d){a.on(g,function S(){b.increaseCount("checkout:item-association:delete:canceled",1);D("#ia-delete-trigger-"+f).data("isItemAssocAlreadyDeleted")||(N=e,L.data("currentQuantity",e),d.getSelect(c).setValue(e));a.off(g,S)})});D("#ia-delete-trigger-"+f).trigger("click")}function P(){return d.isSPP()?D("#revieworder").hasClass("expanded")?!0:!1:0<D("div.spc").length?!0:!1}var D=a.$;if(!D("html").hasClass("a-ie6")){var N,
U,x,L,O,V=!1,ba=!1,fa,aa=p.P&&p.P.AUI_BUILD_DATE,X={addOn:"addOn",pantryMOV:"pantryMOV"};a.declarative("change-quantity",["click","touchend"],function(a){if(!e.protectAgainstDoubleAction("lock-update-quantity",200)){a=a.$currentTarget;var b=!0;a.addClass("hidden");a=a.closest(".quantity-block");a.find(".change-quantity").addClass("hidden");a.find(".quantity-display").addClass("hidden");a.find(".quantity-display-block-tablet").addClass("hidden");a.find(".dynamic-quantity-update").removeClass("hidden").find(".hidden").each(function(){var a=
D(this);a.removeClass("hidden");a.is("input")&&(a.focus(),a.select(),a.unbind("keydown.update-quantity-spc").bind("keydown.update-quantity-spc",function(a){13===a.which&&a.preventDefault()}),a.unbind("keyup.update-quantity-spc").bind("keyup.update-quantity-spc",function(a){13!==a.which||b||D(a.target).closest(".dynamic-quantity-update").find(".update-quantity-button").trigger("click")}))});setTimeout(function(){b=!1},500)}});a.declarative("order-summary-get-quantity",["click","touchend"],function(a){e.protectAgainstDoubleAction("order-summary-get-quantity",
200)||a.$currentTarget.find("select").length&&(U=a.$currentTarget.find("select").val())});a.declarative("order-summary-update-quantity",["change"],G);a.declarative("order-summary-update-quantity-text-field",["click","touchend"],G);a.declarative("order-summary-handle-text-input",["keydown"],function(a){13===a.$event.which?(a.$event.preventDefault(),G(a)):e.limitInputToNumbers(a)});a.declarative("order-summary-show-update-button",["change","keyup"],I);a.declarative("trigger-update-quantity-button",
["keydown"],function(a){13===a.$event.which&&(a.$event.preventDefault(),a.$currentTarget.closest(".quantity-block").find(".update-quantity-button").trigger("click"))});a.declarative("toggle-update-quantity-button",["change","keyup"],function(a){var b=a.$currentTarget.closest(".quantity-block").find(".update-quantity-button"),c=a.$currentTarget.find("input"),d=c.val(),e=c.data("currentQuantity");""===d?("change"===a.type&&c.val(e),b.hide()):parseInt(d,10)!==e?b.show():b.hide()});a.declarative("update-quantity",
["click","touchend"],function(a){b.resetMetrics();var c=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");a=c.closest(".quantity-block");var d=c.closest(".dynamic-quantity-update"),f=d.find(".quantity-input");d.length||(f=a.find(".quantity-input"));if(e.protectAgainstDoubleAction("lock-update-quantity",200))f.focus();else{var h=f.val();x=c.data("entityId");var g=D('.update-quantity-error[data-itemid\x3d"'+x+'"]'),k=parseInt(D("#quantity-input-max-value").val(),10);e.validateNumber(h,
0,k)?(g.hide(),d.find(".a-form-error").removeClass("a-form-error"),f.removeClass("a-form-error"),h=parseInt(h,10),O=f,U=O.data("currentQuantity"),U=parseInt(U,10),h===U?(a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),d.addClass("hidden").children().addClass("hidden")):(N=h,fa=c,c.blur(),c.data("isBundleDelete")?m.isMobileBundleDeleteFixEnabled()?D("#pb-delete-trigger-"+
c.data("bundleGroupId")).trigger("click"):setTimeout(function(){D("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):r(!1))):u(x,"changeQuantity_quantityNotInRange")}});D(document).delegate(".spc-quantity-dropdown","change",function(a){L=D(a.currentTarget);b.resetMetrics();aa?(a=L.next(),x=a.data("entityId"),U=a.data("currentQuantity")):(b.increaseCount("removeauijs21"),x=L.data("entityId"),U=L.data("currentQuantity"));var c=L.find(":selected");N=parseInt(c.val(),10);U!==N&&(a=
D("#toggleDropdownQuantityTrigger"),a.length&&N===parseInt(a.val(),10)?(a=L.closest(".quantity-block"),a.find(".spc-quantity-dropdown-button").hide(),a.find(".quantity-input").show()):(fa=L.parent(),L.blur(),c&&c.data("isBundleDelete")?m.isMobileBundleDeleteFixEnabled()?D("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click"):setTimeout(function(){D("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):m.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&
c&&c.data("showItemAssocDeletePopover")||r(!1)))});a.on("a:dropdown:select",function(a){if(m.isItemAssociationDeleteConfirmationPopoverForWirelessPlansEnabled()&&(a=D(a.nativeItemNode))&&a.data("showItemAssocDeletePopover")){b.increaseCount("checkout:item-association:delete:selected",1);var c=a.closest("select"),d=aa?c.next().data("currentQuantity"):c.data("currentQuantity");W(c,a,d)}});a.declarative("item-assoc-delete-confirm",["click","touchend"],function(a){if(!e.protectAgainstDoubleAction("item-assoc-delete-confirm")){b.increaseCount("checkout:item-association:delete:confirmed",
1);r(!1);var c=D(a.$target).data("itemAssocGroupId");D("#ia-delete-trigger-"+c).data("isItemAssocAlreadyDeleted",1);q.when("a-sheet").execute(function(a){var b=a.get("ia-delete-mbs-"+c);b&&a.hideSheet(b)})}});a.declarative("item-assoc-delete-cancel",["click","touchend"],function(){e.protectAgainstDoubleAction("item-assoc-delete-cancel")||(b.increaseCount("checkout:item-association:delete:canceled",1),N=U)});a.declarative("dont-delete-item",["click","touchend"],function(a){a.$event.preventDefault();
e.protectAgainstDoubleAction("dont-delete-item")||k.hideById(a.$currentTarget.closest(".a-popover").data("aPopoverId"))});a.declarative("delete-item",["click","touchend"],function(a){a.$event.preventDefault();e.protectAgainstDoubleAction("delete-item")||y(a)});a.declarative("delete-prime-membership-item-confirm",["click","touchend"],function(a){a.$event.preventDefault();if(!e.protectAgainstDoubleAction("delete-prime-membership-item-confirm")){var b={additionalData:{deletePrimeMembership:1,primeMembershipASIN:(a.$currentTarget.is("a")?
a.$currentTarget:a.$currentTarget.find("a")).data("asin")}};y(a,b)}});a.declarative("bundle-delete",["click","touchend"],function(){e.protectAgainstDoubleAction("bundle-delete")||r(!1)});a.declarative("bundle-delete-action",["click","touchend"],function(a){e.protectAgainstDoubleAction("bundle-delete-action")||(q.when("a-popover-base").execute(function(b){b.get(a.data.popoverName).hide()}),r(!1))});a.declarative("egc-delete",function(a){x=a.entityId;N=0;r(!0)});a.declarative("bundle-dont-delete",["click",
"touchend"],function(){e.protectAgainstDoubleAction("bundle-dont-delete")||(N=U,m.isMobileBundleDeleteFixEnabled()?q.when("a-dropdown").execute(function(a){L&&(a.getSelect(L).setValue(U.toString()),L.data("currentQuantity",N))}):L&&q.when("a-dropdown").execute(function(a){a.setValue(L.attr("id"),U.toString());L.data("currentQuantity",N)}))});a.declarative("pantry-return-to-cart-btn",["click","touchend"],function(){e.protectAgainstDoubleAction("pantry-return-to-cart-btn")||P()&&t()});a.declarative("pantry-delete-items-btn",
["click","touchend"],function(){!e.protectAgainstDoubleAction("pantry-delete-items-btn")&&P()&&(ba=!0,D(".a-button-close").trigger("click"),r(!0))});a.declarative("pantry-cancel-delete-btn",["click","touchend"],function(){e.protectAgainstDoubleAction("pantry-cancel-delete-btn")||P()&&H(X.pantryMOV)});a.on("a:popover:hide:pantry-mov-popover",function(){P()&&(ba||H(X.pantryMOV))});a.declarative("addon-return-to-cart",["click","touchend"],function(){e.protectAgainstDoubleAction("addon-return-to-cart")||
P()&&t()});a.declarative("addon-delete-items",["click","touchend"],function(){e.protectAgainstDoubleAction("addon-delete-items")||(P()&&(V=!0,D(".a-button-close").trigger("click"),r(!0)),d.isSPP()&&b.increaseCount("checkout:spp-revieworder:addon_delete_pri",1))});a.declarative("addon-dont-delete",["click","touchend"],function(){e.protectAgainstDoubleAction("addon-dont-delete")||(P()&&H(X.addOn),d.isSPP()&&b.increaseCount("checkout:spp-revieworder:addon_keep_pri",1))});a.on("a:popover:hide:addon-warning-normal",
function(){0<D("div.spc-mobile").length?t():P()&&(V||H(X.addOn))});a.on("a:popover:hide:addon-warning-special",function(){P()&&(V||H(X.addOn))});a.on("checkout:reload:spc",v);a.on("checkout:reload:spp-revieworder",v)}});q.when("A","ready").execute(function(a){a.on("a:popover:beforeShow",function(a){if(a.popover.$trigger.hasClass("quantity-dropdown-button")){var g=a.popover.$popover,c=g.closest("div.a-dropdown");c.length&&(a.popover.$iframe.css("max-height","260px"),g.css("max-height","260px"),g=c.find("div.a-popover-inner"),
g.css({"max-height":"260px"}),a.popover.updatePosition(),g.css({"overflow-y":"scroll"}))}})});"use strict";q.when("A","page-transition-controller","page-conductor","ajax-utility").register("tax-exemption-controller",function(a,l,g,c){function d(a,d,f){return f.getResponseHeader("x-amz-checkout-page")?g.ajaxUpdatePage(a,d,f,{pushNewFrame:"false"}):(a=c.jsonify(a))?g.redirect(a):g.redirect()}function f(a,c){var f=c.$target.data("entityId");if(f){l.show();var b={isClientTimeBased:k('input[name\x3d"useCtb"]').val(),
fromAnywhere:k("input[name\x3dfromAnywhere]").val()},b=b||{};c={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};k.extend(c,b);c.entityId=f;c.optOut=a;a=g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});k.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/tax-exemption-optout.html",data:k.param(c),dataType:"text",async:!0,cache:!1,headers:a,success:d,error:g.ajaxRedirect})}else p.ueLogError&&p.ueLogError({name:"MissingData",message:"lineItemId is undefined, when trying to opt out from tax exemption",
logLevel:"FATAL"})}var k=a.$;k("html").hasClass("a-ie6")||(a.declarative("tax-exemption-opt-out",["click","touchend"],function(a){f(!0,a)}),a.declarative("tax-exemption-opt-in",["click","touchend"],function(a){f(!1,a)}))});"use strict";q.when("A").execute(function(a){return{}});"use strict";q.when("A","page-transition-controller","page-conductor").register("sns-subscription-controller",function(a,l,g){function c(){var c=k(document);c.delegate(".sns-option","click",function(a){a=k(this);f(a.closest(".sns-upsell"),
a)});c.delegate(".sns-option-mobile","click",function(a){var c=k(this);a.target.name&&"snsSetCreateSubscription"===a.target.name&&f(c.closest(".sns-upsell-mobile"),c)});c.delegate(".sns-option-tablet","click",function(a){a=k(this);f(a.closest(".sns-upsell-tablet"),a)});c.delegate(".sns-upsell-nextdelivery","change",function(){d(k(this))});a.declarative("sns-upsell-nextdelivery-dropdown","change",function(a){d(k(a.$target))});c.delegate(".sns-upsell-learn-more","click",function(a){var c=k(this);a=
c.width();var b=c.height(),d=c.position(),c=c.find(".sns-upsell-popover-learn-more");c.removeClass("aok-hidden");var f=c.width();c.height();c.css({top:d.top+b,left:d.left-(f-a)/2,position:"absolute"})});c.delegate(".sns-upsell-learn-more-close","click",function(a){(a=k(this))&&a.closest(".sns-upsell-popover-learn-more")&&a.closest(".sns-upsell-popover-learn-more").addClass("aok-hidden");return!1})}function d(a){var c=a.closest(".sns-upsell,.sns-upsell-mobile,.sns-upsell-tablet");if(a.length&&c.length){var d=
c.data("index"),b=c.find("span.sns-change-delivery-txt");b&&b.text(a.find("option:selected").data("date"));b=a.find("option:selected").data("epoch");a=a.find("option:selected").val();c.find("input[type\x3d'hidden'][name\x3d'sns_nextDelivery"+d+"']").val(b);c.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+d+"']").val(a)}}function f(a,c){l.show();var d=a.data("index"),b=(new Date).getTime(),f=a.find("input[type\x3d'hidden'][name\x3d'sns_lineItemIdentifier"+d+"']").attr("value"),p=a.find("input[type\x3d'hidden'][name\x3d'sns_merchantId"+
d+"']").attr("value"),u=a.find("input[type\x3d'hidden'][name\x3d'sns_asin"+d+"']").attr("value");a=a.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+d+"']").attr("value");c=c.prop("checked")||c.find("[type\x3dcheckbox]").is(":checked");b={returnpipedata:0,returnFullHTML:1,cachebuster:b,hasWorkingJavascript:1};b.lineItemIdentifier=f;b.isONMLSelected=c?1:0;b.merchantId=p;b.asin=u;b.frequency=a;f=g.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});k.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-sns-options.html",
data:k.param(b),dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){return g.ajaxUpdatePage(a,b,c)},error:function(a,b,c){g.ajaxRedirect(a,b,c)}})}var k=a.$;k("html").hasClass("a-ie6")||c()});"use strict";q.when("A","page-detector","page-detector-current-page","page-conductor","page-transition-controller","ajax-utility","place-order-controller","client-side-metrics").execute(function(a,l,g,c,d,f,k,h){function e(a){"function"===typeof p.ues&&(p.ues("t0",a,new Date),p.ues("ctb",a,"1"));
"function"===typeof p.uet&&p.uet("tc",a,{wb:1})}function n(a,b){"function"===typeof p.uet&&p.uet(a,b,{wb:1})}function b(a){p.ueLogError&&p.ueLogError({message:a},{logLevel:"WARN",attribution:"ajax-typ"})}function m(){var a=G("span#typ-load").attr("data-typ-args");p.location.href="https://"+p.location.hostname+"/gp/buy/thankyou/handlers/display.html?"+a}function q(){n("cf","ajax-typ:place-your-order");if(x){var a=G("#typ-desktop-frame").contents(),b=x;if(b.deliveryestimates)for(var c in b.deliveryestimates)if(b.deliveryestimates.hasOwnProperty(c)){var e=
a.find("span#"+c);e&&e.replaceWith(b.deliveryestimates[c])}b.autorip&&(a=a.find("#thank-you-rogue"))&&a.replaceWith(b.autorip)}b=G("#typ-desktop-frame").contents();a=b.find("span#typ-rewrite-url");history&&history.pushState&&a&&0<a.length&&(history.pushState({},"",a.attr("data-url")),a.attr("data-view"));b=b.find("title").text();G("#checkoutDisplayPage").hide();G("#typ-desktop").show();document.title=b;d.hide();G("span#typ-load").attr("data-typ-args");n("be","ajax-typ:place-your-order");h.setmarker&&
(b=h.getscope(),O&&h.setscope("ajax-typ"),h.setmarker("cf"),O&&h.setscope(b));O||(h.sendUEPageLoadStats(),"function"===typeof p.uex&&p.uex("ld","ajax-typ:place-your-order",{wb:1}))}function u(a,d,e){a&&a.conductoraction&&a.conductoraction.url?c.redirect(a):(n("af","ajax-typ:place-your-order"),x=a,W?q():F?P=1:(b("No TYP data available after place-order, redirecting to static TYP"),m()))}function z(){if(!fa)if(ba&&clearTimeout(ba),3===V.readyState){var a;try{a=f.jsonify(V.responseText)}catch(d){a=null}null!==
a?(fa=1,u(a)):ba=setTimeout(z,50)}else 4===V.readyState&&(fa=1,200===V.status?(a=f.jsonify(V.responseText),null!==a?u(a):(b("No results from place-order, calling ajaxRedirect"),c.ajaxRedirect())):(b("Error calling place-order, calling ajaxRedirect"),c.ajaxRedirect()))}function w(){da=1;N&&clearTimeout(N);U&&clearTimeout(U);var a=G("#currencyChanged");0<a.length&&"true"===a.val()&&(a='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+G("#tfx-switch-currency-options").find("input:radio:checked").val()+
'" /\x3e',G("#spc-form-inputs").append(a));G("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");a=(new Date).getTime()-aa;G("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'waitingTime' value\x3d'"+a+"' /\x3e");G("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'returnjson' value\x3d'1' /\x3e");X&&G("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'isAsyncTYPEnabled' value\x3d'1' /\x3e");var a=G("#spc-form").serialize(),d=G("#typ-desktop-frame").contents().find("input#cached-promise-data");
0<d.length&&(a+="\x26cachedPromiseData\x3d"+d.val());if(L){if(p.XMLHttpRequest)V=new XMLHttpRequest;else if(p.ActiveXObject)try{V=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){V=null}if(!V){b("Can't get XMLHttpRequest for data stream, calling standard placeOrderController");da=1;k.placeOrderClick();return}V.open("POST","/gp/buy/spc/handlers/place-your-decoupled-order.html",!0);V.setRequestHeader("Content-type","application/x-www-form-urlencoded");V.setRequestHeader("Content-length",a.length);V.setRequestHeader("Connection",
"close");V.onreadystatechange=z;V.overrideMimeType("text/plain");V.send(a)}else G.ajax({type:"POST",url:"/gp/buy/spc/handlers/place-your-decoupled-order.html",data:a,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return f.jsonify(a)},success:function(a,d,e){null!==a?u(a,d,e):(b("No results from place-order, calling ajaxRedirect"),c.ajaxRedirect())},error:function(a,d,e){b("Error calling place-order, calling ajaxRedirect");c.ajaxRedirect(a,d,e)}});"function"===typeof p.uet&&p.uet("bb","ajax-typ:place-your-order",
{wb:1})}function B(){W=F=D=0;G("div#typ-desktop").empty()}function r(a,b,c){D||(D=1,clearTimeout(U),F=0,W=1,E++,(a=G("#typ-desktop-frame").contents().find("span#typ-rewrite-url"))&&0<a.length&&(a=a.attr("data-requestid"),e("ajax-typ:place-your-order"),O||(h.setAsyncRequestId(a),"function"===typeof p.ues&&p.ues("id","ajax-typ:place-your-order",a))),P?q():!da&&5>E&&(N=setTimeout(function(){B();t()},12E4)))}function t(){if(!(da||F||5<=E)){F=1;var a=G("span#typ-load").attr("data-typ-args");U=setTimeout(function(){B();
P&&(b("Timed out waiting for TYP fetch after place-order, redirecting to static TYP"),m())},45E3);G("\x3ciframe /\x3e",{name:"typ-desktop-frame",id:"typ-desktop-frame",width:"100%",height:"100%",frameborder:"0",src:"/gp/buy/thankyou/handlers/display.html?"+a}).appendTo("div#typ-desktop").load(r)}}function H(){r()}function y(){l.isSpc()&&0<G("span#typ-load").length&&(aa=(new Date).getTime(),E=0,G("div#typ-desktop").length?B():G("body").append('\x3cdiv id\x3d"typ-desktop" style\x3d"position:absolute;left:0;right:0;bottom:0;top:0;display:none;"\x3e\x3c/div\x3e'),
L=G("span#typ-load").attr("data-early-json-flush")&&!G("html").hasClass("a-lt-ie10"),X=0<G("span#async-typ-enabled").length,O=G("span#typ-load").attr("data-use-cds-stub"),G(document).undelegate("span.place-order-button-link","click"),G(document).delegate("span.place-order-button-link","click",function(a){a.preventDefault();O?(a=h.getscope(),h.setscope("ajax-typ"),h.setctb(),h.resetue(),h.setmarker("tc"),h.setscope(a)):(h.resetMetrics(),h.setmarker("tc"));F||W?(d.show(),w()):(da=1,k.placeOrderClick())}),
t())}var G=a.$;if(!G("html").hasClass("a-ie6")){var E=0,F=0,da=0,W=0,P=0,D=0,N,U,x,L=0,O=0,V,ba,fa=0,aa=0,X=0;a.on("ajax-typ-cf",H);a.on("checkout:reload:spc",y);a.on("checkout:reload:spp-revieworder",y);a.on("checkout:reload:spclite",y)}});"use strict";q.when("A","client-side-metrics").register("trialSignPrefetchCommon",function(a,l){function g(){c()&&(b().val(0),l.increaseCount("TrialSign:js:activated"),d(),u!==F&&n(),u=a.interval(e,5E4),q=0)}function c(){return 0!==b().length&&0!==m("input[name\x3d'purchaseID']").length}
function d(){p!==F&&p.abort();p=a.ajax("/gp/buy/spc/handlers/trigger-trial-sign.html",{method:"post",params:{purchaseId:m("input[name\x3d'purchaseID']").val()},success:f,error:k,abort:h})}function f(a,c,d){b().val(a.signPurchaseTrialId);p=F;l.increaseCount("TrialSign:js:success")}function k(a,b,c){n();p=F;l.increaseCount("TrialSign:js:failed")}function h(){n();p=F;l.increaseCount("TrialSign:js:aborted")}function e(){q++;10<q?n():(l.increaseCount("TrialSign:js:retry"),l.increaseCount("TrialSign:js:retry:"+
q),d())}function n(){u!==F&&(clearInterval(u),u=F)}function b(){return m("input[name\x3d'trialSignId']")}var m=a.$,p,u,q=0;a.on("checkout:reload:spc",g);a.on("checkout:reload:spclite",g);a.on("checkout:billing-address-update",g);return{makeTrialSignCall:d,trialSignCallSucceeded:f,isTrialSignActivated:c}});"use strict";q.when("A","page-transition-controller","client-side-metrics","page-conductor").register("recurring-delivery-line-item",function(a,l,g,c){function d(a,c,b){if("undefined"===typeof a)throw g.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:JSFailure:VariableUndefined:"+
c,1),b.show(),Error("Provided variable is undefined");b.hide()}function f(a,f,b){d(a,"updateRecurrencePeriod",f);d(a.lineItemId,"updateRecurrencePeriod-lineItemId",f);var m=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});k.ajax({type:"POST",url:"/gp/buy/spc/handlers/update-recurrence-period.html",data:{recurrencePeriod:h,encodedLineItemEntityId:a.lineItemId,relatedRequestId:a.relatedRequestId},dataType:"json",cache:!1,headers:m,success:function(a,c){g.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:"+
c,1);k("#b2brd-frdd").text(a.firstRecurringDeliveryDate);b.hide();f.hide();l.hide()},error:function(c){g.increaseCount("Checkout:B2B:RD:RecurrencePeriod:Update:"+c,1);k("#b2brd-cadence-selector").find(".a-dropdown-prompt").text(a.selectedRecurrencePeriodDisplayString);b.hide();f.show();l.hide()}});l.show()}var k=a.$,h;a.declarative("b2brd-cadence-dropdown-change","change",function(a){var c=k("#update-recurrence-period-error"),b=k("#update-recurrence-period-link");d(a,"b2brd-cadence-dropdown-change",
c);a=a.$event.target.value;d(a,"handleDropdownChange",c);b.show();h=a});a.declarative("update-recurrence-period","click",function(a){var c=k("#update-recurrence-period-error"),b=k("#update-recurrence-period-link");d(a,"update-recurrence-period",c);f(a.data,c,b)});a.declarative("update-recurrence-period-mobile","change",function(a){var c=k("#update-recurrence-period-error"),b=k("#update-recurrence-period-link");d(a,"update-recurrence-period-mobile",c);var g=a.$event.target.value;d(g,"handleDropdownChange",
c);b.show();h=g;f(a.data,c,b)})});"use strict";q.when("A","client-side-metrics","ajax-utility","button-blocker","button-blocker-popover","spclite-items-viewer","fast-track-controller").register("get-final-results-update",function(a,l,g,c,d,f,k){function h(){for(var b=function(){a.trigger("checkout:spc:ordersummary:sizeChanged")},c=0;20>c;++c)setTimeout(b,100*c)}function e(a,b){setTimeout(function(){var c=f.prepare(a);c&&u("#spclite-items-operation").show();u("#spclite-items-header-dynamic").fadeIn(b?
0:300,function(){c&&u("#spclite-items-operation").find(".spclite-items-view-switch").each(function(){var a=u(this).attr("view-name");a&&u(this).find("a").click(function(){l.increaseCount("SPCLite:ClientSide:SwitchViewClick:"+a,1);f.switchToView(a);u("#spclite-items-operation").fadeOut(b?0:300);h()})})})},b?0:800)}function n(b,c,d){if(b&&u.isArray(b))for(var e=!1,f=0;f<b.length;f++){var h=b[f];if(h.identifier&&h.content){var g=u("#"+c+"-"+h.identifier);g&&0!==g.length?a.slideDown(g.html(h.content),
d?0:500,"ease-out",function(){}):(l.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Item:"+c,1),e||(l.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Page:"+c,1),e=!0))}}}function b(b,c){if(b.presentCVs&&0<b.presentCVs.countOfCVs)m();else{b.orderSummaryHTML&&(a.fadeOut(u("#order-summary-footer"),c?0:250,"ease-out"),a.fadeOut(u("#spc-order-summary"),c?0:250,"ease-out",function(){u("#spc-order-summary").replaceWith(b.orderSummaryHTML).hide();b.additionalOrderSummaryHTML&&u("#order-summary-footer").html(b.additionalOrderSummaryHTML);
a.fadeIn(u("#spc-order-summary"),c?0:400,"ease-out");a.fadeIn(u("#order-summary-footer"),c?0:400,"ease-out")}));b.freshDeliveryMessageHTML&&(u("#lazy-fresh-promise-delivery-message").html(b.freshDeliveryMessageHTML),a.slideDown(u("#lazy-fresh-promise-delivery-message"),c?0:500,"ease-out"),k.spcLiteLazyLoadFastTrack());n(b.itemToPrimeMembershipDelivery,"lazy-membership-delivery",c);n(b.itemToGiftContentMapping,"lazy-gift-options",c);n(b.itemToShipOfferingMapping,"lazy-ship-method",c);n(b.itemToPromise,
"lazy-promise",c);b.freshDeliverySlotInformationHTML&&(u("#lazy-fresh-delivery-slot-information").html(b.freshDeliverySlotInformationHTML),a.slideDown(u("#lazy-fresh-delivery-slot-information"),c?0:250,"ease-out"));b.freshDeliveryInstructionsHTML&&(u("#lazy-fresh-delivery-instructions").html(b.freshDeliveryInstructionsHTML),a.slideDown(u("#lazy-fresh-delivery-instructions"),c?0:250,"ease-out"));if(b.itemToPromoMapping&&u.isArray(b.itemToPromoMapping))for(var d=u("#items-block"),f=0;f<b.itemToPromoMapping.length;f++){var g=
b.itemToPromoMapping[f];"lightningdeal"===g.type?d.find(".lazy-lightning-promo-details-"+g.identifier).removeClass("aok-hidden"):"promotion"===g.type&&d.find(".lazy-promo-details-"+g.identifier).removeClass("aok-hidden")}b.freeShippingId&&u("#"+b.freeShippingId).removeClass("aok-hidden");u("input#isOrderSummaryReady").val(1);e(b.itemGroupData,c);h()}}function m(){var b=u("#spclite-block-order-place-message").html()||"";c.show("disabled-order-place",b);c.lock();d.create({name:"disabled-order-place",
content:b});d.lock();var e=c.getButtonBlocker().data("a-popover-id");a.on("checkout:beforeReload",function(){d.unlock();c.unlock();d.destroy();u("#a-popover-"+e).remove()})}function q(a){if(a&&a.data){var b;try{b=p.atob(a.data)}catch(c){return l.increaseCount("SPCLite:FinalResult:Base64Decode:Failure",1),null}if((b=g.jsonify(b))&&!u.isEmptyObject(b))return b}return null}var u=a.$,z,w=function(a,b){function c(){if(f&&0!==f.length){for(var a="",b=0;b<d%3+1;b++)a+=".";f.html(a);d++}}var d=0,e,f;this.start=
function(){b&&b.useTextAnimate&&(d=0,f=a.find(".spclite-loading-text .spclite-processing-indicator"),e=setInterval(c,800))};this.stop=function(){e&&(clearInterval(e),f&&0<f.length&&f.html(""),d=0);a.find(".spclite-loading-spinner").hide();b&&b.showTextAlways||a.find(".spclite-loading-text").hide()}};a.on("checkout:reload:spclite",function(){if("1"===u('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")){var a=q(p.__spcliteFinalResultsData);if(a){b(a,!0);return}}else if(p.__spcliteFinalResultsData){b(p.__spcliteFinalResultsData,
!0);return}var a="",c=u("input#executionId").val();c&&(a+="executionId\x3d"+c);return u.ajax({type:"GET",url:"/gp/buy/spclite/handlers/get-final-results.html/ref\x3dox_spclite_get_final_results",data:a,dataType:"text",async:!0,beforeSend:function(a){z=new w(u("#spclite-order-summary-loading-indicator"),{showTextAlways:!0});z.start();p.uet&&p.uet("bb","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},success:function(a,c,d){a=g.jsonify(a);"1"===u('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")?
(a=q(a))?b(a,!1):m():a&&!u.isEmptyObject(a)?b(a,!1):m()},error:function(a,b,c){m()},complete:function(a){z.stop();p.uex&&p.uex("ld","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},cache:!1})});a.on("checkout:beforeLoadPage",function(){p.__spcliteFinalResultsData=F})});"use strict";q.when("A","client-side-metrics").register("spclite-items-viewer",function(a,l){function g(){var a=d("#spclite-items-block").find(".spclite-item-detail");a&&0<a.length&&(k={},a.each(function(a){a=d(this).attr("entity-id");
k[a]=d("\x3cp\x3e\x3c/p\x3e").append(d(this).clone().removeClass("a-span-last")).html()}))}function c(a,c){if(!c||0===c.length)return null;a=d('\x3cdiv class\x3d"a-row spclite-item-view" view-type\x3d"order-by-delivery"\x3e\x3c/div\x3e');var f=c;c=[];for(var b=[],g=0;g<f.length;g++){var l=f[g];if("normal"!==l.type)b.push(l);else{for(var p=0;p<c.length;)if(l.data.destinationAddressId!==c[p].data.destinationAddressId)p++;else break;for(;p<c.length;)if(l.data.destinationAddressId===c[p].data.destinationAddressId&&
l.data.promise.starttime.dayepoch>c[p].data.promise.starttime.dayepoch)p++;else break;c.splice(p,0,l)}}for(f=0;f<b.length;f++)switch(l=b[f],l.type){case "primemembership":c.unshift(l);break;case "vas":case "digital":case "no-promise":case "exception":c.push(l);break;default:c.push(l)}for(b=0;b<c.length;b++){l=c[b];if(f=l.content)g='\x3cdiv class\x3d"row spclite-item-group-title"\x3e',f.destination&&(g+='\x3cdiv class\x3d"row destination"\x3e'+f.destination+"\x3c/div\x3e"),f.promise&&(g+='\x3cdiv class\x3d"row promise"\x3e'+
f.promise+"\x3c/div\x3e"),g+="\x3c/div\x3e",a.append(g);a:if(f=l.items,k&&f&&0!==f.length){g="";for(p=0;p<f.length;p++){0===p%2&&(g+='\x3cdiv class\x3d"a-row"\x3e');var q=f[p].identifier;if(!k[q]){f=null;break a}q=d(k[q]);1===p%2&&q.addClass("a-span-last");g+=d("\x3cp\x3e\x3c/p\x3e").append(q).html();1===p%2&&(g+="\x3c/div\x3e")}1===f.length%2&&(g+='\x3cdiv class\x3d"a-column a-span6 a-span-last"\x3e\x3c/div\x3e\x3c/div\x3e');f=g}else f=null;if(f)f=d(f),("no-promise"===l.type||"normal"===l.type&&
l.data&&l.data.promise&&"scheduled"!==l.data.promise.type)&&f.find(".spclite-promise").hide(),a.append(f);else return null;b<c.length-1&&a.append("\x3chr\x3e")}return a}var d=a.$,f,k;return{prepare:function(a){try{var d;a:{g();if(k){var n=c("order-by-delivery",a);if(n){f={"order-by-delivery":n};d=!0;break a}}d=!1}return d}catch(b){l.increaseCount("SPCLite:ClientSide:Exception:SwitchViewPrepare",1)}return!1},switchToView:function(a,e){var g;f&&f[a]?g=f[a]:(l.increaseCount("SPCLite:ClientSide:SwitchViewNoPrepared:"+
a,1),"order-by-delivery"===a&&(g=c(a,e)));if(g){var b=d("#spclite-items-block");b.find(".spclite-item-view").fadeOut(300,function(){b.empty();b.append(g.clone().hide());b.find(".spclite-item-view").fadeIn(500)})}}}});"use strict";q.when("A","loading-spinner-controller").register("cpf-controller",function(a,l){function g(a){var c,g,h;if(/^\d{11}$/.test(a)||/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(a)){a=a.replace(/[^\w\s]|_/g,"");if(/(\d)\1{10}/.test(a))return!1;c=a.substring(0,9);g=a.substring(9);h=0;for(var e=
10;1<e;e--)h+=c.charAt(10-e)*e;if((2>h%11?0:11-h%11)!==g.charAt(0))return!1;c=a.substring(0,10);h=0;for(a=11;1<a;a--)h+=c.charAt(11-a)*a;return(2>h%11?0:11-h%11)!==g.charAt(1)?!1:!0}return!1}var c=a.$;a.on("checkout:reload:spp-taxid",function(){c("#useThresholdTaxIdService").length||c("#taxidForm").submit(function(){var a=c("#taxidregistration-imb");if(!g(c("#taxid-field").val()))return l.hideSpinner(c("#spinner-anchor"),!0),a.show(),!1;a.hide();return!0})})});"use strict";q.when("A","page-conductor",
"ready").register("taxid-threshold-controller",function(a,l){function g(){var a=c();l.isSPP()?a?(d("#taxid-continue-disabled").hide(),d("#taxid-continue-enabled").show()):(d("#taxid-continue-enabled").hide(),d("#taxid-continue-disabled").show()):a?d("span.#continue").removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):d("span.#continue").addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled","disabled")}function c(){var a=!0,c=d("#taxIdForm");
c.length&&c.find('input[type\x3d"text"]').each(function(){var c=d(this);if(!c.val()||7>c.val().length)c.parents(".taxid-form").find('input[type\x3d"checkbox"]').attr("checked")||(a=!1)});return a}var d=a.$;a.on("checkout:reload:spp-taxid",function(){if(d("#useThresholdTaxIdService").length){var a=d("#taxIdForm");a.length&&(a.find('input[type\x3d"text"]').keyup(g),a.find('input[type\x3d"checkbox"]').change(g));g()}})});"use strict";q.when("A","page-conductor","loading-spinner-controller","taxaddress-page-config",
"ready").register("taxaddress-controller",function(a,l,g,c){function d(){l.isSPP()&&k()}function f(){if(l.isSPP()){var a=n(p.taxregistrationnumberInputIdSelector).val();n(p.taxregistrationnumberInputIdSelector).val(a.replace(m,""));a=n(p.businesslegalnameInputIdSelector).val();n(p.businesslegalnameInputIdSelector).val(a.trim());k()}}function k(){var a=n("#taxid-continue-enabled"),c=n("#taxid-continue-disabled"),d;d=n(p.taxregistrationnumberInputIdSelector).val();var f=n(p.businesslegalnameInputIdSelector).val();
if(e(d)&&e(f))d=!0;else{var f=!f||e(f.toString().trim()),g=e(n(p.taxaddressInputNameSelector).val());d=e(d)||!b.test(d)||f||g?!1:!0}d?(a.show(),c.hide()):(a.hide(),c.show());d=e(n(p.taxregistrationnumberInputIdSelector).val())&&e(n(p.businesslegalnameInputIdSelector).val())?p.continueLabel:p.saveContinueLabel;a.find("span.a-button-text").text(d);c.find("span.a-button-text").text(d)}function h(){if(q)q=!1;else{var a=n(p.taxregistrationnumberInputIdSelector).val().trim(),b=n(p.businesslegalnameInputIdSelector).val().trim();
if(!e(a)||!e(b)){var c={tax_registration_number:a,business_legal_name:b};n.ajax({type:"POST",url:p.sifEncryptionUrl,dataType:"json",data:c,success:function(a,b,d){e(c.tax_registration_number)?n(p.taxregistrationnumberInputIdSelector).val(""):n(p.taxregistrationnumberInputIdSelector).val(a.sifEncryptedTaxId);e(c.business_legal_name)?n(p.businesslegalnameInputIdSelector).val(""):n(p.businesslegalnameInputIdSelector).val(a.sifEncryptedLegalName);q=!0;n(p.taxaddressFormIdSelector).submit()},error:function(a,
b,d){console.log("[taxaddress-controller.js] Error while encrypting the input fields. Error Type: "+b+" tax_registration_number: "+c.tax_registration_number+" business_legal_name: "+c.business_legal_name)}});return!1}}}function e(a){return!a||0===a.toString().length}var n=a.$,b=/^\d{11}$/,m=/\s+/g,p=c.getConfig(),q=!1;a.on("checkout:reload:spp-taxaddress",function(){n(p.taxregistrationnumberInputIdSelector).keyup(f).blur(f);n(p.businesslegalnameInputIdSelector).keyup(d).blur(f);n('input:radio[name\x3d"'+
p.taxaddressInputName+'"]').each(function(){n(this).change(d)});n(p.taxaddressFormIdSelector).submit(h);d()});return{getNewTaxAddressPopoverURL:function(){return p.newTaxAddressPopoverURL},submitTaxAddressFormWithNewAddressId:function(a){n(p.newTaxaddressInputIdSelector).val(a);g.showSpinner(n(p.taxAddressPanelSelector),!1);n(p.taxaddressFormIdSelector).submit()}}});q.when("A","address-popovers","taxaddress-controller","ready").register("taxaddress-addresspopover-helper",function(a,l,g){l.actionRegisterTaxAddressController(g)});
"use strict";q.when("A","page-spinner-controller","ajax-utility","page-conductor","client-side-metrics").execute(function(a,l,g,c,d){function f(){function d(a){if(!g)if(a.preventDefault(),a=encodeURIComponent(k("#spc-deliverytipinput").val()),k("#tip-error").addClass("aok-hidden"),k("#tip-promo-success").addClass("aok-hidden"),k("#tip-success").addClass("aok-hidden"),k("#tip-ineligible").addClass("aok-hidden"),k("#tip-success").addClass("aok-hidden"),a&&0!==a.length)if(0>a)b("invalidDeliveryTip_NoAmount");
else if(/^[0-9]*(\.[0-9]{1,2})?$/.test(a)){l.show();p=k("#spc-deliverytipnoticecheckbox").attr("checked")?1:0;var e=(new Date).getTime();a="tipamount\x3d"+a+"\x26isDefaultTip\x3d"+p+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+k("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+e;e=c.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});k.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-tip.html/ref\x3dox_tip_page_delivery_tip_add",
data:a,headers:e,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){g=!1;l.hide()},success:f,error:c.ajaxRedirect});g=!1}else b("invalidDeliveryTip_NoAmount");else b("addDeliveryTip_NoAmount")}function f(a,b,c){l.hide()}function b(a){l.hide();k("#tip-error").removeClass("aok-hidden");0<k("div.spc-desktop").length?k("#spc-deliverytipinput").addClass("a-form-error"):k("#spc-deliverytipinput").closest(".a-input-text-wrapper").addClass("a-form-error");
k("#"+a).removeClass("aok-hidden")}var g=!1,p=0;h&&(a.declarative("tip-element",["click"],function(a){var b=a.data.click;b&&null!==b&&d(a.$event)}),h=!1)}var k=a.$;if(!k("html").hasClass("a-ie6")){var h=!0;a.on("checkout:reload:spc",f);a.on("checkout:reload:spclite",f)}});"use strict";q.when("A","checkout-general-utils","page-conductor","loading-spinner-controller").register("checkout-feedback-controller",function(a,l,g,c){function d(){if(!k||"function"!==typeof k)return"";var a=k(),c="";if(a)for(var d in a)if("number"===
typeof a[d]||"string"===typeof a[d]||"boolean"===typeof a[d])c+="\x26__pagedata_"+d+"\x3d"+a[d];return c}var f=a.$,k;a.declarative("checkout-submit-feedback",["click","touchend"],function(a){if(!l.protectAgainstDoubleAction("checkout-submit-feedback",200)&&(a=f("#checkout-feedback-form"),a.length)){c.showSpinner(a,!1);var e=a.serialize(),e=e+d();f.ajax({type:"POST",url:a.attr("action"),data:e,dataType:"text",error:g.ajaxRedirect,success:function(a,b,c){b=c.getResponseHeader("checkout-feedback-submitted");
f(".a-button-close").trigger("click");null!==b&&b!==F&&f("#checkout-feedback-banner").append(a)}})}});return{registerPageDataCollecter:function(a){a&&"function"===typeof a&&(k=a)}}});"use strict";q.when("A","page-spinner-controller","scroll-controller","ajax-utility","page-conductor","checkout-modal-popover","page-detector-current-page","checkout-general-utils","a-popover","client-side-metrics").execute(function(a,l,g,c,d,f,k,h,e,n){function b(){function b(a){a=a.$currentTarget.closest(".delivery-instructions-block");
a.find(".edit-delivery-instructions-link").addClass("aok-hidden");a.find(".delivery-instructions-display").addClass("aok-hidden");var c=a.find(".dynamic-delivery-instructions-update").find(".delivery-instructions-input").attr("maxlength");a.find(".dynamic-delivery-instructions-update").removeClass("aok-hidden");m("#deliveryInstructions").focus();m("#deliveryInstructions").select();m("#deliveryInstructions").keydown(function(a){10===a.which&&a.preventDefault()});m("#deliveryInstructions").keyup(function(){m("#delivery-instructions-left-text").hasClass("aok-hidden")&&
m("#delivery-instructions-left-text").removeClass("aok-hidden");var a=c-m(this).val().length;0>a&&(a=0);m("#delivery-instructions-left").text(a)});setTimeout(function(){},500)}function e(a){l.show();a=a.$currentTarget;var b=m("#deliveryInstructions").val(),c=a.closest(".delivery-instructions-block"),g=a.closest(".dynamic-delivery-instructions-update");c.find(".edit-delivery-instructions-link").removeClass("aok-hidden");c.find(".delivery-instructions-display").removeClass("aok-hidden");g.addClass("aok-hidden");
c=(new Date).getTime();b="deliveryInstructions\x3d"+encodeURIComponent(b)+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+m("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+c;c=d.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":k.getCurrentPage()});m.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-instructions.html/ref\x3dox_instructions_page_delivery_instructions_update",data:b,headers:c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){l.hide()},success:f,error:d.ajaxRedirect});a.blur()}function f(a,b,d){(a=c.jsonify(a))&&!m.isEmptyObject(a)&&m("#deliveryInstructionsDisplay").html(a.deliveryInstructions);l.hide()}p&&(a.declarative("edit-delivery-instructions",["click"],b),a.declarative("update-delivery-instructions",["click"],e),p=!1)}var m=a.$;if(!m("html").hasClass("a-ie6")){var p=!0;a.on("checkout:reload:spc",b);a.on("checkout:reload:spclite",b);a.on("checkout:reload:spp-shipaddress",b);a.on("checkout:reload:spp-f3-sosp",
b);a.on("checkout:reload:spp-payment",b)}});"use strict";q.when("A","page-conductor","page-transition-controller").register("installments-service",function(a,l,g){var c=a.$;return{call:function(a,f,k){g.show();c.ajax({type:"POST",url:"/gp/buy/installments/handlers/set-item-installments.html/ref\x3dox_spc_inst_toggle",data:{itemId:a,programId:f},dataType:"text",async:!0,cache:!1,headers:l.setAjaxTransitionHeader(),success:k.success||null,error:k.error||null})},sendReftag:function(a){c.post("/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+
a)}}});"use strict";q.when("A","page-transition-controller","page-conductor","page-detector","button-blocker","installments-service","client-side-metrics","widgets/installmentsModal/state","allow-installments-page-transition").register("installments-controller",function(a,l,g,c,d,f,k,h,e){function n(){a.defer(m)}function b(a,b,c){e.isEnabled?g.ajaxUpdatePage(a,b,c,{pushNewFrame:"true"}):(l.hide(),g.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"}))}function m(){var a=p("#installments-button-blocker");
1===a.length&&(a=a.data("blocker-message"),d.show("place-order-installments-blocker",a))}var p=a.$;a.declarative("installments-sync-state",["change"],function(a){var c=p("#trigger-installments-modal"),d;if(c.length)if(h.$target=a.$target,h.bundleAsin=a.data.bundleAsin,h.asin=a.data.asin,h.itemId=a.data.itemId,h.isChecked=h.$target.is(":checked"),h.programId=h.isChecked?a.data.programId:"",a={success:b,error:g.ajaxRedirect},h.handlerData=a,d=h.isChecked?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut",
h.isChecked)c=h.asin,a=h.bundleAsin,f.call(h.itemId,h.programId,h.handlerData),a?f.sendReftag("installments_toggle_on_asin_"+c+"_bundle_asin_"+a):f.sendReftag("installments_toggle_on_asin_"+c);else{a=h.itemId;var e=h.programId,l=h.handlerData,m=h.asin,n=h.bundleAsin;n&&c.length?(f.sendReftag("installments_toggle_off_asin_"+m+"_bundle_asin_"+n),c.click()):(f.sendReftag("installments_toggle_off_asin_"+m),f.call(a,e,l))}else c=a.data.itemId,e=(d=a.$target.is(":checked"))?a.data.programId:"",a={success:b,
error:g.ajaxRedirect},d=d?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut",f.call(c,e,a);k.increaseCount(d)});a.declarative("page-transit-invalidate-ric","click",function(a){g.isAnimating()||(a.$event.preventDefault(),a=a.$currentTarget.closest("div.spp-panel"),l.shrinkPanel(a,!0),a={invalidate:!0,gurupaRicCSRFToken:p("#gurupaRicCSRFToken").val()},k.increaseCount("Checkout:RetailInstallmentContract:Invalidate"),p.ajax({type:"POST",url:"/gp/buy/retailinstallmentcontract/handlers/set-line-item-ric.html?_from\x3dgurupa",
data:a,async:!0,cache:!1,headers:g.setAjaxTransitionHeader(),success:g.redirect,error:g.redirect}))});a.on("checkout:reload:spp-revieworder",n);a.on("checkout:reload:spc",n)});"use strict";q.when("A","page-conductor","checkout-modal-popover","page-transition-controller","ajax-utility","page-detector","payments-portal-common","ready").register("spc-payments-portal",function(a,l,g,c,d,f,k){function h(b,c){c={refTag:c,callbackBeforePageUpdate:function(){a.$("div.a-popover button.a-button-close").trigger("click")}};
l.isSPP()&&(c.keepCachedPagesData=1);l.loadPage("spc",b,null,c)}function e(a,d,e){l.isSPP()?(c.blockAllActions(),c.showTransitionInContainer(n("#payment"))):c.show();a="/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+a;var f=l.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});n.ajax({type:"POST",url:a,data:d,headers:f,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?
l.ajaxUpdatePage(a,b,c):e(a)},error:l.ajaxRedirect})}var n=a.$;return{prepareDelegatedPopovers:function(b){function c(a,b){a=n(a);a.data("aCheckoutModalPopover",b);g.createModal({$declarativeParent:a},b)}a.on("pmts:retail:billing-address-popover",function(a){c(".pmts-change-address-link",{header:b.billingAddressPopoverHeader,footer:"",name:"billing-address",allowScrollOnPage:!0})});a.on("pmts:retail:rewards-registration",function(a){c(".pmts-shop-with-points-learn-more-link",{header:b.rewardsRegistrationPopoverHeader,
footer:"",name:"rewards-registration",allowScrollOnPage:!0})})},handleClaimCodeSubmittedEvent:function(a,c){var d={returnjson:"1",returnFullHTML:"1",hasWorkingJavascript:"1",fromAnywhere:n("input[name\x3dfromAnywhere]").val(),cachebuster:(new Date).getTime(),nextAction:"pipeline-dispatch",embedOnlyData:"1"};a=n.param(a)+"\x26"+n.param(d);e("ox_pay_page_gc_add",a,function(a){k.claimCodePageUpdater(c,a)})},handleChangeBillingAddressRequestedEvent:function(){f.isDesktopSpc()?l.isSPP()?n("#pmts-change-billing-address-popover").trigger("click"):
a.trigger("pmts:retail:billing-address-popover"):(c.show(),l.isPipeliningOn()&&h("billingaddressselect","ox_spc_change_ship_addr"))},handleChangePaymentInstrumentRequestedEvent:function(){c.show();l.isPipeliningOn()&&h("payselect","ox_spc_change_payment")},handleRewardsAccountLearnMoreRequestedEvent:function(){a.trigger("pmts:retail:rewards-registration")},handlePointsAccountSubmittedEvent:function(a){var c={hasWorkingJavascript:"1",isClientTimeBased:n("input[name\x3duseCtb]").val(),nextAction:"dispatch"};
a=n.param(a)+"\x26"+n.param(c);e("ox_spc_points_edit",a,function(a){a=d.jsonify(a);l.redirect(a)})}}});"use strict";q.when("ajax-utility","gc-redeem-controller","page-transition-controller","ready").register("payments-portal-common",function(a,l,g){return{claimCodePageUpdater:function(c,d){d=a.jsonify(d);null!==d?d.widgetJsonData?(c.update(d.widgetJsonData),g.hide()):d.autohandlererror&&l.giftSystemErrorHandling(d.autohandlererror):g.hide()}}});"use strict";q.when("A","page-detector-current-page",
"a-button","a-meter").register("checkout-throttle-error",function(a,l,g,c){var d=a.$;a.on("checkout:reload:throttle",function(){if(d("#checkout-throttle-meter").length){var a=1E3*d('input[name\x3d"waiting-time"]').val()/100;g("#checkout-throttle-return-to-cart").disable();var k=c("#checkout-throttle-meter"),h=0,e=setInterval(function(){k.percent(h);if(100>h)h+=1;else{clearInterval(e);var a=g("#checkout-throttle-return-to-cart");a.text(d("#checkout-throttle-primary-button-active-text").text());a.enable()}},
a)}})});"use strict";q.when("A","weblab-helper").register("nav-bar-helper",function(a,l){function g(){try{q.register("navCF")}catch(a){if(-1===a.message.toLowerCase().indexOf("already registered"))throw a;}}if(l.isNavCFWeblabOn())a.on("checkout:reload",g)});q.when("A").execute(function(a){a.declarative("remaining-customizations-action","click",function(a){a.$currentTarget.parent().find(".remaining_customization_info").removeClass("aok-hidden");a.$currentTarget.hide();a.$event.preventDefault()})});
"use strict";q.when("A","checkout-federation-utilities","client-side-metrics").register("checkout-federation-wrapper",function(a,l,g){function c(a){for(var c=[],g=d;g<a.length;g++)c.push(a[g]);return c}var d=2;return{wrap:function(a,d){try{return a.apply(null,c(arguments))}catch(b){var h=d,e=b,n;n=h;n=l.getExternalDependecies()[n];n=n!==F&&null!==n?n.cti:"Undefined";g.logError(e,"["+h+"] Javascript error thrown while executing wrapper",n,"FATAL");p.console&&p.console.error&&p.console.error(e,h,n)}}}});
"use strict";q.when("A","jQuery","checkout-federation-utilities").register("checkout-federation-injector",function(a,l,g){function c(a){a=a.assetsModule;if(d[a]?0:0<l('script[type\x3d"checkout-asset-trigger"][data-checkout-asset-trigger\x3d"'+a+'"]').length)d[a]=!0,q.register("trigger"+a,function(){})}var d={};a.on("checkout:reload",function(){var a=g.getExternalDependecies(),d;for(d in a)a.hasOwnProperty(d)&&c(a[d])})});"use strict";q.when("A","client-side-metrics").register("checkout-federation-utilities",
function(a,l){return{getExternalDependecies:function(){var g=a.state("triggerExternalDependencies");Object&&Object.keys&&l.increaseCount("Checkout:ExternalDependencies:count:"+(g?Object.keys(g).length:"undefined"));return g===F||null===g?{}:g}}});"use strict";q.register("allow-installments-page-transition",function(){return{isEnabled:!1}})});
/* ******** */
(function(l){var m=window.AmazonUIPageJS||window.P,q=m._namespace||m.attributeErrors,a=q?q("CheckoutSinglePagePipeline",""):m;a.guardFatal?a.guardFatal(l)(a,window):a.execute(function(){l(a,window)})})(function(l,m,q){l.when("A").register("scroller-controller",function(a){function c(a){a.scrollTop>=k&&g(m).height()>e.height()?e.css({position:"fixed",width:"inherit",top:"14px"}):e.css({position:"relative",top:"0px"})}var g=a.$,e,k;a.on("checkout:reload",function(){if(e=g("#subtotalsContainer")){var d=
e.closest(".page-container");d&&d.offset()&&(k=d.offset().top,a.on.scroll(c))}})});"use strict";l.when("A","address-book-controller","address-utilities","page-conductor","cache-page-data-controller").register("spp-address-controller",function(a,c,g,e,k){function d(){h("div.address-book-entry").each(function(){h(this).find(".displayAddressLI:last-child").append(h(this).find(".address-edit-link, .address-delete-link").show())});var a=h("#inline-address-form");0<a.length&&g.customizeFormFromIdentity(a);
a=h("#address-list");e.isPrefetchFromAddressEnabled()&&0<a.length&&f(a)}function f(a){a.data("enableFormPrefetch")&&0<a.find("input:checked").length&&(a.data("checkoutFormReady",!0),e.makePrefetch(a),a.data("checkoutFormReady",!1))}function b(a){a=a.popover.getContent().find(".enterAddressFormField");a.length&&(a.unbind("keydown.overrideEnterKeypress").bind("keydown.overrideEnterKeypress",function(a){r=h(a.currentTarget).val()}),a.unbind("keyup.overrideEnterKeypress").bind("keyup.overrideEnterKeypress",
function(a){13!==a.which&&13!==a.keyCode||h(a.currentTarget).val()!==r||(a.preventDefault(),a=h(a.target).closest(".a-popover"),a.length&&(a=a.find(".a-popover-footer .a-button-primary"),a.length&&a.click()))}))}var h=a.$,r;a.on("a:popover:afterUpdatePosition:edit-address",b);a.on("a:popover:afterUpdatePosition:add-address",b);a.declarative("switch-address-book-page","click",function(b){b.$event.preventDefault();var d,f,g=b.$target.closest("div.address-book"),r=g.find(".address-book-page.current-visible-page");
r.length&&(d=r.first(),f=d.find(".a-pagination li.a-selected a").attr("href"),f=""===f||f===q?0:f);if(b.$target.is("a")&&(b=b.$target.attr("href"),b=""===b||b===q?0:b,b!==f)){var e=g.find(".address-book-page-"+b);d.removeClass("current-visible-page").hide();a.fadeIn(e,500,"ease-in",function(){e.addClass("current-visible-page");h("div.address-book").trigger("recalculate-address-height")});d=e;f=b}});a.declarative("show-all-addresses","click",function(a){a.$event.preventDefault();a=a.$target.closest("div.address-book");
a.find(".address-book-page").each(function(){var a=h(this);a.removeClass("current-visible-page");a.show();a.find(".pagination-row").hide()});a.trigger("recalculate-address-height");a.find(".show-all-addresses").hide();a.find(".hide-all-addresses").show()});a.declarative("hide-all-addresses","click",function(a){a.$event.preventDefault();a=a.$target.closest("div.address-book");a.find(".address-book-page").each(function(){var a=h(this);a.find(".pagination-row").show();a.hide()});a.find(".address-book-page-0").addClass("current-visible-page").show();
a.trigger("recalculate-address-height");a.find(".hide-all-addresses").hide();a.find(".show-all-addresses").show()});a.declarative("select-address-in-list","click",function(a){a=a.$target;if(!a.is("a")){var b=a.closest(".address-row");a=b.find('input[type\x3d"radio"]');if(!a.is(":disabled")){var d=h(".address-row");d.removeClass("list-address-selected");d.find('input[type\x3d"radio"]').removeAttr("checked");b.addClass("list-address-selected");a.attr("checked","checked");b=h("#address-list");b.attr("action",
a.val());e.isPrefetchFromAddressEnabled()&&(e.disablePageNoUpdateTransition(),k.clearCache(),f(b))}}});a.on("checkout:reload:spp-shipaddress",d);a.on("checkout:reload:spp-billing-address",d)});"use strict";l.when("A").register("spp-address-suggestion-controller",function(a){var c=a.$;a.declarative("suggestion-continue-submit",["click"],function(a){a.$event.preventDefault();var e=a.data.name;"editSelectedAddress"===e&&(e=(e=a.$target.parents("form:first").find('input[type\x3d"radio"]:checked'))?"edit_"+
e.val():void 0);var k=a.data.value;a=a.$target.parents("form:first");var d=a.attr("action"),d=0<d.indexOf("?")?d+"\x26":d+"?";a=d=d+(e+"\x3d"+k+"\x26")+a.serialize();e=c("#continueLink");e.attr("href",a);e.trigger("click")})});"use strict";l.when("A","a-checkbox","weekend-availability-expander-helper").register("weekend-availability-expander",function(a,c,g){function e(a){a=a.expander.expanderName;null!==r[a]&&(a=k(r[a].saturdayId,r[a].sundayId),g.updateAllWeekendAvailabilityStates(a),g.updateAllTitles(a),
h=b=!1)}function k(a,b){return{isSaturdayChecked:c("#"+a).isChecked(),isSundayChecked:c("#"+b).isChecked()}}function d(a){g.logExpanderState("spc",a.action,h,b)}var f=a.$,b=!0,h=!0,r={"sat-sun-availability-expander":{saturdayId:"sat-sun-availability-checkbox-sat",sundayId:"sat-sun-availability-checkbox-sun"},"sat-sun-availability-expander-domestic":{saturdayId:"sat-sun-availability-checkbox-sat-domestic",sundayId:"sat-sun-availability-checkbox-sun-domestic"}};a.on("checkout:reload:spp-shipaddress",
function(){a.declarative("sat-sun-availability-checkbox-change","change",function(a){var b=k(a.data.satCheckboxId,a.data.sunCheckboxId);g.updateAllWeekendAvailabilityStates(b);g.updateAllTitles(b);b=f("input[name\x3d'BusinessHours']").attr("value");b=g.stateToCheckboxes(b);f(".weekend-checkbox-sat input").prop("checked",b.isSaturdayChecked);f(".weekend-checkbox-sun input").prop("checked",b.isSundayChecked);g.updateAllOptOutMessages(k(a.data.satCheckboxId,a.data.sunCheckboxId))});a.on("a:expander:sat-sun-availability-expander:toggle:expand",
e);a.on("a:expander:sat-sun-availability-expander-domestic:toggle:expand",e);a.on("a:expander:sat-sun-availability-expander:toggle:collapse",function(a){b=!0;h=!1});a.on("a:expander:sat-sun-availability-expander-domestic:toggle:collapse",function(a){b=!0;h=!1});"expander"===f("input[name\x3d'weekendDeliveryDisplayType']").attr("value")&&(a.declarative("edit-address-popover-submit",["click"],d),a.declarative("add-address-popover-submit",["click"],d))})});"use strict";l.when("A","page-detector-current-page",
"delivery-preferences-csm-helper").register("spp-delivery-preferences-controller",function(a,c,g){function e(a,f){"displayed"===a&&g.recordCSMForEligiblePages("address-form:"+f+":");g.recordCSMWithCurrentFieldValues("embedded-in-address-"+f+"-"+a,"prefDelLocation","isDefaultPreference")}var k=a.$;a.on("checkout:reload",function(){"spp-shipaddress"!==c.getCurrentPage()?g.recordCSMForEligiblePages():k("#inline-address-form").length&&(e("displayed","inline"),k("#inline-address-form form").submit(function(){e("submitted",
"inline")}))});a.on("a:popover:show:add-address",function(){e("displayed","popover")});a.declarative("add-address-popover-submit","click",function(a){e("submitted","popover")})});"use strict";l.when("A").register("spp-item-controller",function(a){function c(a,d,f){a=a.trim();a=JSON.parse(a);var b=e(".lineitem");d=e("#address-filter-message");if(""!==a.address_results){var h=a.address_results.split(",");l.when("a-dropdown").execute(function(d){for(d=0;d<h.length;d++){var f=e(b).find("input:hidden[value\x3d"+
h[d]+"]")[0];if(f){f=f.name.split(".")[1];f="#addressID.destinationType.destinationId.destinationOwnerId."+f;f=f.replace(/\./g,"\\.");f=e(f)[0];if(!f)break;for(var c=1;c<f.length-1;c++)if(f[c].value.split(".")[0]===a.addr_id.split(".")[0]){e(f[c]).remove();break}}}});d.hasClass("aok-hidden")&&d.removeClass("aok-hidden")}}function g(){var a="",a="",d=e("#"+"addressID.destinationType.destinationId.destinationOwnerId.1-1".replace(/\./g,"\\."))[0];if(d)for(var f=1;f<d.length-1;f++)a=d[f].value.slice(0,
-7),a="addressid\x3d"+a,e.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/get-shipping-eligibility.html",dataType:"text",data:a,async:!0,cache:!1,error:function(a){alert("error: "+a.responseText)},success:function(a,f,d){c(a,f,d)}})}var e=a.$;a.on("checkout:reload:spp-itemselect",function(){e("form#changeQuantityFormId").attr("action",e("form#changeQuantityFormId").attr("action")+"\x26action\x3dcontinue");e(".lineitem-error-message")&&0!==e(".lineitem-error-message").length&&e("#address-filter-message")&&
0!==e("#address-filter-message").length&&g()})});"use strict";l.when("A","a-carousel-framework").register("spp-gift-controller",function(a,c){a.on("checkout:reload:spp-giftoptions",function(){c.createAll();c.initializeAll()})});"use strict";l.when("A").register("pay-popovers",function(a){var c=a.$;a.on("checkout:reload:spp-payment",function(){c("#payment .payment-popover").each(function(){var a=c(this);1===a.data("haserrors")&&c("#"+a.data("trigger")).trigger("click")})})});"use strict";l.when("A",
"pay-common-util","jppoints").register("gcpromo",function(a,c,g){function e(){var a=d.gcpromo.find("#pm_300");if(!a.is(":disabled")){var f=a.is(":checked"),e=d.gcpromo.find('input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]');f?e&&e.length&&d.gcpromo.addClass("payment-selected"):(d.gcpromo.removeClass("payment-selected"),c.selectDefaultPaymentMethodIfNotSelected());(f=k("#jppoints"))&&f.length&&g.handleJPPointsWithGC(a)}}var k=a.$,d={},f={gcpromo:"#gcPromo"};a.on("checkout:reload:spp-payment",
function(){if(!c.isMobileCX()&&k("#gcPromo").length&&(d=c.getElements(f),d.gcpromo&&d.gcpromo.length)){var a=d.gcpromo.find("#pm_300");c.isTouchCX()?a.parents("label").unbind("click").bind("click",e):a.unbind("click").bind("click",e)}})});"use strict";l.when("A").register("new-payment-methods",function(a){var c=a.$;a.declarative("click-store-card","click",function(a){a=c("#linkToApplyForStoreCard");a.length&&a[0].click()});a.declarative("click-add-loc","click",function(a){a=c("#linkToLoCPopup");a.length&&
a[0].click()});a.declarative("trigger-add-new-direct-debit","click",function(a){a=c("#direct-debit-popover-link");a.length&&a[0].click()});a.declarative("trigger-add-new-invoice-account","click",function(a){a=c("#invoice-account-popover-link");a.length&&a[0].click()})});"use strict";l.when("A","checkout-general-utils","a-tooltip").register("spp-button-blocker",function(a,c,g){var e=a.$;a.declarative("a-tooltip-button-blocker","mouseenter click mouseleave touchend touchenter touchleave".split(" "),
function(a){if(c.protectAgainstDoubleAction("tooltip-button-blocker",400))a.$event.preventDefault();else{var d=a.$currentTarget.find(".a-button-disabled"),f=a.$currentTarget.find("#orderSummaryPrimaryActionBtn");f.length&&(d=f);if("mouseleave"===a.type||"touchleave"===a.type)d.length&&g.remove(d);else if("mouseenter"===a.type||"click"===a.type||"touchenter"===a.type||"touchend"===a.type)a:if(f=e("#"+a.data.name),f=a.data.content||a.$currentTarget.data("blockerText")||f.html(),a=a.data.position,f&&
f.length&&d.length){g.remove(d);var b=d.attr("id");if(b&&"orderSummaryPrimaryActionBtn"===b&&(b=e("#orderSummaryPrimaryActionBtn"),b.is(":visible")&&!b.hasClass("a-button-disabled")))break a;d=g.create(d,{content:f,position:a});d.isActive()||d.show()}}});return{hideContinueBtnBlocker:function(){e(".continue-button-blocker").closest("span.a-declarative").each(function(){var a=e(this);a.length&&g.remove(a)})},showDefaultContinueBtnBlocker:function(){e("#show-default-blocker-in-prefetch").length&&l.when("button-blocker").execute(function(a){var d=
e("#defaultBuyBtnBlockerMsg");d.length&&a.show("default-buy-btn-blocker",d.val())})},hideDefaultContinueBtnBlocker:function(){e("#show-default-blocker-in-prefetch").length&&l.when("button-blocker").execute(function(a){a.hide("default-buy-btn-blocker")})}}});"use strict";l.when("A").register("addtocart-transition-controller",function(a){a.on("checkout:reload:addtocart",function(){l.when("page-transition-controller").execute(function(a){a.hidePageTransition()})})});"use strict";l.when("A","a-modal").execute(function(a,
c){var g=a.$;a.declarative("trigger-modal-dialog","click",function(a){var k=a.$currentTarget.find(".a-declarative").filter(function(){return"a-modal"===g(this).data("action")}).first();k.length&&(c.get(k).lock(11).show(),setTimeout(function(){c.get(k).unlock(12)},550))})});"use strict";l.when("A","a-button","weblab-helper").register("order-summary-primary-action",function(a,c,g){function e(){var a=d("#orderSummaryPrimaryActionBtn");if(a.length){var b=d(".primary-action-button");b.length&&a.find(".os-primary-action-button-text").text(b.text())}}
function k(){var a=c("#orderSummaryPrimaryActionBtn");a.isEmpty()||(d(".primary-action-button").is(":visible")?a.enable():a.disable())}var d=a.$;a.declarative("buy-button-as-primary-action",["click","touchend"],function(a){a=d(".primary-action-button");var b=c("#orderSummaryPrimaryActionBtn");a.length&&b.isEnabled()&&a.find("input").trigger("click")});a.on("orderSummary:primaryActionButton:mirrorPanelBtnState",k);a.on("checkout:afterReload",k);if(g.isRemoveOrderSummaryPrimaryActionBtnTextWeblabOff())a.on("checkout:afterReload",
e)});"use strict";l.when("A","checkout-general-utils","page-conductor","loading-spinner-controller").register("feedback-controller",function(a,c,g,e){var k=a.$,d;a.on("a:popover:show:feedback-banner",function(a){d=a.popover});a.declarative("submit-spp-feedback",["click","touchend"],function(a){if(!c.protectAgainstDoubleAction("submit-spp-feedback",200)&&(a=k("#feedback-form"),a.length)){e.showSpinner(a,!1,d);var b=a.serialize(),b=b+("\x26lineitems\x3d"+k("#lineitemcountforfeedback").val()),b=b+("\x26expandedPanel\x3d"+
k(".expanded").attr("id")),b=b+("\x26ordertotal\x3d"+k(".grand-total-price").text().trim()),b=b+("\x26buttonStatus\x3d"+k("#place-order-btn-blocker-msg").text().trim());k.ajax({type:"POST",url:a.attr("action"),data:b,dataType:"text",error:g.ajaxRedirect,success:function(a,b,d){b=d.getResponseHeader("spp-feedback-submitted");k(".a-button-close").trigger("click");null!==b&&b!==q&&k("#feedback-banner").append(a)}})}})});"use strict";l.when("A","page-conductor","ajax-utility","checkout-general-utils",
"page-transition-controller","client-side-metrics").register("page-conductor-spp",function(a,c,g,e,k,d){function f(a,b){try{a.replaceWith(b.hide())}catch(f){throw d.increaseCount("checkout:spp:panelreplacefailed:"+a.attr("id"),1),k.show(),c.redirect(),Error(f);}}function b(a,b){b&&(d.startWidgetTiming(a),r("#"+a).replaceWith(b),d.finishWidgetTiming(a))}function h(h){var m=r("#auiAnimationSpeedRate");m.length&&(l=.05*(parseInt(m.val(),10)-1)+.2);if(h=g.jsonify(h)){c.overrideIsAnimating(!0);k.hide();
var y,t,x,v,w,u=0,m=0,z=!1;if(h.panels)if(r.each(h.panels,function(b,e){b=r("#"+e.id);var h=r(e.content),c=b.hasClass("expanded"),g=h.hasClass("expanded");"revieworder"===e.id&&c&&!g&&(z=!0);c&&g?(d.startWidgetTiming(e.id),f(b,h),a.fadeIn(h,300,"ease-in",function(){d.finishWidgetTiming(e.id)})):c||g?c&&!g?(v=b,w=h):(y=b,t=h,x=e.id,d.startWidgetTiming(x)):b.replaceWith(h)}),z&&r("#hidden-revieworder").html(r("#revieworder").html()),t!==q||w!==q){var A=r("#page-buffer");w!==q&&(m=Math.max(m,50),A.height(v.height()),
u=Math.floor(v.height()*l),u=Math.min(u,600),v.slideUp(u,"swing",function(){v.replaceWith(w)}),A.slideDown(u,"swing"),t===q&&c.overrideIsAnimating(!1));t!==q&&(u+=50,m=Math.max(m,u),a.delay(function(){f(y,t);var a=Math.floor(t.height()*l),a=Math.min(a,600);t.slideDown(a,"swing",function(){c.overrideIsAnimating(!1);x!==q&&d.finishWidgetTiming(x)});A.slideUp(a,"swing")},u))}else c.overrideIsAnimating(!1);b("spc-imb",h.imb);b("fixup-imb",h.fixupImb);b("tv-ham",h.ham);b("subtotals",h.subtotals);b("callouts",
h.callouts);b("footer",h.footer);b("header",h.header);b("bottomsubtotals",h.bottomsubtotals);return m+5}e.logError("parsing data as JSON obj failed in SPP transition");c.ajaxSorryPage()}var r=a.$,l=.7;c.initFunc(h,function(a){h(a)});c.overrideIsSPP(!0);a.on("checkout:afterReload",function(){c.enablePageNoUpdateTransition()})});"use strict";l.when("A","page-detector-current-page","first-load-dependencies-base","weblab-helper").register("first-load-dependencies",function(a,c,g,e){e=a.$;c={"spp-shipaddress":["spp-address-controller",
"spp-address-suggestion-controller","address-popovers","address-book-controller","weekend-availability-expander"],"spp-addresstranslate":["address-translator","address-translation-controller","spp-address-translation-controller"],"spp-itemselect":["spp-item-controller","itemselect-address-controller","itemselect-quantity-controller","address-popovers"],"spp-shipoption":["shipoptionselect-controller","deliv-prefs-sosp","scheduled-delivery-readiness-checker"],"spp-giftoptions":["gift-form-base-controller",
"gift-form-del-opt-controller","widgets/giftOptions/giftOptions"],"spp-payment":["existing-payments","new-payments","pay-popovers"],"spp-revieworder":"prime-popover-controller prime-decline-controller shipping-speed-selection-controller fast-track-controller gold-box-controller verification-checkbox-controller back-button-protection gift-popover-controller concealment-popover-controller cv-continue-blocker-controller installments-controller spc-apx-standin".split(" "),"spp-billing-address":["address-popovers",
"address-book-controller","spp-address-controller"],"spp-taxid":["cpf-controller","taxid-threshold-controller"],"spp-taxaddress":["taxaddress-controller"],addtocart:["addtocart-transition-controller"]}[c.getCurrentPage()]||[];var k=e.merge("page-transition-controller page-conductor page-conductor-spp gc-redeem-controller inline-fps-balance-controller inline-points-controller order-summary-controller-spp checkout-modal-popover store-search-popover-controller imb-transition-controller verification-checkbox-spp order-summary-primary-action new-payment-methods checkout-federation-injector".split(" "),
c);a.on("afterReady",function(){g.allDependenciesCheck(k)})});"use strict";l.when("A","page-spinner-controller").register("transition-controller",function(a,c){function g(a,b){var f=d('\x3cdiv class\x3d"section-overwrap"/\x3e');f.css({opacity:null===b?.5:b}).css({width:a.outerWidth(),height:a.outerHeight()});a.prepend(f)}function e(a){a.find("div.section-overwrap").remove()}function k(a,b){var f=a.height(),e=a.width(),h=a.offset(),c=d(m),g=a=0;0<c.scrollTop()-h.top&&(a=c.scrollTop()-h.top);0>c.height()+
c.scrollTop()-(h.top+f)&&(g=h.top+f-(c.height()+c.scrollTop()));f=f-a-g;h=b.width();c=b.height();b.css("left",e/2-h/4+"px");c<f&&b.css("top",f/2-c/4+a+"px")}var d=a.$,f=null,b=null,h=null;d(document).delegate("a.disabled-link","click",function(a){a.preventDefault();return!1});c.initFunc({blockAllActions:function(){g(d("#subtotals"),.5);g(d("#bottomsubtotals"),.5);c.clearFocus();d(".spp-panel.collapsed span.a-declarative").each(function(){var a=d(this);a.find("span.a-button").addClass("a-button-disabled");
a.find("a").not(".a-button-text").addClass("disabled-link");a.find(":checkbox, :text").attr("disabled","disabled");a.addClass("off-declarative").removeClass("a-declarative")});g(d(".spp-panel.expanded"),0)},unblockAllActions:function(){e(d("#subtotals"));e(d("#bottomsubtotals"));d(".spp-panel.collapsed span.off-declarative").each(function(){var a=d(this);a.find("span.a-button").removeClass("a-button-disabled");a.find("a").not(".a-button-text").removeClass("disabled-link");a.find(":checkbox, :text").removeAttr("disabled");
a.addClass("a-declarative").removeClass("off-declarative")});e(d(".spp-panel.expanded"))},shrinkPanel:function(a,b,f){if(a){var h=a.find(".panel-content");a=a.find(".shrink-placeholder");h.hide();h=a.find(".loading-img-text");f&&0<f.length&&h.find(".loading-text").html(f);b?h.show():h.hide();a.addClass("current-spinner").show();d("html, body").animate({scrollTop:0},300)}},showTransitionInContainer:function(a,c){var e=a.find(".section-overwrap");e.length&&"0"!==e.css("opacity")||(e=a.height(),(c=400<
e||c?d("#bigLoadingSpinner"):d("#smallLoadingSpinner"))&&c.length||(c=d('\x3cimg id\x3d"loading-spinner-img" class\x3d"loading-spinner-img" src\x3d"https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-'+(400<e?"4":"1")+'x._V391853217_.gif" /\x3e')),e=d('\x3cdiv class\x3d"section-overwrap"\x3e\x3cdiv class\x3d"loading-spinner-inner loading-spinner-image-only"\x3e\x3c/div\x3e\x3c/div\x3e'),e.find(".loading-spinner-image-only").prepend(c.removeClass("aok-hidden")),c=e.find("div.loading-spinner-inner"),
e.css({opacity:.8}).css({width:a.outerWidth(),height:a.outerHeight()}),a.prepend(e),b=a,h=c,k(b,h),d(m).unbind("scroll.checkout-panel-spinner").bind("scroll.checkout-panel-spinner",function(a){f&&m.clearTimeout(f);f=setTimeout(function(){k(b,h);f=null},50)}),d(m).unbind("resize.checkout-panel-spinner").bind("resize.checkout-panel-spinner",function(){k(b,h)}))},hideSpinner:function(){d(".spp-panel").each(function(){d(this).find("div.section-overwrap").remove()});d(m).unbind("scroll.checkout-panel-spinner");
d(m).unbind("resize.checkout-panel-spinner")}})});"use strict";l.when("A").register("page-mash-transition-controller",function(a){function c(a){return function(b){console.error("Could not run MASHLoadingMessage: "+a+b)}}function g(){l.when("mash").execute(function(a){var f=b===q?"":b;a!==q&&m.cordova!==q?m.cordova.exec(null,c("showTransition(): "),"MASHLoadingMessage","startLoading",{message:f}):console.error("Error showing loading screen:"+(a!==q).toString()+", cordova:"+(m.cordova!==q).toString())});
k();return!0}function e(){l.when("mash").execute(function(a){a!==q&&m.cordova!==q?m.cordova.exec(null,c("hideTransition(): "),"MASHLoadingMessage","finishLoading",{}):console.error("Error Hiding loading screen:"+(a!==q).toString()+", cordova:"+(m.cordova!==q).toString())});d();return!0}function k(){l.when("a-tv").execute(function(a){a.disable()})}function d(){l.when("a-tv").execute(function(a){a.enable()})}var f=a.$,b;return{show:g,hide:e,showPageTransition:function(){if("0"===f("#showPageTransition").attr("content"))return!1;
k();return g()},hidePageTransition:function(){d();return e()},blockAllActions:k,unblockAllActions:d,showTransitionInContainer:function(a){return g()},shrinkPanel:function(a,b,f){return g()},setLoadingMessage:function(a){b=a},resetLoadingMessage:function(){b=q}}});"use strict";l.when("A","client-side-metrics").register("imb-transition-controller",function(a,c){function g(a){var b=d(a.target);if(!b.is(":visible"))return a.stopPropagation(),!1;a=b.closest(".imb-content");a.hide();var h=a.closest(".tv-imb");
l.when("a-tv").execute(function(a){a.add(h);a.select(h)});a=a.find("input[type\x3dcheckbox]");a.is(":checked")?(a.prop("checked",!1),c.increaseCount("checkouttv:imb-actionable-content-unselected",1)):(a.prop("checked",!0),c.increaseCount("checkouttv:imb-actionable-content-selected",1));e(h,".outer-box");l.when("verification-checkbox-controller").execute(function(a){a.verifyCheckboxes()})}function e(a,b){a.find("input[type\x3dcheckbox]").is(":checked")?(a.find("i.empty-checkbox"+b).addClass("aok-hidden"),
a.find("i.checked-checkbox"+b).removeClass("aok-hidden")):(a.find("i.empty-checkbox"+b).removeClass("aok-hidden"),a.find("i.checked-checkbox"+b).addClass("aok-hidden"))}function k(a){var b=d(a.target);if(b.hasClass("tv-imb")){a=d(".tv-checkbox-container:visible");if(a.length){var h=a.closest(".tv-imb");e(h,".outer-box");l.when("a-tv").execute(function(a){a.add(h);a.select(b)})}a=b.find(".imb-content");var g=a.is(":hidden");d(".imb-content").hide();var k=b.find(".confirm-button");k.length?(a.show(),
c.increaseCount("checkouttv:imb-actionable-content-shown",1),l.when("a-tv").execute(function(a){a.remove(b);a.select(k)})):g?(c.increaseCount("checkouttv:imb-non-actionable-content-shown",1),a.show()):a.hide()}}var d=a.$;a.on("checkout:reload",function(){if(d("#hasTVNavigation").length&&d(".tv-imb").length){d(".imb-content").hide();var a=d("#fixup-imb");if(a.length){var b=d(".tv-scroll-area");if(b.length){var c=b.height()-a.outerHeight(!0);b.height(c)}a.find(".imb-content").show()}d(".tv-checkbox-container").length&&
d(".tv-imb").each(function(){e(d(this),".outer-box")});d(".tv-imb").unbind("click").bind("click",k);d(".confirm-button").unbind("click").bind("click",g)}})});"use strict";l.when("A","a-tv","page-conductor").register("tv-controller",function(a,c,g){function e(a){a===q&&(a=".tv-selected-first:visible:first");return function(){0<k(a).length?c.select(a):c.select(".a-tv-navigate:visible:first")}}var k=a.$;g.overrideAddToCart(!0);a.on("checkout:beforeReload",e());a.on("checkout:reload:spp-collapsed",e(".continue-button.a-tv-navigate:visible:first"))});
l.when("A","mash","client-side-metrics").register("firetv-legal-disclaimer-mash",function(a,c,g){a.declarative("firetv-legal-disclaimer-mash","click",function(a){g.increaseCount("checkouttv:legal-ingress-clicked",1);m.cordova.exec(null,null,"MASHLegalDisclaimerPlugin","execute",{})})});l.when("A","mash").register("firetv-seller-mash",function(a,c){a.declarative("firetv-seller-mash","click",function(a){m.cordova.exec(null,null,"MASHDisplaySellerInfoPlugin","execute",{merchant_id:a.data.sellerMerchantID})})});
l.when("A","page-mash-transition-controller").execute(function(a,c){a.on("checkout:beforeReload",c.resetLoadingMessage);a.declarative("tv-abort-checkout","click",function(a){var e=a.data.url;c.setLoadingMessage(a.data.loadingMsg);c.showPageTransition();m.location=e})});"use strict";l.when("A","verification-checkbox-controller","page-detector-current-page").register("verification-checkbox-spp",function(a,c,g){var e=a.$;a.on("checkout:reload",function(){e("#show-default-blocker-in-prefetch").length&&
"spc"!==g.getCurrentPage()&&"spp-revieworder"!==g.getCurrentPage()&&c.verifyCheckboxes()})});"use strict";l.when("A","a-tv").register("kindle-controller",function(a,c){function g(){var a=e(".tv-kindle-register-row");a.find(".tv-kindle-register").toggleClass("tv-kindle-register-selected");a.find(".kindle-register-checkmark").toggleClass("aok-hidden")}var e=a.$;a.declarative("tv-kindle-register-select","click",function(a){if(!a.$target.is(".tv-kindle-register-selected")){g();a=e(".tv-kindle-register-row");
var c=a.find(".tv-kindle-register-selected").is(".tv-kindle-register-other"),f="obfuscatedEntityId\x3d"+a.find("input:hidden[name\x3dkindleLineItem]:first").val()+"\x26",f=f+"isKindlePurchase\x3d1\x26",f=f+("hidePrices\x3d"+(c?"1":"0")+"\x26");l.when("page-conductor","page-transition-controller").execute(function(a,c){c.show();e.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-gift.html",data:f,dataType:"text",async:!0,cache:!1,headers:a.setAjaxTransitionHeader({"x-amz-checkout-page":"spc",
"x-amz-checkout-transition":"ajax"}),contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,b,d){c.hide();e(".kindle-register-error-message").addClass("aok-hidden")},error:function(a,b,d){c.hide();g();e(".kindle-register-error-message").removeClass("aok-hidden")}})})}})});"use strict";l.when("A","a-carousel-framework").register("gift-carousel-utils",function(a,c){function g(a,c,e,d){b("."+a,b(d)).not("."+c).each(function(){var a=b(this),c=a.parent();c&&c.is("div")&&
c.hasClass(e)&&a.unwrap()})}function e(a,c){a.each(function(){b(this).attr("aria-posinset",c);c++});return c}function k(a,c){b("li",b(a)).hide();b("li",b(a)).css("visibility","hidden");b(".gift-wrap",b(a)).css("visibility","visible");b(".gw-hidden",b(a)).size()&&g("gift-wrap","noshi-wrap","gw-hidden",a);b(".noshi-wrap",b(a)).not(".gift-wrap").each(function(){b(this).wrap("\x3cdiv class\x3d'noshi-hidden'\x3e\x3c/div\x3e")});c=b(".gift-wrap",b(a));e(c,1);b(".gift-wrap",b(a)).show()}function d(a,c){b("li",
b(a)).hide();b("li",b(a)).css("visibility","hidden");b(".noshi-wrap",b(a)).css("visibility","visible");b(".noshi-hidden",b(a)).size()&&g("noshi-wrap","gift-wrap","noshi-hidden",a);b(".gift-wrap",b(a)).not(".noshi-wrap").each(function(){b(this).wrap("\x3cdiv class\x3d'gw-hidden'\x3e\x3c/div\x3e")});c=b(".noshi-wrap",b(a));e(c,1);b(".noshi-wrap",b(a)).show()}function f(a,e,d,f){var g=c.getCarousel(document.getElementById("giftwrap-carousel-wrap-holder-"+a));b("#afn-gift-options-wrapper-"+a);"all"===
e?a=7:(a=4,d=f);g.setAttr("set_size",a);g.setAttr("totalPages",d);g.gotoPage(1)}var b=a.$;a.on("checkout:gift:changeCarouselWrapOptions",function(a,c,f){"all"===c?(b("li",b(a)).show(),b(".noshi-hidden").size()?g("noshi-wrap","gift-wrap","noshi-hidden",a):b(".gw-hidden").size()&&g("gift-wrap","noshi-wrap","gw-hidden",a),b("li",b(a)).css("visibility","visible"),c=1,f=b(".gift-wrap",b(a)),c=e(f,c),f=b(".noshi-wrap",b(a)).not(".gift-wrap"),e(f,c)):"GW"===c||"gift-wrap"===c?k(a,f):"noshi"===c&&d(a,f)});
a.on("checkout:gift:adaptCarouselGiftPanel",function(a,b){f(a,b,3,2)});a.on("checkout:gift:adaptCarouselSPCPanel",function(a,b){f(a,b,2,1)})});"use strict";l.when("A","a-modal","page-conductor","page-transition-controller").execute("truespc-modal",function(a,c,g,e){a.on("checkout:reload:spp-prime",function(){var k=a.$;(k=c.get(k("#prime-panel-modal")))&&k.show();a.on("a:popover:beforeHide:prime-modal",function(a){e.show();g.loadPage("prime-expanded","spp-revieworder",(m.history.state||{}).additionalURLArgs,
{pushNewFrame:"true"})})})});"use strict";l.when("A","order-summary-controller").register("order-summary-controller-spp",function(a,c){a.on("checkout:reload",function(){c.initOrderSummary()})});"use strict";l.when("A","button-blocker").register("cv-continue-blocker-controller",function(a,c){function g(){var a=e("#cv-block-msg");a&&a.length&&c.show("cv-block-msg",a.html())}var e=a.$;a.on("checkout:reload:spc",g);a.on("checkout:reload:spp-revieworder",g)});"use strict";l.when("A","a-carousel-framework").register("spp-gift-popover-controller",
function(a,c){var g=a.$;a.on("checkout:gift:adjustCarouselInitial",function(a,g){a=a.options.wraps.length+1;var d;d=Math.ceil(a/4);var f=g.find(".carousel-gift-wrap").attr("id"),f=c.getCarousel(document.getElementById(f));f.setAttr("set_size",a);f.setAttr("pageSize",4);f.setAttr("totalPages",d);f.gotoPage(1);g.find(".a-carousel-viewport").css("height",160)});a.on("checkout:gift:removeEmptyCarouselCards",function(a){a.find(".a-carousel-card-empty").each(function(){g(this).remove()})})});"use strict";
l.when("A").register("dhl-controller",function(a){var c=a.$;a.declarative("change-existing-dhl-number","click",function(a){c("#existing-dhl-number").hide();c("#change-dhl-number").show()});a.declarative("save-dhl-number","click",function(a){a=c("#dhlPostNumberInput").val();var e=c("#purchaseId").val();c.ajax({type:"POST",url:"/gp/buy/storeaddress/handlers/change-name.html",data:{callFromSearchPage:1,changeDhlPostNumberInEmbu:1,dhlPostNumber:a,purchaseId:e},dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"truespc"}});
c("#dhl-number").html(a);c("#change-dhl-number").hide();c("#existing-dhl-number").show()})});"use strict";l.when("A","a-dropdown").register("search-utilities-controller",function(a,c){function g(){var a=f("#popover_storeCountry"),b=f("#pickupType"),d=c.getSelect("pickupType");d.removeOptions(b.find(".de-pickup-option"));d.removeOptions(b.find(".at-pickup-option"));d.removeOptions(b.find(".lb-pickup-option"));d.removeOptions(b.find(".nl-pickup-option"));d.removeOptions(b.find(".pl-pickup-option"));
"Germany"===a.val()?(b.append(m),b.find('option[value\x3d"'+b.val()+'"]').hasClass("de-pickup-option")||d.setValue("All")):"Austria"===a.val()?(b.append(q),b.find('option[value\x3d"'+b.val()+'"]').hasClass("at-pickup-option")||d.setValue("All")):"Luxembourg"===a.val()?(b.append(t),b.find('option[value\x3d"'+b.val()+'"]').hasClass("lb-pickup-option")||d.setValue("All")):"Netherland"===a.val()?(b.append(x),b.find('option[value\x3d"'+b.val()+'"]').hasClass("nl-pickup-option")||d.setValue("All")):"Poland"===
a.val()&&(b.append(v),b.find('option[value\x3d"'+b.val()+'"]').hasClass("pl-pickup-option")||d.setValue("All"))}function e(){var a=f("#popover_storeCountry"),b=f("#pickupType"),d=c.getSelect("pickupType");d.removeOptions(b.find(".fr-pickup-option"));d.removeOptions(b.find(".be-pickup-option"));"France"===a.val()?(b.append(C),b.find('option[value\x3d"'+b.val()+'"]').hasClass("be-pickup-option")&&d.setValue("All")):(b.append(y),b.find('option[value\x3d"'+b.val()+'"]').hasClass("fr-pickup-option")&&
d.setValue("All"))}function k(){var a=f("form.locker-search");b=a.find("select[name\x3dstoreCountry]");h=a.find("select[name\x3dpickupType]");b&&h&&b.length&&h.length&&(b.find("option").each(function(a,b){(a=f(b))&&a.attr("data-pickuptypeclass")&&(l[a.attr("data-pickuptypeclass")]=h.find("option."+a.attr("data-pickuptypeclass")).clone())}),d())}function d(){if(b&&h&&b.length&&h.length&&l){var a=b.find("option:selected"),a=f(a).attr("data-pickuptypeclass"),d=f("#pickupType"),e=c.getSelect("pickupType");
f.each(l,function(a,b){e.removeOptions(d.find("."+a))});l.hasOwnProperty(a)&&(d.append(l[a]),d.find('option[value\x3d"'+d.val()+'"]').hasClass(a)||e.setValue("All"))}}var f=a.$,b,h,l={},m,q,C,y,t,x,v;a.declarative("country-filter-pickup-point","change",d);a.declarative("filter-de-pickup-types","change",g);a.declarative("filter-fr-pickup-types","change",e);return{reloadSearchUtils:function(){var a=f("input[name\x3dmerchantAutomation]");a&&a.length?k():(a=f("#searchLocale"),a.length&&"de"===a.val()?
(m=f(".de-pickup-option").clone(),q=f(".at-pickup-option").clone(),x=f(".nl-pickup-option").clone(),t=f(".lb-pickup-option").clone(),v=f(".pl-pickup-option").clone(),g()):a.length&&"fr"===a.val()&&(C=f(".fr-pickup-option").clone(),y=f(".be-pickup-option").clone(),e()))}}});"use strict";l.when("A","a-popover-data","a-modal","search-utilities-controller","page-conductor","a-dropdown","client-side-metrics","weblab-helper").register("store-search-popover-controller",function(a,c,g,e,k,d,f,b){function h(){p!==
q&&null!==p&&l.when("a-modal").execute(function(a){a.remove(p);p=q})}function r(){!p.isContentLoaded()&&0<D?(D--,setTimeout(r,100)):(I(),D=20)}function I(){if(0<B&&"undefined"!==typeof m.Map)try{m.Map.getMapAndIcons(),"undefined"!==typeof m.Map&&m.Map.registerPinClickCallback(P),"undefined"!==typeof m.Map&&m.Map.registerPinClickCallback(C),N=!0}catch(a){--B,0<B&&setTimeout(I,500)}0===B&&(B=20)}function P(a){var b=n("#storeAddressList");a=b.find("#form_"+(a+1));a.length&&b.length&&(x(b,a),v(b,a))}
function C(a){n("#storeAddressList #form_"+(a+1)).length||f.increaseCount("checkout:locker-map:click-on-search-location-pin",1)}function y(a){a.filter("script").each(function(){this.src&&0<this.src.indexOf("mapcontrol")&&(E=this.src)})}function t(a){var b=n(a);p.updateContent(a);p.updatePosition(!0);y(b);null!==E&&!1===N?n.ajax({url:E,async:!1,success:r,dataType:"script"}):r()}function x(a,b){a.animate({scrollTop:b.offset().top-a.offset().top+a.scrollTop()})}function v(a,b){a.find(".address-row").removeClass("list-address-selected");
b.find(".address-row").addClass("list-address-selected")}function w(a){c.showSpinner(p);b.isHeadersCleaned()?n.ajax({type:"POST",url:a,dataType:"json",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",headers:{"x-amz-checkout-page":"truespc"},success:function(a,b,c){if(!a.popoverValid)return k.redirect({conductoraction:{url:"/gp/cart/view.html",type:"redirect"}});t(a.popoverContent);e.reloadSearchUtils()},error:function(a,b,c){p.updateContent("")}}):n.ajax({type:"POST",
url:a,dataType:"html",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",headers:{"x-amz-checkout-page":"truespc"},success:function(a,b,c){if(!c.getResponseHeader("x-amz-checkout-popover-valid"))return k.redirect({conductoraction:{url:"/gp/cart/view.html",type:"redirect"}});t(a);e.reloadSearchUtils()},error:function(a,b,c){p.updateContent("")}})}function u(a,b){if(a.is("span.a-declarative")){var c=a.find("a");if(c.length&&c.hasClass("locker-search-link"))return c.attr("href")}a=
a.parents("form");c=(c=a.attr("action"))?c:"/gp/buy/storeaddress/handlers/popover/search.html";b&&(a=n("#form_"+b));return c+"?"+a.serialize()}function z(){var a=n("#inlineStoreSearchRow"),b=a.find("[name\x3dpickupUrl]").val()+"?",a=A(a,"pickupUrl"),b=b+a;n("#storeCountry").length&&(a&&a.length&&(b+="\x26"),a=d.getSelect("storeCountry").val(),b+="storeCountry\x3d"+a);return b}function A(a,b){var c="";a.find("input").not("[name\x3d"+b+"]").each(function(){""!==c&&(c+="\x26");c+=n(this).serialize()});
return c}function J(a,b){"undefined"!==typeof a&&(a=parseInt(a,10)-1,m.Map.togglePinVisibility(a,b))}function K(a){a.length&&(p&&p.hide(),a.submit())}function L(a,b){var c=a.find('input[name\x3d"storeId"]'),d=a.find('input[name\x3d"formBaseAction"]');c.length&&d.length&&a.attr("action",d.val()+"/ref\x3d"+b+c.val())}function M(a){if(!p){var b=n("#search-popover-header").html();p=g.create(a,{name:"inline-store-search-popover",header:b,popoverLabel:b,dataStrategy:"inline"})}p.isActive()?(a=z(),w(a)):
p.show()}function Q(){F&&(k.reloadPage(),F=0)}function O(){if(p!==q&&null!==p){var a=n("#accessibilityPreferenceLink"),a=z(a);null!=G&&null!=H&&(a+="\x26latitude\x3d"+G+"\x26longitude\x3d"+H);w(a)}else k.reloadPage()}var n=a.$;if(!n("html").hasClass("a-ie6")){var p,E=null,N=!1,B=20,D=20,G=null,H=null;a.declarative("zoom-in-pinpoint","click",function(a){a=a.$target[0].id.replace("pinpointImage_idx_","");var b=n("#storeAddressList"),c=b.find("#form_"+a);c.length&&b.length&&"undefined"!==typeof m.Map&&
(m.Map.selectPin(a-1),x(b,c),v(b,c))});a.on("a:popover:show:store-search-popover",function(a){p=a.popover;p.updateContent("");var b=p.attrs("urlTrigger");b?p.attrs("urlTrigger",""):(b=p.attrs("formTrigger"),b||(b=a.popover.$trigger),b=u(b));w(b)});a.on("a:popover:show:inline-store-search-popover",function(a){p=a.popover;p.updateContent("");a=z();w(a)});a.declarative("trigger-store-search-popover","click",function(a){p?p.updateContent(""):p=g.create(a.$currentTarget,{name:"store-search-popover",header:a.data.header,
dataStrategy:"inline"});p.attrs("urlTrigger",u(a.$currentTarget));p.show()});a.on("a:popover:positionUpdated:inline-store-search-popover",function(a){a=a.popover.getContent();if(a.length){var b=a.find(".locker_map_scale");b.length&&a.find("#sl_map").width(b.innerWidth())}});n(document).delegate("div.store-restrict-warning input[type\x3dcheckbox]","click",function(a){a=n(this).is(":checked");var b=n(this).parents("div.store-restrict-warning").parent().find(".store-ship-btn"),c="ship_to_store_map_button_"+
b.attr("id").replace("ship_to_store_button_",""),c=n("#"+c);a?(b.hasClass("a-button-disabled")&&(b.removeClass("a-button-disabled"),b.find("input[type\x3dsubmit]").removeAttr("disabled")),c.hasClass("a-button-disabled")&&(c.removeClass("a-button-disabled"),c.find("input[type\x3dsubmit]").removeAttr("disabled"))):(b.hasClass("a-button-disabled")||(b.addClass("a-button-disabled"),b.find("input[type\x3dsubmit]").attr("disabled","disabled")),c.hasClass("a-button-disabled")||(c.addClass("a-button-disabled"),
c.find("input[type\x3dsubmit]").attr("disabled","disabled")))});n(document).delegate("div#store-search-result input[name\x3dsearchCriterion][type\x3dradio]","click",function(a){a=n(this).attr("value");n(this).parents("form").find("input.search-term").attr("name",a)});n(document).delegate("div#store-search-result input[name\x3drefineSearch][type\x3dradio]","click",function(a){var b=n(this).parents("[data-a-input-name\x3drefineSearch]");a=b.attr("data-longitude");var b=b.attr("data-latitude"),c=n(this).parents("form");
c.find("input[name\x3dlongitude][type\x3dhidden]").attr("value",a);c.find("input[name\x3dlatitude][type\x3dhidden]").attr("value",b);G=b;H=a});n(document).delegate("div#store-search-result .store-address-list input[type\x3dsubmit]","click",function(a){a.preventDefault();f.increaseCount("checkout:locker-map:click-on-ship-to-address-from-store-list",1);a=n(this).parents("form");L(a,"chk_addr_locker_search_selected_");K(a)});n(document).delegate("form.locker-search","submit",function(a){a.preventDefault();
a=n(this).find(".search-btn");if(!p){var b=n("#search-popover-header").html();p=g.create(a,{name:"store-search-popover",header:b,popoverLabel:b,dataStrategy:"inline"})}p.isActive()?(a=u(a),w(a)):(p.attrs("formTrigger",a),p.show())});n(document).delegate("input[name\x3dfilterLocations]","change",function(a){n(this).is(":checked")?(n(".ineligible-store").hide(),"undefined"!==typeof m.Map&&n(".ineligible-store").each(function(){J(n(this).attr("data-store-display-number"),!1)})):(n(".ineligible-store").show(),
"undefined"!==typeof m.Map&&n(".ineligible-store").each(function(){J(n(this).attr("data-store-display-number"),!0)}))});n(document).delegate("input[name\x3dstoreZip]","keydown",function(a){13===a.which&&n("[name\x3disUnifiedActionsDesignEnabled]").length&&(a.stopPropagation(),p&&p.isActive()?(a=n("form.locker-search").find(".search-btn"),a=u(a),w(a)):(a=n("#pickupSearchBtn"),M(a)))});a.declarative("trigger-addressselect-search-popover","click",function(a){n("[name\x3disUnifiedActionsDesignEnabled]").length&&
M(a.$currentTarget)});a.declarative("map-popover-ship-to-store","submit",function(a){a.$event.preventDefault();f.increaseCount("checkout:locker-map:click-on-ship-to-address-from-popover",1);a=n("#storeAddressList #form_"+a.data.storeIndex);L(a,"chk_locker_map_search_selected_");K(a)});var F=0;a.on("toggle-preference-success",function(){O();F=1});a.on("toggle-preference-failure",O);a.on("a:popover:dismiss",Q);a.on("checkout:reload",h)}});"use strict";l.when("A","mash","client-side-metrics").register("continue-shopping-mash",
function(a,c,g){a.declarative("continue-shopping-mash","click",function(a){m.cordova.exec(null,null,"MASHCloseWebview","execute",{})});a.declarative("firetv-review-order-mash","click",function(a){g.increaseCount("checkouttv:review-order-clicked-from-thank-you-page",1);m.cordova.exec(null,null,"MASHReviewOrder","execute",{})})});l.when("A","a-tv").execute(function(a,c){var g=a.$;c.select(".continuebutton");a.on.ready(function(){var a=g(".review");0<a.length&&c.add(a)})});l.when("A","mash","client-side-metrics").execute(function(a,
c,g){a=a.$;a("#tv-final-page-addToCart").length&&(c=m.cordova,c.exec(null,null,"MASHFinalPageNotification","execute",{message:"AddToCart"}));a("#tv-final-page-TYP").length&&(c=m.cordova,c.exec(null,null,"MASHFinalPageNotification","execute",{message:"ThankYouPage"}));a("#native-add-to-cart").length&&(g.increaseCount("checkouttv:native-add-to-cart-triggered",1),c=m.cordova,c.exec(null,null,"MASHNativeAddToCartPlugin","execute",{}))})});
/* ******** */
